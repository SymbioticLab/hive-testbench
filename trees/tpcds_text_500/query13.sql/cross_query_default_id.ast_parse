(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME customer_demographics))) (TOK_TABREF (TOK_TABNAME household_demographics))) (TOK_TABREF (TOK_TABNAME customer_address))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL ss_quantity))) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL ss_ext_sales_price))) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL ss_ext_wholesale_cost))) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_ext_wholesale_cost)))) (TOK_WHERE (and (and (and (and (= (. (TOK_TABLE_OR_COL store) s_store_sk) (. (TOK_TABLE_OR_COL store_sales) ss_store_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (= (. (TOK_TABLE_OR_COL date_dim) d_year) 2001)) (or (or (and (and (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_hdemo_sk) (. (TOK_TABLE_OR_COL household_demographics) hd_demo_sk)) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_demo_sk) (. (TOK_TABLE_OR_COL store_sales) ss_cdemo_sk))) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_marital_status) 'M')) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_education_status) '4 yr Degree')) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL store_sales) ss_sales_price) 100.00 150.00)) (= (. (TOK_TABLE_OR_COL household_demographics) hd_dep_count) 3)) (and (and (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_hdemo_sk) (. (TOK_TABLE_OR_COL household_demographics) hd_demo_sk)) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_demo_sk) (. (TOK_TABLE_OR_COL store_sales) ss_cdemo_sk))) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_marital_status) 'D')) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_education_status) 'Primary')) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL store_sales) ss_sales_price) 50.00 100.00)) (= (. (TOK_TABLE_OR_COL household_demographics) hd_dep_count) 1))) (and (and (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_hdemo_sk) (. (TOK_TABLE_OR_COL household_demographics) hd_demo_sk)) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_demo_sk) (TOK_TABLE_OR_COL ss_cdemo_sk))) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_marital_status) 'U')) (= (. (TOK_TABLE_OR_COL customer_demographics) cd_education_status) 'Advanced Degree')) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL store_sales) ss_sales_price) 150.00 200.00)) (= (. (TOK_TABLE_OR_COL household_demographics) hd_dep_count) 1)))) (or (or (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_addr_sk) (. (TOK_TABLE_OR_COL customer_address) ca_address_sk)) (= (. (TOK_TABLE_OR_COL customer_address) ca_country) 'United States')) (TOK_FUNCTION in (. (TOK_TABLE_OR_COL customer_address) ca_state) 'KY' 'GA' 'NM')) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL store_sales) ss_net_profit) 100 200)) (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_addr_sk) (. (TOK_TABLE_OR_COL customer_address) ca_address_sk)) (= (. (TOK_TABLE_OR_COL customer_address) ca_country) 'United States')) (TOK_FUNCTION in (. (TOK_TABLE_OR_COL customer_address) ca_state) 'MT' 'OR' 'IN')) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL store_sales) ss_net_profit) 150 300))) (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_addr_sk) (. (TOK_TABLE_OR_COL customer_address) ca_address_sk)) (= (. (TOK_TABLE_OR_COL customer_address) ca_country) 'United States')) (TOK_FUNCTION in (. (TOK_TABLE_OR_COL customer_address) ca_state) 'WI' 'MO' 'WV')) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL store_sales) ss_net_profit) 50 250))))))) FORMATTED)