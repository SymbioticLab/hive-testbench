(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME store_returns)) (and (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL store_returns) sr_item_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_ticket_number) (. (TOK_TABLE_OR_COL store_returns) sr_ticket_number)))) (TOK_TABREF (TOK_TABNAME customer)) (= (. (TOK_TABLE_OR_COL store_sales) ss_customer_sk) (. (TOK_TABLE_OR_COL customer) c_customer_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d1) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL d1) d_date_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL customer) c_first_sales_date_sk) (. (TOK_TABLE_OR_COL d2) d_date_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d3) (= (. (TOK_TABLE_OR_COL customer) c_first_shipto_date_sk) (. (TOK_TABLE_OR_COL d3) d_date_sk))) (TOK_TABREF (TOK_TABNAME store)) (= (. (TOK_TABLE_OR_COL store_sales) ss_store_sk) (. (TOK_TABLE_OR_COL store) s_store_sk))) (TOK_TABREF (TOK_TABNAME customer_demographics) cd1) (= (. (TOK_TABLE_OR_COL store_sales) ss_cdemo_sk) (. (TOK_TABLE_OR_COL cd1) cd_demo_sk))) (TOK_TABREF (TOK_TABNAME customer_demographics) cd2) (= (. (TOK_TABLE_OR_COL customer) c_current_cdemo_sk) (. (TOK_TABLE_OR_COL cd2) cd_demo_sk))) (TOK_TABREF (TOK_TABNAME promotion)) (= (. (TOK_TABLE_OR_COL store_sales) ss_promo_sk) (. (TOK_TABLE_OR_COL promotion) p_promo_sk))) (TOK_TABREF (TOK_TABNAME household_demographics) hd1) (= (. (TOK_TABLE_OR_COL store_sales) ss_hdemo_sk) (. (TOK_TABLE_OR_COL hd1) hd_demo_sk))) (TOK_TABREF (TOK_TABNAME household_demographics) hd2) (= (. (TOK_TABLE_OR_COL customer) c_current_hdemo_sk) (. (TOK_TABLE_OR_COL hd2) hd_demo_sk))) (TOK_TABREF (TOK_TABNAME customer_address) ad1) (= (. (TOK_TABLE_OR_COL store_sales) ss_addr_sk) (. (TOK_TABLE_OR_COL ad1) ca_address_sk))) (TOK_TABREF (TOK_TABNAME customer_address) ad2) (= (. (TOK_TABLE_OR_COL customer) c_current_addr_sk) (. (TOK_TABLE_OR_COL ad2) ca_address_sk))) (TOK_TABREF (TOK_TABNAME income_band) ib1) (= (. (TOK_TABLE_OR_COL hd1) hd_income_band_sk) (. (TOK_TABLE_OR_COL ib1) ib_income_band_sk))) (TOK_TABREF (TOK_TABNAME income_band) ib2) (= (. (TOK_TABLE_OR_COL hd2) hd_income_band_sk) (. (TOK_TABLE_OR_COL ib2) ib_income_band_sk))) (TOK_TABREF (TOK_TABNAME item)) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME catalog_returns)) (and (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL catalog_returns) cr_item_sk)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_order_number) (. (TOK_TABLE_OR_COL catalog_returns) cr_order_number))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL cs_item_sk)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_list_price)) sale) (TOK_SELEXPR (TOK_FUNCTION sum (+ (+ (TOK_TABLE_OR_COL cr_refunded_cash) (TOK_TABLE_OR_COL cr_reversed_charge)) (TOK_TABLE_OR_COL cr_store_credit))) refund)) (TOK_GROUPBY (TOK_TABLE_OR_COL cs_item_sk)) (TOK_HAVING (> (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_list_price)) (* 2 (TOK_FUNCTION sum (+ (+ (TOK_TABLE_OR_COL cr_refunded_cash) (TOK_TABLE_OR_COL cr_reversed_charge)) (TOK_TABLE_OR_COL cr_store_credit)))))))) cs_ui) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL cs_ui) cs_item_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_product_name) product_name) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_sk) item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_name) store_name) (TOK_SELEXPR (TOK_TABLE_OR_COL s_zip) store_zip) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_street_number) b_street_number) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_street_name) b_streen_name) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_city) b_city) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_zip) b_zip) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_street_number) c_street_number) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_street_name) c_street_name) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_city) c_city) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_zip) c_zip) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d1) d_year) syear) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d2) d_year) fsyear) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d3) d_year) s2year) (TOK_SELEXPR (TOK_FUNCTIONSTAR count) cnt) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_wholesale_cost)) s1) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_list_price)) s2) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_coupon_amt)) s3)) (TOK_WHERE (and (and (and (<> (. (TOK_TABLE_OR_COL cd1) cd_marital_status) (. (TOK_TABLE_OR_COL cd2) cd_marital_status)) (TOK_FUNCTION in (TOK_TABLE_OR_COL i_color) 'maroon' 'burnished' 'dim' 'steel' 'navajo' 'chocolate')) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL i_current_price) 35 (+ 35 10))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL i_current_price) (+ 35 1) (+ 35 15)))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_product_name) (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL s_store_name) (TOK_TABLE_OR_COL s_zip) (. (TOK_TABLE_OR_COL ad1) ca_street_number) (. (TOK_TABLE_OR_COL ad1) ca_street_name) (. (TOK_TABLE_OR_COL ad1) ca_city) (. (TOK_TABLE_OR_COL ad1) ca_zip) (. (TOK_TABLE_OR_COL ad2) ca_street_number) (. (TOK_TABLE_OR_COL ad2) ca_street_name) (. (TOK_TABLE_OR_COL ad2) ca_city) (. (TOK_TABLE_OR_COL ad2) ca_zip) (. (TOK_TABLE_OR_COL d1) d_year) (. (TOK_TABLE_OR_COL d2) d_year) (. (TOK_TABLE_OR_COL d3) d_year)))) cs1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME store_returns)) (and (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL store_returns) sr_item_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_ticket_number) (. (TOK_TABLE_OR_COL store_returns) sr_ticket_number)))) (TOK_TABREF (TOK_TABNAME customer)) (= (. (TOK_TABLE_OR_COL store_sales) ss_customer_sk) (. (TOK_TABLE_OR_COL customer) c_customer_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d1) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL d1) d_date_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL customer) c_first_sales_date_sk) (. (TOK_TABLE_OR_COL d2) d_date_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d3) (= (. (TOK_TABLE_OR_COL customer) c_first_shipto_date_sk) (. (TOK_TABLE_OR_COL d3) d_date_sk))) (TOK_TABREF (TOK_TABNAME store)) (= (. (TOK_TABLE_OR_COL store_sales) ss_store_sk) (. (TOK_TABLE_OR_COL store) s_store_sk))) (TOK_TABREF (TOK_TABNAME customer_demographics) cd1) (= (. (TOK_TABLE_OR_COL store_sales) ss_cdemo_sk) (. (TOK_TABLE_OR_COL cd1) cd_demo_sk))) (TOK_TABREF (TOK_TABNAME customer_demographics) cd2) (= (. (TOK_TABLE_OR_COL customer) c_current_cdemo_sk) (. (TOK_TABLE_OR_COL cd2) cd_demo_sk))) (TOK_TABREF (TOK_TABNAME promotion)) (= (. (TOK_TABLE_OR_COL store_sales) ss_promo_sk) (. (TOK_TABLE_OR_COL promotion) p_promo_sk))) (TOK_TABREF (TOK_TABNAME household_demographics) hd1) (= (. (TOK_TABLE_OR_COL store_sales) ss_hdemo_sk) (. (TOK_TABLE_OR_COL hd1) hd_demo_sk))) (TOK_TABREF (TOK_TABNAME household_demographics) hd2) (= (. (TOK_TABLE_OR_COL customer) c_current_hdemo_sk) (. (TOK_TABLE_OR_COL hd2) hd_demo_sk))) (TOK_TABREF (TOK_TABNAME customer_address) ad1) (= (. (TOK_TABLE_OR_COL store_sales) ss_addr_sk) (. (TOK_TABLE_OR_COL ad1) ca_address_sk))) (TOK_TABREF (TOK_TABNAME customer_address) ad2) (= (. (TOK_TABLE_OR_COL customer) c_current_addr_sk) (. (TOK_TABLE_OR_COL ad2) ca_address_sk))) (TOK_TABREF (TOK_TABNAME income_band) ib1) (= (. (TOK_TABLE_OR_COL hd1) hd_income_band_sk) (. (TOK_TABLE_OR_COL ib1) ib_income_band_sk))) (TOK_TABREF (TOK_TABNAME income_band) ib2) (= (. (TOK_TABLE_OR_COL hd2) hd_income_band_sk) (. (TOK_TABLE_OR_COL ib2) ib_income_band_sk))) (TOK_TABREF (TOK_TABNAME item)) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME catalog_returns)) (and (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL catalog_returns) cr_item_sk)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_order_number) (. (TOK_TABLE_OR_COL catalog_returns) cr_order_number))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL cs_item_sk)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_list_price)) sale) (TOK_SELEXPR (TOK_FUNCTION sum (+ (+ (TOK_TABLE_OR_COL cr_refunded_cash) (TOK_TABLE_OR_COL cr_reversed_charge)) (TOK_TABLE_OR_COL cr_store_credit))) refund)) (TOK_GROUPBY (TOK_TABLE_OR_COL cs_item_sk)) (TOK_HAVING (> (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_list_price)) (* 2 (TOK_FUNCTION sum (+ (+ (TOK_TABLE_OR_COL cr_refunded_cash) (TOK_TABLE_OR_COL cr_reversed_charge)) (TOK_TABLE_OR_COL cr_store_credit)))))))) cs_ui) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL cs_ui) cs_item_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_product_name) product_name) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_sk) item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_name) store_name) (TOK_SELEXPR (TOK_TABLE_OR_COL s_zip) store_zip) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_street_number) b_street_number) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_street_name) b_streen_name) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_city) b_city) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad1) ca_zip) b_zip) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_street_number) c_street_number) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_street_name) c_street_name) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_city) c_city) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ad2) ca_zip) c_zip) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d1) d_year) syear) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d2) d_year) fsyear) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d3) d_year) s2year) (TOK_SELEXPR (TOK_FUNCTIONSTAR count) cnt) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_wholesale_cost)) s1) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_list_price)) s2) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_coupon_amt)) s3)) (TOK_WHERE (and (and (and (<> (. (TOK_TABLE_OR_COL cd1) cd_marital_status) (. (TOK_TABLE_OR_COL cd2) cd_marital_status)) (TOK_FUNCTION in (TOK_TABLE_OR_COL i_color) 'maroon' 'burnished' 'dim' 'steel' 'navajo' 'chocolate')) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL i_current_price) 35 (+ 35 10))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL i_current_price) (+ 35 1) (+ 35 15)))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_product_name) (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL s_store_name) (TOK_TABLE_OR_COL s_zip) (. (TOK_TABLE_OR_COL ad1) ca_street_number) (. (TOK_TABLE_OR_COL ad1) ca_street_name) (. (TOK_TABLE_OR_COL ad1) ca_city) (. (TOK_TABLE_OR_COL ad1) ca_zip) (. (TOK_TABLE_OR_COL ad2) ca_street_number) (. (TOK_TABLE_OR_COL ad2) ca_street_name) (. (TOK_TABLE_OR_COL ad2) ca_city) (. (TOK_TABLE_OR_COL ad2) ca_zip) (. (TOK_TABLE_OR_COL d1) d_year) (. (TOK_TABLE_OR_COL d2) d_year) (. (TOK_TABLE_OR_COL d3) d_year)))) cs2) (= (. (TOK_TABLE_OR_COL cs1) item_sk) (. (TOK_TABLE_OR_COL cs2) item_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) product_name)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) store_name)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) store_zip)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) b_street_number)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) b_streen_name)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) b_city)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) b_zip)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) c_street_number)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) c_street_name)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) c_city)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) c_zip)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) syear)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) cnt)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) s1)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) s2)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs1) s3)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs2) s1)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs2) s2)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs2) s3)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs2) syear)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs2) cnt))) (TOK_WHERE (and (and (and (and (= (. (TOK_TABLE_OR_COL cs1) syear) 2000) (= (. (TOK_TABLE_OR_COL cs2) syear) (+ 2000 1))) (<= (. (TOK_TABLE_OR_COL cs2) cnt) (. (TOK_TABLE_OR_COL cs1) cnt))) (= (. (TOK_TABLE_OR_COL cs1) store_name) (. (TOK_TABLE_OR_COL cs2) store_name))) (= (. (TOK_TABLE_OR_COL cs1) store_zip) (. (TOK_TABLE_OR_COL cs2) store_zip)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL cs1) product_name)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL cs1) store_name)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL cs2) cnt))))) FORMATTED)