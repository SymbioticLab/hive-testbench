Created the lattice
HiveAggregate : 1
HiveProject : 11
HiveSortLimit : 2
HiveJoin : 9
HiveTableScan : 4
HiveFilter : 3
Raajay: Total Rels = 30
Raajay: Total plans = 9
Begin exhaustive search for all query plans.
HiveSortLimit(fetch=[100]): rowcount = 1.0, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 405
  HiveSortLimit(sort0=[$0], dir0=[ASC]): rowcount = 1.0, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 399
    HiveAggregate(group=[{}], agg#0=[count()]): rowcount = 1.0, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 386
      HiveProject(DUMMY=[0]): rowcount = 208783.16195447298, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 377
        HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$3], hd_dep_count=[$4], t_time_sk=[$7], t_hour=[$8], t_minute=[$9], s_store_sk=[$5], s_store_name=[$6]): rowcount = 208783.16195447298, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 370
          HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$3], hd_dep_count=[$4], s_store_sk=[$8], s_store_name=[$9], t_time_sk=[$5], t_hour=[$6], t_minute=[$7]): rowcount = 208783.16195447298, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 366
            HiveJoin(condition=[=($2, $8)], joinType=[inner], algorithm=[none], cost=[{2296620.9633173845 rows, 0.0 cpu, 0.0 io}]): rowcount = 208783.16195447298, cumulative cost = {1.467539021894737E9 rows, 0.0 cpu, 0.0 io}, id = 362
              HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$6], hd_dep_count=[$7], t_time_sk=[$3], t_hour=[$4], t_minute=[$5]): rowcount = 2296614.781499203, cumulative cost = {1.4652424009314196E9 rows, 0.0 cpu, 0.0 io}, id = 357
                HiveJoin(condition=[=($1, $6)], joinType=[inner], algorithm=[none], cost=[{2.5263417141945772E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 2296614.781499203, cumulative cost = {1.4652424009314196E9 rows, 0.0 cpu, 0.0 io}, id = 348
                  HiveJoin(condition=[=($0, $3)], joinType=[inner], algorithm=[none], cost=[{1.4399789837894738E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 2.5262762596491225E7, cumulative cost = {1.4399789837894738E9 rows, 0.0 cpu, 0.0 io}, id = 345
                    HiveProject(ss_sold_time_sk=[$1], ss_hdemo_sk=[$5], ss_store_sk=[$7]): rowcount = 1.439977468E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 342
                      HiveTableScan(table=[[tpcds_text_500.store_sales]]): rowcount = 1.439977468E9, cumulative cost = {0}, id = 124
                    HiveProject(t_time_sk=[$0], t_hour=[$3], t_minute=[$4]): rowcount = 1515.7894736842104, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 344
                      HiveFilter(condition=[AND(=($3, 8), >=($4, 30))]): rowcount = 1515.7894736842104, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 343
                        HiveTableScan(table=[[tpcds_text_500.time_dim]]): rowcount = 86400.0, cumulative cost = {0}, id = 130
                  HiveProject(hd_demo_sk=[$0], hd_dep_count=[$3]): rowcount = 654.5454545454546, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 347
                    HiveFilter(condition=[=($3, 5)]): rowcount = 654.5454545454546, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 346
                      HiveTableScan(table=[[tpcds_text_500.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 126
              HiveProject(s_store_sk=[$0], s_store_name=[$5]): rowcount = 6.181818181818182, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 360
                HiveFilter(condition=[=($5, 'ese')]): rowcount = 6.181818181818182, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 359
                  HiveTableScan(table=[[tpcds_text_500.store]]): rowcount = 68.0, cumulative cost = {0}, id = 134

HiveSortLimit(fetch=[100]): rowcount = 1.0, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 407
  HiveSortLimit(sort0=[$0], dir0=[ASC]): rowcount = 1.0, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 391
    HiveAggregate(group=[{}], agg#0=[count()]): rowcount = 1.0, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 390
      HiveProject(DUMMY=[0]): rowcount = 208783.16195447298, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 373
        HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$3], hd_dep_count=[$4], t_time_sk=[$7], t_hour=[$8], t_minute=[$9], s_store_sk=[$5], s_store_name=[$6]): rowcount = 208783.16195447298, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 368
          HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$3], hd_dep_count=[$4], s_store_sk=[$8], s_store_name=[$9], t_time_sk=[$5], t_hour=[$6], t_minute=[$7]): rowcount = 208783.16195447298, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 365
            HiveJoin(condition=[=($2, $8)], joinType=[inner], algorithm=[none], cost=[{2296620.9633173845 rows, 0.0 cpu, 0.0 io}]): rowcount = 208783.16195447298, cumulative cost = {1.5731833018437002E9 rows, 0.0 cpu, 0.0 io}, id = 363
              HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$6], hd_dep_count=[$7], t_time_sk=[$3], t_hour=[$4], t_minute=[$5]): rowcount = 2296614.781499203, cumulative cost = {1.5708866808803828E9 rows, 0.0 cpu, 0.0 io}, id = 358
                HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], t_time_sk=[$5], t_hour=[$6], t_minute=[$7], hd_demo_sk=[$3], hd_dep_count=[$4]): rowcount = 2296614.781499203, cumulative cost = {1.5708866808803828E9 rows, 0.0 cpu, 0.0 io}, id = 356
                  HiveJoin(condition=[=($0, $5)], joinType=[inner], algorithm=[none], cost=[{1.3090855833492824E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 2296614.781499203, cumulative cost = {1.5708866808803828E9 rows, 0.0 cpu, 0.0 io}, id = 355
                    HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[{1.4399781225454545E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.3090704254545456E8, cumulative cost = {1.4399781225454545E9 rows, 0.0 cpu, 0.0 io}, id = 352
                      HiveProject(ss_sold_time_sk=[$1], ss_hdemo_sk=[$5], ss_store_sk=[$7]): rowcount = 1.439977468E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 349
                        HiveTableScan(table=[[tpcds_text_500.store_sales]]): rowcount = 1.439977468E9, cumulative cost = {0}, id = 124
                      HiveProject(hd_demo_sk=[$0], hd_dep_count=[$3]): rowcount = 654.5454545454546, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 351
                        HiveFilter(condition=[=($3, 5)]): rowcount = 654.5454545454546, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 350
                          HiveTableScan(table=[[tpcds_text_500.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 126
                    HiveProject(t_time_sk=[$0], t_hour=[$3], t_minute=[$4]): rowcount = 1515.7894736842104, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 354
                      HiveFilter(condition=[AND(=($3, 8), >=($4, 30))]): rowcount = 1515.7894736842104, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 353
                        HiveTableScan(table=[[tpcds_text_500.time_dim]]): rowcount = 86400.0, cumulative cost = {0}, id = 130
              HiveProject(s_store_sk=[$0], s_store_name=[$5]): rowcount = 6.181818181818182, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 360
                HiveFilter(condition=[=($5, 'ese')]): rowcount = 6.181818181818182, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 359
                  HiveTableScan(table=[[tpcds_text_500.store]]): rowcount = 68.0, cumulative cost = {0}, id = 134

HiveSortLimit(fetch=[100]): rowcount = 1.0, cumulative cost = {1.5827873272936058E9 rows, 0.0 cpu, 0.0 io}, id = 400
  HiveSortLimit(sort0=[$0], dir0=[ASC]): rowcount = 1.0, cumulative cost = {1.5827873272936058E9 rows, 0.0 cpu, 0.0 io}, id = 393
    HiveAggregate(group=[{}], agg#0=[count()]): rowcount = 1.0, cumulative cost = {1.5827873272936058E9 rows, 0.0 cpu, 0.0 io}, id = 387
      HiveProject(DUMMY=[0]): rowcount = 208783.16195447298, cumulative cost = {1.5827873272936058E9 rows, 0.0 cpu, 0.0 io}, id = 375
        HiveProject(ss_sold_time_sk=[$0], ss_hdemo_sk=[$1], ss_store_sk=[$2], hd_demo_sk=[$3], hd_dep_count=[$4], t_time_sk=[$7], t_hour=[$8], t_minute=[$9], s_store_sk=[$5], s_store_name=[$6]): rowcount = 208783.16195447298, cumulative cost = {1.5827873272936058E9 rows, 0.0 cpu, 0.0 io}, id = 372
          HiveJoin(condition=[=($0, $7)], joinType=[inner], algorithm=[none], cost=[{1.1902156020878645E7 rows, 0.0 cpu, 0.0 io}]): rowcount = 208783.16195447298, cumulative cost = {1.5827873272936058E9 rows, 0.0 cpu, 0.0 io}, id = 333
            HiveJoin(condition=[=($2, $5)], joinType=[inner], algorithm=[none], cost=[{1.3090704872727275E8 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.190064023140496E7, cumulative cost = {1.5708851712727273E9 rows, 0.0 cpu, 0.0 io}, id = 312
              HiveJoin(condition=[=($1, $3)], joinType=[inner], algorithm=[none], cost=[{1.4399781225454545E9 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.3090704254545456E8, cumulative cost = {1.4399781225454545E9 rows, 0.0 cpu, 0.0 io}, id = 309
                HiveProject(ss_sold_time_sk=[$1], ss_hdemo_sk=[$5], ss_store_sk=[$7]): rowcount = 1.439977468E9, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 306
                  HiveTableScan(table=[[tpcds_text_500.store_sales]]): rowcount = 1.439977468E9, cumulative cost = {0}, id = 124
                HiveProject(hd_demo_sk=[$0], hd_dep_count=[$3]): rowcount = 654.5454545454546, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 308
                  HiveFilter(condition=[=($3, 5)]): rowcount = 654.5454545454546, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 307
                    HiveTableScan(table=[[tpcds_text_500.household_demographics]]): rowcount = 7200.0, cumulative cost = {0}, id = 126
              HiveProject(s_store_sk=[$0], s_store_name=[$5]): rowcount = 6.181818181818182, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 311
                HiveFilter(condition=[=($5, 'ese')]): rowcount = 6.181818181818182, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 310
                  HiveTableScan(table=[[tpcds_text_500.store]]): rowcount = 68.0, cumulative cost = {0}, id = 134
            HiveProject(t_time_sk=[$0], t_hour=[$3], t_minute=[$4]): rowcount = 1515.7894736842104, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 331
              HiveFilter(condition=[AND(=($3, 8), >=($4, 30))]): rowcount = 1515.7894736842104, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 330
                HiveTableScan(table=[[tpcds_text_500.time_dim]]): rowcount = 86400.0, cumulative cost = {0}, id = 130

{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"Edges:":{"Map 1":[{"parent":"Map 4","type":"BROADCAST_EDGE"},{"parent":"Map 5","type":"BROADCAST_EDGE"},{"parent":"Map 6","type":"BROADCAST_EDGE"}],"Reducer 2":{"parent":"Map 1","type":"SIMPLE_EDGE"},"Reducer 3":{"parent":"Reducer 2","type":"SIMPLE_EDGE"}},"DagName:":"wentingt_20180312152046_ec25bc07-f580-4ef4-915d-db20f1be8c9d:1","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"store_sales","Statistics:":"Num rows: 1439977468 Data size: 201545980594 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((ss_hdemo_sk is not null and ss_sold_time_sk is not null) and ss_store_sk is not null) (type: boolean)","Statistics:":"Num rows: 179997184 Data size: 25193247644 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 179997184 Data size: 25193247644 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col1 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col0","_col2"],"input vertices:":{"1":"Map 4"},"Statistics:":"Num rows: 197996906 Data size: 27712573009 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col2"],"input vertices:":{"1":"Map 5"},"Statistics:":"Num rows: 217796601 Data size: 30483830970 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col2 (type: int)","1":"_col0 (type: int)"},"input vertices:":{"1":"Map 6"},"Statistics:":"Num rows: 239576266 Data size: 33532214793 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Group By Operator":{"aggregations:":["count()"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)"}}}}}}}}}}}}}}}}]},"Map 4":{"Map Operator Tree:":[{"TableScan":{"alias:":"household_demographics","Statistics:":"Num rows: 7200 Data size: 144453 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((hd_dep_count = 5) and hd_demo_sk is not null) (type: boolean)","Statistics:":"Num rows: 1800 Data size: 36113 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"hd_demo_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1800 Data size: 36113 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 1800 Data size: 36113 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"time_dim","Statistics:":"Num rows: 86400 Data size: 5021380 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(((t_hour = 8) and (t_minute >= 30)) and t_time_sk is not null) (type: boolean)","Statistics:":"Num rows: 7200 Data size: 418448 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"t_time_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 7200 Data size: 418448 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 7200 Data size: 418448 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Map 6":{"Map Operator Tree:":[{"TableScan":{"alias:":"store","Statistics:":"Num rows: 68 Data size: 18027 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)","Statistics:":"Num rows: 17 Data size: 4506 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"s_store_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 17 Data size: 4506 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 17 Data size: 4506 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Reducer 2":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE"}}}}},"Reducer 3":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"KEY.reducesinkkey0 (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"Limit":{"Number of rows:":"100","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}}}}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"100","Processor Tree:":{"ListSink":{}}}}}}
