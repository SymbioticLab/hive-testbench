(TOK_EXPLAIN (TOK_QUERY (TOK_CTE (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME inventory)) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME warehouse))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL w_warehouse_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL w_warehouse_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_moy)) (TOK_SELEXPR (TOK_FUNCTION stddev_samp (TOK_TABLE_OR_COL inv_quantity_on_hand)) stdev) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL inv_quantity_on_hand)) mean)) (TOK_WHERE (and (and (and (= (TOK_TABLE_OR_COL inv_item_sk) (TOK_TABLE_OR_COL i_item_sk)) (= (TOK_TABLE_OR_COL inv_warehouse_sk) (TOK_TABLE_OR_COL w_warehouse_sk))) (= (TOK_TABLE_OR_COL inv_date_sk) (TOK_TABLE_OR_COL d_date_sk))) (= (TOK_TABLE_OR_COL d_year) 1999))) (TOK_GROUPBY (TOK_TABLE_OR_COL w_warehouse_name) (TOK_TABLE_OR_COL w_warehouse_sk) (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL d_moy)))) foo)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL w_warehouse_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL w_warehouse_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_moy)) (TOK_SELEXPR (TOK_TABLE_OR_COL stdev)) (TOK_SELEXPR (TOK_TABLE_OR_COL mean)) (TOK_SELEXPR (TOK_FUNCTION case (TOK_TABLE_OR_COL mean) 0 TOK_NULL (/ (TOK_TABLE_OR_COL stdev) (TOK_TABLE_OR_COL mean))) cov)) (TOK_WHERE (> (TOK_FUNCTION case (TOK_TABLE_OR_COL mean) 0 0 (/ (TOK_TABLE_OR_COL stdev) (TOK_TABLE_OR_COL mean))) 1)))) inv)) (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME inv) inv1) (TOK_TABREF (TOK_TABNAME inv) inv2))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv1) w_warehouse_sk)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv1) i_item_sk)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv1) d_moy)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv1) mean)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv1) cov)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv2) w_warehouse_sk)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv2) i_item_sk)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv2) d_moy)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv2) mean)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL inv2) cov))) (TOK_WHERE (and (and (and (and (= (. (TOK_TABLE_OR_COL inv1) i_item_sk) (. (TOK_TABLE_OR_COL inv2) i_item_sk)) (= (. (TOK_TABLE_OR_COL inv1) w_warehouse_sk) (. (TOK_TABLE_OR_COL inv2) w_warehouse_sk))) (= (. (TOK_TABLE_OR_COL inv1) d_moy) 3)) (= (. (TOK_TABLE_OR_COL inv2) d_moy) (+ 3 1))) (> (. (TOK_TABLE_OR_COL inv1) cov) 1.5))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv1) w_warehouse_sk)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv1) i_item_sk)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv1) d_moy)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv1) mean)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv1) cov)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv2) d_moy)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv2) mean)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL inv2) cov))))) FORMATTED)