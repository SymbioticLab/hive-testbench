(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_FULLOUTERJOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales) ss) (TOK_TABREF (TOK_TABNAME date_dim) d1) (= (. (TOK_TABLE_OR_COL ss) ss_sold_date_sk) (. (TOK_TABLE_OR_COL d1) d_date_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL ss) ss_customer_sk) customer_sk) (TOK_SELEXPR (. (TOK_TABLE_OR_COL ss) ss_item_sk) item_sk)) (TOK_WHERE (and (>= (. (TOK_TABLE_OR_COL d1) d_month_seq) 1206) (<= (. (TOK_TABLE_OR_COL d1) d_month_seq) 1217))) (TOK_GROUPBY (. (TOK_TABLE_OR_COL ss) ss_customer_sk) (. (TOK_TABLE_OR_COL ss) ss_item_sk)))) ssci) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales) cs) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL cs) cs_sold_date_sk) (. (TOK_TABLE_OR_COL d2) d_date_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs) cs_bill_customer_sk) customer_sk) (TOK_SELEXPR (. (TOK_TABLE_OR_COL cs) cs_item_sk) item_sk)) (TOK_WHERE (and (>= (. (TOK_TABLE_OR_COL d2) d_month_seq) 1206) (<= (. (TOK_TABLE_OR_COL d2) d_month_seq) 1217))) (TOK_GROUPBY (. (TOK_TABLE_OR_COL cs) cs_bill_customer_sk) (. (TOK_TABLE_OR_COL cs) cs_item_sk)))) csci) (and (= (. (TOK_TABLE_OR_COL ssci) customer_sk) (. (TOK_TABLE_OR_COL csci) customer_sk)) (= (. (TOK_TABLE_OR_COL ssci) item_sk) (. (TOK_TABLE_OR_COL csci) item_sk))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL ssci) customer_sk)) (TOK_FUNCTION TOK_ISNULL (. (TOK_TABLE_OR_COL csci) customer_sk))) 1 0)) store_only) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (TOK_FUNCTION TOK_ISNULL (. (TOK_TABLE_OR_COL ssci) customer_sk)) (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL csci) customer_sk))) 1 0)) catalog_only) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL ssci) customer_sk)) (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL csci) customer_sk))) 1 0)) store_and_catalog)))) FORMATTED)