(TOK_EXPLAIN (TOK_QUERY (TOK_CTE (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_SUBQUERY (TOK_UNIONALL (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME catalog_sales))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL cs_sold_date_sk) sold_date_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_bill_customer_sk) customer_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_item_sk) item_sk)))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME web_sales))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ws_sold_date_sk) sold_date_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_bill_customer_sk) customer_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_item_sk) item_sk))))) cs_or_ws_sales) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME customer)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL c_customer_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL c_current_addr_sk))) (TOK_WHERE (and (and (and (and (and (and (= (TOK_TABLE_OR_COL sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (= (TOK_TABLE_OR_COL item_sk) (TOK_TABLE_OR_COL i_item_sk))) (= (TOK_TABLE_OR_COL i_category) 'Jewelry')) (= (TOK_TABLE_OR_COL i_class) 'football')) (= (TOK_TABLE_OR_COL c_customer_sk) (. (TOK_TABLE_OR_COL cs_or_ws_sales) customer_sk))) (= (TOK_TABLE_OR_COL d_moy) 3)) (= (TOK_TABLE_OR_COL d_year) 2000))) (TOK_GROUPBY (TOK_TABLE_OR_COL c_customer_sk) (TOK_TABLE_OR_COL c_current_addr_sk)))) my_customers) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME my_customers)) (TOK_TABREF (TOK_TABNAME store_sales))) (TOK_TABREF (TOK_TABNAME customer_address))) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL c_customer_sk)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_ext_sales_price)) revenue)) (TOK_WHERE (and (and (and (and (and (= (TOK_TABLE_OR_COL c_current_addr_sk) (TOK_TABLE_OR_COL ca_address_sk)) (= (TOK_TABLE_OR_COL ca_county) (TOK_TABLE_OR_COL s_county))) (= (TOK_TABLE_OR_COL ca_state) (TOK_TABLE_OR_COL s_state))) (= (TOK_TABLE_OR_COL ss_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk))) (= (TOK_TABLE_OR_COL c_customer_sk) (TOK_TABLE_OR_COL ss_customer_sk))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1203 1205))) (TOK_GROUPBY (TOK_TABLE_OR_COL c_customer_sk)))) my_revenue) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME my_revenue))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION TOK_INT (/ (TOK_TABLE_OR_COL revenue) 50)) segment)))) segments)) (TOK_FROM (TOK_TABREF (TOK_TABNAME segments))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL segment)) (TOK_SELEXPR (TOK_FUNCTIONSTAR count) num_customers) (TOK_SELEXPR (* (TOK_TABLE_OR_COL segment) 50) segment_base)) (TOK_GROUPBY (TOK_TABLE_OR_COL segment)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL segment)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL num_customers))) (TOK_LIMIT 100))) FORMATTED)