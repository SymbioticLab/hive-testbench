Created the lattice
HiveAggregate : 3
HiveProject : 29
HiveJoin : 12
HiveUnion : 2
HiveSortLimit : 2
HiveTableScan : 7
HiveFilter : 10
Raajay: Total Rels = 65
Raajay: Total plans = 27
Begin exhaustive search for all query plans.
HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709543.9246794871 rows, 0.0 cpu, 0.0 io}, id = 1117
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709543.9246794871 rows, 0.0 cpu, 0.0 io}, id = 1094
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709543.9246794871 rows, 0.0 cpu, 0.0 io}, id = 1056
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709543.9246794871 rows, 0.0 cpu, 0.0 io}, id = 1041
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304224.4737230362 rows, 0.0 cpu, 0.0 io}, id = 974
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 923
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 918
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 917
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 912
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 910
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 908
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 905
                        HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_order_number=[$2], ws_quantity=[$3], ws_net_paid=[$4], ws_net_profit=[$5], wr_item_sk=[$9], wr_order_number=[$10], wr_return_quantity=[$11], wr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 902
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{47912.94421550671 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 891
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{53355.615460927955 rows, 0.0 cpu, 0.0 io}]): rowcount = 36.61088217338217, cumulative cost = {53355.615460927955 rows, 0.0 cpu, 0.0 io}, id = 888
                              HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 885
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 884
                                  HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 887
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 886
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 890
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 889
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 971
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 966
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 964
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 961
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 958
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 956
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 951
                        HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_order_number=[$2], cs_quantity=[$3], cs_net_paid=[$4], cs_net_profit=[$5], cr_item_sk=[$9], cr_order_number=[$10], cr_return_quantity=[$11], cr_return_amount=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 950
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{96236.92821530321 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 939
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{106718.98583129831 rows, 0.0 cpu, 0.0 io}]): rowcount = 73.26154863654864, cumulative cost = {106718.98583129831 rows, 0.0 cpu, 0.0 io}, id = 936
                              HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 933
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 932
                                  HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 935
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 934
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 938
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 937
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1027
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1025
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1020
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1019
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1016
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1011
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1009
                      HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ticket_number=[$2], ss_quantity=[$3], ss_net_paid=[$4], ss_net_profit=[$5], sr_item_sk=[$9], sr_ticket_number=[$10], sr_return_quantity=[$11], sr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1006
                        HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{191908.20586589337 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 996
                          HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{213411.24509055758 rows, 0.0 cpu, 0.0 io}]): rowcount = 146.53919922669922, cumulative cost = {213411.24509055758 rows, 0.0 cpu, 0.0 io}, id = 993
                            HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 990
                              HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 989
                                HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                            HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 992
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 991
                                HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 995
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 994
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709564.9743611967 rows, 0.0 cpu, 0.0 io}, id = 1132
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709564.9743611967 rows, 0.0 cpu, 0.0 io}, id = 1093
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709564.9743611967 rows, 0.0 cpu, 0.0 io}, id = 1063
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709564.9743611967 rows, 0.0 cpu, 0.0 io}, id = 1044
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304245.5234047458 rows, 0.0 cpu, 0.0 io}, id = 972
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 922
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 920
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 915
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 914
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 909
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 907
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 903
                        HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{107.83158036652513 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 883
                          HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{101181.77777777777 rows, 0.0 cpu, 0.0 io}]): rowcount = 57.66056388300864, cumulative cost = {101181.77777777777 rows, 0.0 cpu, 0.0 io}, id = 880
                            HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 877
                              HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 876
                                HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 879
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 878
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
                          HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 882
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 881
                              HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 971
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 966
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 964
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 961
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 958
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 956
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 951
                        HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_order_number=[$2], cs_quantity=[$3], cs_net_paid=[$4], cs_net_profit=[$5], cr_item_sk=[$9], cr_order_number=[$10], cr_return_quantity=[$11], cr_return_amount=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 950
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{96236.92821530321 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 939
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{106718.98583129831 rows, 0.0 cpu, 0.0 io}]): rowcount = 73.26154863654864, cumulative cost = {106718.98583129831 rows, 0.0 cpu, 0.0 io}, id = 936
                              HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 933
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 932
                                  HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 935
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 934
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 938
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 937
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1027
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1025
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1020
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1019
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1016
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1011
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1009
                      HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ticket_number=[$2], ss_quantity=[$3], ss_net_paid=[$4], ss_net_profit=[$5], sr_item_sk=[$9], sr_ticket_number=[$10], sr_return_quantity=[$11], sr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1006
                        HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{191908.20586589337 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 996
                          HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{213411.24509055758 rows, 0.0 cpu, 0.0 io}]): rowcount = 146.53919922669922, cumulative cost = {213411.24509055758 rows, 0.0 cpu, 0.0 io}, id = 993
                            HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 990
                              HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 989
                                HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                            HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 992
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 991
                                HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 995
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 994
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709591.6726165921 rows, 0.0 cpu, 0.0 io}, id = 1112
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709591.6726165921 rows, 0.0 cpu, 0.0 io}, id = 1092
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709591.6726165921 rows, 0.0 cpu, 0.0 io}, id = 1079
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709591.6726165921 rows, 0.0 cpu, 0.0 io}, id = 1039
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304272.22166014113 rows, 0.0 cpu, 0.0 io}, id = 980
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 923
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 918
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 917
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 912
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 910
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 908
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 905
                        HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_order_number=[$2], ws_quantity=[$3], ws_net_paid=[$4], ws_net_profit=[$5], wr_item_sk=[$9], wr_order_number=[$10], wr_return_quantity=[$11], wr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 902
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{47912.94421550671 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 891
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{53355.615460927955 rows, 0.0 cpu, 0.0 io}]): rowcount = 36.61088217338217, cumulative cost = {53355.615460927955 rows, 0.0 cpu, 0.0 io}, id = 888
                              HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 885
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 884
                                  HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 887
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 886
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 890
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 889
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 970
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 967
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 963
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 960
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 957
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 954
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 953
                        HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{171.1805022250359 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 931
                          HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{202832.48148148146 rows, 0.0 cpu, 0.0 io}]): rowcount = 121.00948574151941, cumulative cost = {202832.48148148146 rows, 0.0 cpu, 0.0 io}, id = 928
                            HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 925
                              HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 924
                                HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 927
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 926
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
                          HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 930
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 929
                              HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1027
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1025
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1020
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1019
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1016
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1011
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1009
                      HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ticket_number=[$2], ss_quantity=[$3], ss_net_paid=[$4], ss_net_profit=[$5], sr_item_sk=[$9], sr_ticket_number=[$10], sr_return_quantity=[$11], sr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1006
                        HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{191908.20586589337 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 996
                          HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{213411.24509055758 rows, 0.0 cpu, 0.0 io}]): rowcount = 146.53919922669922, cumulative cost = {213411.24509055758 rows, 0.0 cpu, 0.0 io}, id = 993
                            HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 990
                              HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 989
                                HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                            HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 992
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 991
                                HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 995
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 994
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709612.7222983018 rows, 0.0 cpu, 0.0 io}, id = 1119
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709612.7222983018 rows, 0.0 cpu, 0.0 io}, id = 1084
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709612.7222983018 rows, 0.0 cpu, 0.0 io}, id = 1070
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709612.7222983018 rows, 0.0 cpu, 0.0 io}, id = 1038
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304293.2713418508 rows, 0.0 cpu, 0.0 io}, id = 975
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 922
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 920
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 915
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 914
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 909
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 907
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 903
                        HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{107.83158036652513 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 883
                          HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{101181.77777777777 rows, 0.0 cpu, 0.0 io}]): rowcount = 57.66056388300864, cumulative cost = {101181.77777777777 rows, 0.0 cpu, 0.0 io}, id = 880
                            HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 877
                              HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 876
                                HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 879
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 878
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
                          HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 882
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 881
                              HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 969
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 968
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 965
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 962
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 959
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 955
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 952
                        HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_order_number=[$2], cs_quantity=[$3], cs_net_paid=[$4], cs_net_profit=[$5], cr_item_sk=[$9], cr_order_number=[$10], cr_return_quantity=[$11], cr_return_amount=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 949
                          HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_order_number=[$2], cs_quantity=[$3], cs_net_paid=[$4], cs_net_profit=[$5], d_date_sk=[$10], d_year=[$11], d_moy=[$12], cr_item_sk=[$6], cr_order_number=[$7], cr_return_quantity=[$8], cr_return_amount=[$9]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 948
                            HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{171.1805022250359 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 947
                              HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{202832.48148148146 rows, 0.0 cpu, 0.0 io}]): rowcount = 121.00948574151941, cumulative cost = {202832.48148148146 rows, 0.0 cpu, 0.0 io}, id = 944
                                HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 941
                                  HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 940
                                    HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                                HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 943
                                  HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 942
                                    HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 946
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 945
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1027
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1025
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1020
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1019
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1016
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1011
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1009
                      HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ticket_number=[$2], ss_quantity=[$3], ss_net_paid=[$4], ss_net_profit=[$5], sr_item_sk=[$9], sr_ticket_number=[$10], sr_return_quantity=[$11], sr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 1006
                        HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{191908.20586589337 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405319.45095645095 rows, 0.0 cpu, 0.0 io}, id = 996
                          HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{213411.24509055758 rows, 0.0 cpu, 0.0 io}]): rowcount = 146.53919922669922, cumulative cost = {213411.24509055758 rows, 0.0 cpu, 0.0 io}, id = 993
                            HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 990
                              HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 989
                                HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                            HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 992
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 991
                                HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 995
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 994
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709786.0509264907 rows, 0.0 cpu, 0.0 io}, id = 1126
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709786.0509264907 rows, 0.0 cpu, 0.0 io}, id = 1085
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709786.0509264907 rows, 0.0 cpu, 0.0 io}, id = 1062
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709786.0509264907 rows, 0.0 cpu, 0.0 io}, id = 1050
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304224.4737230362 rows, 0.0 cpu, 0.0 io}, id = 974
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 923
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 918
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 917
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 912
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 910
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 908
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 905
                        HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_order_number=[$2], ws_quantity=[$3], ws_net_paid=[$4], ws_net_profit=[$5], wr_item_sk=[$9], wr_order_number=[$10], wr_return_quantity=[$11], wr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 902
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{47912.94421550671 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 891
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{53355.615460927955 rows, 0.0 cpu, 0.0 io}]): rowcount = 36.61088217338217, cumulative cost = {53355.615460927955 rows, 0.0 cpu, 0.0 io}, id = 888
                              HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 885
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 884
                                  HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 887
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 886
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 890
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 889
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 971
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 966
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 964
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 961
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 958
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 956
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 951
                        HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_order_number=[$2], cs_quantity=[$3], cs_net_paid=[$4], cs_net_profit=[$5], cr_item_sk=[$9], cr_order_number=[$10], cr_return_quantity=[$11], cr_return_amount=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 950
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{96236.92821530321 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 939
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{106718.98583129831 rows, 0.0 cpu, 0.0 io}]): rowcount = 73.26154863654864, cumulative cost = {106718.98583129831 rows, 0.0 cpu, 0.0 io}, id = 936
                              HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 933
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 932
                                  HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 935
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 934
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 938
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 937
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1028
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1024
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1022
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1018
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1014
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1012
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1008
                      HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{438.8364627138319 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 988
                        HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{405122.74074074073 rows, 0.0 cpu, 0.0 io}]): rowcount = 388.6654462303154, cumulative cost = {405122.74074074073 rows, 0.0 cpu, 0.0 io}, id = 985
                          HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 982
                            HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 981
                              HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 984
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 983
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508
                        HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 987
                          HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 986
                            HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709807.1006082003 rows, 0.0 cpu, 0.0 io}, id = 1124
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709807.1006082003 rows, 0.0 cpu, 0.0 io}, id = 1088
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709807.1006082003 rows, 0.0 cpu, 0.0 io}, id = 1081
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709807.1006082003 rows, 0.0 cpu, 0.0 io}, id = 1053
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304245.5234047458 rows, 0.0 cpu, 0.0 io}, id = 972
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 922
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 920
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 915
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 914
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 909
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 907
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 903
                        HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{107.83158036652513 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 883
                          HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{101181.77777777777 rows, 0.0 cpu, 0.0 io}]): rowcount = 57.66056388300864, cumulative cost = {101181.77777777777 rows, 0.0 cpu, 0.0 io}, id = 880
                            HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 877
                              HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 876
                                HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 879
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 878
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
                          HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 882
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 881
                              HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 971
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 966
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 964
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 961
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 958
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 956
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 951
                        HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$1], cs_order_number=[$2], cs_quantity=[$3], cs_net_paid=[$4], cs_net_profit=[$5], cr_item_sk=[$9], cr_order_number=[$10], cr_return_quantity=[$11], cr_return_amount=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 950
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{96236.92821530321 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {202955.9140466015 rows, 0.0 cpu, 0.0 io}, id = 939
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{106718.98583129831 rows, 0.0 cpu, 0.0 io}]): rowcount = 73.26154863654864, cumulative cost = {106718.98583129831 rows, 0.0 cpu, 0.0 io}, id = 936
                              HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 933
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 932
                                  HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 935
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 934
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 938
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 937
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1028
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1024
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1022
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1018
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1014
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1012
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1008
                      HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{438.8364627138319 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 988
                        HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{405122.74074074073 rows, 0.0 cpu, 0.0 io}]): rowcount = 388.6654462303154, cumulative cost = {405122.74074074073 rows, 0.0 cpu, 0.0 io}, id = 985
                          HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 982
                            HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 981
                              HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 984
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 983
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508
                        HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 987
                          HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 986
                            HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709833.7988635957 rows, 0.0 cpu, 0.0 io}, id = 1135
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709833.7988635957 rows, 0.0 cpu, 0.0 io}, id = 1095
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709833.7988635957 rows, 0.0 cpu, 0.0 io}, id = 1068
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709833.7988635957 rows, 0.0 cpu, 0.0 io}, id = 1048
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304272.22166014113 rows, 0.0 cpu, 0.0 io}, id = 980
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 923
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 918
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 917
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 912
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 910
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 908
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 905
                        HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_order_number=[$2], ws_quantity=[$3], ws_net_paid=[$4], ws_net_profit=[$5], wr_item_sk=[$9], wr_order_number=[$10], wr_return_quantity=[$11], wr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 902
                          HiveJoin(condition=[AND(=($2, $10), =($1, $9))], joinType=[inner], algorithm=[none], cost=[{47912.94421550671 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101268.55967643467 rows, 0.0 cpu, 0.0 io}, id = 891
                            HiveJoin(condition=[=($0, $6)], joinType=[inner], algorithm=[none], cost=[{53355.615460927955 rows, 0.0 cpu, 0.0 io}]): rowcount = 36.61088217338217, cumulative cost = {53355.615460927955 rows, 0.0 cpu, 0.0 io}, id = 888
                              HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 885
                                HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 884
                                  HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 887
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 886
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
                            HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 890
                              HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 889
                                HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 970
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 967
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 963
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 960
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 957
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 954
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 953
                        HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{171.1805022250359 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 931
                          HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{202832.48148148146 rows, 0.0 cpu, 0.0 io}]): rowcount = 121.00948574151941, cumulative cost = {202832.48148148146 rows, 0.0 cpu, 0.0 io}, id = 928
                            HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 925
                              HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 924
                                HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 927
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 926
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
                          HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 930
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 929
                              HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1028
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1024
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1022
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1018
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1014
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1012
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1008
                      HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{438.8364627138319 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 988
                        HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{405122.74074074073 rows, 0.0 cpu, 0.0 io}]): rowcount = 388.6654462303154, cumulative cost = {405122.74074074073 rows, 0.0 cpu, 0.0 io}, id = 985
                          HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 982
                            HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 981
                              HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                          HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 984
                            HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 983
                              HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508
                        HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 987
                          HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 986
                            HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475

HiveSortLimit(fetch=[100]): rowcount = 3.0, cumulative cost = {709854.8485453054 rows, 0.0 cpu, 0.0 io}, id = 1113
  HiveSortLimit(sort0=[$5], sort1=[$6], sort2=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC]): rowcount = 3.0, cumulative cost = {709854.8485453054 rows, 0.0 cpu, 0.0 io}, id = 1109
    HiveProject(channel=[$0], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4], 1=[1], 4=[4], 5=[5]): rowcount = 3.0, cumulative cost = {709854.8485453054 rows, 0.0 cpu, 0.0 io}, id = 1057
      HiveUnion(all=[true]): rowcount = 3.0, cumulative cost = {709854.8485453054 rows, 0.0 cpu, 0.0 io}, id = 1031
        HiveUnion(all=[true]): rowcount = 2.0, cumulative cost = {304293.2713418508 rows, 0.0 cpu, 0.0 io}, id = 979
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 921
            HiveProject(channel=['web'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 919
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 916
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 913
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 911
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 906
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 904
                        HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_order_number=[$2], ws_quantity=[$3], ws_net_paid=[$4], ws_net_profit=[$5], wr_item_sk=[$9], wr_order_number=[$10], wr_return_quantity=[$11], wr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 901
                          HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$1], ws_order_number=[$2], ws_quantity=[$3], ws_net_paid=[$4], ws_net_profit=[$5], d_date_sk=[$10], d_year=[$11], d_moy=[$12], wr_item_sk=[$6], wr_order_number=[$7], wr_return_quantity=[$8], wr_return_amt=[$9]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 900
                            HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{107.83158036652513 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {101289.6093581443 rows, 0.0 cpu, 0.0 io}, id = 899
                              HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{101181.77777777777 rows, 0.0 cpu, 0.0 io}]): rowcount = 57.66056388300864, cumulative cost = {101181.77777777777 rows, 0.0 cpu, 0.0 io}, id = 896
                                HiveProject(ws_sold_date_sk=[$0], ws_item_sk=[$3], ws_order_number=[$17], ws_quantity=[$18], ws_net_paid=[$29], ws_net_profit=[$33]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 893
                                  HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 53305.44444444444, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 892
                                    HiveTableScan(table=[[tpcds_text_2.web_sales]]): rowcount = 1439247.0, cumulative cost = {0}, id = 468
                                HiveProject(wr_item_sk=[$2], wr_order_number=[$13], wr_return_quantity=[$14], wr_return_amt=[$15]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 895
                                  HiveFilter(condition=[>($15, 1E4)]): rowcount = 47876.33333333333, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 894
                                    HiveTableScan(table=[[tpcds_text_2.web_returns]]): rowcount = 143629.0, cumulative cost = {0}, id = 471
                              HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 898
                                HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 897
                                  HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
          HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 970
            HiveProject(channel=['catalog'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 967
              HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 963
                HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 960
                  HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 957
                    HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 954
                      HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 953
                        HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{171.1805022250359 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {203003.6619837065 rows, 0.0 cpu, 0.0 io}, id = 931
                          HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{202832.48148148146 rows, 0.0 cpu, 0.0 io}]): rowcount = 121.00948574151941, cumulative cost = {202832.48148148146 rows, 0.0 cpu, 0.0 io}, id = 928
                            HiveProject(cs_sold_date_sk=[$0], cs_item_sk=[$15], cs_order_number=[$17], cs_quantity=[$18], cs_net_paid=[$29], cs_net_profit=[$33]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 925
                              HiveFilter(condition=[AND(>($33, 1E0), >($29, 0E0), >($18, 0))]): rowcount = 106668.8148148148, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 924
                                HiveTableScan(table=[[tpcds_text_2.catalog_sales]]): rowcount = 2880058.0, cumulative cost = {0}, id = 486
                            HiveProject(cr_item_sk=[$2], cr_order_number=[$16], cr_return_quantity=[$17], cr_return_amount=[$18]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 927
                              HiveFilter(condition=[>($18, 1E4)]): rowcount = 96163.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 926
                                HiveTableScan(table=[[tpcds_text_2.catalog_returns]]): rowcount = 288491.0, cumulative cost = {0}, id = 489
                          HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 930
                            HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 929
                              HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475
        HiveProject(channel=[CAST($0):VARCHAR(2147483647) CHARACTER SET "ISO-8859-1" COLLATE "ISO-8859-1$en_US$primary" NOT NULL], item=[$1], return_ratio=[$2], return_rank=[$3], currency_rank=[$4]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1026
          HiveProject(channel=['store'], item=[$0], return_ratio=[$1], return_rank=[$2], currency_rank=[$3]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1023
            HiveFilter(condition=[OR(<=($2, 10), <=($3, 10))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1021
              HiveProject(item=[$0], return_ratio=[$1], rank_window_0=[rank() OVER (PARTITION BY 0 ORDER BY $1 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)], rank_window_1=[rank() OVER (PARTITION BY 0 ORDER BY $2 ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1017
                HiveProject(item=[$0], return_ratio=[/(CAST($1):DECIMAL(15, 4), CAST($2):DECIMAL(15, 4))], currency_ratio=[/(CAST($3):DECIMAL(15, 4), CAST($4):DECIMAL(15, 4))]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1015
                  HiveAggregate(group=[{0}], agg#0=[sum($1)], agg#1=[sum($2)], agg#2=[sum($3)], agg#3=[sum($4)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1013
                    HiveProject($f0=[$1], $f1=[coalesce($8, 0)], $f2=[coalesce($3, 0)], $f3=[coalesce($9, 0)], $f4=[coalesce($4, 0)]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1010
                      HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ticket_number=[$2], ss_quantity=[$3], ss_net_paid=[$4], ss_net_profit=[$5], sr_item_sk=[$9], sr_ticket_number=[$10], sr_return_quantity=[$11], sr_return_amt=[$12], d_date_sk=[$6], d_year=[$7], d_moy=[$8]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1007
                        HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$1], ss_ticket_number=[$2], ss_quantity=[$3], ss_net_paid=[$4], ss_net_profit=[$5], d_date_sk=[$10], d_year=[$11], d_moy=[$12], sr_item_sk=[$6], sr_ticket_number=[$7], sr_return_quantity=[$8], sr_return_amt=[$9]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1005
                          HiveJoin(condition=[=($0, $10)], joinType=[inner], algorithm=[none], cost=[{438.8364627138319 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {405561.57720345457 rows, 0.0 cpu, 0.0 io}, id = 1004
                            HiveJoin(condition=[AND(=($2, $7), =($1, $6))], joinType=[inner], algorithm=[none], cost=[{405122.74074074073 rows, 0.0 cpu, 0.0 io}]): rowcount = 388.6654462303154, cumulative cost = {405122.74074074073 rows, 0.0 cpu, 0.0 io}, id = 1001
                              HiveProject(ss_sold_date_sk=[$0], ss_item_sk=[$2], ss_ticket_number=[$9], ss_quantity=[$10], ss_net_paid=[$20], ss_net_profit=[$22]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 998
                                HiveFilter(condition=[AND(>($22, 1E0), >($20, 0E0), >($10, 0))]): rowcount = 213361.07407407407, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 997
                                  HiveTableScan(table=[[tpcds_text_2.store_sales]]): rowcount = 5760749.0, cumulative cost = {0}, id = 505
                              HiveProject(sr_item_sk=[$2], sr_ticket_number=[$9], sr_return_quantity=[$10], sr_return_amt=[$11]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1000
                                HiveFilter(condition=[>($11, 1E4)]): rowcount = 191761.66666666666, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 999
                                  HiveTableScan(table=[[tpcds_text_2.store_returns]]): rowcount = 575285.0, cumulative cost = {0}, id = 508
                            HiveProject(d_date_sk=[$0], d_year=[$6], d_moy=[$8]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1003
                              HiveFilter(condition=[AND(=($6, 2000), =($8, 12))]): rowcount = 50.17101648351649, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 1002
                                HiveTableScan(table=[[tpcds_text_2.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 475

{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"Edges:":{"Reducer 11":[{"parent":"Map 10","type":"SIMPLE_EDGE"},{"parent":"Map 15","type":"SIMPLE_EDGE"},{"parent":"Map 16","type":"BROADCAST_EDGE"}],"Reducer 12":{"parent":"Reducer 11","type":"SIMPLE_EDGE"},"Reducer 13":{"parent":"Reducer 12","type":"SIMPLE_EDGE"},"Reducer 14":[{"parent":"Reducer 13","type":"SIMPLE_EDGE"},{"parent":"Union 6","type":"CONTAINS"}],"Reducer 18":[{"parent":"Map 17","type":"SIMPLE_EDGE"},{"parent":"Map 22","type":"SIMPLE_EDGE"},{"parent":"Map 23","type":"BROADCAST_EDGE"}],"Reducer 19":{"parent":"Reducer 18","type":"SIMPLE_EDGE"},"Reducer 2":[{"parent":"Map 1","type":"SIMPLE_EDGE"},{"parent":"Map 8","type":"SIMPLE_EDGE"},{"parent":"Map 9","type":"BROADCAST_EDGE"}],"Reducer 20":{"parent":"Reducer 19","type":"SIMPLE_EDGE"},"Reducer 21":[{"parent":"Reducer 20","type":"SIMPLE_EDGE"},{"parent":"Union 6","type":"CONTAINS"}],"Reducer 3":{"parent":"Reducer 2","type":"SIMPLE_EDGE"},"Reducer 4":{"parent":"Reducer 3","type":"SIMPLE_EDGE"},"Reducer 5":[{"parent":"Reducer 4","type":"SIMPLE_EDGE"},{"parent":"Union 6","type":"CONTAINS"}],"Reducer 7":{"parent":"Union 6","type":"SIMPLE_EDGE"}},"DagName:":"wentingt_20180312122930_77861376-e528-4374-88aa-1fe59bba9980:1","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"ws","Statistics:":"Num rows: 1439247 Data size: 294315305 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(((ws_sold_date_sk is not null and (ws_net_profit > 1.0)) and (ws_net_paid > 0.0)) and (ws_quantity > 0)) (type: boolean)","Statistics:":"Num rows: 26652 Data size: 5450135 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"ws_order_number (type: bigint), ws_item_sk (type: int)","sort order:":"++","Map-reduce partition columns:":"ws_order_number (type: bigint), ws_item_sk (type: int)","Statistics:":"Num rows: 26652 Data size: 5450135 Basic stats: COMPLETE Column stats: NONE","value expressions:":"ws_sold_date_sk (type: int), ws_quantity (type: int), ws_net_paid (type: float)"}}}}}}]},"Map 10":{"Map Operator Tree:":[{"TableScan":{"alias:":"cs","Statistics:":"Num rows: 2880058 Data size: 592281282 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(((cs_sold_date_sk is not null and (cs_net_profit > 1.0)) and (cs_net_paid > 0.0)) and (cs_quantity > 0)) (type: boolean)","Statistics:":"Num rows: 53334 Data size: 10968088 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"cs_order_number (type: bigint), cs_item_sk (type: int)","sort order:":"++","Map-reduce partition columns:":"cs_order_number (type: bigint), cs_item_sk (type: int)","Statistics:":"Num rows: 53334 Data size: 10968088 Basic stats: COMPLETE Column stats: NONE","value expressions:":"cs_sold_date_sk (type: int), cs_quantity (type: int), cs_net_paid (type: float)"}}}}}}]},"Map 15":{"Map Operator Tree:":[{"TableScan":{"alias:":"cr","Statistics:":"Num rows: 288491 Data size: 42910964 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"cr_order_number (type: bigint), cr_item_sk (type: int)","sort order:":"++","Map-reduce partition columns:":"cr_order_number (type: bigint), cr_item_sk (type: int)","Statistics:":"Num rows: 288491 Data size: 42910964 Basic stats: COMPLETE Column stats: NONE","value expressions:":"cr_return_quantity (type: int), cr_return_amount (type: float)"}}}}]},"Map 16":{"Map Operator Tree:":[{"TableScan":{"alias:":"date_dim","Statistics:":"Num rows: 73049 Data size: 10244389 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((d_date_sk is not null and (d_year = 2000)) and (d_moy = 12)) (type: boolean)","Statistics:":"Num rows: 9131 Data size: 1280531 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"d_date_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"d_date_sk (type: int)","Statistics:":"Num rows: 9131 Data size: 1280531 Basic stats: COMPLETE Column stats: NONE"}}}}}}]},"Map 17":{"Map Operator Tree:":[{"TableScan":{"alias:":"sts","Statistics:":"Num rows: 5760749 Data size: 778265736 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(((ss_sold_date_sk is not null and (ss_net_profit > 1.0)) and (ss_net_paid > 0.0)) and (ss_quantity > 0)) (type: boolean)","Statistics:":"Num rows: 106680 Data size: 14412255 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"ss_ticket_number (type: bigint), ss_item_sk (type: int)","sort order:":"++","Map-reduce partition columns:":"ss_ticket_number (type: bigint), ss_item_sk (type: int)","Statistics:":"Num rows: 106680 Data size: 14412255 Basic stats: COMPLETE Column stats: NONE","value expressions:":"ss_sold_date_sk (type: int), ss_quantity (type: int), ss_net_paid (type: float)"}}}}}}]},"Map 22":{"Map Operator Tree:":[{"TableScan":{"alias:":"sr","Statistics:":"Num rows: 575285 Data size: 65580422 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"sr_ticket_number (type: bigint), sr_item_sk (type: int)","sort order:":"++","Map-reduce partition columns:":"sr_ticket_number (type: bigint), sr_item_sk (type: int)","Statistics:":"Num rows: 575285 Data size: 65580422 Basic stats: COMPLETE Column stats: NONE","value expressions:":"sr_return_quantity (type: int), sr_return_amt (type: float)"}}}}]},"Map 23":{"Map Operator Tree:":[{"TableScan":{"alias:":"date_dim","Statistics:":"Num rows: 73049 Data size: 10244389 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((d_date_sk is not null and (d_year = 2000)) and (d_moy = 12)) (type: boolean)","Statistics:":"Num rows: 9131 Data size: 1280531 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"d_date_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"d_date_sk (type: int)","Statistics:":"Num rows: 9131 Data size: 1280531 Basic stats: COMPLETE Column stats: NONE"}}}}}}]},"Map 8":{"Map Operator Tree:":[{"TableScan":{"alias:":"wr","Statistics:":"Num rows: 143629 Data size: 19658165 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"wr_order_number (type: bigint), wr_item_sk (type: int)","sort order:":"++","Map-reduce partition columns:":"wr_order_number (type: bigint), wr_item_sk (type: int)","Statistics:":"Num rows: 143629 Data size: 19658165 Basic stats: COMPLETE Column stats: NONE","value expressions:":"wr_return_quantity (type: int), wr_return_amt (type: float)"}}}}]},"Map 9":{"Map Operator Tree:":[{"TableScan":{"alias:":"date_dim","Statistics:":"Num rows: 73049 Data size: 10244389 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((d_date_sk is not null and (d_year = 2000)) and (d_moy = 12)) (type: boolean)","Statistics:":"Num rows: 9131 Data size: 1280531 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"d_date_sk (type: int)","sort order:":"+","Map-reduce partition columns:":"d_date_sk (type: int)","Statistics:":"Num rows: 9131 Data size: 1280531 Basic stats: COMPLETE Column stats: NONE"}}}}}}]},"Reducer 11":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Left Outer Join0 to 1"}],"keys:":{"0":"cs_order_number (type: bigint), cs_item_sk (type: int)","1":"cr_order_number (type: bigint), cr_item_sk (type: int)"},"outputColumnNames:":["_col0","_col15","_col18","_col29","_col54","_col55"],"Statistics:":"Num rows: 317340 Data size: 47202061 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(_col55 > 10000.0) (type: boolean)","Statistics:":"Num rows: 105780 Data size: 15734020 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"d_date_sk (type: int)"},"outputColumnNames:":["_col0","_col15","_col18","_col29","_col54","_col55","_col67"],"input vertices:":{"1":"Map 16"},"Statistics:":"Num rows: 116358 Data size: 17307422 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Filter Operator":{"predicate:":"(_col0 = _col67) (type: boolean)","Statistics:":"Num rows: 58179 Data size: 8653711 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col15 (type: int), _col54 (type: int), _col18 (type: int), _col55 (type: float), _col29 (type: float)","outputColumnNames:":["_col15","_col54","_col18","_col55","_col29"],"Statistics:":"Num rows: 58179 Data size: 8653711 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"aggregations:":["sum(COALESCE(_col54,0))","sum(COALESCE(_col18,0))","sum(COALESCE(_col55,0))","sum(COALESCE(_col29,0))"],"keys:":"_col15 (type: int)","mode:":"hash","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 58179 Data size: 8653711 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 58179 Data size: 8653711 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)"}}}}}}}}}}}}}}},"Reducer 12":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)"],"keys:":"KEY._col0 (type: int)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20)), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col1 (type: decimal(35,20))","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: int), _col2 (type: decimal(35,20))"}}}}}}},"Reducer 13":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: int), KEY.reducesinkkey1 (type: decimal(35,20)), VALUE._col1 (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","output shape:":"_col0: int, _col1: decimal(35,20), _col2: decimal(35,20)","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col1","partition by:":"0","raw input shape:":{},"window functions:":[{"window function definition":{"alias:":"rank_window_0","arguments:":"_col1","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"rank_window_0 (type: int), _col0 (type: int), _col1 (type: decimal(35,20)), _col2 (type: decimal(35,20))","outputColumnNames:":["rank_window_0","_col0","_col1","_col2"],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col2 (type: decimal(35,20))","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","value expressions:":"rank_window_0 (type: int), _col0 (type: int), _col1 (type: decimal(35,20))"}}}}}}}}},"Reducer 14":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: decimal(35,20)), KEY.reducesinkkey1 (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col3","partition by:":"0","raw input shape:":{},"window functions:":[{"window function definition":{"alias:":"rank_window_1","arguments:":"_col3","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 29089 Data size: 4326781 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)","Statistics:":"Num rows: 19392 Data size: 2884421 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"'catalog' (type: string), _col1 (type: int), _col2 (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 19392 Data size: 2884421 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"1 (type: int), 4 (type: int), 5 (type: int)","sort order:":"+++","Statistics:":"Num rows: 67716 Data size: 8614012 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: int), _col2 (type: decimal(35,20)), _col3 (type: int), _col4 (type: int)"}}}}}}}}}}},"Reducer 18":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Left Outer Join0 to 1"}],"keys:":{"0":"ss_ticket_number (type: bigint), ss_item_sk (type: int)","1":"sr_ticket_number (type: bigint), sr_item_sk (type: int)"},"outputColumnNames:":["_col0","_col2","_col10","_col20","_col36","_col37"],"Statistics:":"Num rows: 632813 Data size: 72138465 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(_col37 > 10000.0) (type: boolean)","Statistics:":"Num rows: 210937 Data size: 24046079 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"d_date_sk (type: int)"},"outputColumnNames:":["_col0","_col2","_col10","_col20","_col36","_col37","_col49"],"input vertices:":{"1":"Map 23"},"Statistics:":"Num rows: 232030 Data size: 26450687 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Filter Operator":{"predicate:":"(_col0 = _col49) (type: boolean)","Statistics:":"Num rows: 116015 Data size: 13225343 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col2 (type: int), _col36 (type: int), _col10 (type: int), _col37 (type: float), _col20 (type: float)","outputColumnNames:":["_col2","_col36","_col10","_col37","_col20"],"Statistics:":"Num rows: 116015 Data size: 13225343 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"aggregations:":["sum(COALESCE(_col36,0))","sum(COALESCE(_col10,0))","sum(COALESCE(_col37,0))","sum(COALESCE(_col20,0))"],"keys:":"_col2 (type: int)","mode:":"hash","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 116015 Data size: 13225343 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 116015 Data size: 13225343 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)"}}}}}}}}}}}}}}},"Reducer 19":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)"],"keys:":"KEY._col0 (type: int)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20)), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col1 (type: decimal(35,20))","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: int), _col2 (type: decimal(35,20))"}}}}}}},"Reducer 2":{"Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Left Outer Join0 to 1"}],"keys:":{"0":"ws_order_number (type: bigint), ws_item_sk (type: int)","1":"wr_order_number (type: bigint), wr_item_sk (type: int)"},"outputColumnNames:":["_col0","_col3","_col18","_col29","_col51","_col52"],"Statistics:":"Num rows: 157991 Data size: 21623981 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(_col52 > 10000.0) (type: boolean)","Statistics:":"Num rows: 52663 Data size: 7207902 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"d_date_sk (type: int)"},"outputColumnNames:":["_col0","_col3","_col18","_col29","_col51","_col52","_col64"],"input vertices:":{"1":"Map 9"},"Statistics:":"Num rows: 57929 Data size: 7928692 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Filter Operator":{"predicate:":"(_col0 = _col64) (type: boolean)","Statistics:":"Num rows: 28964 Data size: 3964277 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col3 (type: int), _col51 (type: int), _col18 (type: int), _col52 (type: float), _col29 (type: float)","outputColumnNames:":["_col3","_col51","_col18","_col52","_col29"],"Statistics:":"Num rows: 28964 Data size: 3964277 Basic stats: COMPLETE Column stats: NONE","children":{"Group By Operator":{"aggregations:":["sum(COALESCE(_col51,0))","sum(COALESCE(_col18,0))","sum(COALESCE(_col52,0))","sum(COALESCE(_col29,0))"],"keys:":"_col3 (type: int)","mode:":"hash","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 28964 Data size: 3964277 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 28964 Data size: 3964277 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)"}}}}}}}}}}}}}}},"Reducer 20":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: int), KEY.reducesinkkey1 (type: decimal(35,20)), VALUE._col1 (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","output shape:":"_col0: int, _col1: decimal(35,20), _col2: decimal(35,20)","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col1","partition by:":"0","raw input shape:":{},"window functions:":[{"window function definition":{"alias:":"rank_window_0","arguments:":"_col1","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"rank_window_0 (type: int), _col0 (type: int), _col1 (type: decimal(35,20)), _col2 (type: decimal(35,20))","outputColumnNames:":["rank_window_0","_col0","_col1","_col2"],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col2 (type: decimal(35,20))","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","value expressions:":"rank_window_0 (type: int), _col0 (type: int), _col1 (type: decimal(35,20))"}}}}}}}}},"Reducer 21":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: decimal(35,20)), KEY.reducesinkkey1 (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col3","partition by:":"0","raw input shape:":{},"window functions:":[{"window function definition":{"alias:":"rank_window_1","arguments:":"_col3","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 58007 Data size: 6612614 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)","Statistics:":"Num rows: 38670 Data size: 4408257 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"'store' (type: string), _col1 (type: int), _col2 (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 38670 Data size: 4408257 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"1 (type: int), 4 (type: int), 5 (type: int)","sort order:":"+++","Statistics:":"Num rows: 67716 Data size: 8614012 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: int), _col2 (type: decimal(35,20)), _col3 (type: int), _col4 (type: int)"}}}}}}}}}}},"Reducer 3":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["sum(VALUE._col0)","sum(VALUE._col1)","sum(VALUE._col2)","sum(VALUE._col3)"],"keys:":"KEY._col0 (type: int)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20)), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col1 (type: decimal(35,20))","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: int), _col2 (type: decimal(35,20))"}}}}}}},"Reducer 4":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: int), KEY.reducesinkkey1 (type: decimal(35,20)), VALUE._col1 (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","output shape:":"_col0: int, _col1: decimal(35,20), _col2: decimal(35,20)","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col1","partition by:":"0","raw input shape:":{},"window functions:":[{"window function definition":{"alias:":"rank_window_0","arguments:":"_col1","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"rank_window_0 (type: int), _col0 (type: int), _col1 (type: decimal(35,20)), _col2 (type: decimal(35,20))","outputColumnNames:":["rank_window_0","_col0","_col1","_col2"],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col2 (type: decimal(35,20))","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","value expressions:":"rank_window_0 (type: int), _col0 (type: int), _col1 (type: decimal(35,20))"}}}}}}}}},"Reducer 5":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: decimal(35,20)), KEY.reducesinkkey1 (type: decimal(35,20))","outputColumnNames:":["_col0","_col1","_col2","_col3"],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col3","partition by:":"0","raw input shape:":{},"window functions:":[{"window function definition":{"alias:":"rank_window_1","arguments:":"_col3","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 14482 Data size: 1982138 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)","Statistics:":"Num rows: 9654 Data size: 1321334 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"'web' (type: string), _col1 (type: int), _col2 (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 9654 Data size: 1321334 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"1 (type: int), 4 (type: int), 5 (type: int)","sort order:":"+++","Statistics:":"Num rows: 67716 Data size: 8614012 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: string), _col1 (type: int), _col2 (type: decimal(35,20)), _col3 (type: int), _col4 (type: int)"}}}}}}}}}}},"Reducer 7":{"Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col0 (type: string), VALUE._col1 (type: int), VALUE._col2 (type: decimal(35,20)), VALUE._col3 (type: int), VALUE._col4 (type: int)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"Statistics:":"Num rows: 67716 Data size: 8614012 Basic stats: COMPLETE Column stats: NONE","children":{"Limit":{"Number of rows:":"100","Statistics:":"Num rows: 100 Data size: 12700 Basic stats: COMPLETE Column stats: NONE","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 100 Data size: 12700 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}}}}}}}},"Union 6":{"Vertex:":"Union 6"}}}},"Stage-0":{"Fetch Operator":{"limit:":"100","Processor Tree:":{"ListSink":{}}}}}}
