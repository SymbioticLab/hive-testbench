(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME household_demographics))) (TOK_TABREF (TOK_TABNAME customer_address)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_ticket_number)) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_customer_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL ca_city) bought_city) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_coupon_amt)) amt) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_net_profit)) profit)) (TOK_WHERE (and (and (and (and (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_store_sk) (. (TOK_TABLE_OR_COL store) s_store_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_hdemo_sk) (. (TOK_TABLE_OR_COL household_demographics) hd_demo_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_addr_sk) (. (TOK_TABLE_OR_COL customer_address) ca_address_sk))) (or (= (. (TOK_TABLE_OR_COL household_demographics) hd_dep_count) 4) (= (. (TOK_TABLE_OR_COL household_demographics) hd_vehicle_count) 2))) (TOK_FUNCTION in (. (TOK_TABLE_OR_COL date_dim) d_dow) 6 0)) (TOK_FUNCTION in (. (TOK_TABLE_OR_COL date_dim) d_year) 1998 (+ 1998 1) (+ 1998 2))) (TOK_FUNCTION in (. (TOK_TABLE_OR_COL store) s_city) 'Rosedale' 'Bethlehem' 'Clinton' 'Clifton' 'Springfield'))) (TOK_GROUPBY (TOK_TABLE_OR_COL ss_ticket_number) (TOK_TABLE_OR_COL ss_customer_sk) (TOK_TABLE_OR_COL ss_addr_sk) (TOK_TABLE_OR_COL ca_city)))) dn) (TOK_TABREF (TOK_TABNAME customer))) (TOK_TABREF (TOK_TABNAME customer_address) current_addr))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL c_last_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL c_first_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL ca_city)) (TOK_SELEXPR (TOK_TABLE_OR_COL bought_city)) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_ticket_number)) (TOK_SELEXPR (TOK_TABLE_OR_COL amt)) (TOK_SELEXPR (TOK_TABLE_OR_COL profit))) (TOK_WHERE (and (and (= (. (TOK_TABLE_OR_COL dn) ss_customer_sk) (. (TOK_TABLE_OR_COL customer) c_customer_sk)) (= (. (TOK_TABLE_OR_COL customer) c_current_addr_sk) (. (TOK_TABLE_OR_COL current_addr) ca_address_sk))) (<> (. (TOK_TABLE_OR_COL current_addr) ca_city) (TOK_TABLE_OR_COL bought_city)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL c_last_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL c_first_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL ca_city)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL bought_city)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL ss_ticket_number))) (TOK_LIMIT 100))) FORMATTED)