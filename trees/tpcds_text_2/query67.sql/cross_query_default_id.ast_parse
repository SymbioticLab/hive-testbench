(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME item)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_product_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_qoy)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_moy)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION coalesce (* (TOK_TABLE_OR_COL ss_sales_price) (TOK_TABLE_OR_COL ss_quantity)) 0)) sumsales)) (TOK_WHERE (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_store_sk) (. (TOK_TABLE_OR_COL store) s_store_sk))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11)))) (TOK_ROLLUP_GROUPBY (TOK_TABLE_OR_COL i_category) (TOK_TABLE_OR_COL i_class) (TOK_TABLE_OR_COL i_brand) (TOK_TABLE_OR_COL i_product_name) (TOK_TABLE_OR_COL d_year) (TOK_TABLE_OR_COL d_qoy) (TOK_TABLE_OR_COL d_moy) (TOK_TABLE_OR_COL s_store_id)))) dw1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_product_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_qoy)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_moy)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL sumsales)) (TOK_SELEXPR (TOK_FUNCTION rank (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL i_category)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (TOK_TABLE_OR_COL sumsales)))))) rk)))) dw2)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (<= (TOK_TABLE_OR_COL rk) 100)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_category)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_class)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_brand)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_product_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_year)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_qoy)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_moy)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_store_id)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL sumsales)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL rk))) (TOK_LIMIT 100))) FORMATTED)