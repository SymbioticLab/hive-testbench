(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME web_returns))) (TOK_TABREF (TOK_TABNAME web_page))) (TOK_TABREF (TOK_TABNAME customer_demographics) cd1)) (TOK_TABREF (TOK_TABNAME customer_demographics) cd2)) (TOK_TABREF (TOK_TABNAME customer_address))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME reason)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION substr (TOK_TABLE_OR_COL r_reason_desc) 1 20) r) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL ws_quantity)) wq) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL wr_refunded_cash)) ref) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL wr_fee)) fee)) (TOK_WHERE (and (and (and (and (and (and (and (and (and (and (= (. (TOK_TABLE_OR_COL web_sales) ws_web_page_sk) (. (TOK_TABLE_OR_COL web_page) wp_web_page_sk)) (= (. (TOK_TABLE_OR_COL web_sales) ws_item_sk) (. (TOK_TABLE_OR_COL web_returns) wr_item_sk))) (= (. (TOK_TABLE_OR_COL web_sales) ws_order_number) (. (TOK_TABLE_OR_COL web_returns) wr_order_number))) (= (. (TOK_TABLE_OR_COL web_sales) ws_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (= (TOK_TABLE_OR_COL d_year) 1998)) (= (. (TOK_TABLE_OR_COL cd1) cd_demo_sk) (. (TOK_TABLE_OR_COL web_returns) wr_refunded_cdemo_sk))) (= (. (TOK_TABLE_OR_COL cd2) cd_demo_sk) (. (TOK_TABLE_OR_COL web_returns) wr_returning_cdemo_sk))) (= (. (TOK_TABLE_OR_COL customer_address) ca_address_sk) (. (TOK_TABLE_OR_COL web_returns) wr_refunded_addr_sk))) (= (. (TOK_TABLE_OR_COL reason) r_reason_sk) (. (TOK_TABLE_OR_COL web_returns) wr_reason_sk))) (or (or (and (and (and (and (= (. (TOK_TABLE_OR_COL cd1) cd_marital_status) 'M') (= (. (TOK_TABLE_OR_COL cd1) cd_marital_status) (. (TOK_TABLE_OR_COL cd2) cd_marital_status))) (= (. (TOK_TABLE_OR_COL cd1) cd_education_status) '4 yr Degree')) (= (. (TOK_TABLE_OR_COL cd1) cd_education_status) (. (TOK_TABLE_OR_COL cd2) cd_education_status))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_sales_price) 100.00 150.00)) (and (and (and (and (= (. (TOK_TABLE_OR_COL cd1) cd_marital_status) 'D') (= (. (TOK_TABLE_OR_COL cd1) cd_marital_status) (. (TOK_TABLE_OR_COL cd2) cd_marital_status))) (= (. (TOK_TABLE_OR_COL cd1) cd_education_status) 'Primary')) (= (. (TOK_TABLE_OR_COL cd1) cd_education_status) (. (TOK_TABLE_OR_COL cd2) cd_education_status))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_sales_price) 50.00 100.00))) (and (and (and (and (= (. (TOK_TABLE_OR_COL cd1) cd_marital_status) 'U') (= (. (TOK_TABLE_OR_COL cd1) cd_marital_status) (. (TOK_TABLE_OR_COL cd2) cd_marital_status))) (= (. (TOK_TABLE_OR_COL cd1) cd_education_status) 'Advanced Degree')) (= (. (TOK_TABLE_OR_COL cd1) cd_education_status) (. (TOK_TABLE_OR_COL cd2) cd_education_status))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_sales_price) 150.00 200.00)))) (or (or (and (and (= (TOK_TABLE_OR_COL ca_country) 'United States') (TOK_FUNCTION in (TOK_TABLE_OR_COL ca_state) 'KY' 'GA' 'NM')) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_net_profit) 100 200)) (and (and (= (TOK_TABLE_OR_COL ca_country) 'United States') (TOK_FUNCTION in (TOK_TABLE_OR_COL ca_state) 'MT' 'OR' 'IN')) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_net_profit) 150 300))) (and (and (= (TOK_TABLE_OR_COL ca_country) 'United States') (TOK_FUNCTION in (TOK_TABLE_OR_COL ca_state) 'WI' 'MO' 'WV')) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_net_profit) 50 250))))) (TOK_GROUPBY (TOK_TABLE_OR_COL r_reason_desc)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL r)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL wq)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL ref)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL fee))) (TOK_LIMIT 100))) FORMATTED)