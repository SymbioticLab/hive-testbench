(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME item)) (TOK_SUBQUERY (TOK_UNIONALL (TOK_UNIONALL (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ws_ext_sales_price) ext_price) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_sold_date_sk) sold_date_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_item_sk) sold_item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_sold_time_sk) time_sk)) (TOK_WHERE (and (and (= (. (TOK_TABLE_OR_COL date_dim) d_date_sk) (. (TOK_TABLE_OR_COL web_sales) ws_sold_date_sk)) (= (TOK_TABLE_OR_COL d_moy) 12)) (= (TOK_TABLE_OR_COL d_year) 2001))))) (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL cs_ext_sales_price) ext_price) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_sold_date_sk) sold_date_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_item_sk) sold_item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_sold_time_sk) time_sk)) (TOK_WHERE (and (and (= (. (TOK_TABLE_OR_COL date_dim) d_date_sk) (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk)) (= (TOK_TABLE_OR_COL d_moy) 12)) (= (TOK_TABLE_OR_COL d_year) 2001)))))) (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_ext_sales_price) ext_price) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_sold_date_sk) sold_date_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_item_sk) sold_item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_sold_time_sk) time_sk)) (TOK_WHERE (and (and (= (. (TOK_TABLE_OR_COL date_dim) d_date_sk) (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk)) (= (TOK_TABLE_OR_COL d_moy) 12)) (= (TOK_TABLE_OR_COL d_year) 2001)))))) tmp) (= (. (TOK_TABLE_OR_COL tmp) sold_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (TOK_TABREF (TOK_TABNAME time_dim)) (= (. (TOK_TABLE_OR_COL tmp) time_sk) (. (TOK_TABLE_OR_COL time_dim) t_time_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand_id) brand_id) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand) brand) (TOK_SELEXPR (TOK_TABLE_OR_COL t_hour)) (TOK_SELEXPR (TOK_TABLE_OR_COL t_minute)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ext_price)) ext_price)) (TOK_WHERE (and (= (TOK_TABLE_OR_COL i_manager_id) 1) (or (= (TOK_TABLE_OR_COL t_meal_time) 'breakfast') (= (TOK_TABLE_OR_COL t_meal_time) 'dinner')))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_brand) (TOK_TABLE_OR_COL i_brand_id) (TOK_TABLE_OR_COL t_hour) (TOK_TABLE_OR_COL t_minute)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (TOK_TABLE_OR_COL ext_price)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_brand_id))))) FORMATTED)