(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_desc)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_current_price)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_sales_price)) itemrevenue) (TOK_SELEXPR (/ (* (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_sales_price)) 100) (TOK_FUNCTION sum (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_sales_price)) (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL i_class)))))) revenueratio)) (TOK_WHERE (and (and (and (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk)) (TOK_FUNCTION in (TOK_TABLE_OR_COL i_category) 'Jewelry' 'Sports' 'Books')) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_date) '2001-01-12' '2001-02-11'))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id) (TOK_TABLE_OR_COL i_item_desc) (TOK_TABLE_OR_COL i_category) (TOK_TABLE_OR_COL i_class) (TOK_TABLE_OR_COL i_current_price)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_category)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_class)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_id)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_desc)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL revenueratio))) (TOK_LIMIT 100))) FORMATTED)