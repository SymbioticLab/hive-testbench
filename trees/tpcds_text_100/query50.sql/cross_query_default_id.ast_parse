(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME store_returns))) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME date_dim) d1)) (TOK_TABREF (TOK_TABNAME date_dim) d2))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_company_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_street_number)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_street_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_street_type)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_suite_number)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_city)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_county)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_state)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_zip)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (<= (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 30) 1 0)) 30days) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (> (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 30) (<= (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 60)) 1 0)) 3160days) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (> (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 60) (<= (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 90)) 1 0)) 6190days) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (> (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 90) (<= (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 120)) 1 0)) 91120days) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (> (- (TOK_TABLE_OR_COL sr_returned_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk)) 120) 1 0)) 120days)) (TOK_WHERE (and (and (and (and (and (and (and (= (. (TOK_TABLE_OR_COL d2) d_year) 2000) (= (. (TOK_TABLE_OR_COL d2) d_moy) 9)) (= (. (TOK_TABLE_OR_COL store_sales) ss_ticket_number) (. (TOK_TABLE_OR_COL store_returns) sr_ticket_number))) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL store_returns) sr_item_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL d1) d_date_sk))) (= (TOK_TABLE_OR_COL sr_returned_date_sk) (. (TOK_TABLE_OR_COL d2) d_date_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_customer_sk) (. (TOK_TABLE_OR_COL store_returns) sr_customer_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_store_sk) (. (TOK_TABLE_OR_COL store) s_store_sk)))) (TOK_GROUPBY (TOK_TABLE_OR_COL s_store_name) (TOK_TABLE_OR_COL s_company_id) (TOK_TABLE_OR_COL s_street_number) (TOK_TABLE_OR_COL s_street_name) (TOK_TABLE_OR_COL s_street_type) (TOK_TABLE_OR_COL s_suite_number) (TOK_TABLE_OR_COL s_city) (TOK_TABLE_OR_COL s_county) (TOK_TABLE_OR_COL s_state) (TOK_TABLE_OR_COL s_zip)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_store_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_company_id)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_street_number)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_street_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_street_type)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_suite_number)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_city)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_county)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_state)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_zip))) (TOK_LIMIT 100))) FORMATTED)