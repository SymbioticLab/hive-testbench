(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_FULLOUTERJOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_customer_sk) customer_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_item_sk) item_sk)) (TOK_WHERE (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))) (TOK_GROUPBY (TOK_TABLE_OR_COL ss_customer_sk) (TOK_TABLE_OR_COL ss_item_sk)))) ssci) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL cs_bill_customer_sk) customer_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_item_sk) item_sk)) (TOK_WHERE (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))) (TOK_GROUPBY (TOK_TABLE_OR_COL cs_bill_customer_sk) (TOK_TABLE_OR_COL cs_item_sk)))) csci) (and (= (. (TOK_TABLE_OR_COL ssci) customer_sk) (. (TOK_TABLE_OR_COL csci) customer_sk)) (= (. (TOK_TABLE_OR_COL ssci) item_sk) (. (TOK_TABLE_OR_COL csci) item_sk))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL ssci) customer_sk)) (TOK_FUNCTION TOK_ISNULL (. (TOK_TABLE_OR_COL csci) customer_sk))) 1 0)) store_only) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (TOK_FUNCTION TOK_ISNULL (. (TOK_TABLE_OR_COL ssci) customer_sk)) (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL csci) customer_sk))) 1 0)) catalog_only) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (and (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL ssci) customer_sk)) (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL csci) customer_sk))) 1 0)) store_and_catalog)) (TOK_LIMIT 100))) FORMATTED)