(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_LEFTOUTERJOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME catalog_returns)) (and (= (. (TOK_TABLE_OR_COL catalog_sales) cs_order_number) (. (TOK_TABLE_OR_COL catalog_returns) cr_order_number)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL catalog_returns) cr_item_sk)))) (TOK_TABREF (TOK_TABNAME warehouse))) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL w_state)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (< (TOK_FUNCTION TOK_DATE (TOK_TABLE_OR_COL d_date)) (TOK_FUNCTION TOK_DATE '1998-04-08')) (- (TOK_TABLE_OR_COL cs_sales_price) (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL cr_refunded_cash) 0)) 0)) sales_before) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (>= (TOK_FUNCTION TOK_DATE (TOK_TABLE_OR_COL d_date)) (TOK_FUNCTION TOK_DATE '1998-04-08')) (- (TOK_TABLE_OR_COL cs_sales_price) (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL cr_refunded_cash) 0)) 0)) sales_after)) (TOK_WHERE (and (and (and (and (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL i_current_price) 0.99 1.49) (= (. (TOK_TABLE_OR_COL item) i_item_sk) (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk))) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_warehouse_sk) (. (TOK_TABLE_OR_COL warehouse) w_warehouse_sk))) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL date_dim) d_date) '1998-03-09' '1998-05-08'))) (TOK_GROUPBY (TOK_TABLE_OR_COL w_state) (TOK_TABLE_OR_COL i_item_id)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL w_state)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_id))) (TOK_LIMIT 100))) FORMATTED)