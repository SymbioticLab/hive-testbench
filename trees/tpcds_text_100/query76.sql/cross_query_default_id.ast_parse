(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNIONALL (TOK_UNIONALL (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'store' channel) (TOK_SELEXPR 'ss_addr_sk' col_name) (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_qoy)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_ext_sales_price) ext_sales_price)) (TOK_WHERE (AND (AND (TOK_FUNCTION TOK_ISNULL (TOK_TABLE_OR_COL ss_addr_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk)))))) (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'web' channel) (TOK_SELEXPR 'ws_web_page_sk' col_name) (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_qoy)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_ext_sales_price) ext_sales_price)) (TOK_WHERE (AND (AND (TOK_FUNCTION TOK_ISNULL (TOK_TABLE_OR_COL ws_web_page_sk)) (= (. (TOK_TABLE_OR_COL web_sales) ws_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (= (. (TOK_TABLE_OR_COL web_sales) ws_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))))))) (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'catalog' channel) (TOK_SELEXPR 'cs_warehouse_sk' col_name) (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_qoy)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_ext_sales_price) ext_sales_price)) (TOK_WHERE (AND (AND (TOK_FUNCTION TOK_ISNULL (TOK_TABLE_OR_COL cs_warehouse_sk)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))))))) foo)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL channel)) (TOK_SELEXPR (TOK_TABLE_OR_COL col_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_qoy)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_FUNCTIONSTAR COUNT) sales_cnt) (TOK_SELEXPR (TOK_FUNCTION SUM (TOK_TABLE_OR_COL ext_sales_price)) sales_amt)) (TOK_GROUPBY (TOK_TABLE_OR_COL channel) (TOK_TABLE_OR_COL col_name) (TOK_TABLE_OR_COL d_year) (TOK_TABLE_OR_COL d_qoy) (TOK_TABLE_OR_COL i_category)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL channel)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL col_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_year)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_qoy)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_category))) (TOK_LIMIT 100))) FORMATTED)