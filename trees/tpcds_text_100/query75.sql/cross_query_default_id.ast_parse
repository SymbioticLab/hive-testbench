(TOK_EXPLAIN (TOK_QUERY (TOK_CTE (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNIONALL (TOK_UNIONALL (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME item)) (= (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL cs_item_sk))) (TOK_TABREF (TOK_TABNAME date_dim)) (= (TOK_TABLE_OR_COL d_date_sk) (TOK_TABLE_OR_COL cs_sold_date_sk))) (TOK_TABREF (TOK_TABNAME catalog_returns)) (AND (= (TOK_TABLE_OR_COL cs_order_number) (TOK_TABLE_OR_COL cr_order_number)) (= (TOK_TABLE_OR_COL cs_item_sk) (TOK_TABLE_OR_COL cr_item_sk))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_manufact_id)) (TOK_SELEXPR (- (TOK_TABLE_OR_COL cs_quantity) (TOK_FUNCTION COALESCE (TOK_TABLE_OR_COL cr_return_quantity) 0)) sales_cnt) (TOK_SELEXPR (- (TOK_TABLE_OR_COL cs_ext_sales_price) (TOK_FUNCTION COALESCE (TOK_TABLE_OR_COL cr_return_amount) 0.0)) sales_amt)) (TOK_WHERE (= (TOK_TABLE_OR_COL i_category) 'Sports')))) (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME item)) (= (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL ss_item_sk))) (TOK_TABREF (TOK_TABNAME date_dim)) (= (TOK_TABLE_OR_COL d_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk))) (TOK_TABREF (TOK_TABNAME store_returns)) (AND (= (TOK_TABLE_OR_COL ss_ticket_number) (TOK_TABLE_OR_COL sr_ticket_number)) (= (TOK_TABLE_OR_COL ss_item_sk) (TOK_TABLE_OR_COL sr_item_sk))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_manufact_id)) (TOK_SELEXPR (- (TOK_TABLE_OR_COL ss_quantity) (TOK_FUNCTION COALESCE (TOK_TABLE_OR_COL sr_return_quantity) 0)) sales_cnt) (TOK_SELEXPR (- (TOK_TABLE_OR_COL ss_ext_sales_price) (TOK_FUNCTION COALESCE (TOK_TABLE_OR_COL sr_return_amt) 0.0)) sales_amt)) (TOK_WHERE (= (TOK_TABLE_OR_COL i_category) 'Sports'))))) (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME item)) (= (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL ws_item_sk))) (TOK_TABREF (TOK_TABNAME date_dim)) (= (TOK_TABLE_OR_COL d_date_sk) (TOK_TABLE_OR_COL ws_sold_date_sk))) (TOK_TABREF (TOK_TABNAME web_returns)) (AND (= (TOK_TABLE_OR_COL ws_order_number) (TOK_TABLE_OR_COL wr_order_number)) (= (TOK_TABLE_OR_COL ws_item_sk) (TOK_TABLE_OR_COL wr_item_sk))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_manufact_id)) (TOK_SELEXPR (- (TOK_TABLE_OR_COL ws_quantity) (TOK_FUNCTION COALESCE (TOK_TABLE_OR_COL wr_return_quantity) 0)) sales_cnt) (TOK_SELEXPR (- (TOK_TABLE_OR_COL ws_ext_sales_price) (TOK_FUNCTION COALESCE (TOK_TABLE_OR_COL wr_return_amt) 0.0)) sales_amt)) (TOK_WHERE (= (TOK_TABLE_OR_COL i_category) 'Sports'))))) sales_detail)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL d_year)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_category_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_manufact_id)) (TOK_SELEXPR (TOK_FUNCTION SUM (TOK_TABLE_OR_COL sales_cnt)) sales_cnt) (TOK_SELEXPR (TOK_FUNCTION SUM (TOK_TABLE_OR_COL sales_amt)) sales_amt)) (TOK_GROUPBY (TOK_TABLE_OR_COL d_year) (TOK_TABLE_OR_COL i_brand_id) (TOK_TABLE_OR_COL i_class_id) (TOK_TABLE_OR_COL i_category_id) (TOK_TABLE_OR_COL i_manufact_id)))) all_sales)) (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME all_sales) curr_yr) (TOK_TABREF (TOK_TABNAME all_sales) prev_yr))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL prev_yr) d_year) prev_year) (TOK_SELEXPR (. (TOK_TABLE_OR_COL curr_yr) d_year) year) (TOK_SELEXPR (. (TOK_TABLE_OR_COL curr_yr) i_brand_id)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL curr_yr) i_class_id)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL curr_yr) i_category_id)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL curr_yr) i_manufact_id)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL prev_yr) sales_cnt) prev_yr_cnt) (TOK_SELEXPR (. (TOK_TABLE_OR_COL curr_yr) sales_cnt) curr_yr_cnt) (TOK_SELEXPR (- (. (TOK_TABLE_OR_COL curr_yr) sales_cnt) (. (TOK_TABLE_OR_COL prev_yr) sales_cnt)) sales_cnt_diff) (TOK_SELEXPR (- (. (TOK_TABLE_OR_COL curr_yr) sales_amt) (. (TOK_TABLE_OR_COL prev_yr) sales_amt)) sales_amt_diff)) (TOK_WHERE (AND (AND (AND (AND (AND (AND (= (. (TOK_TABLE_OR_COL curr_yr) i_brand_id) (. (TOK_TABLE_OR_COL prev_yr) i_brand_id)) (= (. (TOK_TABLE_OR_COL curr_yr) i_class_id) (. (TOK_TABLE_OR_COL prev_yr) i_class_id))) (= (. (TOK_TABLE_OR_COL curr_yr) i_category_id) (. (TOK_TABLE_OR_COL prev_yr) i_category_id))) (= (. (TOK_TABLE_OR_COL curr_yr) i_manufact_id) (. (TOK_TABLE_OR_COL prev_yr) i_manufact_id))) (= (. (TOK_TABLE_OR_COL curr_yr) d_year) 2002)) (= (. (TOK_TABLE_OR_COL prev_yr) d_year) (- 2002 1))) (< (/ (TOK_FUNCTION (TOK_DECIMAL 17 2) (. (TOK_TABLE_OR_COL curr_yr) sales_cnt)) (TOK_FUNCTION (TOK_DECIMAL 17 2) (. (TOK_TABLE_OR_COL prev_yr) sales_cnt))) 0.9))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL sales_cnt_diff))) (TOK_LIMIT 100))) FORMATTED)