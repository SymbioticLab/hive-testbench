(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME item)) (TOK_TABREF (TOK_TABNAME store_sales))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME store)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_category)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_class)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_company_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_moy)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_sales_price)) sum_sales) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_sales_price)) (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL i_category) (TOK_TABLE_OR_COL i_brand) (TOK_TABLE_OR_COL s_store_name) (TOK_TABLE_OR_COL s_company_name))))) avg_monthly_sales)) (TOK_WHERE (and (and (and (and (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk)) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (= (. (TOK_TABLE_OR_COL store_sales) ss_store_sk) (. (TOK_TABLE_OR_COL store) s_store_sk))) (TOK_FUNCTION in (TOK_TABLE_OR_COL d_year) 2000)) (or (and (TOK_FUNCTION in (TOK_TABLE_OR_COL i_category) 'Home' 'Books' 'Electronics') (TOK_FUNCTION in (TOK_TABLE_OR_COL i_class) 'wallpaper' 'parenting' 'musical')) (and (TOK_FUNCTION in (TOK_TABLE_OR_COL i_category) 'Shoes' 'Jewelry' 'Men') (TOK_FUNCTION in (TOK_TABLE_OR_COL i_class) 'womens' 'birdal' 'pants'))))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_category) (TOK_TABLE_OR_COL i_class) (TOK_TABLE_OR_COL i_brand) (TOK_TABLE_OR_COL s_store_name) (TOK_TABLE_OR_COL s_company_name) (TOK_TABLE_OR_COL d_moy)))) tmp1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (> (TOK_FUNCTION when (<> (TOK_TABLE_OR_COL avg_monthly_sales) 0) (/ (TOK_FUNCTION abs (- (TOK_TABLE_OR_COL sum_sales) (TOK_TABLE_OR_COL avg_monthly_sales))) (TOK_TABLE_OR_COL avg_monthly_sales)) TOK_NULL) 0.1)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (- (TOK_TABLE_OR_COL sum_sales) (TOK_TABLE_OR_COL avg_monthly_sales))) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_store_name))) (TOK_LIMIT 100))) FORMATTED)