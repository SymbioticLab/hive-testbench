(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_LEFTOUTERJOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_TABREF (TOK_TABNAME customer)) (= (. (TOK_TABLE_OR_COL store_sales) ss_customer_sk) (. (TOK_TABLE_OR_COL customer) c_customer_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECTDI (TOK_SELEXPR (TOK_TABLE_OR_COL c_last_name) l1) (TOK_SELEXPR (TOK_TABLE_OR_COL c_first_name) f1) (TOK_SELEXPR (TOK_TABLE_OR_COL d_date) d1)) (TOK_WHERE (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))))) t1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_TABREF (TOK_TABNAME customer)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_bill_customer_sk) (. (TOK_TABLE_OR_COL customer) c_customer_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECTDI (TOK_SELEXPR (TOK_TABLE_OR_COL c_last_name) l2) (TOK_SELEXPR (TOK_TABLE_OR_COL c_first_name) f2) (TOK_SELEXPR (TOK_TABLE_OR_COL d_date) d2)) (TOK_WHERE (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))))) t2) (and (and (= (. (TOK_TABLE_OR_COL t1) l1) (. (TOK_TABLE_OR_COL t2) l2)) (= (. (TOK_TABLE_OR_COL t1) f1) (. (TOK_TABLE_OR_COL t2) f2))) (= (. (TOK_TABLE_OR_COL t1) d1) (. (TOK_TABLE_OR_COL t2) d2)))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL web_sales) ws_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_TABREF (TOK_TABNAME customer)) (= (. (TOK_TABLE_OR_COL web_sales) ws_bill_customer_sk) (. (TOK_TABLE_OR_COL customer) c_customer_sk)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECTDI (TOK_SELEXPR (TOK_TABLE_OR_COL c_last_name) l3) (TOK_SELEXPR (TOK_TABLE_OR_COL c_first_name) f3) (TOK_SELEXPR (TOK_TABLE_OR_COL d_date) d3)) (TOK_WHERE (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))))) t3) (and (and (= (. (TOK_TABLE_OR_COL t1) l1) (. (TOK_TABLE_OR_COL t3) l3)) (= (. (TOK_TABLE_OR_COL t1) f1) (. (TOK_TABLE_OR_COL t3) f3))) (= (. (TOK_TABLE_OR_COL t1) d1) (. (TOK_TABLE_OR_COL t3) d3))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTIONSTAR count))) (TOK_WHERE (and (TOK_FUNCTION TOK_ISNULL (TOK_TABLE_OR_COL l2)) (TOK_FUNCTION TOK_ISNULL (TOK_TABLE_OR_COL l3)))))) FORMATTED)