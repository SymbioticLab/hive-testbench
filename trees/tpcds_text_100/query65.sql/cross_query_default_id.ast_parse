(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store)) (TOK_TABREF (TOK_TABNAME item))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_store_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_item_sk)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_sales_price)) revenue)) (TOK_WHERE (and (= (TOK_TABLE_OR_COL ss_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1212 (+ 1212 11)))) (TOK_GROUPBY (TOK_TABLE_OR_COL ss_store_sk) (TOK_TABLE_OR_COL ss_item_sk)))) sa)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_store_sk)) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL revenue)) ave)) (TOK_GROUPBY (TOK_TABLE_OR_COL ss_store_sk)))) sb)) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_store_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_item_sk)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_sales_price)) revenue)) (TOK_WHERE (and (= (TOK_TABLE_OR_COL ss_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1212 (+ 1212 11)))) (TOK_GROUPBY (TOK_TABLE_OR_COL ss_store_sk) (TOK_TABLE_OR_COL ss_item_sk)))) sc))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_desc)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL sc) revenue)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_current_price)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_wholesale_cost)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_brand))) (TOK_WHERE (and (and (and (= (. (TOK_TABLE_OR_COL sb) ss_store_sk) (. (TOK_TABLE_OR_COL sc) ss_store_sk)) (<= (. (TOK_TABLE_OR_COL sc) revenue) (* 0.1 (. (TOK_TABLE_OR_COL sb) ave)))) (= (TOK_TABLE_OR_COL s_store_sk) (. (TOK_TABLE_OR_COL sc) ss_store_sk))) (= (TOK_TABLE_OR_COL i_item_sk) (. (TOK_TABLE_OR_COL sc) ss_item_sk)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_store_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_desc))) (TOK_LIMIT 100))) FORMATTED)