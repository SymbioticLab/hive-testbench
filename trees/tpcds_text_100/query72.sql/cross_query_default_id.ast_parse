(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_LEFTOUTERJOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME inventory)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL inventory) inv_item_sk))) (TOK_TABREF (TOK_TABNAME warehouse)) (= (. (TOK_TABLE_OR_COL warehouse) w_warehouse_sk) (. (TOK_TABLE_OR_COL inventory) inv_warehouse_sk))) (TOK_TABREF (TOK_TABNAME item)) (= (. (TOK_TABLE_OR_COL item) i_item_sk) (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk))) (TOK_TABREF (TOK_TABNAME customer_demographics)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_bill_cdemo_sk) (. (TOK_TABLE_OR_COL customer_demographics) cd_demo_sk))) (TOK_TABREF (TOK_TABNAME household_demographics)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_bill_hdemo_sk) (. (TOK_TABLE_OR_COL household_demographics) hd_demo_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d1) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL d1) d_date_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL inventory) inv_date_sk) (. (TOK_TABLE_OR_COL d2) d_date_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d3) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_ship_date_sk) (. (TOK_TABLE_OR_COL d3) d_date_sk))) (TOK_TABREF (TOK_TABNAME promotion)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_promo_sk) (. (TOK_TABLE_OR_COL promotion) p_promo_sk))) (TOK_TABREF (TOK_TABNAME catalog_returns)) (and (= (. (TOK_TABLE_OR_COL catalog_returns) cr_item_sk) (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk)) (= (. (TOK_TABLE_OR_COL catalog_returns) cr_order_number) (. (TOK_TABLE_OR_COL catalog_sales) cs_order_number))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_desc)) (TOK_SELEXPR (TOK_TABLE_OR_COL w_warehouse_name)) (TOK_SELEXPR (. (TOK_TABLE_OR_COL d1) d_week_seq)) (TOK_SELEXPR (TOK_FUNCTION count (TOK_FUNCTION when (TOK_FUNCTION TOK_ISNULL (TOK_TABLE_OR_COL p_promo_sk)) 1 0)) no_promo) (TOK_SELEXPR (TOK_FUNCTION count (TOK_FUNCTION when (TOK_FUNCTION TOK_ISNOTNULL (TOK_TABLE_OR_COL p_promo_sk)) 1 0)) promo) (TOK_SELEXPR (TOK_FUNCTIONSTAR count) total_cnt)) (TOK_WHERE (and (and (and (and (and (and (and (= (. (TOK_TABLE_OR_COL d1) d_week_seq) (. (TOK_TABLE_OR_COL d2) d_week_seq)) (< (TOK_TABLE_OR_COL inv_quantity_on_hand) (TOK_TABLE_OR_COL cs_quantity))) (> (. (TOK_TABLE_OR_COL d3) d_date) (+ (. (TOK_TABLE_OR_COL d1) d_date) 5))) (= (TOK_TABLE_OR_COL hd_buy_potential) '1001-5000')) (= (. (TOK_TABLE_OR_COL d1) d_year) 2001)) (= (TOK_TABLE_OR_COL hd_buy_potential) '1001-5000')) (= (TOK_TABLE_OR_COL cd_marital_status) 'M')) (= (. (TOK_TABLE_OR_COL d1) d_year) 2001))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_desc) (TOK_TABLE_OR_COL w_warehouse_name) (. (TOK_TABLE_OR_COL d1) d_week_seq)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (TOK_TABLE_OR_COL total_cnt)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_desc)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL w_warehouse_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_week_seq))) (TOK_LIMIT 100))) FORMATTED)