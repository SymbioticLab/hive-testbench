(TOK_EXPLAIN (TOK_QUERY (TOK_CTE (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ws_item_sk) item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL d_date)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_sales_price))) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_sales_price)) (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL ws_item_sk)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_date)))) (TOK_WINDOWRANGE (preceding unbounded) current))) cume_sales)) (TOK_WHERE (and (and (= (TOK_TABLE_OR_COL ws_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))) (TOK_FUNCTION TOK_ISNOTNULL (TOK_TABLE_OR_COL ws_item_sk)))) (TOK_GROUPBY (TOK_TABLE_OR_COL ws_item_sk) (TOK_TABLE_OR_COL d_date)))) web_v1) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL ss_item_sk) item_sk) (TOK_SELEXPR (TOK_TABLE_OR_COL d_date)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_sales_price))) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_sales_price)) (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL ss_item_sk)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_date)))) (TOK_WINDOWRANGE (preceding unbounded) current))) cume_sales)) (TOK_WHERE (and (and (= (TOK_TABLE_OR_COL ss_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_month_seq) 1193 (+ 1193 11))) (TOK_FUNCTION TOK_ISNOTNULL (TOK_TABLE_OR_COL ss_item_sk)))) (TOK_GROUPBY (TOK_TABLE_OR_COL ss_item_sk) (TOK_TABLE_OR_COL d_date)))) store_v1)) (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_FULLOUTERJOIN (TOK_TABREF (TOK_TABNAME web_v1) web) (TOK_TABREF (TOK_TABNAME store_v1) store) (and (= (. (TOK_TABLE_OR_COL web) item_sk) (. (TOK_TABLE_OR_COL store) item_sk)) (= (. (TOK_TABLE_OR_COL web) d_date) (. (TOK_TABLE_OR_COL store) d_date))))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION when (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL web) item_sk)) (. (TOK_TABLE_OR_COL web) item_sk) (. (TOK_TABLE_OR_COL store) item_sk)) item_sk) (TOK_SELEXPR (TOK_FUNCTION when (TOK_FUNCTION TOK_ISNOTNULL (. (TOK_TABLE_OR_COL web) d_date)) (. (TOK_TABLE_OR_COL web) d_date) (. (TOK_TABLE_OR_COL store) d_date)) d_date) (TOK_SELEXPR (. (TOK_TABLE_OR_COL web) cume_sales) web_sales) (TOK_SELEXPR (. (TOK_TABLE_OR_COL store) cume_sales) store_sales)))) x)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL item_sk)) (TOK_SELEXPR (TOK_TABLE_OR_COL d_date)) (TOK_SELEXPR (TOK_TABLE_OR_COL web_sales)) (TOK_SELEXPR (TOK_TABLE_OR_COL store_sales)) (TOK_SELEXPR (TOK_FUNCTION max (TOK_TABLE_OR_COL web_sales) (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL item_sk)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_date)))) (TOK_WINDOWRANGE (preceding unbounded) current))) web_cumulative) (TOK_SELEXPR (TOK_FUNCTION max (TOK_TABLE_OR_COL store_sales) (TOK_WINDOWSPEC (TOK_PARTITIONINGSPEC (TOK_DISTRIBUTEBY (TOK_TABLE_OR_COL item_sk)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_date)))) (TOK_WINDOWRANGE (preceding unbounded) current))) store_cumulative)))) y)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (> (TOK_TABLE_OR_COL web_cumulative) (TOK_TABLE_OR_COL store_cumulative))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL item_sk)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL d_date))) (TOK_LIMIT 100))) FORMATTED)