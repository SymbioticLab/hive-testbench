(TOK_EXPLAIN (TOK_QUERY (TOK_CTE (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_LEFTOUTERJOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME store_returns)) (and (= (TOK_TABLE_OR_COL ss_item_sk) (TOK_TABLE_OR_COL sr_item_sk)) (= (TOK_TABLE_OR_COL ss_ticket_number) (TOK_TABLE_OR_COL sr_ticket_number)))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME promotion)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_id) store_id) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_ext_sales_price)) sales) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL sr_return_amt) 0)) returns) (TOK_SELEXPR (TOK_FUNCTION sum (- (TOK_TABLE_OR_COL ss_net_profit) (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL sr_net_loss) 0))) profit)) (TOK_WHERE (and (and (and (and (and (and (= (TOK_TABLE_OR_COL ss_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_date) (TOK_FUNCTION TOK_DATE '1998-08-04') (TOK_FUNCTION TOK_DATE '1998-09-04'))) (= (TOK_TABLE_OR_COL ss_store_sk) (TOK_TABLE_OR_COL s_store_sk))) (= (TOK_TABLE_OR_COL ss_item_sk) (TOK_TABLE_OR_COL i_item_sk))) (> (TOK_TABLE_OR_COL i_current_price) 50)) (= (TOK_TABLE_OR_COL ss_promo_sk) (TOK_TABLE_OR_COL p_promo_sk))) (= (TOK_TABLE_OR_COL p_channel_tv) 'N'))) (TOK_GROUPBY (TOK_TABLE_OR_COL s_store_id)))) ssr) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_LEFTOUTERJOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME catalog_returns)) (and (= (TOK_TABLE_OR_COL cs_item_sk) (TOK_TABLE_OR_COL cr_item_sk)) (= (TOK_TABLE_OR_COL cs_order_number) (TOK_TABLE_OR_COL cr_order_number)))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME catalog_page))) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME promotion)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL cp_catalog_page_id) catalog_page_id) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_sales_price)) sales) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL cr_return_amount) 0)) returns) (TOK_SELEXPR (TOK_FUNCTION sum (- (TOK_TABLE_OR_COL cs_net_profit) (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL cr_net_loss) 0))) profit)) (TOK_WHERE (and (and (and (and (and (and (= (TOK_TABLE_OR_COL cs_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_date) (TOK_FUNCTION TOK_DATE '1998-08-04') (TOK_FUNCTION TOK_DATE '1998-09-04'))) (= (TOK_TABLE_OR_COL cs_catalog_page_sk) (TOK_TABLE_OR_COL cp_catalog_page_sk))) (= (TOK_TABLE_OR_COL cs_item_sk) (TOK_TABLE_OR_COL i_item_sk))) (> (TOK_TABLE_OR_COL i_current_price) 50)) (= (TOK_TABLE_OR_COL cs_promo_sk) (TOK_TABLE_OR_COL p_promo_sk))) (= (TOK_TABLE_OR_COL p_channel_tv) 'N'))) (TOK_GROUPBY (TOK_TABLE_OR_COL cp_catalog_page_id)))) csr) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_LEFTOUTERJOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME web_returns)) (and (= (TOK_TABLE_OR_COL ws_item_sk) (TOK_TABLE_OR_COL wr_item_sk)) (= (TOK_TABLE_OR_COL ws_order_number) (TOK_TABLE_OR_COL wr_order_number)))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME web_site))) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME promotion)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL web_site_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_ext_sales_price)) sales) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL wr_return_amt) 0)) returns) (TOK_SELEXPR (TOK_FUNCTION sum (- (TOK_TABLE_OR_COL ws_net_profit) (TOK_FUNCTION coalesce (TOK_TABLE_OR_COL wr_net_loss) 0))) profit)) (TOK_WHERE (and (and (and (and (and (and (= (TOK_TABLE_OR_COL ws_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk)) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_date) (TOK_FUNCTION TOK_DATE '1998-08-04') (TOK_FUNCTION TOK_DATE '1998-09-04'))) (= (TOK_TABLE_OR_COL ws_web_site_sk) (TOK_TABLE_OR_COL web_site_sk))) (= (TOK_TABLE_OR_COL ws_item_sk) (TOK_TABLE_OR_COL i_item_sk))) (> (TOK_TABLE_OR_COL i_current_price) 50)) (= (TOK_TABLE_OR_COL ws_promo_sk) (TOK_TABLE_OR_COL p_promo_sk))) (= (TOK_TABLE_OR_COL p_channel_tv) 'N'))) (TOK_GROUPBY (TOK_TABLE_OR_COL web_site_id)))) wsr)) (TOK_FROM (TOK_SUBQUERY (TOK_UNIONALL (TOK_UNIONALL (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME ssr))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'store channel' channel) (TOK_SELEXPR (TOK_FUNCTION concat 'store' (TOK_TABLE_OR_COL store_id)) id) (TOK_SELEXPR (TOK_TABLE_OR_COL sales)) (TOK_SELEXPR (TOK_TABLE_OR_COL returns)) (TOK_SELEXPR (TOK_TABLE_OR_COL profit))))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME csr))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'catalog channel' channel) (TOK_SELEXPR (TOK_FUNCTION concat 'catalog_page' (TOK_TABLE_OR_COL catalog_page_id)) id) (TOK_SELEXPR (TOK_TABLE_OR_COL sales)) (TOK_SELEXPR (TOK_TABLE_OR_COL returns)) (TOK_SELEXPR (TOK_TABLE_OR_COL profit)))))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME wsr))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR 'web channel' channel) (TOK_SELEXPR (TOK_FUNCTION concat 'web_site' (TOK_TABLE_OR_COL web_site_id)) id) (TOK_SELEXPR (TOK_TABLE_OR_COL sales)) (TOK_SELEXPR (TOK_TABLE_OR_COL returns)) (TOK_SELEXPR (TOK_TABLE_OR_COL profit)))))) x)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL channel)) (TOK_SELEXPR (TOK_TABLE_OR_COL id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL sales)) sales) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL returns)) returns) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL profit)) profit)) (TOK_ROLLUP_GROUPBY (TOK_TABLE_OR_COL channel) (TOK_TABLE_OR_COL id)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL channel)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL id))) (TOK_LIMIT 100))) FORMATTED)