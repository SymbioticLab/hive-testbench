(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME inventory)) (TOK_TABREF (TOK_TABNAME warehouse))) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME date_dim)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL w_warehouse_name)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (< (TOK_FUNCTION TOK_DATE (TOK_TABLE_OR_COL d_date)) (TOK_FUNCTION TOK_DATE '1998-04-08')) (TOK_TABLE_OR_COL inv_quantity_on_hand) 0)) inv_before) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION when (>= (TOK_FUNCTION TOK_DATE (TOK_TABLE_OR_COL d_date)) (TOK_FUNCTION TOK_DATE '1998-04-08')) (TOK_TABLE_OR_COL inv_quantity_on_hand) 0)) inv_after)) (TOK_WHERE (and (and (and (and (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL i_current_price) 0.99 1.49) (= (. (TOK_TABLE_OR_COL item) i_item_sk) (. (TOK_TABLE_OR_COL inventory) inv_item_sk))) (= (. (TOK_TABLE_OR_COL inventory) inv_warehouse_sk) (. (TOK_TABLE_OR_COL warehouse) w_warehouse_sk))) (= (. (TOK_TABLE_OR_COL inventory) inv_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL d_date) '1998-03-09' '1998-05-07'))) (TOK_GROUPBY (TOK_TABLE_OR_COL w_warehouse_name) (TOK_TABLE_OR_COL i_item_id)))) x)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (TOK_FUNCTION between KW_FALSE (TOK_FUNCTION when (> (TOK_TABLE_OR_COL inv_before) 0) (/ (TOK_TABLE_OR_COL inv_after) (TOK_TABLE_OR_COL inv_before)) TOK_NULL) (/ 2.0 3.0) (/ 3.0 2.0))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL w_warehouse_name)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_id))) (TOK_LIMIT 100))) FORMATTED)