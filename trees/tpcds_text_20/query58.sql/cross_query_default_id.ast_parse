(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME item)) (= (. (TOK_TABLE_OR_COL store_sales) ss_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL store_sales) ss_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME date_dim) d1) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL d1) d_week_seq) (. (TOK_TABLE_OR_COL d2) d_week_seq)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL d1) d_date))) (TOK_WHERE (= (. (TOK_TABLE_OR_COL d2) d_date) '1998-08-04')))) sub) (= (. (TOK_TABLE_OR_COL date_dim) d_date) (. (TOK_TABLE_OR_COL sub) d_date)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id) item_id) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_ext_sales_price)) ss_item_rev)) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)))) ss_items) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME item)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME date_dim) d1) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL d1) d_week_seq) (. (TOK_TABLE_OR_COL d2) d_week_seq)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL d1) d_date))) (TOK_WHERE (= (. (TOK_TABLE_OR_COL d2) d_date) '1998-08-04')))) sub) (= (. (TOK_TABLE_OR_COL date_dim) d_date) (. (TOK_TABLE_OR_COL sub) d_date)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id) item_id) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_sales_price)) cs_item_rev)) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)))) cs_items) (= (. (TOK_TABLE_OR_COL ss_items) item_id) (. (TOK_TABLE_OR_COL cs_items) item_id))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME item)) (= (. (TOK_TABLE_OR_COL web_sales) ws_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (TOK_TABREF (TOK_TABNAME date_dim)) (= (. (TOK_TABLE_OR_COL web_sales) ws_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME date_dim) d1) (TOK_TABREF (TOK_TABNAME date_dim) d2) (= (. (TOK_TABLE_OR_COL d1) d_week_seq) (. (TOK_TABLE_OR_COL d2) d_week_seq)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL d1) d_date))) (TOK_WHERE (= (. (TOK_TABLE_OR_COL d2) d_date) '1998-08-04')))) sub) (= (. (TOK_TABLE_OR_COL date_dim) d_date) (. (TOK_TABLE_OR_COL sub) d_date)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id) item_id) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_ext_sales_price)) ws_item_rev)) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)))) ws_items) (= (. (TOK_TABLE_OR_COL ss_items) item_id) (. (TOK_TABLE_OR_COL ws_items) item_id)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL ss_items) item_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL ss_item_rev)) (TOK_SELEXPR (* (/ (/ (TOK_TABLE_OR_COL ss_item_rev) (+ (+ (TOK_TABLE_OR_COL ss_item_rev) (TOK_TABLE_OR_COL cs_item_rev)) (TOK_TABLE_OR_COL ws_item_rev))) 3) 100) ss_dev) (TOK_SELEXPR (TOK_TABLE_OR_COL cs_item_rev)) (TOK_SELEXPR (* (/ (/ (TOK_TABLE_OR_COL cs_item_rev) (+ (+ (TOK_TABLE_OR_COL ss_item_rev) (TOK_TABLE_OR_COL cs_item_rev)) (TOK_TABLE_OR_COL ws_item_rev))) 3) 100) cs_dev) (TOK_SELEXPR (TOK_TABLE_OR_COL ws_item_rev)) (TOK_SELEXPR (* (/ (/ (TOK_TABLE_OR_COL ws_item_rev) (+ (+ (TOK_TABLE_OR_COL ss_item_rev) (TOK_TABLE_OR_COL cs_item_rev)) (TOK_TABLE_OR_COL ws_item_rev))) 3) 100) ws_dev) (TOK_SELEXPR (/ (+ (+ (TOK_TABLE_OR_COL ss_item_rev) (TOK_TABLE_OR_COL cs_item_rev)) (TOK_TABLE_OR_COL ws_item_rev)) 3) average)) (TOK_WHERE (and (and (and (and (and (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ss_item_rev) (* 0.9 (TOK_TABLE_OR_COL cs_item_rev)) (* 1.1 (TOK_TABLE_OR_COL cs_item_rev))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ss_item_rev) (* 0.9 (TOK_TABLE_OR_COL ws_item_rev)) (* 1.1 (TOK_TABLE_OR_COL ws_item_rev)))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL cs_item_rev) (* 0.9 (TOK_TABLE_OR_COL ss_item_rev)) (* 1.1 (TOK_TABLE_OR_COL ss_item_rev)))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL cs_item_rev) (* 0.9 (TOK_TABLE_OR_COL ws_item_rev)) (* 1.1 (TOK_TABLE_OR_COL ws_item_rev)))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_item_rev) (* 0.9 (TOK_TABLE_OR_COL ss_item_rev)) (* 1.1 (TOK_TABLE_OR_COL ss_item_rev)))) (TOK_FUNCTION between KW_FALSE (TOK_TABLE_OR_COL ws_item_rev) (* 0.9 (TOK_TABLE_OR_COL cs_item_rev)) (* 1.1 (TOK_TABLE_OR_COL cs_item_rev))))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL item_id)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL ss_item_rev))) (TOK_LIMIT 100))) FORMATTED)