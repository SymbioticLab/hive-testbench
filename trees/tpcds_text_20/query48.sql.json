Created the lattice
HiveAggregate : 1
HiveProject : 12
HiveJoin : 10
HiveTableScan : 5
HiveFilter : 11
Raajay: Total Rels = 39
Raajay: Total plans = 9
Begin exhaustive search for all query plans.
HiveAggregate(group=[{}], agg#0=[sum($0)]): rowcount = 1.0, cumulative cost = {42247.630320149976 rows, 0.0 cpu, 0.0 io}, id = 633
  HiveProject($f0=[$4]): rowcount = 1.0, cumulative cost = {42247.630320149976 rows, 0.0 cpu, 0.0 io}, id = 628
    HiveJoin(condition=[=($0, $14)], joinType=[inner], algorithm=[none], cost=[{653.2232142857142 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {42247.630320149976 rows, 0.0 cpu, 0.0 io}, id = 617
      HiveFilter(condition=[OR(AND(IN($12, 'KY', 'GA', 'NM'), BETWEEN(false, $6, 0, 2000)), AND(IN($12, 'MT', 'OR', 'IN'), BETWEEN(false, $6, 150, 3000)), AND(IN($12, 'WI', 'MO', 'WV'), BETWEEN(false, $6, 50, 25000)))]): rowcount = 1.0, cumulative cost = {41594.40710586426 rows, 0.0 cpu, 0.0 io}, id = 606
        HiveProject(ss_sold_date_sk=[$0], ss_cdemo_sk=[$1], ss_addr_sk=[$2], ss_store_sk=[$3], ss_quantity=[$4], ss_sales_price=[$5], ss_net_profit=[$6], s_store_sk=[$7], cd_demo_sk=[$11], cd_marital_status=[$12], cd_education_status=[$13], ca_address_sk=[$8], ca_state=[$9], ca_country=[$10]): rowcount = 1.0, cumulative cost = {41594.40710586426 rows, 0.0 cpu, 0.0 io}, id = 595
          HiveProject(ss_sold_date_sk=[$0], ss_cdemo_sk=[$1], ss_addr_sk=[$2], ss_store_sk=[$3], ss_quantity=[$4], ss_sales_price=[$5], ss_net_profit=[$6], s_store_sk=[$7], ca_address_sk=[$11], ca_state=[$12], ca_country=[$13], cd_demo_sk=[$8], cd_marital_status=[$9], cd_education_status=[$10]): rowcount = 1.0, cumulative cost = {41594.40710586426 rows, 0.0 cpu, 0.0 io}, id = 593
            HiveJoin(condition=[=($2, $11)], joinType=[inner], algorithm=[none], cost=[{11059.518216975372 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {41594.40710586426 rows, 0.0 cpu, 0.0 io}, id = 591
              HiveProject(ss_sold_date_sk=[$0], ss_cdemo_sk=[$1], ss_addr_sk=[$2], ss_store_sk=[$3], ss_quantity=[$4], ss_sales_price=[$5], ss_net_profit=[$6], s_store_sk=[$10], cd_demo_sk=[$7], cd_marital_status=[$8], cd_education_status=[$9]): rowcount = 1.0, cumulative cost = {30534.888888888887 rows, 0.0 cpu, 0.0 io}, id = 584
                HiveJoin(condition=[=($10, $3)], joinType=[inner], algorithm=[none], cost=[{45.0 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {30534.888888888887 rows, 0.0 cpu, 0.0 io}, id = 570
                  HiveJoin(condition=[=($7, $1)], joinType=[inner], algorithm=[none], cost=[{30489.888888888887 rows, 0.0 cpu, 0.0 io}]): rowcount = 1.0, cumulative cost = {30489.888888888887 rows, 0.0 cpu, 0.0 io}, id = 568
                    HiveProject(ss_sold_date_sk=[$0], ss_cdemo_sk=[$4], ss_addr_sk=[$6], ss_store_sk=[$7], ss_quantity=[$10], ss_sales_price=[$13], ss_net_profit=[$22]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 565
                      HiveFilter(condition=[OR(BETWEEN(false, $13, 1E2, 1.5E2), BETWEEN(false, $13, 5E1, 1E2), BETWEEN(false, $13, 1.5E2, 2E2))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 564
                        HiveFilter(condition=[AND(OR(BETWEEN(false, $13, 1E2, 1.5E2), BETWEEN(false, $13, 5E1, 1E2), BETWEEN(false, $13, 1.5E2, 2E2)), OR(BETWEEN(false, $22, 0, 2000), BETWEEN(false, $22, 150, 3000), BETWEEN(false, $22, 50, 25000)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 563
                          HiveFilter(condition=[AND(OR(BETWEEN(false, $13, 1E2, 1.5E2), BETWEEN(false, $13, 5E1, 1E2), BETWEEN(false, $13, 1.5E2, 2E2)), OR(BETWEEN(false, $22, 0, 2000), BETWEEN(false, $22, 150, 3000), BETWEEN(false, $22, 50, 25000)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 562
                            HiveFilter(condition=[AND(OR(BETWEEN(false, $13, 1E2, 1.5E2), BETWEEN(false, $13, 5E1, 1E2), BETWEEN(false, $13, 1.5E2, 2E2)), OR(BETWEEN(false, $22, 0, 2000), BETWEEN(false, $22, 150, 3000), BETWEEN(false, $22, 50, 25000)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 561
                              HiveFilter(condition=[AND(OR(BETWEEN(false, $13, 1E2, 1.5E2), BETWEEN(false, $13, 5E1, 1E2), BETWEEN(false, $13, 1.5E2, 2E2)), OR(BETWEEN(false, $22, 0, 2000), BETWEEN(false, $22, 150, 3000), BETWEEN(false, $22, 50, 25000)))]): rowcount = 1.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 560
                                HiveTableScan(table=[[tpcds_text_20.store_sales]]): rowcount = 5.7598932E7, cumulative cost = {0}, id = 220
                    HiveProject(cd_demo_sk=[$0], cd_marital_status=[$2], cd_education_status=[$3]): rowcount = 30488.888888888887, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 567
                      HiveFilter(condition=[AND(=($2, 'M'), =($3, '4 yr Degree'))]): rowcount = 30488.888888888887, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 566
                        HiveTableScan(table=[[tpcds_text_20.customer_demographics]]): rowcount = 1920800.0, cumulative cost = {0}, id = 230
                  HiveProject(s_store_sk=[$0]): rowcount = 44.0, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 569
                    HiveTableScan(table=[[tpcds_text_20.store]]): rowcount = 44.0, cumulative cost = {0}, id = 227
              HiveProject(ca_address_sk=[$0], ca_state=[$8], ca_country=[$10]): rowcount = 11058.518216975372, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 588
                HiveFilter(condition=[=($10, 'United States')]): rowcount = 11058.518216975372, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 587
                  HiveFilter(condition=[OR(IN($8, 'KY', 'GA', 'NM'), IN($8, 'MT', 'OR', 'IN'), IN($8, 'WI', 'MO', 'WV'))]): rowcount = 22117.036433950743, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 586
                    HiveFilter(condition=[OR(IN($8, 'KY', 'GA', 'NM'), IN($8, 'MT', 'OR', 'IN'), IN($8, 'WI', 'MO', 'WV'))]): rowcount = 22117.036433950743, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 585
                      HiveTableScan(table=[[tpcds_text_20.customer_address]]): rowcount = 133000.0, cumulative cost = {0}, id = 234
      HiveProject(d_date_sk=[$0], d_year=[$6]): rowcount = 652.2232142857142, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 611
        HiveFilter(condition=[=($6, 1998)]): rowcount = 652.2232142857142, cumulative cost = {0.0 rows, 0.0 cpu, 0.0 io}, id = 610
          HiveTableScan(table=[[tpcds_text_20.date_dim]]): rowcount = 73049.0, cumulative cost = {0}, id = 241

{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"Edges:":{"Map 1":[{"parent":"Map 3","type":"BROADCAST_EDGE"},{"parent":"Map 4","type":"BROADCAST_EDGE"},{"parent":"Map 5","type":"BROADCAST_EDGE"},{"parent":"Map 6","type":"BROADCAST_EDGE"}],"Reducer 2":{"parent":"Map 1","type":"SIMPLE_EDGE"}},"DagName:":"wentingt_20180312131934_937e3c0d-46d7-4a29-89cf-4fc52c44302b:1","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"store_sales","Statistics:":"Num rows: 57598932 Data size: 7890920534 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((((((ss_sales_price BETWEEN 100.0 AND 150.0 or ss_sales_price BETWEEN 50.0 AND 100.0 or ss_sales_price BETWEEN 150.0 AND 200.0) and (ss_net_profit BETWEEN 0 AND 2000 or ss_net_profit BETWEEN 150 AND 3000 or ss_net_profit BETWEEN 50 AND 25000)) and ss_store_sk is not null) and ss_cdemo_sk is not null) and ss_addr_sk is not null) and ss_sold_date_sk is not null) (type: boolean)","Statistics:":"Num rows: 3599934 Data size: 493182636 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"ss_sold_date_sk (type: int), ss_cdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_net_profit (type: float)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4","_col6"],"Statistics:":"Num rows: 3599934 Data size: 493182636 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col3 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col0","_col1","_col2","_col4","_col6"],"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 3959927 Data size: 542500911 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col1 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col0","_col2","_col4","_col6"],"input vertices:":{"1":"Map 4"},"Statistics:":"Num rows: 4355919 Data size: 596751015 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col2 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col0","_col4","_col6","_col12"],"input vertices:":{"1":"Map 5"},"Statistics:":"Num rows: 4791511 Data size: 656426130 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Filter Operator":{"predicate:":"(((_col12) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 0 AND 2000) or ((_col12) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 3000) or ((_col12) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 25000)) (type: boolean)","Statistics:":"Num rows: 3593631 Data size: 492319289 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"_col0 (type: int), _col4 (type: int)","outputColumnNames:":["_col0","_col4"],"Statistics:":"Num rows: 3593631 Data size: 492319289 Basic stats: COMPLETE Column stats: NONE","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: int)","1":"_col0 (type: int)"},"outputColumnNames:":["_col4"],"input vertices:":{"1":"Map 6"},"Statistics:":"Num rows: 3952994 Data size: 541551229 Basic stats: COMPLETE Column stats: NONE","HybridGraceHashJoin:":"true","children":{"Group By Operator":{"aggregations:":["sum(_col4)"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col0 (type: bigint)"}}}}}}}}}}}}}}}}}}}}}}]},"Map 3":{"Map Operator Tree:":[{"TableScan":{"alias:":"store","Statistics:":"Num rows: 44 Data size: 11539 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"s_store_sk is not null (type: boolean)","Statistics:":"Num rows: 22 Data size: 5769 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"s_store_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 22 Data size: 5769 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 22 Data size: 5769 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Map 4":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_demographics","Statistics:":"Num rows: 1920800 Data size: 78739296 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"(((cd_marital_status = 'M') and (cd_education_status = '4 yr Degree')) and cd_demo_sk is not null) (type: boolean)","Statistics:":"Num rows: 240100 Data size: 9842412 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"cd_demo_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 240100 Data size: 9842412 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 240100 Data size: 9842412 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_address","Statistics:":"Num rows: 133000 Data size: 14555796 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((((ca_state) IN ('KY', 'GA', 'NM') or (ca_state) IN ('MT', 'OR', 'IN') or (ca_state) IN ('WI', 'MO', 'WV')) and (ca_country = 'United States')) and ca_address_sk is not null) (type: boolean)","Statistics:":"Num rows: 33250 Data size: 3638949 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"ca_address_sk (type: int), ca_state (type: string)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 33250 Data size: 3638949 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 33250 Data size: 3638949 Basic stats: COMPLETE Column stats: NONE","value expressions:":"_col1 (type: string)"}}}}}}}}]},"Map 6":{"Map Operator Tree:":[{"TableScan":{"alias:":"date_dim","Statistics:":"Num rows: 73049 Data size: 10244389 Basic stats: COMPLETE Column stats: NONE","children":{"Filter Operator":{"predicate:":"((d_year = 1998) and d_date_sk is not null) (type: boolean)","Statistics:":"Num rows: 18262 Data size: 2561062 Basic stats: COMPLETE Column stats: NONE","children":{"Select Operator":{"expressions:":"d_date_sk (type: int)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 18262 Data size: 2561062 Basic stats: COMPLETE Column stats: NONE","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: int)","Statistics:":"Num rows: 18262 Data size: 2561062 Basic stats: COMPLETE Column stats: NONE"}}}}}}}}]},"Reducer 2":{"Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["sum(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE","table:":{"input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"}}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{}}}}}}
