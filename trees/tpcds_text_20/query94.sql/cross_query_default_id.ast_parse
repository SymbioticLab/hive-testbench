(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_LEFTSEMIJOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales) ws1) (TOK_TABREF (TOK_TABNAME customer_address) ca) (= (. (TOK_TABLE_OR_COL ws1) ws_ship_addr_sk) (. (TOK_TABLE_OR_COL ca) ca_address_sk))) (TOK_TABREF (TOK_TABNAME web_site) s) (= (. (TOK_TABLE_OR_COL ws1) ws_web_site_sk) (. (TOK_TABLE_OR_COL s) web_site_sk))) (TOK_TABREF (TOK_TABNAME date_dim) d) (= (. (TOK_TABLE_OR_COL ws1) ws_ship_date_sk) (. (TOK_TABLE_OR_COL d) d_date_sk))) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales) ws2) (TOK_TABREF (TOK_TABNAME web_sales) ws3) (= (. (TOK_TABLE_OR_COL ws2) ws_order_number) (. (TOK_TABLE_OR_COL ws3) ws_order_number)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL ws2) ws_order_number) ws_order_number)) (TOK_WHERE (<> (. (TOK_TABLE_OR_COL ws2) ws_warehouse_sk) (. (TOK_TABLE_OR_COL ws3) ws_warehouse_sk))))) ws_wh1) (= (. (TOK_TABLE_OR_COL ws1) ws_order_number) (. (TOK_TABLE_OR_COL ws_wh1) ws_order_number))) (TOK_TABREF (TOK_TABNAME web_returns) wr1) (= (. (TOK_TABLE_OR_COL ws1) ws_order_number) (. (TOK_TABLE_OR_COL wr1) wr_order_number)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTIONDI count (TOK_TABLE_OR_COL ws_order_number)) order_count) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_ext_ship_cost)) total_shipping_cost) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_net_profit)) total_net_profit)) (TOK_WHERE (and (and (and (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL d) d_date) '1999-05-01' '1999-07-01') (= (. (TOK_TABLE_OR_COL ca) ca_state) 'TX')) (= (. (TOK_TABLE_OR_COL s) web_company_name) 'pri')) (TOK_FUNCTION TOK_ISNULL (. (TOK_TABLE_OR_COL wr1) wr_order_number)))) (TOK_LIMIT 100))) FORMATTED)