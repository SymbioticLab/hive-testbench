(TOK_EXPLAIN (TOK_QUERY (TOK_CTE (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME customer_address))) (TOK_TABREF (TOK_TABNAME item)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_ext_sales_price)) total_sales)) (TOK_WHERE (and (and (and (and (and (and (TOK_SUBQUERY_EXPR (TOK_SUBQUERY_OP in) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME item) i)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL i) i_item_id))) (TOK_WHERE (TOK_FUNCTION in (TOK_TABLE_OR_COL i_color) 'purple' 'burlywood' 'indian')))) (. (TOK_TABLE_OR_COL item) i_item_id)) (= (TOK_TABLE_OR_COL ss_item_sk) (TOK_TABLE_OR_COL i_item_sk))) (= (TOK_TABLE_OR_COL ss_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk))) (= (TOK_TABLE_OR_COL d_year) 2001)) (= (TOK_TABLE_OR_COL d_moy) 1)) (= (TOK_TABLE_OR_COL ss_addr_sk) (TOK_TABLE_OR_COL ca_address_sk))) (= (TOK_TABLE_OR_COL ca_gmt_offset) (- 6)))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)))) ss) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME customer_address))) (TOK_TABREF (TOK_TABNAME item)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_ext_sales_price)) total_sales)) (TOK_WHERE (and (and (and (and (and (and (TOK_SUBQUERY_EXPR (TOK_SUBQUERY_OP in) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME item) i)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL i) i_item_id))) (TOK_WHERE (TOK_FUNCTION in (TOK_TABLE_OR_COL i_color) 'purple' 'burlywood' 'indian')))) (. (TOK_TABLE_OR_COL item) i_item_id)) (= (TOK_TABLE_OR_COL cs_item_sk) (TOK_TABLE_OR_COL i_item_sk))) (= (TOK_TABLE_OR_COL cs_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk))) (= (TOK_TABLE_OR_COL d_year) 2001)) (= (TOK_TABLE_OR_COL d_moy) 1)) (= (TOK_TABLE_OR_COL cs_bill_addr_sk) (TOK_TABLE_OR_COL ca_address_sk))) (= (TOK_TABLE_OR_COL ca_gmt_offset) (- 6)))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)))) cs) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME web_sales)) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME customer_address))) (TOK_TABREF (TOK_TABNAME item)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ws_ext_sales_price)) total_sales)) (TOK_WHERE (and (and (and (and (and (and (TOK_SUBQUERY_EXPR (TOK_SUBQUERY_OP in) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME item) i)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL i) i_item_id))) (TOK_WHERE (TOK_FUNCTION in (TOK_TABLE_OR_COL i_color) 'purple' 'burlywood' 'indian')))) (. (TOK_TABLE_OR_COL item) i_item_id)) (= (TOK_TABLE_OR_COL ws_item_sk) (TOK_TABLE_OR_COL i_item_sk))) (= (TOK_TABLE_OR_COL ws_sold_date_sk) (TOK_TABLE_OR_COL d_date_sk))) (= (TOK_TABLE_OR_COL d_year) 2001)) (= (TOK_TABLE_OR_COL d_moy) 1)) (= (TOK_TABLE_OR_COL ws_bill_addr_sk) (TOK_TABLE_OR_COL ca_address_sk))) (= (TOK_TABLE_OR_COL ca_gmt_offset) (- 6)))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)))) ws)) (TOK_FROM (TOK_SUBQUERY (TOK_UNIONALL (TOK_UNIONALL (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME ss))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cs))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF))))) (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME ws))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF))))) tmp1)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL total_sales)) total_sales)) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL total_sales))) (TOK_LIMIT 100))) FORMATTED)