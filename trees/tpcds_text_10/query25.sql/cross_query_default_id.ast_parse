(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME store_sales)) (TOK_TABREF (TOK_TABNAME store_returns))) (TOK_TABREF (TOK_TABNAME catalog_sales))) (TOK_TABREF (TOK_TABNAME date_dim) d1)) (TOK_TABREF (TOK_TABNAME date_dim) d2)) (TOK_TABREF (TOK_TABNAME date_dim) d3)) (TOK_TABREF (TOK_TABNAME store))) (TOK_TABREF (TOK_TABNAME item)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_desc)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_id)) (TOK_SELEXPR (TOK_TABLE_OR_COL s_store_name)) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL ss_net_profit)) store_sales_profit) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL sr_net_loss)) store_returns_loss) (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL cs_net_profit)) catalog_sales_profit)) (TOK_WHERE (and (and (and (and (and (and (and (and (and (and (and (and (and (and (and (= (. (TOK_TABLE_OR_COL d1) d_moy) 4) (= (. (TOK_TABLE_OR_COL d1) d_year) 1998)) (= (. (TOK_TABLE_OR_COL d1) d_date_sk) (TOK_TABLE_OR_COL ss_sold_date_sk))) (= (TOK_TABLE_OR_COL i_item_sk) (TOK_TABLE_OR_COL ss_item_sk))) (= (TOK_TABLE_OR_COL s_store_sk) (TOK_TABLE_OR_COL ss_store_sk))) (= (TOK_TABLE_OR_COL ss_customer_sk) (TOK_TABLE_OR_COL sr_customer_sk))) (= (TOK_TABLE_OR_COL ss_item_sk) (TOK_TABLE_OR_COL sr_item_sk))) (= (TOK_TABLE_OR_COL ss_ticket_number) (TOK_TABLE_OR_COL sr_ticket_number))) (= (TOK_TABLE_OR_COL sr_returned_date_sk) (. (TOK_TABLE_OR_COL d2) d_date_sk))) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL d2) d_moy) 4 10)) (= (. (TOK_TABLE_OR_COL d2) d_year) 1998)) (= (TOK_TABLE_OR_COL sr_customer_sk) (TOK_TABLE_OR_COL cs_bill_customer_sk))) (= (TOK_TABLE_OR_COL sr_item_sk) (TOK_TABLE_OR_COL cs_item_sk))) (= (TOK_TABLE_OR_COL cs_sold_date_sk) (. (TOK_TABLE_OR_COL d3) d_date_sk))) (TOK_FUNCTION between KW_FALSE (. (TOK_TABLE_OR_COL d3) d_moy) 4 10)) (= (. (TOK_TABLE_OR_COL d3) d_year) 1998))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id) (TOK_TABLE_OR_COL i_item_desc) (TOK_TABLE_OR_COL s_store_id) (TOK_TABLE_OR_COL s_store_name)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_id)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_desc)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_store_id)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL s_store_name))) (TOK_LIMIT 100))) FORMATTED)