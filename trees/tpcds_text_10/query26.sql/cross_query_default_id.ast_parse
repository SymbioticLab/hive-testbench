(TOK_EXPLAIN (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_JOIN (TOK_TABREF (TOK_TABNAME catalog_sales)) (TOK_TABREF (TOK_TABNAME customer_demographics))) (TOK_TABREF (TOK_TABNAME date_dim))) (TOK_TABREF (TOK_TABNAME item))) (TOK_TABREF (TOK_TABNAME promotion)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL i_item_id)) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL cs_quantity)) agg1) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL cs_list_price)) agg2) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL cs_coupon_amt)) agg3) (TOK_SELEXPR (TOK_FUNCTION avg (TOK_TABLE_OR_COL cs_sales_price)) agg4)) (TOK_WHERE (and (and (and (and (and (and (and (and (= (. (TOK_TABLE_OR_COL catalog_sales) cs_sold_date_sk) (. (TOK_TABLE_OR_COL date_dim) d_date_sk)) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_item_sk) (. (TOK_TABLE_OR_COL item) i_item_sk))) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_bill_cdemo_sk) (. (TOK_TABLE_OR_COL customer_demographics) cd_demo_sk))) (= (. (TOK_TABLE_OR_COL catalog_sales) cs_promo_sk) (. (TOK_TABLE_OR_COL promotion) p_promo_sk))) (= (TOK_TABLE_OR_COL cd_gender) 'F')) (= (TOK_TABLE_OR_COL cd_marital_status) 'W')) (= (TOK_TABLE_OR_COL cd_education_status) 'Primary')) (or (= (TOK_TABLE_OR_COL p_channel_email) 'N') (= (TOK_TABLE_OR_COL p_channel_event) 'N'))) (= (TOK_TABLE_OR_COL d_year) 1998))) (TOK_GROUPBY (TOK_TABLE_OR_COL i_item_id)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL i_item_id))) (TOK_LIMIT 100))) FORMATTED)