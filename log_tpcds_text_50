@@@sample-queries-tpcds/query12.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage , consists of Stage-15, Stage-1
  Stage-15 has a backup stage: Stage-1
  Stage-11 depends on stages: Stage-15
  Stage-10 depends on stages: Stage-1, Stage-11 , consists of Stage-13, Stage-14, Stage-2
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-3 depends on stages: Stage-2, Stage-8, Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-14 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-14
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 42855 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
                outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
                Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
              sort order: +++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col3 (type: string), _col0 (type: string), _col1 (type: string), _col4 (type: float), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: string)
              sort order: +
              Map-reduce partition columns: _col3 (type: string)
              Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col3 (type: float), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: float, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col3 ASC NULLS FIRST
                  partition by: _col3
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col5
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col0 (type: string), _col5 (type: double), ((_col5 * 100.0) / sum_window_0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col0 (type: string), _col6 (type: double)
              sort order: +++++
              Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: float), KEY.reducesinkkey2 (type: string), VALUE._col1 (type: double), KEY.reducesinkkey4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
                    outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
            outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
            Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 42855 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: float), _col4 (type: string), _col5 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query13.sql
STAGE DEPENDENCIES:
  Stage-30 is a root stage
  Stage-22 depends on stages: Stage-30
  Stage-21 depends on stages: Stage-22 , consists of Stage-28, Stage-29, Stage-2
  Stage-28 has a backup stage: Stage-2
  Stage-19 depends on stages: Stage-28
  Stage-27 depends on stages: Stage-2, Stage-19, Stage-20
  Stage-18 depends on stages: Stage-27
  Stage-17 depends on stages: Stage-18 , consists of Stage-25, Stage-26, Stage-4
  Stage-25 has a backup stage: Stage-4
  Stage-15 depends on stages: Stage-25
  Stage-14 depends on stages: Stage-4, Stage-15, Stage-16 , consists of Stage-23, Stage-24, Stage-5
  Stage-23 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-23
  Stage-6 depends on stages: Stage-5, Stage-12, Stage-13
  Stage-24 has a backup stage: Stage-5
  Stage-13 depends on stages: Stage-24
  Stage-5
  Stage-26 has a backup stage: Stage-4
  Stage-16 depends on stages: Stage-26
  Stage-4
  Stage-29 has a backup stage: Stage-2
  Stage-20 depends on stages: Stage-29
  Stage-2
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:store 
          TableScan
            alias: store
            Statistics: Num rows: 9615 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 9615 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9615 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_sales_price BETWEEN 100 AND 150 or ss_sales_price BETWEEN 50 AND 100 or ss_sales_price BETWEEN 150 AND 200) and (ss_net_profit BETWEEN 100 AND 200 or ss_net_profit BETWEEN 150 AND 300 or ss_net_profit BETWEEN 50 AND 250) and ss_store_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 55933221 Data size: 2237328841 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_sales_price (type: float), ss_ext_sales_price (type: float), ss_ext_wholesale_cost (type: float), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 55933221 Data size: 2237328841 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 61526544 Data size: 2461061778 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and ((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col5, _col6, _col7, _col8, _col9, _col12, _col13
              Statistics: Num rows: 67679199 Data size: 2707168014 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 3) or (hd_dep_count = 1)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_dep_count (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col5, _col6, _col7, _col8, _col9, _col12, _col13, _col15
              Statistics: Num rows: 74447120 Data size: 2977884879 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (((_col12 = 'M') and (_col13 = '4 yr Degree') and _col6 BETWEEN 100 AND 150 and (_col15 = 3)) or ((_col12 = 'D') and (_col13 = 'Primary') and _col6 BETWEEN 50 AND 100 and (_col15 = 1)) or ((_col12 = 'U') and (_col13 = 'Advanced Degree') and _col6 BETWEEN 150 AND 200 and (_col15 = 1))) (type: boolean)
                Statistics: Num rows: 3101961 Data size: 124078443 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col3 (type: int), _col5 (type: int), _col7 (type: float), _col8 (type: float), _col9 (type: float)
                  outputColumnNames: _col0, _col3, _col5, _col7, _col8, _col9
                  Statistics: Num rows: 3101961 Data size: 124078443 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col5, _col7, _col8, _col9, _col17
              Statistics: Num rows: 3412157 Data size: 136486290 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (((_col17) IN ('KY', 'GA', 'NM') and _col9 BETWEEN 100 AND 200) or ((_col17) IN ('MT', 'OR', 'IN') and _col9 BETWEEN 150 AND 300) or ((_col17) IN ('WI', 'MO', 'WV') and _col9 BETWEEN 50 AND 250)) (type: boolean)
                Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col5 (type: int), _col7 (type: float), _col8 (type: float)
                  outputColumnNames: _col0, _col5, _col7, _col8
                  Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col7, _col8
              Statistics: Num rows: 709322 Data size: 5674585 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: avg(_col5), avg(_col7), avg(_col8), sum(_col8)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: struct<count:bigint,sum:double,input:int>), _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), sum(VALUE._col3)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col7, _col8
                  Statistics: Num rows: 709322 Data size: 5674585 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: avg(_col5), avg(_col7), avg(_col8), sum(_col8)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col7 (type: float), _col8 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col7, _col8
          Statistics: Num rows: 709322 Data size: 5674585 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: avg(_col5), avg(_col7), avg(_col8), sum(_col8)
            mode: hash
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col5, _col7, _col8, _col9, _col17
                  Statistics: Num rows: 3412157 Data size: 136486290 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((_col17) IN ('KY', 'GA', 'NM') and _col9 BETWEEN 100 AND 200) or ((_col17) IN ('MT', 'OR', 'IN') and _col9 BETWEEN 150 AND 300) or ((_col17) IN ('WI', 'MO', 'WV') and _col9 BETWEEN 50 AND 250)) (type: boolean)
                    Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col0 (type: int), _col5 (type: int), _col7 (type: float), _col8 (type: float)
                      outputColumnNames: _col0, _col5, _col7, _col8
                      Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int)
              sort order: +
              Map-reduce partition columns: _col3 (type: int)
              Statistics: Num rows: 3101961 Data size: 124078443 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col5 (type: int), _col7 (type: float), _col8 (type: float), _col9 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col5, _col7, _col8, _col9, _col17
          Statistics: Num rows: 3412157 Data size: 136486290 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (((_col17) IN ('KY', 'GA', 'NM') and _col9 BETWEEN 100 AND 200) or ((_col17) IN ('MT', 'OR', 'IN') and _col9 BETWEEN 150 AND 300) or ((_col17) IN ('WI', 'MO', 'WV') and _col9 BETWEEN 50 AND 250)) (type: boolean)
            Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col5 (type: int), _col7 (type: float), _col8 (type: float)
              outputColumnNames: _col0, _col5, _col7, _col8
              Statistics: Num rows: 568692 Data size: 22747681 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and ((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col5, _col6, _col7, _col8, _col9, _col12, _col13
                  Statistics: Num rows: 67679199 Data size: 2707168014 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 61526544 Data size: 2461061778 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: float), _col7 (type: float), _col8 (type: float), _col9 (type: float)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and ((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col5, _col6, _col7, _col8, _col9, _col12, _col13
          Statistics: Num rows: 67679199 Data size: 2707168014 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query15.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-14 depends on stages: Stage-1 , consists of Stage-17, Stage-18, Stage-2
  Stage-17 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-17
  Stage-11 depends on stages: Stage-2, Stage-12, Stage-13 , consists of Stage-15, Stage-16, Stage-3
  Stage-15 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-15
  Stage-4 depends on stages: Stage-3, Stage-9, Stage-10
  Stage-5 depends on stages: Stage-4
  Stage-16 has a backup stage: Stage-3
  Stage-10 depends on stages: Stage-16
  Stage-3
  Stage-18 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-18
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col6, _col7
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((substr(_col7, 1, 5)) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') or (_col6) IN ('CA', 'WA', 'GA') or (_col2 > 500)) (type: boolean)
                Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col2 (type: float), _col7 (type: string)
                  outputColumnNames: _col0, _col2, _col7
                  Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 843275029 Data size: 10119300363 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 843275029 Data size: 10119300363 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 843275029 Data size: 10119300363 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col7 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col6, _col7
                  Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((substr(_col7, 1, 5)) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') or (_col6) IN ('CA', 'WA', 'GA') or (_col2 > 500)) (type: boolean)
                    Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col0 (type: int), _col2 (type: float), _col7 (type: string)
                      outputColumnNames: _col0, _col2, _col7
                      Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col6, _col7
          Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((substr(_col7, 1, 5)) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') or (_col6) IN ('CA', 'WA', 'GA') or (_col2 > 500)) (type: boolean)
            Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col2 (type: float), _col7 (type: string)
              outputColumnNames: _col0, _col2, _col7
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query17.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-32 depends on stages: Stage-1 , consists of Stage-42, Stage-43, Stage-2
  Stage-42 has a backup stage: Stage-2
  Stage-30 depends on stages: Stage-42
  Stage-29 depends on stages: Stage-2, Stage-30, Stage-31 , consists of Stage-40, Stage-41, Stage-3
  Stage-40 has a backup stage: Stage-3
  Stage-27 depends on stages: Stage-40
  Stage-26 depends on stages: Stage-3, Stage-27, Stage-28 , consists of Stage-38, Stage-39, Stage-4
  Stage-38 has a backup stage: Stage-4
  Stage-24 depends on stages: Stage-38
  Stage-23 depends on stages: Stage-4, Stage-24, Stage-25 , consists of Stage-36, Stage-37, Stage-5
  Stage-36 has a backup stage: Stage-5
  Stage-21 depends on stages: Stage-36
  Stage-35 depends on stages: Stage-5, Stage-21, Stage-22
  Stage-20 depends on stages: Stage-35
  Stage-19 depends on stages: Stage-20 , consists of Stage-33, Stage-34, Stage-7
  Stage-33 has a backup stage: Stage-7
  Stage-17 depends on stages: Stage-33
  Stage-8 depends on stages: Stage-7, Stage-17, Stage-18
  Stage-9 depends on stages: Stage-8
  Stage-34 has a backup stage: Stage-7
  Stage-18 depends on stages: Stage-34
  Stage-7
  Stage-37 has a backup stage: Stage-5
  Stage-22 depends on stages: Stage-37
  Stage-5
  Stage-39 has a backup stage: Stage-4
  Stage-25 depends on stages: Stage-39
  Stage-4
  Stage-41 has a backup stage: Stage-3
  Stage-28 depends on stages: Stage-41
  Stage-3
  Stage-43 has a backup stage: Stage-2
  Stage-31 depends on stages: Stage-43
  Stage-2
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int), _col5 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null and sr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: int), sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
            1 _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col8, _col10
          Statistics: Num rows: 791055611 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:catalog_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:catalog_sales 
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int), _col8 (type: int)
                    1 _col2 (type: int), _col1 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int), _col8 (type: int)
                1 _col2 (type: int), _col1 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name = '2000Q1') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_5:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col10, _col14
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_6:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col5, _col10, _col14, _col22
              Statistics: Num rows: 1530544245 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_7:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_7:item 
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col10, _col14, _col22, _col24, _col25
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col24 (type: string), _col25 (type: string), _col22 (type: string), _col5 (type: int), _col10 (type: int), _col14 (type: int)
                outputColumnNames: _col24, _col25, _col22, _col5, _col10, _col14
                Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(_col5), avg(_col5), stddev_samp(_col5), count(_col10), avg(_col10), stddev_samp(_col10), count(_col14), avg(_col14), stddev_samp(_col14)
                  keys: _col24 (type: string), _col25 (type: string), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                  Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: struct<count:bigint,sum:double,input:int>), _col5 (type: struct<count:bigint,sum:double,variance:double>), _col6 (type: bigint), _col7 (type: struct<count:bigint,sum:double,input:int>), _col8 (type: struct<count:bigint,sum:double,variance:double>), _col9 (type: bigint), _col10 (type: struct<count:bigint,sum:double,input:int>), _col11 (type: struct<count:bigint,sum:double,variance:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), avg(VALUE._col1), stddev_samp(VALUE._col2), count(VALUE._col3), avg(VALUE._col4), stddev_samp(VALUE._col5), count(VALUE._col6), avg(VALUE._col7), stddev_samp(VALUE._col8)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
          Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), (_col8 / _col7) (type: double), _col9 (type: bigint), _col10 (type: double), (_col11 / _col10) (type: double), _col2 (type: string), _col3 (type: bigint), _col4 (type: double), _col5 (type: double), (_col5 / _col4) (type: double), _col6 (type: bigint), _col7 (type: double), _col8 (type: double)
            outputColumnNames: _col0, _col1, _col10, _col11, _col12, _col13, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
            Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: double), _col13 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: bigint), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col10 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
          Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col10, _col14, _col22, _col24, _col25
                  Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col24 (type: string), _col25 (type: string), _col22 (type: string), _col5 (type: int), _col10 (type: int), _col14 (type: int)
                    outputColumnNames: _col24, _col25, _col22, _col5, _col10, _col14
                    Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count(_col5), avg(_col5), stddev_samp(_col5), count(_col10), avg(_col10), stddev_samp(_col10), count(_col14), avg(_col14), stddev_samp(_col14)
                      keys: _col24 (type: string), _col25 (type: string), _col22 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                      Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1530544245 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col10 (type: int), _col14 (type: int), _col22 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col10, _col14, _col22, _col24, _col25
          Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col24 (type: string), _col25 (type: string), _col22 (type: string), _col5 (type: int), _col10 (type: int), _col14 (type: int)
            outputColumnNames: _col24, _col25, _col22, _col5, _col10, _col14
            Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(_col5), avg(_col5), stddev_samp(_col5), count(_col10), avg(_col10), stddev_samp(_col10), count(_col14), avg(_col14), stddev_samp(_col14)
              keys: _col24 (type: string), _col25 (type: string), _col22 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d3
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col10, _col14
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: int)
              sort order: +
              Map-reduce partition columns: _col11 (type: int)
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: int), _col10 (type: int), _col14 (type: int)
          TableScan
            alias: d3
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col10, _col14
          Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
                  Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int)
              sort order: +
              Map-reduce partition columns: _col6 (type: int)
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: int), _col10 (type: int), _col11 (type: int), _col14 (type: int)
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
          Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name = '2000Q1') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
                  Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: int), _col10 (type: int), _col11 (type: int), _col14 (type: int)
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name = '2000Q1') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
          Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: int), _col8 (type: int)
                1 _col2 (type: int), _col1 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: int), _col8 (type: int)
                    1 _col2 (type: int), _col1 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
                  Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: int), _col8 (type: int)
              sort order: ++
              Map-reduce partition columns: _col7 (type: int), _col8 (type: int)
              Statistics: Num rows: 791055611 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int), _col1 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col2 (type: int), _col1 (type: int)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: int), _col8 (type: int)
            1 _col2 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query18.sql
STAGE DEPENDENCIES:
  Stage-31 is a root stage , consists of Stage-42, Stage-1
  Stage-42 has a backup stage: Stage-1
  Stage-30 depends on stages: Stage-42
  Stage-29 depends on stages: Stage-1, Stage-30 , consists of Stage-40, Stage-41, Stage-2
  Stage-40 has a backup stage: Stage-2
  Stage-27 depends on stages: Stage-40
  Stage-26 depends on stages: Stage-2, Stage-27, Stage-28 , consists of Stage-38, Stage-39, Stage-3
  Stage-38 has a backup stage: Stage-3
  Stage-24 depends on stages: Stage-38
  Stage-23 depends on stages: Stage-3, Stage-24, Stage-25 , consists of Stage-36, Stage-37, Stage-4
  Stage-36 has a backup stage: Stage-4
  Stage-21 depends on stages: Stage-36
  Stage-20 depends on stages: Stage-4, Stage-21, Stage-22 , consists of Stage-34, Stage-35, Stage-5
  Stage-34 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-34
  Stage-17 depends on stages: Stage-5, Stage-18, Stage-19 , consists of Stage-32, Stage-33, Stage-6
  Stage-32 has a backup stage: Stage-6
  Stage-15 depends on stages: Stage-32
  Stage-7 depends on stages: Stage-6, Stage-15, Stage-16
  Stage-8 depends on stages: Stage-7
  Stage-33 has a backup stage: Stage-6
  Stage-16 depends on stages: Stage-33
  Stage-6
  Stage-35 has a backup stage: Stage-5
  Stage-19 depends on stages: Stage-35
  Stage-5
  Stage-37 has a backup stage: Stage-4
  Stage-22 depends on stages: Stage-37
  Stage-4
  Stage-39 has a backup stage: Stage-3
  Stage-25 depends on stages: Stage-39
  Stage-3
  Stage-41 has a backup stage: Stage-2
  Stage-28 depends on stages: Stage-41
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-31
    Conditional Operator

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_cdemo_sk is not null and cs_item_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_bill_cdemo_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_list_price (type: float), cs_sales_price (type: float), cs_coupon_amt (type: float), cs_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 464614321 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:cd1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 387788 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'M') and (cd_education_status = 'College') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_dep_count (type: int)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col14
              Statistics: Num rows: 511075764 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8, _col14, _col16
              Statistics: Num rows: 562183352 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 5132629 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_birth_month) IN (9, 5, 12, 4, 1, 10) and c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_addr_sk (type: int), c_birth_year (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4
                Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col18, _col19, _col21
              Statistics: Num rows: 618401700 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 139822 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('ND', 'WI', 'AL', 'NC', 'OK', 'MS', 'TN') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col18, _col21, _col23, _col24, _col25
              Statistics: Num rows: 680241884 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_6:cd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_6:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col18 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col21, _col23, _col24, _col25
              Statistics: Num rows: 748266088 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col16 (type: string), _col25 (type: string), _col24 (type: string), _col23 (type: string), CAST( _col4 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col5 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col7 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col6 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col8 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col21 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col14 AS decimal(12,2)) (type: decimal(12,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 748266088 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col4), avg(_col5), avg(_col6), avg(_col7), avg(_col8), avg(_col9), avg(_col10)
                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), 0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                  Statistics: Num rows: 3741330440 Data size: 134687896665 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
              sort order: +++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
              Statistics: Num rows: 3741330440 Data size: 134687896665 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col6 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col7 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col8 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col9 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col10 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col11 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3), avg(VALUE._col4), avg(VALUE._col5), avg(VALUE._col6)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7, _col8, _col9, _col10, _col11
          Statistics: Num rows: 1870665220 Data size: 67343948332 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col5 (type: decimal(16,6)), _col6 (type: decimal(16,6)), _col7 (type: decimal(16,6)), _col8 (type: decimal(16,6)), _col9 (type: decimal(16,6)), _col10 (type: decimal(16,6)), _col11 (type: decimal(16,6))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
            Statistics: Num rows: 1870665220 Data size: 67343948332 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col0 (type: string)
              sort order: ++++
              Statistics: Num rows: 1870665220 Data size: 67343948332 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: decimal(16,6)), _col5 (type: decimal(16,6)), _col6 (type: decimal(16,6)), _col7 (type: decimal(16,6)), _col8 (type: decimal(16,6)), _col9 (type: decimal(16,6)), _col10 (type: decimal(16,6))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), VALUE._col0 (type: decimal(16,6)), VALUE._col1 (type: decimal(16,6)), VALUE._col2 (type: decimal(16,6)), VALUE._col3 (type: decimal(16,6)), VALUE._col4 (type: decimal(16,6)), VALUE._col5 (type: decimal(16,6)), VALUE._col6 (type: decimal(16,6))
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
          Statistics: Num rows: 1870665220 Data size: 67343948332 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col18 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd2
            Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col21, _col23, _col24, _col25
                  Statistics: Num rows: 748266088 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col16 (type: string), _col25 (type: string), _col24 (type: string), _col23 (type: string), CAST( _col4 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col5 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col7 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col6 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col8 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col21 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col14 AS decimal(12,2)) (type: decimal(12,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                    Statistics: Num rows: 748266088 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: avg(_col4), avg(_col5), avg(_col6), avg(_col7), avg(_col8), avg(_col9), avg(_col10)
                      keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), 0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                      Statistics: Num rows: 3741330440 Data size: 134687896665 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col18 (type: int)
              sort order: +
              Map-reduce partition columns: _col18 (type: int)
              Statistics: Num rows: 680241884 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col8 (type: float), _col14 (type: int), _col16 (type: string), _col21 (type: int), _col23 (type: string), _col24 (type: string), _col25 (type: string)
          TableScan
            alias: cd2
            Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col18 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col21, _col23, _col24, _col25
          Statistics: Num rows: 748266088 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col16 (type: string), _col25 (type: string), _col24 (type: string), _col23 (type: string), CAST( _col4 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col5 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col7 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col6 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col8 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col21 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col14 AS decimal(12,2)) (type: decimal(12,2))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
            Statistics: Num rows: 748266088 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col4), avg(_col5), avg(_col6), avg(_col7), avg(_col8), avg(_col9), avg(_col10)
              keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), 0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
              Statistics: Num rows: 3741330440 Data size: 134687896665 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 139822 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('ND', 'WI', 'AL', 'NC', 'OK', 'MS', 'TN') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col18, _col21, _col23, _col24, _col25
                  Statistics: Num rows: 680241884 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col19 (type: int)
              sort order: +
              Map-reduce partition columns: _col19 (type: int)
              Statistics: Num rows: 618401700 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col8 (type: float), _col14 (type: int), _col16 (type: string), _col18 (type: int), _col21 (type: int)
          TableScan
            alias: customer_address
            Statistics: Num rows: 139822 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('ND', 'WI', 'AL', 'NC', 'OK', 'MS', 'TN') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 69911 Data size: 21252982 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col19 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col18, _col21, _col23, _col24, _col25
          Statistics: Num rows: 680241884 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 5132629 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_birth_month) IN (9, 5, 12, 4, 1, 10) and c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_addr_sk (type: int), c_birth_year (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4
                Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col18, _col19, _col21
                  Statistics: Num rows: 618401700 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 562183352 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col8 (type: float), _col14 (type: int), _col16 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 5132629 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_birth_month) IN (9, 5, 12, 4, 1, 10) and c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_addr_sk (type: int), c_birth_year (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4
                Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2566315 Data size: 51326306 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col14, _col16, _col18, _col19, _col21
          Statistics: Num rows: 618401700 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8, _col14, _col16
                  Statistics: Num rows: 562183352 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int)
              sort order: +
              Map-reduce partition columns: _col3 (type: int)
              Statistics: Num rows: 511075764 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col8 (type: float), _col14 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8, _col14, _col16
          Statistics: Num rows: 562183352 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd1
            Statistics: Num rows: 387788 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'M') and (cd_education_status = 'College') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_dep_count (type: int)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col14
                  Statistics: Num rows: 511075764 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 464614321 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col8 (type: float)
          TableScan
            alias: cd1
            Statistics: Num rows: 387788 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'M') and (cd_education_status = 'College') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_dep_count (type: int)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 96947 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col14
          Statistics: Num rows: 511075764 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_cdemo_sk is not null and cs_item_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_bill_cdemo_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_list_price (type: float), cs_sales_price (type: float), cs_coupon_amt (type: float), cs_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col8 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 464614321 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query19.sql
STAGE DEPENDENCIES:
  Stage-24 is a root stage , consists of Stage-32, Stage-1
  Stage-32 has a backup stage: Stage-1
  Stage-23 depends on stages: Stage-32
  Stage-22 depends on stages: Stage-1, Stage-23 , consists of Stage-30, Stage-31, Stage-2
  Stage-30 has a backup stage: Stage-2
  Stage-20 depends on stages: Stage-30
  Stage-19 depends on stages: Stage-2, Stage-20, Stage-21 , consists of Stage-28, Stage-29, Stage-3
  Stage-28 has a backup stage: Stage-3
  Stage-17 depends on stages: Stage-28
  Stage-16 depends on stages: Stage-3, Stage-17, Stage-18 , consists of Stage-26, Stage-27, Stage-4
  Stage-26 has a backup stage: Stage-4
  Stage-14 depends on stages: Stage-26
  Stage-25 depends on stages: Stage-4, Stage-14, Stage-15
  Stage-6 depends on stages: Stage-25
  Stage-7 depends on stages: Stage-6
  Stage-27 has a backup stage: Stage-4
  Stage-15 depends on stages: Stage-27
  Stage-4
  Stage-29 has a backup stage: Stage-3
  Stage-18 depends on stages: Stage-29
  Stage-3
  Stage-31 has a backup stage: Stage-2
  Stage-21 depends on stages: Stage-31
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-24
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 11) and (d_year = 1999) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5, _col6, _col7
                  Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 80948 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 7) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string), i_manufact_id (type: int), i_manufact (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col6, _col7, _col9, _col10, _col11, _col12
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col6, _col7, _col9, _col10, _col11, _col12, _col15
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_zip (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col6, _col7, _col9, _col10, _col11, _col12, _col17
              Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_5:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_5:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_zip (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col7, _col9, _col10, _col11, _col12, _col17, _col19
              Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (substr(_col17, 1, 5) <> substr(_col19, 1, 5)) (type: boolean)
                Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col10 (type: string), _col9 (type: int), _col11 (type: int), _col12 (type: string), _col7 (type: float)
                  outputColumnNames: _col10, _col9, _col11, _col12, _col7
                  Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col7)
                    keys: _col10 (type: string), _col9 (type: int), _col11 (type: int), _col12 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: string)
                      sort order: ++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: string)
                      Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col0 (type: string), _col2 (type: int), _col3 (type: string), _col4 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: double), _col1 (type: string), _col0 (type: int), _col2 (type: int), _col3 (type: string)
              sort order: -++++
              Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey2 (type: int), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_zip (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col6, _col7, _col9, _col10, _col11, _col12, _col17
                  Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col15 (type: int)
              sort order: +
              Map-reduce partition columns: _col15 (type: int)
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col6 (type: int), _col7 (type: float), _col9 (type: int), _col10 (type: string), _col11 (type: int), _col12 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_zip (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col15 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col6, _col7, _col9, _col10, _col11, _col12, _col17
          Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col6, _col7, _col9, _col10, _col11, _col12, _col15
                  Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col6 (type: int), _col7 (type: float), _col9 (type: int), _col10 (type: string), _col11 (type: int), _col12 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col6, _col7, _col9, _col10, _col11, _col12, _col15
          Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 80948 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 7) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string), i_manufact_id (type: int), i_manufact (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col6, _col7, _col9, _col10, _col11, _col12
                  Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col6 (type: int), _col7 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 80948 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 7) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string), i_manufact_id (type: int), i_manufact (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 40474 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col6, _col7, _col9, _col10, _col11, _col12
          Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 11) and (d_year = 1999) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: store_sales
            Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5, _col6, _col7
          Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query20.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage , consists of Stage-15, Stage-1
  Stage-15 has a backup stage: Stage-1
  Stage-11 depends on stages: Stage-15
  Stage-10 depends on stages: Stage-1, Stage-11 , consists of Stage-13, Stage-14, Stage-2
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-3 depends on stages: Stage-2, Stage-8, Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-14 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-14
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 42855 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
                outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
                Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
              sort order: +++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col3 (type: string), _col0 (type: string), _col1 (type: string), _col4 (type: float), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: string)
              sort order: +
              Map-reduce partition columns: _col3 (type: string)
              Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col3 (type: float), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: float, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col3 ASC NULLS FIRST
                  partition by: _col3
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col5
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col0 (type: string), _col5 (type: double), ((_col5 * 100.0) / sum_window_0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col0 (type: string), _col6 (type: double)
              sort order: +++++
              Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: float), KEY.reducesinkkey2 (type: string), VALUE._col1 (type: double), KEY.reducesinkkey4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 766613647 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
                    outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
                    Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
            outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
            Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 42855 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: float), _col4 (type: string), _col5 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query21.sql
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-15 depends on stages: Stage-20
  Stage-14 depends on stages: Stage-15 , consists of Stage-18, Stage-19, Stage-2
  Stage-18 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-18
  Stage-11 depends on stages: Stage-2, Stage-12, Stage-13 , consists of Stage-16, Stage-17, Stage-3
  Stage-16 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-16
  Stage-4 depends on stages: Stage-3, Stage-9, Stage-10
  Stage-5 depends on stages: Stage-4
  Stage-17 has a backup stage: Stage-3
  Stage-10 depends on stages: Stage-17
  Stage-3
  Stage-19 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-19
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_warehouse_sk is not null and inv_item_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col5
                  Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 161897 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col5, _col7
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-07' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col7, _col10
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col5 (type: string), _col7 (type: string), CASE WHEN ((CAST( _col10 AS DATE) < 1998-04-08)) THEN (_col3) ELSE (0) END (type: int), CASE WHEN ((CAST( _col10 AS DATE) >= 1998-04-08)) THEN (_col3) ELSE (0) END (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2), sum(_col3)
                  keys: _col0 (type: string), _col1 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint), _col3 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: CASE WHEN ((_col2 > 0)) THEN ((UDFToDouble(_col3) / UDFToDouble(_col2)) BETWEEN 0.6666666666666666 AND 1.5) ELSE (null) END (type: boolean)
            Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: bigint), _col3 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-07' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col7, _col10
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col5 (type: string), _col7 (type: string), CASE WHEN ((CAST( _col10 AS DATE) < 1998-04-08)) THEN (_col3) ELSE (0) END (type: int), CASE WHEN ((CAST( _col10 AS DATE) >= 1998-04-08)) THEN (_col3) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col5 (type: string), _col7 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-07' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col7, _col10
          Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col5 (type: string), _col7 (type: string), CASE WHEN ((CAST( _col10 AS DATE) < 1998-04-08)) THEN (_col3) ELSE (0) END (type: int), CASE WHEN ((CAST( _col10 AS DATE) >= 1998-04-08)) THEN (_col3) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2), sum(_col3)
              keys: _col0 (type: string), _col1 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 161897 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3, _col5, _col7
                  Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col3 (type: int), _col5 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 161897 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col3, _col5, _col7
          Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query22.sql
STAGE DEPENDENCIES:
  Stage-14 is a root stage , consists of Stage-18, Stage-1
  Stage-18 has a backup stage: Stage-1
  Stage-13 depends on stages: Stage-18
  Stage-12 depends on stages: Stage-1, Stage-13 , consists of Stage-16, Stage-17, Stage-2
  Stage-16 has a backup stage: Stage-2
  Stage-10 depends on stages: Stage-16
  Stage-15 depends on stages: Stage-2, Stage-10, Stage-11
  Stage-4 depends on stages: Stage-15
  Stage-5 depends on stages: Stage-4
  Stage-17 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-17
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-14
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_date_sk is not null and inv_item_sk is not null and inv_warehouse_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 206 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 206 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 206 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col7, _col8, _col9, _col10
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col3 (type: int)
                outputColumnNames: _col7, _col8, _col9, _col10, _col3
                Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col3)
                  keys: _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), 0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 484529490 Data size: 7752471965 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
                    sort order: +++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
                    Statistics: Num rows: 484529490 Data size: 7752471965 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col5 (type: struct<count:bigint,sum:double,input:int>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col5
          Statistics: Num rows: 242264745 Data size: 3876235982 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col3 (type: string), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 242264745 Data size: 3876235982 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: double), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: +++++
              Statistics: Num rows: 242264745 Data size: 3876235982 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 242264745 Data size: 3876235982 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10
                  Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10
          Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_date_sk is not null and inv_item_sk is not null and inv_warehouse_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query24.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-82 depends on stages: Stage-1
  Stage-52 depends on stages: Stage-82
  Stage-51 depends on stages: Stage-52 , consists of Stage-80, Stage-81, Stage-3
  Stage-80 has a backup stage: Stage-3
  Stage-49 depends on stages: Stage-80
  Stage-48 depends on stages: Stage-3, Stage-49, Stage-50 , consists of Stage-78, Stage-79, Stage-4
  Stage-78 has a backup stage: Stage-4
  Stage-46 depends on stages: Stage-78
  Stage-45 depends on stages: Stage-4, Stage-46, Stage-47 , consists of Stage-76, Stage-77, Stage-5
  Stage-76 has a backup stage: Stage-5
  Stage-43 depends on stages: Stage-76
  Stage-6 depends on stages: Stage-5, Stage-43, Stage-44
  Stage-42 depends on stages: Stage-6, Stage-20 , consists of Stage-74, Stage-75, Stage-7
  Stage-74 has a backup stage: Stage-7
  Stage-40 depends on stages: Stage-74
  Stage-39 depends on stages: Stage-7, Stage-32, Stage-40, Stage-41 , consists of Stage-73, Stage-8
  Stage-73 has a backup stage: Stage-8
  Stage-38 depends on stages: Stage-73
  Stage-8
  Stage-75 has a backup stage: Stage-7
  Stage-41 depends on stages: Stage-75
  Stage-7
  Stage-77 has a backup stage: Stage-5
  Stage-44 depends on stages: Stage-77
  Stage-5
  Stage-79 has a backup stage: Stage-4
  Stage-47 depends on stages: Stage-79
  Stage-4
  Stage-81 has a backup stage: Stage-3
  Stage-50 depends on stages: Stage-81
  Stage-3
  Stage-14 is a root stage
  Stage-89 depends on stages: Stage-14
  Stage-62 depends on stages: Stage-89
  Stage-61 depends on stages: Stage-62 , consists of Stage-87, Stage-88, Stage-16
  Stage-87 has a backup stage: Stage-16
  Stage-59 depends on stages: Stage-87
  Stage-58 depends on stages: Stage-16, Stage-59, Stage-60 , consists of Stage-85, Stage-86, Stage-17
  Stage-85 has a backup stage: Stage-17
  Stage-56 depends on stages: Stage-85
  Stage-55 depends on stages: Stage-17, Stage-56, Stage-57 , consists of Stage-83, Stage-84, Stage-18
  Stage-83 has a backup stage: Stage-18
  Stage-53 depends on stages: Stage-83
  Stage-19 depends on stages: Stage-18, Stage-53, Stage-54
  Stage-20 depends on stages: Stage-19
  Stage-84 has a backup stage: Stage-18
  Stage-54 depends on stages: Stage-84
  Stage-18
  Stage-86 has a backup stage: Stage-17
  Stage-57 depends on stages: Stage-86
  Stage-17
  Stage-88 has a backup stage: Stage-16
  Stage-60 depends on stages: Stage-88
  Stage-16
  Stage-26 is a root stage
  Stage-96 depends on stages: Stage-26
  Stage-72 depends on stages: Stage-96
  Stage-71 depends on stages: Stage-72 , consists of Stage-94, Stage-95, Stage-28
  Stage-94 has a backup stage: Stage-28
  Stage-69 depends on stages: Stage-94
  Stage-68 depends on stages: Stage-28, Stage-69, Stage-70 , consists of Stage-92, Stage-93, Stage-29
  Stage-92 has a backup stage: Stage-29
  Stage-66 depends on stages: Stage-92
  Stage-65 depends on stages: Stage-29, Stage-66, Stage-67 , consists of Stage-90, Stage-91, Stage-30
  Stage-90 has a backup stage: Stage-30
  Stage-63 depends on stages: Stage-90
  Stage-31 depends on stages: Stage-30, Stage-63, Stage-64
  Stage-32 depends on stages: Stage-31
  Stage-91 has a backup stage: Stage-30
  Stage-64 depends on stages: Stage-91
  Stage-30
  Stage-93 has a backup stage: Stage-29
  Stage-67 depends on stages: Stage-93
  Stage-29
  Stage-95 has a backup stage: Stage-28
  Stage-70 depends on stages: Stage-95
  Stage-28
  Stage-0 depends on stages: Stage-38, Stage-8

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 124 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-52
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col8, _col10, _col11
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-51
    Conditional Operator

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'orchid') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-48
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-45
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
                outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
                Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col5 (type: string), _col6 (type: string), _col7 (type: int), _col8 (type: string)
              sort order: +++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col9 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: int), KEY._col8 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col9 (type: double)
            outputColumnNames: _col0, _col6, _col7, _col9
            Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col9)
              keys: _col0 (type: string), _col6 (type: string), _col7 (type: string)
              mode: complete
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 337803847 Data size: 8107292344 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col2 (type: string), _col1 (type: string), _col0 (type: string), _col3 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337803847 Data size: 8107292344 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-39
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3, _col5
              Statistics: Num rows: 337803847 Data size: 41212069350 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col3 > _col5) (type: boolean)
                Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1, _col2, _col3, _col5
          Statistics: Num rows: 337803847 Data size: 41212069350 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col3 > _col5) (type: boolean)
            Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 337803847 Data size: 8107292344 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)
                  outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
                    outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
                    Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col4)
                      keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                      Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: string), _col21 (type: string)
              sort order: ++
              Map-reduce partition columns: _col11 (type: string), _col21 (type: string)
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), upper(_col2) (type: string)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: string), upper(_col2) (type: string)
                  Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: string), _col21 (type: string)
            1 _col1 (type: string), upper(_col2) (type: string)
          outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
          Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
            outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
            Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col4)
              keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'orchid') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'orchid') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: string), _col4 (type: string), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-89
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 124 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col8, _col10, _col11
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-61
    Conditional Operator

  Stage: Stage-87
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-58
    Conditional Operator

  Stage: Stage-85
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              mode: hash
              outputColumnNames: _col0
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (sq_count_check(_col0) <= 1) (type: boolean)
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-84
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)
                  outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
                  Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                    Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: string), _col21 (type: string)
              sort order: ++
              Map-reduce partition columns: _col11 (type: string), _col21 (type: string)
              Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), upper(_col2) (type: string)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: string), upper(_col2) (type: string)
                  Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: string), _col21 (type: string)
            1 _col1 (type: string), upper(_col2) (type: string)
          outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
          Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
            mode: hash
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
            Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-86
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-57
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-88
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col8 (type: string), _col10 (type: string), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-96
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_4:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 124 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-72
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col8, _col10, _col11
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-71
    Conditional Operator

  Stage: Stage-94
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_5:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_5:item 
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-69
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-68
    Conditional Operator

  Stage: Stage-92
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_6:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_6:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-66
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-65
    Conditional Operator

  Stage: Stage-90
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_7:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_7:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-63
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
                outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
                Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col10 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
          Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: double)
            outputColumnNames: _col10
            Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col10)
              mode: hash
              outputColumnNames: _col0
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: struct<count:bigint,sum:double,input:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: (0.05 * _col0) (type: double)
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)
                  outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
                    outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
                    Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col4)
                      keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: string), _col21 (type: string)
              sort order: ++
              Map-reduce partition columns: _col11 (type: string), _col21 (type: string)
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), upper(_col2) (type: string)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: string), upper(_col2) (type: string)
                  Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: string), _col21 (type: string)
            1 _col1 (type: string), upper(_col2) (type: string)
          outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
          Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
            outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
            Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col4)
              keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-93
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-67
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-95
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-70
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-82 depends on stages: Stage-1
  Stage-52 depends on stages: Stage-82
  Stage-51 depends on stages: Stage-52 , consists of Stage-80, Stage-81, Stage-3
  Stage-80 has a backup stage: Stage-3
  Stage-49 depends on stages: Stage-80
  Stage-48 depends on stages: Stage-3, Stage-49, Stage-50 , consists of Stage-78, Stage-79, Stage-4
  Stage-78 has a backup stage: Stage-4
  Stage-46 depends on stages: Stage-78
  Stage-45 depends on stages: Stage-4, Stage-46, Stage-47 , consists of Stage-76, Stage-77, Stage-5
  Stage-76 has a backup stage: Stage-5
  Stage-43 depends on stages: Stage-76
  Stage-6 depends on stages: Stage-5, Stage-43, Stage-44
  Stage-42 depends on stages: Stage-6, Stage-20 , consists of Stage-74, Stage-75, Stage-7
  Stage-74 has a backup stage: Stage-7
  Stage-40 depends on stages: Stage-74
  Stage-39 depends on stages: Stage-7, Stage-32, Stage-40, Stage-41 , consists of Stage-73, Stage-8
  Stage-73 has a backup stage: Stage-8
  Stage-38 depends on stages: Stage-73
  Stage-8
  Stage-75 has a backup stage: Stage-7
  Stage-41 depends on stages: Stage-75
  Stage-7
  Stage-77 has a backup stage: Stage-5
  Stage-44 depends on stages: Stage-77
  Stage-5
  Stage-79 has a backup stage: Stage-4
  Stage-47 depends on stages: Stage-79
  Stage-4
  Stage-81 has a backup stage: Stage-3
  Stage-50 depends on stages: Stage-81
  Stage-3
  Stage-14 is a root stage
  Stage-89 depends on stages: Stage-14
  Stage-62 depends on stages: Stage-89
  Stage-61 depends on stages: Stage-62 , consists of Stage-87, Stage-88, Stage-16
  Stage-87 has a backup stage: Stage-16
  Stage-59 depends on stages: Stage-87
  Stage-58 depends on stages: Stage-16, Stage-59, Stage-60 , consists of Stage-85, Stage-86, Stage-17
  Stage-85 has a backup stage: Stage-17
  Stage-56 depends on stages: Stage-85
  Stage-55 depends on stages: Stage-17, Stage-56, Stage-57 , consists of Stage-83, Stage-84, Stage-18
  Stage-83 has a backup stage: Stage-18
  Stage-53 depends on stages: Stage-83
  Stage-19 depends on stages: Stage-18, Stage-53, Stage-54
  Stage-20 depends on stages: Stage-19
  Stage-84 has a backup stage: Stage-18
  Stage-54 depends on stages: Stage-84
  Stage-18
  Stage-86 has a backup stage: Stage-17
  Stage-57 depends on stages: Stage-86
  Stage-17
  Stage-88 has a backup stage: Stage-16
  Stage-60 depends on stages: Stage-88
  Stage-16
  Stage-26 is a root stage
  Stage-96 depends on stages: Stage-26
  Stage-72 depends on stages: Stage-96
  Stage-71 depends on stages: Stage-72 , consists of Stage-94, Stage-95, Stage-28
  Stage-94 has a backup stage: Stage-28
  Stage-69 depends on stages: Stage-94
  Stage-68 depends on stages: Stage-28, Stage-69, Stage-70 , consists of Stage-92, Stage-93, Stage-29
  Stage-92 has a backup stage: Stage-29
  Stage-66 depends on stages: Stage-92
  Stage-65 depends on stages: Stage-29, Stage-66, Stage-67 , consists of Stage-90, Stage-91, Stage-30
  Stage-90 has a backup stage: Stage-30
  Stage-63 depends on stages: Stage-90
  Stage-31 depends on stages: Stage-30, Stage-63, Stage-64
  Stage-32 depends on stages: Stage-31
  Stage-91 has a backup stage: Stage-30
  Stage-64 depends on stages: Stage-91
  Stage-30
  Stage-93 has a backup stage: Stage-29
  Stage-67 depends on stages: Stage-93
  Stage-29
  Stage-95 has a backup stage: Stage-28
  Stage-70 depends on stages: Stage-95
  Stage-28
  Stage-0 depends on stages: Stage-38, Stage-8

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 124 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-52
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col8, _col10, _col11
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-51
    Conditional Operator

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'chiffon') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-48
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-45
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
                outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
                Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col5 (type: string), _col6 (type: string), _col7 (type: int), _col8 (type: string)
              sort order: +++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col9 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: int), KEY._col8 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col9 (type: double)
            outputColumnNames: _col0, _col6, _col7, _col9
            Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col9)
              keys: _col0 (type: string), _col6 (type: string), _col7 (type: string)
              mode: complete
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 337803847 Data size: 8107292344 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col2 (type: string), _col1 (type: string), _col0 (type: string), _col3 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337803847 Data size: 8107292344 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-39
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3, _col5
              Statistics: Num rows: 337803847 Data size: 41212069350 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col3 > _col5) (type: boolean)
                Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1, _col2, _col3, _col5
          Statistics: Num rows: 337803847 Data size: 41212069350 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col3 > _col5) (type: boolean)
            Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 112601282 Data size: 13737356409 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 337803847 Data size: 8107292344 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 337803847 Data size: 11147526967 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)
                  outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
                    outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
                    Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col4)
                      keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                      Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: string), _col21 (type: string)
              sort order: ++
              Map-reduce partition columns: _col11 (type: string), _col21 (type: string)
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), upper(_col2) (type: string)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: string), upper(_col2) (type: string)
                  Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: string), _col21 (type: string)
            1 _col1 (type: string), upper(_col2) (type: string)
          outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
          Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
            outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
            Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col4)
              keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'chiffon') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'chiffon') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 28020 Data size: 8742283 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: string), _col4 (type: string), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-89
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 124 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col8, _col10, _col11
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-61
    Conditional Operator

  Stage: Stage-87
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-58
    Conditional Operator

  Stage: Stage-85
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            Statistics: Num rows: 810729231 Data size: 16214584679 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              mode: hash
              outputColumnNames: _col0
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (sq_count_check(_col0) <= 1) (type: boolean)
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-84
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)
                  outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
                  Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                    Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: string), _col21 (type: string)
              sort order: ++
              Map-reduce partition columns: _col11 (type: string), _col21 (type: string)
              Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), upper(_col2) (type: string)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: string), upper(_col2) (type: string)
                  Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: string), _col21 (type: string)
            1 _col1 (type: string), upper(_col2) (type: string)
          outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
          Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
            mode: hash
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
            Statistics: Num rows: 1621458463 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-86
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-57
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 1474053117 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-88
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col8 (type: string), _col10 (type: string), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-96
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_4:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 124 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 62 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-72
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col8, _col10, _col11
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-71
    Conditional Operator

  Stage: Stage-94
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_5:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_5:item 
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-69
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-68
    Conditional Operator

  Stage: Stage-92
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_6:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_6:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-66
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-65
    Conditional Operator

  Stage: Stage-90
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_7:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_7:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-63
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
                outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
                Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col10 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
          Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: double)
            outputColumnNames: _col10
            Statistics: Num rows: 675607694 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col10)
              mode: hash
              outputColumnNames: _col0
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: struct<count:bigint,sum:double,input:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: (0.05 * _col0) (type: double)
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)
                  outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
                  Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
                    outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
                    Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col4)
                      keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: string), _col21 (type: string)
              sort order: ++
              Map-reduce partition columns: _col11 (type: string), _col21 (type: string)
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), upper(_col2) (type: string)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: string), upper(_col2) (type: string)
                  Statistics: Num rows: 141686 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: string), _col21 (type: string)
            1 _col1 (type: string), upper(_col2) (type: string)
          outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
          Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
            outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
            Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col4)
              keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
              Statistics: Num rows: 1351215388 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-93
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-67
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 337673 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-95
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-70
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 56041 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query25.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-32 depends on stages: Stage-1 , consists of Stage-42, Stage-43, Stage-2
  Stage-42 has a backup stage: Stage-2
  Stage-30 depends on stages: Stage-42
  Stage-29 depends on stages: Stage-2, Stage-30, Stage-31 , consists of Stage-40, Stage-41, Stage-3
  Stage-40 has a backup stage: Stage-3
  Stage-27 depends on stages: Stage-40
  Stage-26 depends on stages: Stage-3, Stage-27, Stage-28 , consists of Stage-38, Stage-39, Stage-4
  Stage-38 has a backup stage: Stage-4
  Stage-24 depends on stages: Stage-38
  Stage-23 depends on stages: Stage-4, Stage-24, Stage-25 , consists of Stage-36, Stage-37, Stage-5
  Stage-36 has a backup stage: Stage-5
  Stage-21 depends on stages: Stage-36
  Stage-35 depends on stages: Stage-5, Stage-21, Stage-22
  Stage-20 depends on stages: Stage-35
  Stage-19 depends on stages: Stage-20 , consists of Stage-33, Stage-34, Stage-7
  Stage-33 has a backup stage: Stage-7
  Stage-17 depends on stages: Stage-33
  Stage-8 depends on stages: Stage-7, Stage-17, Stage-18
  Stage-9 depends on stages: Stage-8
  Stage-34 has a backup stage: Stage-7
  Stage-18 depends on stages: Stage-34
  Stage-7
  Stage-37 has a backup stage: Stage-5
  Stage-22 depends on stages: Stage-37
  Stage-5
  Stage-39 has a backup stage: Stage-4
  Stage-25 depends on stages: Stage-39
  Stage-4
  Stage-41 has a backup stage: Stage-3
  Stage-28 depends on stages: Stage-41
  Stage-3
  Stage-43 has a backup stage: Stage-2
  Stage-31 depends on stages: Stage-43
  Stage-2
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int), _col5 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null and sr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: int), sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col4 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
            1 _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col8, _col10
          Statistics: Num rows: 791055611 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:catalog_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:catalog_sales 
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int), _col8 (type: int)
                    1 _col2 (type: int), _col1 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int), _col8 (type: int)
                1 _col2 (type: int), _col1 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 4) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col10, _col14
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_6:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col5, _col10, _col14, _col25, _col26
              Statistics: Num rows: 1530544245 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_7:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_7:item 
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col10, _col14, _col25, _col26, _col28, _col29
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string), _col5 (type: float), _col10 (type: float), _col14 (type: float)
                outputColumnNames: _col28, _col29, _col25, _col26, _col5, _col10, _col14
                Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col5), sum(_col10), sum(_col14)
                  keys: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col10, _col14, _col25, _col26, _col28, _col29
                  Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string), _col5 (type: float), _col10 (type: float), _col14 (type: float)
                    outputColumnNames: _col28, _col29, _col25, _col26, _col5, _col10, _col14
                    Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col5), sum(_col10), sum(_col14)
                      keys: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1530544245 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: float), _col10 (type: float), _col14 (type: float), _col25 (type: string), _col26 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col10, _col14, _col25, _col26, _col28, _col29
          Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string), _col5 (type: float), _col10 (type: float), _col14 (type: float)
            outputColumnNames: _col28, _col29, _col25, _col26, _col5, _col10, _col14
            Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col5), sum(_col10), sum(_col14)
              keys: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d3
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col10, _col14
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: int)
              sort order: +
              Map-reduce partition columns: _col11 (type: int)
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: float), _col10 (type: float), _col14 (type: float)
          TableScan
            alias: d3
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col10, _col14
          Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
                  Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int)
              sort order: +
              Map-reduce partition columns: _col6 (type: int)
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: float), _col10 (type: float), _col11 (type: int), _col14 (type: float)
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
          Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 4) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
                  Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: int), _col10 (type: float), _col11 (type: int), _col14 (type: float)
          TableScan
            alias: d1
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 4) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
          Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: int), _col8 (type: int)
                1 _col2 (type: int), _col1 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: int), _col8 (type: int)
                    1 _col2 (type: int), _col1 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
                  Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: int), _col8 (type: int)
              sort order: ++
              Map-reduce partition columns: _col7 (type: int), _col8 (type: int)
              Statistics: Num rows: 791055611 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: int), _col10 (type: float)
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int), _col1 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col2 (type: int), _col1 (type: int)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: int), _col8 (type: int)
            1 _col2 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query26.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-17 depends on stages: Stage-1 , consists of Stage-21, Stage-22, Stage-2
  Stage-21 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-21
  Stage-14 depends on stages: Stage-2, Stage-15, Stage-16 , consists of Stage-19, Stage-20, Stage-3
  Stage-19 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-19
  Stage-18 depends on stages: Stage-3, Stage-12, Stage-13
  Stage-5 depends on stages: Stage-18
  Stage-6 depends on stages: Stage-5
  Stage-20 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-20
  Stage-3
  Stage-22 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-22
  Stage-2
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_cdemo_sk is not null and cs_sold_date_sk is not null and cs_item_sk is not null and cs_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_cdemo_sk (type: int), cs_item_sk (type: int), cs_promo_sk (type: int), cs_quantity (type: int), cs_list_price (type: float), cs_sales_price (type: float), cs_coupon_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 265329 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'F') and (cd_marital_status = 'W') and (cd_education_status = 'Primary') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 522691112 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col15
              Statistics: Num rows: 632456272 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 318 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((p_channel_email = 'N') or (p_channel_event = 'N')) and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 318 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 318 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col7, _col15
              Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col15 (type: string), _col4 (type: int), _col5 (type: float), _col7 (type: float), _col6 (type: float)
                outputColumnNames: _col15, _col4, _col5, _col7, _col6
                Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col4), avg(_col5), avg(_col7), avg(_col6)
                  keys: _col15 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>), _col4 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 347850957 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 347850957 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 347850957 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col15
                  Statistics: Num rows: 632456272 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col15
          Statistics: Num rows: 632456272 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 522691112 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query27.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-17 depends on stages: Stage-1 , consists of Stage-21, Stage-22, Stage-2
  Stage-21 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-21
  Stage-20 depends on stages: Stage-2, Stage-15, Stage-16
  Stage-14 depends on stages: Stage-20
  Stage-13 depends on stages: Stage-14 , consists of Stage-18, Stage-19, Stage-4
  Stage-18 has a backup stage: Stage-4
  Stage-11 depends on stages: Stage-18
  Stage-5 depends on stages: Stage-4, Stage-11, Stage-12
  Stage-6 depends on stages: Stage-5
  Stage-19 has a backup stage: Stage-4
  Stage-12 depends on stages: Stage-19
  Stage-4
  Stage-22 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-22
  Stage-2
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_cdemo_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_cdemo_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_list_price (type: float), ss_sales_price (type: float), ss_coupon_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col2 (type: int)
                  Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 265329 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'F') and (cd_marital_status = 'D') and (cd_education_status = 'Unknown') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 692173659 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_state) IN ('KS', 'AL', 'MN', 'SC', 'VT') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col15
              Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col7, _col15, _col17
              Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col17 (type: string), _col15 (type: string), _col4 (type: int), _col5 (type: float), _col7 (type: float), _col6 (type: float)
                outputColumnNames: _col17, _col15, _col4, _col5, _col7, _col6
                Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col4), avg(_col5), avg(_col7), avg(_col6)
                  keys: _col17 (type: string), _col15 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: struct<count:bigint,sum:double,input:int>), _col3 (type: struct<count:bigint,sum:double,input:float>), _col4 (type: struct<count:bigint,sum:double,input:float>), _col5 (type: struct<count:bigint,sum:double,input:float>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 460641599 Data size: 14740531200 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 460641599 Data size: 14740531200 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 460641599 Data size: 14740531200 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5, _col6, _col7, _col15, _col17
                  Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col17 (type: string), _col15 (type: string), _col4 (type: int), _col5 (type: float), _col7 (type: float), _col6 (type: float)
                    outputColumnNames: _col17, _col15, _col4, _col5, _col7, _col6
                    Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: avg(_col4), avg(_col5), avg(_col7), avg(_col6)
                      keys: _col17 (type: string), _col15 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col15 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5, _col6, _col7, _col15, _col17
          Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col17 (type: string), _col15 (type: string), _col4 (type: int), _col5 (type: float), _col7 (type: float), _col6 (type: float)
            outputColumnNames: _col17, _col15, _col4, _col5, _col7, _col6
            Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col4), avg(_col5), avg(_col7), avg(_col6)
              keys: _col17 (type: string), _col15 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 692173659 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query28.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-14 depends on stages: Stage-1, Stage-3, Stage-4, Stage-5, Stage-6, Stage-7 , consists of Stage-15, Stage-16, Stage-17, Stage-18, Stage-19, Stage-20, Stage-2
  Stage-15 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-15
  Stage-16 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-16
  Stage-17 has a backup stage: Stage-2
  Stage-10 depends on stages: Stage-17
  Stage-18 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-18
  Stage-19 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-19
  Stage-20 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-20
  Stage-2
  Stage-3 is a root stage
  Stage-4 is a root stage
  Stage-5 is a root stage
  Stage-6 is a root stage
  Stage-7 is a root stage
  Stage-0 depends on stages: Stage-8, Stage-9, Stage-10, Stage-11, Stage-12, Stage-13, Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 0 AND 5 and (ss_list_price BETWEEN 11 AND 21 or ss_coupon_amt BETWEEN 460 AND 1460 or ss_wholesale_cost BETWEEN 14 AND 34)) (type: boolean)
              Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
               Inner Join 0 to 3
               Inner Join 0 to 4
               Inner Join 0 to 5
          keys:
            0 
            1 
            2 
            3 
            4 
            5 
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
            Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
            Limit
              Number of rows: 100
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 26 AND 30 and (ss_list_price BETWEEN 28 AND 38 or ss_coupon_amt BETWEEN 2513 AND 3513 or ss_wholesale_cost BETWEEN 42 AND 62)) (type: boolean)
              Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 21 AND 25 and (ss_list_price BETWEEN 135 AND 145 or ss_coupon_amt BETWEEN 14180 AND 15180 or ss_wholesale_cost BETWEEN 38 AND 58)) (type: boolean)
              Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 16 AND 20 and (ss_list_price BETWEEN 142 AND 152 or ss_coupon_amt BETWEEN 3054 AND 4054 or ss_wholesale_cost BETWEEN 80 AND 100)) (type: boolean)
              Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 11 AND 15 and (ss_list_price BETWEEN 66 AND 76 or ss_coupon_amt BETWEEN 920 AND 1920 or ss_wholesale_cost BETWEEN 4 AND 24)) (type: boolean)
              Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 6 AND 10 and (ss_list_price BETWEEN 91 AND 101 or ss_coupon_amt BETWEEN 1430 AND 2430 or ss_wholesale_cost BETWEEN 32 AND 52)) (type: boolean)
              Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 46611018 Data size: 745776288 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query29.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-32 depends on stages: Stage-1 , consists of Stage-42, Stage-43, Stage-2
  Stage-42 has a backup stage: Stage-2
  Stage-30 depends on stages: Stage-42
  Stage-29 depends on stages: Stage-2, Stage-30, Stage-31 , consists of Stage-40, Stage-41, Stage-3
  Stage-40 has a backup stage: Stage-3
  Stage-27 depends on stages: Stage-40
  Stage-26 depends on stages: Stage-3, Stage-27, Stage-28 , consists of Stage-38, Stage-39, Stage-4
  Stage-38 has a backup stage: Stage-4
  Stage-24 depends on stages: Stage-38
  Stage-23 depends on stages: Stage-4, Stage-24, Stage-25 , consists of Stage-36, Stage-37, Stage-5
  Stage-36 has a backup stage: Stage-5
  Stage-21 depends on stages: Stage-36
  Stage-35 depends on stages: Stage-5, Stage-21, Stage-22
  Stage-20 depends on stages: Stage-35
  Stage-19 depends on stages: Stage-20 , consists of Stage-33, Stage-34, Stage-7
  Stage-33 has a backup stage: Stage-7
  Stage-17 depends on stages: Stage-33
  Stage-8 depends on stages: Stage-7, Stage-17, Stage-18
  Stage-9 depends on stages: Stage-8
  Stage-34 has a backup stage: Stage-7
  Stage-18 depends on stages: Stage-34
  Stage-7
  Stage-37 has a backup stage: Stage-5
  Stage-22 depends on stages: Stage-37
  Stage-5
  Stage-39 has a backup stage: Stage-4
  Stage-25 depends on stages: Stage-39
  Stage-4
  Stage-41 has a backup stage: Stage-3
  Stage-28 depends on stages: Stage-41
  Stage-3
  Stage-43 has a backup stage: Stage-2
  Stage-31 depends on stages: Stage-43
  Stage-2
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int), _col5 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null and sr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: int), sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 71131578 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
            1 _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col8, _col10
          Statistics: Num rows: 791055611 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:catalog_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:catalog_sales 
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int), _col8 (type: int)
                    1 _col2 (type: int), _col1 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int), _col8 (type: int)
                1 _col2 (type: int), _col1 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 2 AND 5 and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000, 2001, 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col10, _col14
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_6:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col5, _col10, _col14, _col24, _col25
              Statistics: Num rows: 1530544245 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_7:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_7:item 
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col10, _col14, _col24, _col25, _col27, _col28
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string), _col5 (type: int), _col10 (type: int), _col14 (type: int)
                outputColumnNames: _col27, _col28, _col24, _col25, _col5, _col10, _col14
                Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col5), sum(_col10), sum(_col14)
                  keys: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 841799352 Data size: 13468789658 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col10, _col14, _col24, _col25, _col27, _col28
                  Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string), _col5 (type: int), _col10 (type: int), _col14 (type: int)
                    outputColumnNames: _col27, _col28, _col24, _col25, _col5, _col10, _col14
                    Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col5), sum(_col10), sum(_col14)
                      keys: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1530544245 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col10 (type: int), _col14 (type: int), _col24 (type: string), _col25 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col10, _col14, _col24, _col25, _col27, _col28
          Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string), _col5 (type: int), _col10 (type: int), _col14 (type: int)
            outputColumnNames: _col27, _col28, _col24, _col25, _col5, _col10, _col14
            Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col5), sum(_col10), sum(_col14)
              keys: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 1683598705 Data size: 26937579333 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000, 2001, 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col10, _col14
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col11 (type: int)
              sort order: +
              Map-reduce partition columns: _col11 (type: int)
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: int), _col10 (type: int), _col14 (type: int)
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000, 2001, 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644840 Data size: 5158723 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col11 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col10, _col14
          Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 2 AND 5 and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
                  Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int)
              sort order: +
              Map-reduce partition columns: _col6 (type: int)
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: int), _col10 (type: int), _col11 (type: int), _col14 (type: int)
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 2 AND 5 and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col10, _col11, _col14
          Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
                  Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: int), _col10 (type: int), _col11 (type: int), _col14 (type: int)
          TableScan
            alias: d1
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col6, _col10, _col11, _col14
          Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: int), _col8 (type: int)
                1 _col2 (type: int), _col1 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: int), _col8 (type: int)
                    1 _col2 (type: int), _col1 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
                  Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: int), _col8 (type: int)
              sort order: ++
              Map-reduce partition columns: _col7 (type: int), _col8 (type: int)
              Statistics: Num rows: 791055611 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int), _col1 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col2 (type: int), _col1 (type: int)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: int), _col8 (type: int)
            1 _col2 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col10, _col11, _col14
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query31.sql
STAGE DEPENDENCIES:
  Stage-47 is a root stage , consists of Stage-82, Stage-1
  Stage-82 has a backup stage: Stage-1
  Stage-46 depends on stages: Stage-82
  Stage-45 depends on stages: Stage-1, Stage-46 , consists of Stage-80, Stage-81, Stage-2
  Stage-80 has a backup stage: Stage-2
  Stage-43 depends on stages: Stage-80
  Stage-3 depends on stages: Stage-2, Stage-43, Stage-44
  Stage-42 depends on stages: Stage-3, Stage-11, Stage-16, Stage-21, Stage-26 , consists of Stage-75, Stage-76, Stage-77, Stage-78, Stage-79, Stage-4
  Stage-75 has a backup stage: Stage-4
  Stage-37 depends on stages: Stage-75
  Stage-36 depends on stages: Stage-4, Stage-31, Stage-37, Stage-38, Stage-39, Stage-40, Stage-41 , consists of Stage-73, Stage-74, Stage-5
  Stage-73 has a backup stage: Stage-5
  Stage-34 depends on stages: Stage-73
  Stage-6 depends on stages: Stage-5, Stage-34, Stage-35
  Stage-74 has a backup stage: Stage-5
  Stage-35 depends on stages: Stage-74
  Stage-5
  Stage-76 has a backup stage: Stage-4
  Stage-38 depends on stages: Stage-76
  Stage-77 has a backup stage: Stage-4
  Stage-39 depends on stages: Stage-77
  Stage-78 has a backup stage: Stage-4
  Stage-40 depends on stages: Stage-78
  Stage-79 has a backup stage: Stage-4
  Stage-41 depends on stages: Stage-79
  Stage-4
  Stage-81 has a backup stage: Stage-2
  Stage-44 depends on stages: Stage-81
  Stage-2
  Stage-1
  Stage-52 is a root stage , consists of Stage-85, Stage-9
  Stage-85 has a backup stage: Stage-9
  Stage-51 depends on stages: Stage-85
  Stage-50 depends on stages: Stage-9, Stage-51 , consists of Stage-83, Stage-84, Stage-10
  Stage-83 has a backup stage: Stage-10
  Stage-48 depends on stages: Stage-83
  Stage-11 depends on stages: Stage-10, Stage-48, Stage-49
  Stage-84 has a backup stage: Stage-10
  Stage-49 depends on stages: Stage-84
  Stage-10
  Stage-9
  Stage-57 is a root stage , consists of Stage-88, Stage-14
  Stage-88 has a backup stage: Stage-14
  Stage-56 depends on stages: Stage-88
  Stage-55 depends on stages: Stage-14, Stage-56 , consists of Stage-86, Stage-87, Stage-15
  Stage-86 has a backup stage: Stage-15
  Stage-53 depends on stages: Stage-86
  Stage-16 depends on stages: Stage-15, Stage-53, Stage-54
  Stage-87 has a backup stage: Stage-15
  Stage-54 depends on stages: Stage-87
  Stage-15
  Stage-14
  Stage-62 is a root stage , consists of Stage-91, Stage-19
  Stage-91 has a backup stage: Stage-19
  Stage-61 depends on stages: Stage-91
  Stage-60 depends on stages: Stage-19, Stage-61 , consists of Stage-89, Stage-90, Stage-20
  Stage-89 has a backup stage: Stage-20
  Stage-58 depends on stages: Stage-89
  Stage-21 depends on stages: Stage-20, Stage-58, Stage-59
  Stage-90 has a backup stage: Stage-20
  Stage-59 depends on stages: Stage-90
  Stage-20
  Stage-19
  Stage-67 is a root stage , consists of Stage-94, Stage-24
  Stage-94 has a backup stage: Stage-24
  Stage-66 depends on stages: Stage-94
  Stage-65 depends on stages: Stage-24, Stage-66 , consists of Stage-92, Stage-93, Stage-25
  Stage-92 has a backup stage: Stage-25
  Stage-63 depends on stages: Stage-92
  Stage-26 depends on stages: Stage-25, Stage-63, Stage-64
  Stage-93 has a backup stage: Stage-25
  Stage-64 depends on stages: Stage-93
  Stage-25
  Stage-24
  Stage-72 is a root stage , consists of Stage-97, Stage-29
  Stage-97 has a backup stage: Stage-29
  Stage-71 depends on stages: Stage-97
  Stage-70 depends on stages: Stage-29, Stage-71 , consists of Stage-95, Stage-96, Stage-30
  Stage-95 has a backup stage: Stage-30
  Stage-68 depends on stages: Stage-95
  Stage-31 depends on stages: Stage-30, Stage-68, Stage-69
  Stage-96 has a backup stage: Stage-30
  Stage-69 depends on stages: Stage-96
  Stage-30
  Stage-29
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-47
    Conditional Operator

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 1) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-45
    Conditional Operator

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 4466827538 Data size: 53601930509 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col7, _col9, _col11
              Statistics: Num rows: 2456755199 Data size: 29481062418 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col3 > 0.0)) THEN (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > (_col5 / _col3))) ELSE ((null > (_col5 / _col3))) END) ELSE (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), (_col9 / _col7) (type: double), (_col3 / _col1) (type: double), (_col11 / _col9) (type: double), (_col5 / _col3) (type: double)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: double)
              sort order: +
              Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), 1998 (type: int), KEY.reducesinkkey0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col7, _col9, _col11
              Statistics: Num rows: 2456755199 Data size: 29481062418 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col3 > 0.0)) THEN (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > (_col5 / _col3))) ELSE ((null > (_col5 / _col3))) END) ELSE (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), (_col9 / _col7) (type: double), (_col3 / _col1) (type: double), (_col11 / _col9) (type: double), (_col5 / _col3) (type: double)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: double), _col3 (type: double), _col5 (type: double), _col7 (type: double), _col9 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5, _col7, _col9, _col11
          Statistics: Num rows: 2456755199 Data size: 29481062418 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: CASE WHEN ((_col3 > 0.0)) THEN (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > (_col5 / _col3))) ELSE ((null > (_col5 / _col3))) END) ELSE (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > null)) ELSE (null) END) END (type: boolean)
            Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), (_col9 / _col7) (type: double), (_col3 / _col1) (type: double), (_col11 / _col9) (type: double), (_col5 / _col3) (type: double)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5
              Statistics: Num rows: 1228377599 Data size: 14740531203 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 4466827538 Data size: 53601930509 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 4466827538 Data size: 53601930509 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 4466827538 Data size: 53601930509 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 4466827538 Data size: 53601930509 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
               Inner Join 0 to 3
               Inner Join 3 to 4
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
            2 _col0 (type: string)
            3 _col0 (type: string)
            4 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
          Statistics: Num rows: 4466827538 Data size: 53601930509 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
            Statistics: Num rows: 2233413769 Data size: 26800965254 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 1) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-52
    Conditional Operator

  Stage: Stage-85
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-50
    Conditional Operator

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_3:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_3:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-84
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-57
    Conditional Operator

  Stage: Stage-88
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 3) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-86
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-87
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 3) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-62
    Conditional Operator

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 1) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-61
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-60
    Conditional Operator

  Stage: Stage-89
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-90
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 1) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-67
    Conditional Operator

  Stage: Stage-94
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:$hdt$_5:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:$hdt$_5:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-66
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-65
    Conditional Operator

  Stage: Stage-92
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:$hdt$_6:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:$hdt$_6:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-63
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-93
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-72
    Conditional Operator

  Stage: Stage-97
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 3) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-71
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-70
    Conditional Operator

  Stage: Stage-95
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-68
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col7
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col7, _col2
                Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 383527475 Data size: 4602329708 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-96
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-69
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col7
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col2 (type: float)
                    outputColumnNames: _col7, _col2
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col7 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col7
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col7, _col2
            Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 3) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query32.sql
STAGE DEPENDENCIES:
  Stage-14 is a root stage , consists of Stage-20, Stage-1
  Stage-20 has a backup stage: Stage-1
  Stage-13 depends on stages: Stage-20
  Stage-12 depends on stages: Stage-1, Stage-7, Stage-13 , consists of Stage-17, Stage-18, Stage-19, Stage-2
  Stage-17 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-17
  Stage-3 depends on stages: Stage-2, Stage-9, Stage-10, Stage-11
  Stage-18 has a backup stage: Stage-2
  Stage-10 depends on stages: Stage-18
  Stage-19 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-19
  Stage-2
  Stage-1
  Stage-16 is a root stage , consists of Stage-21, Stage-6
  Stage-21 has a backup stage: Stage-6
  Stage-15 depends on stages: Stage-21
  Stage-7 depends on stages: Stage-6, Stage-15
  Stage-6
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-14
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:d 
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2000-01-27' AND '2000-04-27' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_discount_amt (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col2 (type: float)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_1:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col1, _col5
              Statistics: Num rows: 3066454589 Data size: 36797455091 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
                Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: float)
                  outputColumnNames: _col1
                  Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col1)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 1 to 2
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col1, _col5
                  Statistics: Num rows: 3066454589 Data size: 36797455091 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
                    Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col1 (type: float)
                      outputColumnNames: _col1
                      Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col1, _col5
              Statistics: Num rows: 3066454589 Data size: 36797455091 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
                Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: float)
                  outputColumnNames: _col1
                  Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col1)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: float)
          TableScan
            alias: i
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1092805 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col1, _col5
          Statistics: Num rows: 3066454589 Data size: 36797455091 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
            Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: float)
              outputColumnNames: _col1
              Statistics: Num rows: 1022151529 Data size: 12265818355 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_discount_amt (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2000-01-27' AND '2000-04-27' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col2 (type: float)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:d 
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2000-01-27' AND '2000-04-27' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_discount_amt (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: avg(_col2)
                    keys: _col1 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), (1.3 * _col1) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_discount_amt (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2000-01-27' AND '2000-04-27' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: avg(_col2)
            keys: _col1 (type: int)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query34.sql
STAGE DEPENDENCIES:
  Stage-17 is a root stage , consists of Stage-21, Stage-1
  Stage-21 has a backup stage: Stage-1
  Stage-16 depends on stages: Stage-21
  Stage-20 depends on stages: Stage-1, Stage-16
  Stage-4 depends on stages: Stage-20
  Stage-13 depends on stages: Stage-4 , consists of Stage-18, Stage-19, Stage-5
  Stage-18 has a backup stage: Stage-5
  Stage-11 depends on stages: Stage-18
  Stage-6 depends on stages: Stage-5, Stage-11, Stage-12
  Stage-19 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-19
  Stage-5
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and (d_dom BETWEEN 1 AND 3 or d_dom BETWEEN 25 AND 28) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 95530 Data size: 1146360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 95530 Data size: 1146360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4
                  Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_county) IN ('Kittitas County', 'Adams County', 'Richland County', 'Furnas County', 'Orange County', 'Appanoose County', 'Franklin Parish', 'Tehama County') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 1354 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_buy_potential = '1001-5000') or (hd_buy_potential = '5001-10000')) and (hd_vehicle_count > 0) and CASE WHEN ((hd_vehicle_count > 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) > 1.2)) ELSE (null) END and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 225 Data size: 25200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 225 Data size: 25200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col4
                Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count()
                  keys: _col1 (type: int), _col4 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: bigint)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                    Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col2 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 558353442 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col0 (type: int), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 558353442 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: _col2 BETWEEN 15 AND 20 (type: boolean)
              Statistics: Num rows: 62039271 Data size: 1488942506 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
              Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: +++-
              Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: bigint), _col5 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 62039271 Data size: 1488942506 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: bigint)
          TableScan
            alias: customer
            Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
          Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and (d_dom BETWEEN 1 AND 3 or d_dom BETWEEN 25 AND 28) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 95530 Data size: 1146360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 95530 Data size: 1146360 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 95530 Data size: 1146360 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query39.sql
STAGE DEPENDENCIES:
  Stage-25 is a root stage , consists of Stage-37, Stage-1
  Stage-37 has a backup stage: Stage-1
  Stage-24 depends on stages: Stage-37
  Stage-36 depends on stages: Stage-1, Stage-24
  Stage-23 depends on stages: Stage-36
  Stage-22 depends on stages: Stage-23 , consists of Stage-34, Stage-35, Stage-3
  Stage-34 has a backup stage: Stage-3
  Stage-20 depends on stages: Stage-34
  Stage-4 depends on stages: Stage-3, Stage-20, Stage-21
  Stage-19 depends on stages: Stage-4, Stage-13 , consists of Stage-32, Stage-33, Stage-5
  Stage-32 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-32
  Stage-6 depends on stages: Stage-5, Stage-17, Stage-18
  Stage-33 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-33
  Stage-5
  Stage-35 has a backup stage: Stage-3
  Stage-21 depends on stages: Stage-35
  Stage-3
  Stage-1
  Stage-31 is a root stage , consists of Stage-41, Stage-10
  Stage-41 has a backup stage: Stage-10
  Stage-30 depends on stages: Stage-41
  Stage-40 depends on stages: Stage-10, Stage-30
  Stage-29 depends on stages: Stage-40
  Stage-28 depends on stages: Stage-29 , consists of Stage-38, Stage-39, Stage-12
  Stage-38 has a backup stage: Stage-12
  Stage-26 depends on stages: Stage-38
  Stage-13 depends on stages: Stage-12, Stage-26, Stage-27
  Stage-39 has a backup stage: Stage-12
  Stage-27 depends on stages: Stage-39
  Stage-12
  Stage-10
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-25
    Conditional Operator

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4
                  Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col5, _col6
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                outputColumnNames: _col5, _col4, _col6, _col3
                Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: stddev_samp(_col3), avg(_col3)
                  keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: struct<count:bigint,sum:double,variance:double>), _col4 (type: struct<count:bigint,sum:double,input:int>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: stddev_samp(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col1, _col2, _col3, _col4
            Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: CASE WHEN ((_col4 = 0.0)) THEN (false) ELSE (((_col3 / _col4) > 1.0)) END (type: boolean)
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col4 (type: double), CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE ((_col3 / _col4)) END (type: double)
                outputColumnNames: _col1, _col2, _col3, _col4
                Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
              Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
                Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double), _col8 (type: double), _col9 (type: double)
              sort order: ++++++
              Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col6 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), 3 (type: int), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), VALUE._col0 (type: int), VALUE._col1 (type: int), 4 (type: int), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
              Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
                Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: int)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: int)
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: int)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: int)
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int)
            1 _col1 (type: int), _col2 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
          Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
            outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
            Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                    outputColumnNames: _col5, _col4, _col6, _col3
                    Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: stddev_samp(_col3), avg(_col3)
                      keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6
          Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
            outputColumnNames: _col5, _col4, _col6, _col3
            Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: stddev_samp(_col3), avg(_col3)
              keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4
          Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Conditional Operator

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4
                  Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_3:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_3:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col5, _col6
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                outputColumnNames: _col5, _col4, _col6, _col3
                Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: stddev_samp(_col3), avg(_col3)
                  keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: struct<count:bigint,sum:double,variance:double>), _col4 (type: struct<count:bigint,sum:double,input:int>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: stddev_samp(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col1, _col2, _col3, _col4
            Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: CASE WHEN ((_col4 = 0.0)) THEN (false) ELSE (((_col3 / _col4) > 1.0)) END (type: boolean)
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col4 (type: double), CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE ((_col3 / _col4)) END (type: double)
                outputColumnNames: _col1, _col2, _col3, _col4
                Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                    outputColumnNames: _col5, _col4, _col6, _col3
                    Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: stddev_samp(_col3), avg(_col3)
                      keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6
          Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
            outputColumnNames: _col5, _col4, _col6, _col3
            Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: stddev_samp(_col3), avg(_col3)
              keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4
          Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

STAGE DEPENDENCIES:
  Stage-25 is a root stage , consists of Stage-37, Stage-1
  Stage-37 has a backup stage: Stage-1
  Stage-24 depends on stages: Stage-37
  Stage-36 depends on stages: Stage-1, Stage-24
  Stage-23 depends on stages: Stage-36
  Stage-22 depends on stages: Stage-23 , consists of Stage-34, Stage-35, Stage-3
  Stage-34 has a backup stage: Stage-3
  Stage-20 depends on stages: Stage-34
  Stage-4 depends on stages: Stage-3, Stage-20, Stage-21
  Stage-19 depends on stages: Stage-4, Stage-13 , consists of Stage-32, Stage-33, Stage-5
  Stage-32 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-32
  Stage-6 depends on stages: Stage-5, Stage-17, Stage-18
  Stage-33 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-33
  Stage-5
  Stage-35 has a backup stage: Stage-3
  Stage-21 depends on stages: Stage-35
  Stage-3
  Stage-1
  Stage-31 is a root stage , consists of Stage-41, Stage-10
  Stage-41 has a backup stage: Stage-10
  Stage-30 depends on stages: Stage-41
  Stage-40 depends on stages: Stage-10, Stage-30
  Stage-29 depends on stages: Stage-40
  Stage-28 depends on stages: Stage-29 , consists of Stage-38, Stage-39, Stage-12
  Stage-38 has a backup stage: Stage-12
  Stage-26 depends on stages: Stage-38
  Stage-13 depends on stages: Stage-12, Stage-26, Stage-27
  Stage-39 has a backup stage: Stage-12
  Stage-27 depends on stages: Stage-39
  Stage-12
  Stage-10
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-25
    Conditional Operator

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4
                  Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col5, _col6
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                outputColumnNames: _col5, _col4, _col6, _col3
                Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: stddev_samp(_col3), avg(_col3)
                  keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: struct<count:bigint,sum:double,variance:double>), _col4 (type: struct<count:bigint,sum:double,input:int>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: stddev_samp(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col1, _col2, _col3, _col4
            Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (CASE WHEN ((_col4 = 0.0)) THEN (false) ELSE (((_col3 / _col4) > 1.0)) END and CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE (((_col3 / _col4) > 1.5)) END) (type: boolean)
              Statistics: Num rows: 12113237 Data size: 193811794 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col4 (type: double), CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE ((_col3 / _col4)) END (type: double)
                outputColumnNames: _col1, _col2, _col3, _col4
                Statistics: Num rows: 12113237 Data size: 193811794 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
              Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
                Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double), _col8 (type: double), _col9 (type: double)
              sort order: ++++++
              Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col6 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), 3 (type: int), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), VALUE._col0 (type: int), VALUE._col1 (type: int), 4 (type: int), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
              Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
                Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: int)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: int)
              Statistics: Num rows: 12113237 Data size: 193811794 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: int)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: int)
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int)
            1 _col1 (type: int), _col2 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
          Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
            outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
            Statistics: Num rows: 26649121 Data size: 426385957 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                    outputColumnNames: _col5, _col4, _col6, _col3
                    Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: stddev_samp(_col3), avg(_col3)
                      keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6
          Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
            outputColumnNames: _col5, _col4, _col6, _col3
            Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: stddev_samp(_col3), avg(_col3)
              keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4
          Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Conditional Operator

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4
                  Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_3:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_3:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col5, _col6
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                outputColumnNames: _col5, _col4, _col6, _col3
                Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: stddev_samp(_col3), avg(_col3)
                  keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: struct<count:bigint,sum:double,variance:double>), _col4 (type: struct<count:bigint,sum:double,input:int>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: stddev_samp(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col1, _col2, _col3, _col4
            Statistics: Num rows: 48452949 Data size: 775247196 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: CASE WHEN ((_col4 = 0.0)) THEN (false) ELSE (((_col3 / _col4) > 1.0)) END (type: boolean)
              Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col4 (type: double), CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE ((_col3 / _col4)) END (type: double)
                outputColumnNames: _col1, _col2, _col3, _col4
                Statistics: Num rows: 24226474 Data size: 387623589 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6
                  Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
                    outputColumnNames: _col5, _col4, _col6, _col3
                    Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: stddev_samp(_col3), avg(_col3)
                      keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 88096269 Data size: 1409540327 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6
          Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col3 (type: int)
            outputColumnNames: _col5, _col4, _col6, _col3
            Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: stddev_samp(_col3), avg(_col3)
              keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 96905898 Data size: 1550494393 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4371220 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4
          Statistics: Num rows: 80087516 Data size: 1281400270 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query3.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-14
  Stage-9 depends on stages: Stage-1, Stage-10 , consists of Stage-12, Stage-13, Stage-2
  Stage-12 has a backup stage: Stage-2
  Stage-7 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:dt 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:dt 
          TableScan
            alias: dt
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col5, _col7, _col8
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col7 (type: int), _col8 (type: string), _col5 (type: float)
                outputColumnNames: _col1, _col7, _col8, _col5
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col5)
                  keys: _col1 (type: int), _col7 (type: int), _col8 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col3 (type: double), _col1 (type: int)
              sort order: +-+
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col5, _col7, _col8
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col7 (type: int), _col8 (type: string), _col5 (type: float)
                    outputColumnNames: _col1, _col7, _col8, _col5
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col5)
                      keys: _col1 (type: int), _col7 (type: int), _col8 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col5 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col5, _col7, _col8
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col7 (type: int), _col8 (type: string), _col5 (type: float)
            outputColumnNames: _col1, _col7, _col8, _col5
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col5)
              keys: _col1 (type: int), _col7 (type: int), _col8 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: dt
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query40.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-22 depends on stages: Stage-1
  Stage-17 depends on stages: Stage-22
  Stage-16 depends on stages: Stage-17 , consists of Stage-20, Stage-21, Stage-3
  Stage-20 has a backup stage: Stage-3
  Stage-14 depends on stages: Stage-20
  Stage-13 depends on stages: Stage-3, Stage-14, Stage-15 , consists of Stage-18, Stage-19, Stage-4
  Stage-18 has a backup stage: Stage-4
  Stage-11 depends on stages: Stage-18
  Stage-5 depends on stages: Stage-4, Stage-11, Stage-12
  Stage-6 depends on stages: Stage-5
  Stage-19 has a backup stage: Stage-4
  Stage-12 depends on stages: Stage-19
  Stage-4
  Stage-21 has a backup stage: Stage-3
  Stage-15 depends on stages: Stage-21
  Stage-3
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_warehouse_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col2 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col4 (type: float)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_refunded_cash (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col2 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col7
          Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col7, _col9
              Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 161897 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col7, _col9, _col11
              Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-08' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col7, _col9, _col11, _col14
              Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col9 (type: string), _col11 (type: string), CASE WHEN ((CAST( _col14 AS DATE) < 1998-04-08)) THEN ((_col4 - COALESCE(_col7,0))) ELSE (0) END (type: float), CASE WHEN ((CAST( _col14 AS DATE) >= 1998-04-08)) THEN ((_col4 - COALESCE(_col7,0))) ELSE (0) END (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2), sum(_col3)
                  keys: _col0 (type: string), _col1 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 463801275 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 463801275 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 463801275 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-08' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col7, _col9, _col11, _col14
                  Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col9 (type: string), _col11 (type: string), CASE WHEN ((CAST( _col14 AS DATE) < 1998-04-08)) THEN ((_col4 - COALESCE(_col7,0))) ELSE (0) END (type: float), CASE WHEN ((CAST( _col14 AS DATE) >= 1998-04-08)) THEN ((_col4 - COALESCE(_col7,0))) ELSE (0) END (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col7 (type: float), _col9 (type: string), _col11 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-08' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col7, _col9, _col11, _col14
          Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col9 (type: string), _col11 (type: string), CASE WHEN ((CAST( _col14 AS DATE) < 1998-04-08)) THEN ((_col4 - COALESCE(_col7,0))) ELSE (0) END (type: float), CASE WHEN ((CAST( _col14 AS DATE) >= 1998-04-08)) THEN ((_col4 - COALESCE(_col7,0))) ELSE (0) END (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2), sum(_col3)
              keys: _col0 (type: string), _col1 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 927602550 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 161897 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col4, _col7, _col9, _col11
                  Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col4 (type: float), _col7 (type: float), _col9 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 161897 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 17988 Data size: 1942704 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col4, _col7, _col9, _col11
          Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query42.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-14
  Stage-9 depends on stages: Stage-1, Stage-10 , consists of Stage-12, Stage-13, Stage-2
  Stage-12 has a backup stage: Stage-2
  Stage-7 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:dt 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:dt 
          TableScan
            alias: dt
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category_id (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col7, _col8
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
                outputColumnNames: _col7, _col8, _col5
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col5)
                  keys: _col7 (type: int), _col8 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: string), _col2 (type: double)
            outputColumnNames: _col1, _col2, _col3
            Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: double), _col1 (type: int), _col2 (type: string)
              sort order: -++
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: 1998 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category_id (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col7, _col8
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
                    outputColumnNames: _col7, _col8, _col5
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col5)
                      keys: _col7 (type: int), _col8 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category_id (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col7, _col8
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
            outputColumnNames: _col7, _col8, _col5
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col5)
              keys: _col7 (type: int), _col8 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: dt
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query43.sql
STAGE DEPENDENCIES:
  Stage-9 is a root stage , consists of Stage-11, Stage-1
  Stage-11 has a backup stage: Stage-1
  Stage-8 depends on stages: Stage-11
  Stage-10 depends on stages: Stage-1, Stage-8
  Stage-3 depends on stages: Stage-10
  Stage-4 depends on stages: Stage-3
  Stage-1
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-9
    Conditional Operator

  Stage: Stage-11
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 5158664 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_day_name (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 47765 Data size: 5158664 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 184 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_gmt_offset = -6) and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 92 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 92 Data size: 19231 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col5, _col7, _col8
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), CASE WHEN ((_col2 = 'Sunday')) THEN (_col5) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Monday')) THEN (_col5) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Tuesday')) THEN (_col5) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Wednesday')) THEN (_col5) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Thursday')) THEN (_col5) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Friday')) THEN (_col5) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Saturday')) THEN (_col5) ELSE (null) END (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                  keys: _col0 (type: string), _col1 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double)
              sort order: +++++++++
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double), KEY.reducesinkkey6 (type: double), KEY.reducesinkkey7 (type: double), KEY.reducesinkkey8 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 5158664 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_day_name (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 47765 Data size: 5158664 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 47765 Data size: 5158664 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: string)
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col5
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query45.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-24 depends on stages: Stage-1 , consists of Stage-31, Stage-32, Stage-2
  Stage-31 has a backup stage: Stage-2
  Stage-22 depends on stages: Stage-31
  Stage-21 depends on stages: Stage-2, Stage-22, Stage-23 , consists of Stage-29, Stage-30, Stage-3
  Stage-29 has a backup stage: Stage-3
  Stage-19 depends on stages: Stage-29
  Stage-18 depends on stages: Stage-3, Stage-19, Stage-20 , consists of Stage-27, Stage-28, Stage-4
  Stage-27 has a backup stage: Stage-4
  Stage-16 depends on stages: Stage-27
  Stage-15 depends on stages: Stage-4, Stage-12, Stage-16, Stage-17 , consists of Stage-25, Stage-26, Stage-5
  Stage-25 has a backup stage: Stage-5
  Stage-13 depends on stages: Stage-25
  Stage-6 depends on stages: Stage-5, Stage-13, Stage-14
  Stage-7 depends on stages: Stage-6
  Stage-26 has a backup stage: Stage-5
  Stage-14 depends on stages: Stage-26
  Stage-5
  Stage-28 has a backup stage: Stage-4
  Stage-17 depends on stages: Stage-28
  Stage-4
  Stage-30 has a backup stage: Stage-3
  Stage-20 depends on stages: Stage-30
  Stage-3
  Stage-32 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-32
  Stage-2
  Stage-12 is a root stage
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_bill_customer_sk is not null and ws_sold_date_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_bill_customer_sk (type: int), ws_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col2 (type: int)
                  Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: float)
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col5
          Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col7, _col8
              Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col7, _col8
              Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col7, _col8, _col13
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Conditional Operator

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col7, _col8
              Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col3 (type: float)
                outputColumnNames: _col8, _col7, _col3
                Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col8 (type: string), _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 382856326 Data size: 6125701239 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 382856326 Data size: 6125701239 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 382856326 Data size: 6125701239 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col7, _col8
              Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col3 (type: float)
                outputColumnNames: _col8, _col7, _col3
                Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col8 (type: string), _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col13 (type: string)
              sort order: +
              Map-reduce partition columns: _col13 (type: string)
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 42031 Data size: 4371246 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col13 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col7, _col8
          Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col7 (type: string), _col3 (type: float)
            outputColumnNames: _col8, _col7, _col3
            Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col8 (type: string), _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 765712653 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col7, _col8, _col13
                  Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col7, _col8, _col13
          Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col7, _col8
                  Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col7, _col8
          Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col7, _col8
                  Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col7, _col8
          Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i2
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_item_sk) IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 84062 Data size: 8742492 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 84062 Data size: 8742492 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 84062 Data size: 8742492 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 84062 Data size: 8742492 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 42031 Data size: 4371246 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query46.sql
STAGE DEPENDENCIES:
  Stage-27 is a root stage , consists of Stage-35, Stage-1
  Stage-35 has a backup stage: Stage-1
  Stage-26 depends on stages: Stage-35
  Stage-34 depends on stages: Stage-1, Stage-26
  Stage-24 depends on stages: Stage-34
  Stage-23 depends on stages: Stage-24 , consists of Stage-32, Stage-33, Stage-4
  Stage-32 has a backup stage: Stage-4
  Stage-21 depends on stages: Stage-32
  Stage-5 depends on stages: Stage-4, Stage-21, Stage-22
  Stage-20 depends on stages: Stage-5 , consists of Stage-30, Stage-31, Stage-6
  Stage-30 has a backup stage: Stage-6
  Stage-18 depends on stages: Stage-30
  Stage-17 depends on stages: Stage-6, Stage-18, Stage-19 , consists of Stage-28, Stage-29, Stage-7
  Stage-28 has a backup stage: Stage-7
  Stage-15 depends on stages: Stage-28
  Stage-8 depends on stages: Stage-7, Stage-15, Stage-16
  Stage-29 has a backup stage: Stage-7
  Stage-16 depends on stages: Stage-29
  Stage-7
  Stage-31 has a backup stage: Stage-6
  Stage-19 depends on stages: Stage-31
  Stage-6
  Stage-33 has a backup stage: Stage-4
  Stage-22 depends on stages: Stage-33
  Stage-4
  Stage-1
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-27
    Conditional Operator

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_dow) IN (6, 0) and (d_year) IN (1998, 1999, 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214947 Data size: 2579365 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214947 Data size: 2579365 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_coupon_amt (type: float), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 615265475 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_city) IN ('Rosedale', 'Bethlehem', 'Clinton', 'Clifton', 'Springfield') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 4) or (hd_vehicle_count = 2)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 12636 Data size: 151640 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 12636 Data size: 151640 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7
              Statistics: Num rows: 676792037 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col3, _col5, _col6, _col7
                Statistics: Num rows: 744471256 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col17
              Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col17 (type: string), _col6 (type: float), _col7 (type: float)
                outputColumnNames: _col1, _col3, _col5, _col17, _col6, _col7
                Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col6), sum(_col7)
                  keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col17 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
              Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 409459199 Data size: 14740531198 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: bigint), _col0 (type: int), _col3 (type: string), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 409459199 Data size: 14740531198 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8
              Statistics: Num rows: 450405128 Data size: 16214584669 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:current_addr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:current_addr 
          TableScan
            alias: current_addr
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col7, _col8, _col10
              Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col10 <> _col2) (type: boolean)
                Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col8 (type: string), _col7 (type: string), _col10 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: bigint)
              sort order: +++++
              Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col5 (type: double), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: bigint), VALUE._col0 (type: double), VALUE._col1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: current_addr
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col7, _col8, _col10
                  Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (_col10 <> _col2) (type: boolean)
                    Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col8 (type: string), _col7 (type: string), _col10 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int)
              sort order: +
              Map-reduce partition columns: _col6 (type: int)
              Statistics: Num rows: 450405128 Data size: 16214584669 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double), _col7 (type: string), _col8 (type: string)
          TableScan
            alias: current_addr
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col7, _col8, _col10
          Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col10 <> _col2) (type: boolean)
            Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col8 (type: string), _col7 (type: string), _col10 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 495445651 Data size: 17836043522 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8
                  Statistics: Num rows: 450405128 Data size: 16214584669 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 409459199 Data size: 14740531198 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8
          Statistics: Num rows: 450405128 Data size: 16214584669 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col17
                  Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col17 (type: string), _col6 (type: float), _col7 (type: float)
                    outputColumnNames: _col1, _col3, _col5, _col17, _col6, _col7
                    Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col6), sum(_col7)
                      keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col17 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int)
              sort order: +
              Map-reduce partition columns: _col3 (type: int)
              Statistics: Num rows: 744471256 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col5 (type: bigint), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col17
          Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col17 (type: string), _col6 (type: float), _col7 (type: float)
            outputColumnNames: _col1, _col3, _col5, _col17, _col6, _col7
            Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col6), sum(_col7)
              keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col17 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 818918399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_coupon_amt (type: float), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: bigint), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_dow) IN (6, 0) and (d_year) IN (1998, 1999, 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214947 Data size: 2579365 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214947 Data size: 2579365 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214947 Data size: 2579365 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 615265475 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query48.sql
STAGE DEPENDENCIES:
  Stage-26 is a root stage
  Stage-19 depends on stages: Stage-26
  Stage-18 depends on stages: Stage-19 , consists of Stage-24, Stage-25, Stage-2
  Stage-24 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-24
  Stage-15 depends on stages: Stage-2, Stage-16, Stage-17 , consists of Stage-22, Stage-23, Stage-3
  Stage-22 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-22
  Stage-12 depends on stages: Stage-3, Stage-13, Stage-14 , consists of Stage-20, Stage-21, Stage-4
  Stage-20 has a backup stage: Stage-4
  Stage-10 depends on stages: Stage-20
  Stage-5 depends on stages: Stage-4, Stage-10, Stage-11
  Stage-21 has a backup stage: Stage-4
  Stage-11 depends on stages: Stage-21
  Stage-4
  Stage-23 has a backup stage: Stage-3
  Stage-14 depends on stages: Stage-23
  Stage-3
  Stage-25 has a backup stage: Stage-2
  Stage-17 depends on stages: Stage-25
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:store 
          TableScan
            alias: store
            Statistics: Num rows: 9615 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 9615 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9615 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_sales_price BETWEEN 100 AND 150 or ss_sales_price BETWEEN 50 AND 100 or ss_sales_price BETWEEN 150 AND 200) and (ss_net_profit BETWEEN 0 AND 2000 or ss_net_profit BETWEEN 150 AND 3000 or ss_net_profit BETWEEN 50 AND 25000) and ss_store_sk is not null and ss_cdemo_sk is not null and ss_addr_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 79904604 Data size: 2237328912 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_cdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6
                Statistics: Num rows: 79904604 Data size: 2237328912 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col6
                  Statistics: Num rows: 87895066 Data size: 2461061856 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and (cd_education_status = '4 yr Degree') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col6
              Statistics: Num rows: 96684574 Data size: 2707168100 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Conditional Operator

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col6, _col12
              Statistics: Num rows: 106353033 Data size: 2977884974 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (((_col12) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 0 AND 2000) or ((_col12) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 3000) or ((_col12) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 25000)) (type: boolean)
                Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col4 (type: int)
                  outputColumnNames: _col0, _col4
                  Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4
              Statistics: Num rows: 19498053 Data size: 545945513 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4
                  Statistics: Num rows: 19498053 Data size: 545945513 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col4)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4
          Statistics: Num rows: 19498053 Data size: 545945513 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: sum(_col4)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col4, _col6, _col12
                  Statistics: Num rows: 106353033 Data size: 2977884974 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((_col12) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 0 AND 2000) or ((_col12) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 3000) or ((_col12) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 25000)) (type: boolean)
                    Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col0 (type: int), _col4 (type: int)
                      outputColumnNames: _col0, _col4
                      Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 96684574 Data size: 2707168100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col4 (type: int), _col6 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col4, _col6, _col12
          Statistics: Num rows: 106353033 Data size: 2977884974 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (((_col12) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 0 AND 2000) or ((_col12) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 3000) or ((_col12) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 25000)) (type: boolean)
            Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col4 (type: int)
              outputColumnNames: _col0, _col4
              Statistics: Num rows: 17725503 Data size: 496314092 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and (cd_education_status = '4 yr Degree') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col6
                  Statistics: Num rows: 96684574 Data size: 2707168100 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 87895066 Data size: 2461061856 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: int), _col6 (type: float)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and (cd_education_status = '4 yr Degree') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 98848 Data size: 20165024 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col6
          Statistics: Num rows: 96684574 Data size: 2707168100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query49.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-25 depends on stages: Stage-1 , consists of Stage-32, Stage-33, Stage-2
  Stage-32 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-32
  Stage-3 depends on stages: Stage-2, Stage-23, Stage-24
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5, Stage-13, Stage-20
  Stage-33 has a backup stage: Stage-2
  Stage-24 depends on stages: Stage-33
  Stage-2
  Stage-9 is a root stage
  Stage-28 depends on stages: Stage-9 , consists of Stage-34, Stage-35, Stage-10
  Stage-34 has a backup stage: Stage-10
  Stage-26 depends on stages: Stage-34
  Stage-11 depends on stages: Stage-10, Stage-26, Stage-27
  Stage-12 depends on stages: Stage-11
  Stage-13 depends on stages: Stage-12
  Stage-35 has a backup stage: Stage-10
  Stage-27 depends on stages: Stage-35
  Stage-10
  Stage-16 is a root stage
  Stage-31 depends on stages: Stage-16 , consists of Stage-36, Stage-37, Stage-17
  Stage-36 has a backup stage: Stage-17
  Stage-29 depends on stages: Stage-36
  Stage-18 depends on stages: Stage-17, Stage-29, Stage-30
  Stage-19 depends on stages: Stage-18
  Stage-20 depends on stages: Stage-19
  Stage-37 has a backup stage: Stage-17
  Stage-30 depends on stages: Stage-37
  Stage-17
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ws_net_profit > 1) and (ws_net_paid > 0) and (ws_quantity > 0) and ws_order_number is not null and ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10062375 Data size: 281746500 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_net_paid (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 10062375 Data size: 281746500 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 10062375 Data size: 281746500 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: wr
            Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((wr_return_amt > 10000) and wr_item_sk is not null and wr_order_number is not null) (type: boolean)
              Statistics: Num rows: 8605084 Data size: 172101685 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 8605084 Data size: 172101685 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 8605084 Data size: 172101685 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col4, _col8, _col9
          Statistics: Num rows: 11068612 Data size: 309921156 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col8, _col9
              Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: bigint, _col2: bigint, _col3: double, _col4: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
              value expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: int, _col2: bigint, _col3: bigint, _col4: double, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_1
                        arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 6087736 Data size: 170456624 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)
              Statistics: Num rows: 4058490 Data size: 113637730 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'web' (type: string), _col1 (type: int), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 4058490 Data size: 113637730 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int)
                sort order: +++
                Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
                TopN Hash Memory Usage: 0.1
                value expressions: _col1 (type: int), _col2 (type: decimal(35,20))
          TableScan
            Union
              Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int)
                sort order: +++
                Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
                TopN Hash Memory Usage: 0.1
                value expressions: _col1 (type: int), _col2 (type: decimal(35,20))
          TableScan
            Union
              Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int)
                sort order: +++
                Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
                TopN Hash Memory Usage: 0.1
                value expressions: _col1 (type: int), _col2 (type: decimal(35,20))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: int), VALUE._col1 (type: decimal(35,20)), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 23646696 Data size: 570300363 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col8, _col9
                  Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 11068612 Data size: 309921156 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: float), _col8 (type: int), _col9 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col8, _col9
          Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 12175473 Data size: 340913278 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 543055689 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cs_net_profit > 1) and (cs_net_paid > 0) and (cs_quantity > 0) and cs_order_number is not null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 20113173 Data size: 563168844 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_net_paid (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 20113173 Data size: 563168844 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 20113173 Data size: 563168844 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: cr
            Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cr_return_amount > 10000) and cr_order_number is not null and cr_item_sk is not null) (type: boolean)
              Statistics: Num rows: 18487421 Data size: 369748423 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 18487421 Data size: 369748423 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 18487421 Data size: 369748423 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col4, _col8, _col9
          Statistics: Num rows: 22124490 Data size: 619485741 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-28
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col8, _col9
              Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: bigint, _col2: bigint, _col3: double, _col4: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
              value expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: int, _col2: bigint, _col3: bigint, _col4: double, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_1
                        arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 12168469 Data size: 340717150 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)
              Statistics: Num rows: 8112312 Data size: 227144747 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'catalog' (type: string), _col1 (type: int), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 8112312 Data size: 227144747 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col8, _col9
                  Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 22124490 Data size: 619485741 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: float), _col8 (type: int), _col9 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col8, _col9
          Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 24336939 Data size: 681434329 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: sts
            Statistics: Num rows: 719141449 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_net_profit > 1) and (ss_net_paid > 0) and (ss_quantity > 0) and ss_item_sk is not null and ss_ticket_number is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 26634868 Data size: 745776304 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_net_paid (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 26634868 Data size: 745776304 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 26634868 Data size: 745776304 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: sr
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((sr_return_amt > 10000) and sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 28452631 Data size: 569052622 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 28452631 Data size: 569052622 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 28452631 Data size: 569052622 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col4, _col8, _col9
          Statistics: Num rows: 31297894 Data size: 625957897 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col8, _col9
              Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: bigint, _col2: bigint, _col3: double, _col4: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
              value expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: int, _col2: bigint, _col3: bigint, _col4: double, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_1
                        arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 17213842 Data size: 344276850 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)
              Statistics: Num rows: 11475894 Data size: 229517886 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'store' (type: string), _col1 (type: int), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 11475894 Data size: 229517886 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col8, _col9
                  Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 31297894 Data size: 625957897 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: float), _col8 (type: int), _col9 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col8, _col9
          Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col3,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col4,0) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 34427684 Data size: 688553701 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query50.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-22 depends on stages: Stage-1
  Stage-17 depends on stages: Stage-22
  Stage-16 depends on stages: Stage-17 , consists of Stage-20, Stage-21, Stage-3
  Stage-20 has a backup stage: Stage-3
  Stage-14 depends on stages: Stage-20
  Stage-13 depends on stages: Stage-3, Stage-14, Stage-15 , consists of Stage-18, Stage-19, Stage-4
  Stage-18 has a backup stage: Stage-4
  Stage-11 depends on stages: Stage-18
  Stage-5 depends on stages: Stage-4, Stage-11, Stage-12
  Stage-6 depends on stages: Stage-5
  Stage-19 has a backup stage: Stage-4
  Stage-12 depends on stages: Stage-19
  Stage-4
  Stage-21 has a backup stage: Stage-3
  Stage-15 depends on stages: Stage-21
  Stage-3
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null and sr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: int), sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int), _col4 (type: bigint)
            1 _col1 (type: int), _col2 (type: int), _col3 (type: bigint)
          outputColumnNames: _col0, _col3, _col5
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 42 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 42 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_company_id (type: int), s_street_number (type: string), s_street_name (type: string), s_street_type (type: string), s_suite_number (type: string), s_city (type: string), s_county (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 42 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col11 (type: int), _col12 (type: string), _col13 (type: string), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: string), _col18 (type: string), _col19 (type: string), CASE WHEN (((_col5 - _col0) <= 30)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 30) and ((_col5 - _col0) <= 60))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 60) and ((_col5 - _col0) <= 90))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 90) and ((_col5 - _col0) <= 120))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col5 - _col0) > 120)) THEN (1) ELSE (0) END (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14)
                  keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                  Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
          Statistics: Num rows: 614188799 Data size: 14740531204 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Statistics: Num rows: 614188799 Data size: 14740531204 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey5 (type: string), KEY.reducesinkkey6 (type: string), KEY.reducesinkkey7 (type: string), KEY.reducesinkkey8 (type: string), KEY.reducesinkkey9 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
          Statistics: Num rows: 614188799 Data size: 14740531204 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: string), _col11 (type: int), _col12 (type: string), _col13 (type: string), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: string), _col18 (type: string), _col19 (type: string), CASE WHEN (((_col5 - _col0) <= 30)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 30) and ((_col5 - _col0) <= 60))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 60) and ((_col5 - _col0) <= 90))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 90) and ((_col5 - _col0) <= 120))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col5 - _col0) > 120)) THEN (1) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                    Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14)
                      keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                      Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col10 (type: string), _col11 (type: int), _col12 (type: string), _col13 (type: string), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: string), _col18 (type: string), _col19 (type: string)
          TableScan
            alias: d2
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col11 (type: int), _col12 (type: string), _col13 (type: string), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: string), _col18 (type: string), _col19 (type: string), CASE WHEN (((_col5 - _col0) <= 30)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 30) and ((_col5 - _col0) <= 60))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 60) and ((_col5 - _col0) <= 90))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col5 - _col0) > 90) and ((_col5 - _col0) <= 120))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col5 - _col0) > 120)) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
            Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14)
              keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
              Statistics: Num rows: 1228377599 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col10 (type: string), _col11 (type: int), _col12 (type: string), _col13 (type: string), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: string), _col18 (type: string), _col19 (type: string)
          TableScan
            alias: d1
            Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2579359 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col5, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query51.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-14
  Stage-2 depends on stages: Stage-1, Stage-10
  Stage-3 depends on stages: Stage-2, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-1
  Stage-13 is a root stage , consists of Stage-15, Stage-7
  Stage-15 has a backup stage: Stage-7
  Stage-12 depends on stages: Stage-15
  Stage-8 depends on stages: Stage-7, Stage-12
  Stage-7
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col4 (type: string), _col2 (type: float)
                    outputColumnNames: _col1, _col4, _col2
                    Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col1 (type: int), _col4 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 348661334 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: string, _col2: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col1 ASC NULLS FIRST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col2
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~CURRENT
            Statistics: Num rows: 348661334 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: string), sum_window_0 (type: double)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 348661334 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 348661334 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: string)
            1 _col0 (type: int), _col1 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END (type: int), CASE WHEN (_col1 is not null) THEN (_col1) ELSE (_col4) END (type: string)
              sort order: ++
              Map-reduce partition columns: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END (type: int)
              Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: string), _col2 (type: double), _col3 (type: int), _col4 (type: string), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: string), VALUE._col2 (type: double), VALUE._col3 (type: int), VALUE._col4 (type: string), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: string, _col2: double, _col3: int, _col4: string, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: CASE WHEN (_col1 is not null) THEN (_col1) ELSE (_col4) END ASC NULLS FIRST
                  partition by: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END
                  raw input shape:
                  window functions:
                      window function definition
                        alias: max_window_0
                        arguments: _col2
                        name: max
                        window function: GenericUDAFMaxEvaluator
                        window frame: PRECEDING(MAX)~CURRENT
                      window function definition
                        alias: max_window_1
                        arguments: _col5
                        name: max
                        window function: GenericUDAFMaxEvaluator
                        window frame: PRECEDING(MAX)~CURRENT
            Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (max_window_0 > max_window_1) (type: boolean)
              Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END (type: int), CASE WHEN (_col1 is not null) THEN (_col1) ELSE (_col4) END (type: string), _col2 (type: double), _col5 (type: double), max_window_0 (type: double), max_window_1 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col4 (type: string), _col2 (type: float)
            outputColumnNames: _col1, _col4, _col2
            Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col1 (type: int), _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col4 (type: string), _col2 (type: float)
                    outputColumnNames: _col1, _col4, _col2
                    Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col1 (type: int), _col4 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: string, _col2: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col1 ASC NULLS FIRST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col2
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~CURRENT
            Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: string), sum_window_0 (type: double)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col4 (type: string), _col2 (type: float)
            outputColumnNames: _col1, _col4, _col2
            Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col1 (type: int), _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query52.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-14
  Stage-9 depends on stages: Stage-1, Stage-10 , consists of Stage-12, Stage-13, Stage-2
  Stage-12 has a backup stage: Stage-2
  Stage-7 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:dt 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:dt 
          TableScan
            alias: dt
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col7, _col8
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
                outputColumnNames: _col7, _col8, _col5
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col5)
                  keys: _col7 (type: int), _col8 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: string), _col2 (type: double)
            outputColumnNames: _col1, _col2, _col3
            Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: double), _col1 (type: int)
              sort order: -+
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: 1998 (type: int), KEY.reducesinkkey1 (type: int), VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col7, _col8
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
                    outputColumnNames: _col7, _col8, _col5
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col5)
                      keys: _col7 (type: int), _col8 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col7, _col8
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
            outputColumnNames: _col7, _col8, _col5
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col5)
              keys: _col7 (type: int), _col8 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: dt
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query54.sql
STAGE DEPENDENCIES:
  Stage-37 is a root stage , consists of Stage-49, Stage-1
  Stage-49 has a backup stage: Stage-1
  Stage-36 depends on stages: Stage-49
  Stage-35 depends on stages: Stage-1, Stage-36 , consists of Stage-47, Stage-48, Stage-2
  Stage-47 has a backup stage: Stage-2
  Stage-33 depends on stages: Stage-47
  Stage-32 depends on stages: Stage-2, Stage-33, Stage-34 , consists of Stage-45, Stage-46, Stage-3
  Stage-45 has a backup stage: Stage-3
  Stage-30 depends on stages: Stage-45
  Stage-4 depends on stages: Stage-3, Stage-30, Stage-31
  Stage-29 depends on stages: Stage-4 , consists of Stage-43, Stage-44, Stage-5
  Stage-43 has a backup stage: Stage-5
  Stage-27 depends on stages: Stage-43
  Stage-26 depends on stages: Stage-5, Stage-27, Stage-28 , consists of Stage-41, Stage-42, Stage-6
  Stage-41 has a backup stage: Stage-6
  Stage-24 depends on stages: Stage-41
  Stage-40 depends on stages: Stage-6, Stage-24, Stage-25
  Stage-23 depends on stages: Stage-40
  Stage-22 depends on stages: Stage-23 , consists of Stage-38, Stage-39, Stage-8
  Stage-38 has a backup stage: Stage-8
  Stage-20 depends on stages: Stage-38
  Stage-9 depends on stages: Stage-8, Stage-20, Stage-21
  Stage-10 depends on stages: Stage-9
  Stage-11 depends on stages: Stage-10
  Stage-39 has a backup stage: Stage-8
  Stage-21 depends on stages: Stage-39
  Stage-8
  Stage-42 has a backup stage: Stage-6
  Stage-25 depends on stages: Stage-42
  Stage-6
  Stage-44 has a backup stage: Stage-5
  Stage-28 depends on stages: Stage-44
  Stage-5
  Stage-46 has a backup stage: Stage-3
  Stage-31 depends on stages: Stage-46
  Stage-3
  Stage-48 has a backup stage: Stage-2
  Stage-34 depends on stages: Stage-48
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-11

STAGE PLANS:
  Stage: Stage-37
    Conditional Operator

  Stage: Stage-49
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Jewelry') and (i_class = 'football') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21427 Data size: 4371117 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 21427 Data size: 4371117 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 1901059626 Data size: 22812715520 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2091165633 Data size: 25093987615 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_customer_sk (type: int), ws_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 1901059626 Data size: 22812715520 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2091165633 Data size: 25093987615 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Conditional Operator

  Stage: Stage-47
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 3) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1
              Statistics: Num rows: 2300282246 Data size: 27603386974 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-45
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col9, _col10
              Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col9 (type: int), _col10 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1265155262 Data size: 15181863158 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:store_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:store_sales 
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_customer_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col1 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col4
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Conditional Operator

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null and ca_state is not null) (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col6, _col7
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 192 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_county is not null and s_state is not null) (type: boolean)
              Statistics: Num rows: 192 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_county (type: string), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 192 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: string), _col7 (type: string)
                    1 _col0 (type: string), _col1 (type: string)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string), _col7 (type: string)
                1 _col0 (type: string), _col1 (type: string)
              outputColumnNames: _col0, _col2, _col4
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1203 AND 1205 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4
              Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4)
                keys: _col0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: UDFToInteger((_col1 / 50.0)) (type: int)
            outputColumnNames: _col0
            Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 614188800 Data size: 7370265608 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: bigint), (_col0 * 50) (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 614188800 Data size: 7370265608 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Statistics: Num rows: 614188800 Data size: 7370265608 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: int)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 614188800 Data size: 7370265608 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1203 AND 1205 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col4
                  Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col0 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col4 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1203 AND 1205 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col4
          Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: sum(_col4)
            keys: _col0 (type: int)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 2456755200 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null and ca_state is not null) (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col6, _col7
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null and ca_state is not null) (type: boolean)
              Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col6, _col7
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col1 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_customer_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col4
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1265155262 Data size: 15181863158 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int)
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_customer_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-46
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col9, _col10
                  Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col9 (type: int), _col10 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 2300282246 Data size: 27603386974 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: customer
            Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 12831574 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col9, _col10
          Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col9 (type: int), _col10 (type: int)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 2530310525 Data size: 30363726329 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 3) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1
                  Statistics: Num rows: 2300282246 Data size: 27603386974 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 2091165633 Data size: 25093987615 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 3) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1
          Statistics: Num rows: 2300282246 Data size: 27603386974 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 1901059626 Data size: 22812715520 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col2 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col2 (type: int)
                    Statistics: Num rows: 1901059626 Data size: 22812715520 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: int), _col1 (type: int)
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_customer_sk (type: int), ws_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 1901059626 Data size: 22812715520 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col2 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col2 (type: int)
                    Statistics: Num rows: 1901059626 Data size: 22812715520 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: int), _col1 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 85710 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Jewelry') and (i_class = 'football') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21427 Data size: 4371117 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 21427 Data size: 4371117 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 21427 Data size: 4371117 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 2091165633 Data size: 25093987615 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query55.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-14
  Stage-9 depends on stages: Stage-1, Stage-10 , consists of Stage-12, Stage-13, Stage-2
  Stage-12 has a backup stage: Stage-2
  Stage-7 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 36) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col7, _col8
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
                outputColumnNames: _col7, _col8, _col5
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col5)
                  keys: _col7 (type: int), _col8 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: double), _col0 (type: int)
              sort order: -+
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 36) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col7, _col8
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
                    outputColumnNames: _col7, _col8, _col5
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col5)
                      keys: _col7 (type: int), _col8 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 36) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col7, _col8
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: int), _col8 (type: string), _col5 (type: float)
            outputColumnNames: _col7, _col8, _col5
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col5)
              keys: _col7 (type: int), _col8 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query56.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-32 depends on stages: Stage-3, Stage-11, Stage-33, Stage-34 , consists of Stage-63, Stage-64, Stage-4
  Stage-63 has a backup stage: Stage-4
  Stage-30 depends on stages: Stage-63
  Stage-5 depends on stages: Stage-4, Stage-30, Stage-31
  Stage-6 depends on stages: Stage-5, Stage-16, Stage-25
  Stage-7 depends on stages: Stage-6
  Stage-64 has a backup stage: Stage-4
  Stage-31 depends on stages: Stage-64
  Stage-4
  Stage-20 is a root stage
  Stage-43 depends on stages: Stage-14, Stage-20, Stage-44, Stage-45 , consists of Stage-65, Stage-66, Stage-15
  Stage-65 has a backup stage: Stage-15
  Stage-41 depends on stages: Stage-65
  Stage-16 depends on stages: Stage-15, Stage-41, Stage-42
  Stage-66 has a backup stage: Stage-15
  Stage-42 depends on stages: Stage-66
  Stage-15
  Stage-29 is a root stage
  Stage-54 depends on stages: Stage-23, Stage-29, Stage-55, Stage-56 , consists of Stage-67, Stage-68, Stage-24
  Stage-67 has a backup stage: Stage-24
  Stage-52 depends on stages: Stage-67
  Stage-25 depends on stages: Stage-24, Stage-52, Stage-53
  Stage-68 has a backup stage: Stage-24
  Stage-53 depends on stages: Stage-68
  Stage-24
  Stage-40 is a root stage , consists of Stage-73, Stage-1
  Stage-73 has a backup stage: Stage-1
  Stage-39 depends on stages: Stage-73
  Stage-38 depends on stages: Stage-1, Stage-39 , consists of Stage-71, Stage-72, Stage-2
  Stage-71 has a backup stage: Stage-2
  Stage-36 depends on stages: Stage-71
  Stage-35 depends on stages: Stage-2, Stage-36, Stage-37 , consists of Stage-69, Stage-70, Stage-3
  Stage-69 has a backup stage: Stage-3
  Stage-33 depends on stages: Stage-69
  Stage-70 has a backup stage: Stage-3
  Stage-34 depends on stages: Stage-70
  Stage-3
  Stage-72 has a backup stage: Stage-2
  Stage-37 depends on stages: Stage-72
  Stage-2
  Stage-1
  Stage-51 is a root stage , consists of Stage-78, Stage-12
  Stage-78 has a backup stage: Stage-12
  Stage-50 depends on stages: Stage-78
  Stage-49 depends on stages: Stage-12, Stage-50 , consists of Stage-76, Stage-77, Stage-13
  Stage-76 has a backup stage: Stage-13
  Stage-47 depends on stages: Stage-76
  Stage-46 depends on stages: Stage-13, Stage-47, Stage-48 , consists of Stage-74, Stage-75, Stage-14
  Stage-74 has a backup stage: Stage-14
  Stage-44 depends on stages: Stage-74
  Stage-75 has a backup stage: Stage-14
  Stage-45 depends on stages: Stage-75
  Stage-14
  Stage-77 has a backup stage: Stage-13
  Stage-48 depends on stages: Stage-77
  Stage-13
  Stage-12
  Stage-62 is a root stage , consists of Stage-83, Stage-21
  Stage-83 has a backup stage: Stage-21
  Stage-61 depends on stages: Stage-83
  Stage-60 depends on stages: Stage-21, Stage-61 , consists of Stage-81, Stage-82, Stage-22
  Stage-81 has a backup stage: Stage-22
  Stage-58 depends on stages: Stage-81
  Stage-57 depends on stages: Stage-22, Stage-58, Stage-59 , consists of Stage-79, Stage-80, Stage-23
  Stage-79 has a backup stage: Stage-23
  Stage-55 depends on stages: Stage-79
  Stage-80 has a backup stage: Stage-23
  Stage-56 depends on stages: Stage-80
  Stage-23
  Stage-82 has a backup stage: Stage-22
  Stage-59 depends on stages: Stage-82
  Stage-22
  Stage-21
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 87424 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('purple', 'burlywood', 'indian') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 921283199 Data size: 14740531208 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 982518155 Data size: 15720290509 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double)
              sort order: +
              Statistics: Num rows: 982518155 Data size: 15720290509 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 982518155 Data size: 15720290509 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col3 (type: float)
            outputColumnNames: _col10, _col3
            Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 87424 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('purple', 'burlywood', 'indian') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Conditional Operator

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 695701914 Data size: 11131230639 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col3 (type: float)
            outputColumnNames: _col10, _col3
            Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 87424 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('purple', 'burlywood', 'indian') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-54
    Conditional Operator

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-52
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 348051198 Data size: 5568819187 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col3 (type: float)
            outputColumnNames: _col10, _col3
            Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-40
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-38
    Conditional Operator

  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3
              Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Conditional Operator

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col10
                  Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-51
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_addr_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_addr_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-49
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col3
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-46
    Conditional Operator

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col10
                  Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3
                  Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col3
          Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_addr_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_addr_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-62
    Conditional Operator

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-61
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-60
    Conditional Operator

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3
              Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-57
    Conditional Operator

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-55
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col10
                  Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query58.sql
STAGE DEPENDENCIES:
  Stage-41 is a root stage , consists of Stage-75, Stage-1
  Stage-75 has a backup stage: Stage-1
  Stage-40 depends on stages: Stage-75
  Stage-39 depends on stages: Stage-1, Stage-40 , consists of Stage-73, Stage-74, Stage-2
  Stage-73 has a backup stage: Stage-2
  Stage-37 depends on stages: Stage-73
  Stage-36 depends on stages: Stage-2, Stage-10, Stage-37, Stage-38, Stage-42, Stage-43 , consists of Stage-71, Stage-72, Stage-3
  Stage-71 has a backup stage: Stage-3
  Stage-34 depends on stages: Stage-71
  Stage-4 depends on stages: Stage-3, Stage-34, Stage-35
  Stage-33 depends on stages: Stage-4, Stage-15 , consists of Stage-69, Stage-70, Stage-5
  Stage-69 has a backup stage: Stage-5
  Stage-31 depends on stages: Stage-69
  Stage-30 depends on stages: Stage-5, Stage-23, Stage-31, Stage-32 , consists of Stage-67, Stage-68, Stage-6
  Stage-67 has a backup stage: Stage-6
  Stage-28 depends on stages: Stage-67
  Stage-7 depends on stages: Stage-6, Stage-28, Stage-29
  Stage-68 has a backup stage: Stage-6
  Stage-29 depends on stages: Stage-68
  Stage-6
  Stage-70 has a backup stage: Stage-5
  Stage-32 depends on stages: Stage-70
  Stage-5
  Stage-72 has a backup stage: Stage-3
  Stage-35 depends on stages: Stage-72
  Stage-3
  Stage-74 has a backup stage: Stage-2
  Stage-38 depends on stages: Stage-74
  Stage-2
  Stage-1
  Stage-44 is a root stage , consists of Stage-76, Stage-77, Stage-10
  Stage-76 has a backup stage: Stage-10
  Stage-42 depends on stages: Stage-76
  Stage-77 has a backup stage: Stage-10
  Stage-43 depends on stages: Stage-77
  Stage-10
  Stage-52 is a root stage , consists of Stage-82, Stage-12
  Stage-82 has a backup stage: Stage-12
  Stage-51 depends on stages: Stage-82
  Stage-50 depends on stages: Stage-12, Stage-51 , consists of Stage-80, Stage-81, Stage-13
  Stage-80 has a backup stage: Stage-13
  Stage-48 depends on stages: Stage-80
  Stage-47 depends on stages: Stage-13, Stage-18, Stage-48, Stage-49, Stage-53, Stage-54 , consists of Stage-78, Stage-79, Stage-14
  Stage-78 has a backup stage: Stage-14
  Stage-45 depends on stages: Stage-78
  Stage-15 depends on stages: Stage-14, Stage-45, Stage-46
  Stage-79 has a backup stage: Stage-14
  Stage-46 depends on stages: Stage-79
  Stage-14
  Stage-81 has a backup stage: Stage-13
  Stage-49 depends on stages: Stage-81
  Stage-13
  Stage-12
  Stage-55 is a root stage , consists of Stage-83, Stage-84, Stage-18
  Stage-83 has a backup stage: Stage-18
  Stage-53 depends on stages: Stage-83
  Stage-84 has a backup stage: Stage-18
  Stage-54 depends on stages: Stage-84
  Stage-18
  Stage-63 is a root stage , consists of Stage-89, Stage-20
  Stage-89 has a backup stage: Stage-20
  Stage-62 depends on stages: Stage-89
  Stage-61 depends on stages: Stage-20, Stage-62 , consists of Stage-87, Stage-88, Stage-21
  Stage-87 has a backup stage: Stage-21
  Stage-59 depends on stages: Stage-87
  Stage-58 depends on stages: Stage-21, Stage-26, Stage-59, Stage-60, Stage-64, Stage-65 , consists of Stage-85, Stage-86, Stage-22
  Stage-85 has a backup stage: Stage-22
  Stage-56 depends on stages: Stage-85
  Stage-23 depends on stages: Stage-22, Stage-56, Stage-57
  Stage-86 has a backup stage: Stage-22
  Stage-57 depends on stages: Stage-86
  Stage-22
  Stage-88 has a backup stage: Stage-21
  Stage-60 depends on stages: Stage-88
  Stage-21
  Stage-20
  Stage-66 is a root stage , consists of Stage-90, Stage-91, Stage-26
  Stage-90 has a backup stage: Stage-26
  Stage-64 depends on stages: Stage-90
  Stage-91 has a backup stage: Stage-26
  Stage-65 depends on stages: Stage-91
  Stage-26
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-41
    Conditional Operator

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-39
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col6
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Conditional Operator

  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1116706885 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Conditional Operator

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3
              Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col3) AND (1.1 * _col3) and _col3 BETWEEN (0.9 * _col1) AND (1.1 * _col1)) (type: boolean)
                Statistics: Num rows: 15165155 Data size: 181981860 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Conditional Operator

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 464068265 Data size: 5568819195 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col3 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col5 BETWEEN (0.9 * _col1) AND (1.1 * _col1) and _col5 BETWEEN (0.9 * _col3) AND (1.1 * _col3)) (type: boolean)
                Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: double), (((_col1 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col3 (type: double), (((_col3 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col5 (type: double), (((_col5 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), (((_col1 + _col3) + _col5) / 3.0) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double)
              sort order: ++
              Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 464068265 Data size: 5568819195 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col3 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col5 BETWEEN (0.9 * _col1) AND (1.1 * _col1) and _col5 BETWEEN (0.9 * _col3) AND (1.1 * _col3)) (type: boolean)
                Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: double), (((_col1 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col3 (type: double), (((_col3 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col5 (type: double), (((_col5 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), (((_col1 + _col3) + _col5) / 3.0) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 15165155 Data size: 181981860 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col3 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 421880232 Data size: 5062562795 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5
          Statistics: Num rows: 464068265 Data size: 5568819195 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col3 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col5 BETWEEN (0.9 * _col1) AND (1.1 * _col1) and _col5 BETWEEN (0.9 * _col3) AND (1.1 * _col3)) (type: boolean)
            Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: double), (((_col1 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col3 (type: double), (((_col3 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col5 (type: double), (((_col5 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), (((_col1 + _col3) + _col5) / 3.0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 70731 Data size: 848772 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3
              Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col3) AND (1.1 * _col3) and _col3 BETWEEN (0.9 * _col1) AND (1.1 * _col1)) (type: boolean)
                Statistics: Num rows: 15165155 Data size: 181981860 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1116706885 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 843275029 Data size: 10119300363 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3
          Statistics: Num rows: 1228377600 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 BETWEEN (0.9 * _col3) AND (1.1 * _col3) and _col3 BETWEEN (0.9 * _col1) AND (1.1 * _col1)) (type: boolean)
            Statistics: Num rows: 15165155 Data size: 181981860 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: float)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col6
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col6
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-52
    Conditional Operator

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-50
    Conditional Operator

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col6
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-47
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 843275029 Data size: 10119300363 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: float)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1686550059 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col6
                  Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col6
          Statistics: Num rows: 1533227294 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_4:$hdt$_5:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_4:$hdt$_5:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-84
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_4:$hdt$_4:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_4:$hdt$_4:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-63
    Conditional Operator

  Stage: Stage-89
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-61
    Conditional Operator

  Stage: Stage-87
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col6
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-58
    Conditional Operator

  Stage: Stage-85
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 421880232 Data size: 5062562795 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-86
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-57
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: float)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-88
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col6
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col6
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Conditional Operator

  Stage: Stage-90
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_4:$hdt$_5:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_4:$hdt$_5:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_4:$hdt$_4:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_4:$hdt$_4:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-65
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
          TableScan
            alias: d2
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query60.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-32 depends on stages: Stage-3, Stage-11, Stage-33, Stage-34 , consists of Stage-63, Stage-64, Stage-4
  Stage-63 has a backup stage: Stage-4
  Stage-30 depends on stages: Stage-63
  Stage-5 depends on stages: Stage-4, Stage-30, Stage-31
  Stage-6 depends on stages: Stage-5, Stage-16, Stage-25
  Stage-7 depends on stages: Stage-6
  Stage-64 has a backup stage: Stage-4
  Stage-31 depends on stages: Stage-64
  Stage-4
  Stage-20 is a root stage
  Stage-43 depends on stages: Stage-14, Stage-20, Stage-44, Stage-45 , consists of Stage-65, Stage-66, Stage-15
  Stage-65 has a backup stage: Stage-15
  Stage-41 depends on stages: Stage-65
  Stage-16 depends on stages: Stage-15, Stage-41, Stage-42
  Stage-66 has a backup stage: Stage-15
  Stage-42 depends on stages: Stage-66
  Stage-15
  Stage-29 is a root stage
  Stage-54 depends on stages: Stage-23, Stage-29, Stage-55, Stage-56 , consists of Stage-67, Stage-68, Stage-24
  Stage-67 has a backup stage: Stage-24
  Stage-52 depends on stages: Stage-67
  Stage-25 depends on stages: Stage-24, Stage-52, Stage-53
  Stage-68 has a backup stage: Stage-24
  Stage-53 depends on stages: Stage-68
  Stage-24
  Stage-40 is a root stage , consists of Stage-73, Stage-1
  Stage-73 has a backup stage: Stage-1
  Stage-39 depends on stages: Stage-73
  Stage-38 depends on stages: Stage-1, Stage-39 , consists of Stage-71, Stage-72, Stage-2
  Stage-71 has a backup stage: Stage-2
  Stage-36 depends on stages: Stage-71
  Stage-35 depends on stages: Stage-2, Stage-36, Stage-37 , consists of Stage-69, Stage-70, Stage-3
  Stage-69 has a backup stage: Stage-3
  Stage-33 depends on stages: Stage-69
  Stage-70 has a backup stage: Stage-3
  Stage-34 depends on stages: Stage-70
  Stage-3
  Stage-72 has a backup stage: Stage-2
  Stage-37 depends on stages: Stage-72
  Stage-2
  Stage-1
  Stage-51 is a root stage , consists of Stage-78, Stage-12
  Stage-78 has a backup stage: Stage-12
  Stage-50 depends on stages: Stage-78
  Stage-49 depends on stages: Stage-12, Stage-50 , consists of Stage-76, Stage-77, Stage-13
  Stage-76 has a backup stage: Stage-13
  Stage-47 depends on stages: Stage-76
  Stage-46 depends on stages: Stage-13, Stage-47, Stage-48 , consists of Stage-74, Stage-75, Stage-14
  Stage-74 has a backup stage: Stage-14
  Stage-44 depends on stages: Stage-74
  Stage-75 has a backup stage: Stage-14
  Stage-45 depends on stages: Stage-75
  Stage-14
  Stage-77 has a backup stage: Stage-13
  Stage-48 depends on stages: Stage-77
  Stage-13
  Stage-12
  Stage-62 is a root stage , consists of Stage-83, Stage-21
  Stage-83 has a backup stage: Stage-21
  Stage-61 depends on stages: Stage-83
  Stage-60 depends on stages: Stage-21, Stage-61 , consists of Stage-81, Stage-82, Stage-22
  Stage-81 has a backup stage: Stage-22
  Stage-58 depends on stages: Stage-81
  Stage-57 depends on stages: Stage-22, Stage-58, Stage-59 , consists of Stage-79, Stage-80, Stage-23
  Stage-79 has a backup stage: Stage-23
  Stage-55 depends on stages: Stage-79
  Stage-80 has a backup stage: Stage-23
  Stage-56 depends on stages: Stage-80
  Stage-23
  Stage-82 has a backup stage: Stage-22
  Stage-59 depends on stages: Stage-82
  Stage-22
  Stage-21
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 87424 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Children') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 921283199 Data size: 14740531208 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 1965036311 Data size: 31440581034 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 982518155 Data size: 15720290509 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double)
              sort order: ++
              Statistics: Num rows: 982518155 Data size: 15720290509 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 982518155 Data size: 15720290509 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col3 (type: float)
            outputColumnNames: _col10, _col3
            Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1842566399 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 87424 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Children') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Conditional Operator

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 695701914 Data size: 11131230639 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col3 (type: float)
            outputColumnNames: _col10, _col3
            Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1391403829 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 87424 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Children') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 43712 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-54
    Conditional Operator

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-52
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 348051198 Data size: 5568819187 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col3 (type: float)
                outputColumnNames: _col10, _col3
                Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 21856 Data size: 4371220 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col3 (type: float)
            outputColumnNames: _col10, _col3
            Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 696102397 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-40
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-38
    Conditional Operator

  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3
              Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Conditional Operator

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col10
                  Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_addr_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-51
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_addr_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_addr_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-49
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col3
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-46
    Conditional Operator

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col10
                  Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 1264912545 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3
                  Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col3
          Statistics: Num rows: 1149920471 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_addr_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_addr_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-62
    Conditional Operator

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-61
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-60
    Conditional Operator

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3
              Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-57
    Conditional Operator

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-55
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col10
              Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col10
                  Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col10
          Statistics: Num rows: 632820348 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 575291213 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_addr_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query64.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-111 depends on stages: Stage-1 , consists of Stage-168, Stage-169, Stage-2
  Stage-168 has a backup stage: Stage-2
  Stage-109 depends on stages: Stage-168
  Stage-108 depends on stages: Stage-2, Stage-109, Stage-110 , consists of Stage-166, Stage-167, Stage-3
  Stage-166 has a backup stage: Stage-3
  Stage-106 depends on stages: Stage-166
  Stage-105 depends on stages: Stage-3, Stage-106, Stage-107 , consists of Stage-164, Stage-165, Stage-4
  Stage-164 has a backup stage: Stage-4
  Stage-103 depends on stages: Stage-164
  Stage-102 depends on stages: Stage-4, Stage-103, Stage-104 , consists of Stage-162, Stage-163, Stage-5
  Stage-162 has a backup stage: Stage-5
  Stage-100 depends on stages: Stage-162
  Stage-161 depends on stages: Stage-5, Stage-100, Stage-101
  Stage-99 depends on stages: Stage-161
  Stage-98 depends on stages: Stage-99 , consists of Stage-159, Stage-160, Stage-7
  Stage-159 has a backup stage: Stage-7
  Stage-96 depends on stages: Stage-159
  Stage-95 depends on stages: Stage-7, Stage-96, Stage-97 , consists of Stage-157, Stage-158, Stage-8
  Stage-157 has a backup stage: Stage-8
  Stage-93 depends on stages: Stage-157
  Stage-156 depends on stages: Stage-8, Stage-93, Stage-94
  Stage-90 depends on stages: Stage-156
  Stage-89 depends on stages: Stage-90 , consists of Stage-154, Stage-155, Stage-12
  Stage-154 has a backup stage: Stage-12
  Stage-87 depends on stages: Stage-154
  Stage-86 depends on stages: Stage-12, Stage-87, Stage-88 , consists of Stage-152, Stage-153, Stage-13
  Stage-152 has a backup stage: Stage-13
  Stage-84 depends on stages: Stage-152
  Stage-151 depends on stages: Stage-13, Stage-84, Stage-85
  Stage-82 depends on stages: Stage-151
  Stage-81 depends on stages: Stage-37, Stage-82 , consists of Stage-148, Stage-149, Stage-150, Stage-16
  Stage-148 has a backup stage: Stage-16
  Stage-78 depends on stages: Stage-148
  Stage-17 depends on stages: Stage-16, Stage-78, Stage-79, Stage-80
  Stage-77 depends on stages: Stage-17, Stage-55 , consists of Stage-146, Stage-147, Stage-18
  Stage-146 has a backup stage: Stage-18
  Stage-75 depends on stages: Stage-146
  Stage-19 depends on stages: Stage-18, Stage-75, Stage-76
  Stage-147 has a backup stage: Stage-18
  Stage-76 depends on stages: Stage-147
  Stage-18
  Stage-149 has a backup stage: Stage-16
  Stage-79 depends on stages: Stage-149
  Stage-150 has a backup stage: Stage-16
  Stage-80 depends on stages: Stage-150
  Stage-16
  Stage-153 has a backup stage: Stage-13
  Stage-85 depends on stages: Stage-153
  Stage-13
  Stage-155 has a backup stage: Stage-12
  Stage-88 depends on stages: Stage-155
  Stage-12
  Stage-158 has a backup stage: Stage-8
  Stage-94 depends on stages: Stage-158
  Stage-8
  Stage-160 has a backup stage: Stage-7
  Stage-97 depends on stages: Stage-160
  Stage-7
  Stage-163 has a backup stage: Stage-5
  Stage-101 depends on stages: Stage-163
  Stage-5
  Stage-165 has a backup stage: Stage-4
  Stage-104 depends on stages: Stage-165
  Stage-4
  Stage-167 has a backup stage: Stage-3
  Stage-107 depends on stages: Stage-167
  Stage-3
  Stage-169 has a backup stage: Stage-2
  Stage-110 depends on stages: Stage-169
  Stage-2
  Stage-36 is a root stage
  Stage-37 depends on stages: Stage-36
  Stage-39 is a root stage
  Stage-145 depends on stages: Stage-39 , consists of Stage-190, Stage-191, Stage-40
  Stage-190 has a backup stage: Stage-40
  Stage-143 depends on stages: Stage-190
  Stage-142 depends on stages: Stage-40, Stage-143, Stage-144 , consists of Stage-188, Stage-189, Stage-41
  Stage-188 has a backup stage: Stage-41
  Stage-140 depends on stages: Stage-188
  Stage-139 depends on stages: Stage-41, Stage-140, Stage-141 , consists of Stage-186, Stage-187, Stage-42
  Stage-186 has a backup stage: Stage-42
  Stage-137 depends on stages: Stage-186
  Stage-136 depends on stages: Stage-42, Stage-137, Stage-138 , consists of Stage-184, Stage-185, Stage-43
  Stage-184 has a backup stage: Stage-43
  Stage-134 depends on stages: Stage-184
  Stage-183 depends on stages: Stage-43, Stage-134, Stage-135
  Stage-133 depends on stages: Stage-183
  Stage-132 depends on stages: Stage-133 , consists of Stage-181, Stage-182, Stage-45
  Stage-181 has a backup stage: Stage-45
  Stage-130 depends on stages: Stage-181
  Stage-129 depends on stages: Stage-45, Stage-130, Stage-131 , consists of Stage-179, Stage-180, Stage-46
  Stage-179 has a backup stage: Stage-46
  Stage-127 depends on stages: Stage-179
  Stage-178 depends on stages: Stage-46, Stage-127, Stage-128
  Stage-124 depends on stages: Stage-178
  Stage-123 depends on stages: Stage-124 , consists of Stage-176, Stage-177, Stage-50
  Stage-176 has a backup stage: Stage-50
  Stage-121 depends on stages: Stage-176
  Stage-120 depends on stages: Stage-50, Stage-121, Stage-122 , consists of Stage-174, Stage-175, Stage-51
  Stage-174 has a backup stage: Stage-51
  Stage-118 depends on stages: Stage-174
  Stage-173 depends on stages: Stage-51, Stage-118, Stage-119
  Stage-116 depends on stages: Stage-173
  Stage-115 depends on stages: Stage-73, Stage-116 , consists of Stage-170, Stage-171, Stage-172, Stage-54
  Stage-170 has a backup stage: Stage-54
  Stage-112 depends on stages: Stage-170
  Stage-55 depends on stages: Stage-54, Stage-112, Stage-113, Stage-114
  Stage-171 has a backup stage: Stage-54
  Stage-113 depends on stages: Stage-171
  Stage-172 has a backup stage: Stage-54
  Stage-114 depends on stages: Stage-172
  Stage-54
  Stage-175 has a backup stage: Stage-51
  Stage-119 depends on stages: Stage-175
  Stage-51
  Stage-177 has a backup stage: Stage-50
  Stage-122 depends on stages: Stage-177
  Stage-50
  Stage-180 has a backup stage: Stage-46
  Stage-128 depends on stages: Stage-180
  Stage-46
  Stage-182 has a backup stage: Stage-45
  Stage-131 depends on stages: Stage-182
  Stage-45
  Stage-185 has a backup stage: Stage-43
  Stage-135 depends on stages: Stage-185
  Stage-43
  Stage-187 has a backup stage: Stage-42
  Stage-138 depends on stages: Stage-187
  Stage-42
  Stage-189 has a backup stage: Stage-41
  Stage-141 depends on stages: Stage-189
  Stage-41
  Stage-191 has a backup stage: Stage-40
  Stage-144 depends on stages: Stage-191
  Stage-40
  Stage-72 is a root stage
  Stage-73 depends on stages: Stage-72
  Stage-0 depends on stages: Stage-19

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_customer_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null and ss_cdemo_sk is not null and ss_promo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_promo_sk (type: int), ss_ticket_number (type: bigint), ss_wholesale_cost (type: float), ss_list_price (type: float), ss_coupon_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col8 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col8 (type: bigint)
                  Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col8 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11
          Statistics: Num rows: 425953021 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-111
    Conditional Operator

  Stage: Stage-168
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-109
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-108
    Conditional Operator

  Stage: Stage-166
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-106
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-105
    Conditional Operator

  Stage: Stage-164
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-103
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col23
              Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-102
    Conditional Operator

  Stage: Stage-162
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_5:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-100
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col18 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25
              Statistics: Num rows: 623637870 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-161
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_6:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_store_name is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-99
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28
              Statistics: Num rows: 686001671 Data size: 35672087090 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-98
    Conditional Operator

  Stage: Stage-159
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_7:cd1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_7:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-96
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
              Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-95
    Conditional Operator

  Stage: Stage-157
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_8:cd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_8:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-93
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
              Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col30 <> _col32) (type: boolean)
                Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: int), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float)
                  outputColumnNames: _col1, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col4, _col5, _col7, _col9
                  Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-156
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:promotion 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:hd1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:hd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_promo_sk is not null (type: boolean)
              Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:hd1 
          TableScan
            alias: hd1
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:hd2 
          TableScan
            alias: hd2
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col16 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-90
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28
              Statistics: Num rows: 913068282 Data size: 47479551002 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col4 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col5, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col35
                Statistics: Num rows: 1004375131 Data size: 52227507234 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col16 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col5, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37
                  Statistics: Num rows: 1104812668 Data size: 57450259202 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-89
    Conditional Operator

  Stage: Stage-154
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:ad1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:ad1 
          TableScan
            alias: ad1
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-87
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
              Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-86
    Conditional Operator

  Stage: Stage-152
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_5:ad2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_5:ad2 
          TableScan
            alias: ad2
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col17 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-84
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col17 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
              Statistics: Num rows: 1336823386 Data size: 69514816646 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-151
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_6:ib1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_7:ib2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_6:ib1 
          TableScan
            alias: ib1
            Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col35 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_7:ib2 
          TableScan
            alias: ib2
            Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col37 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-82
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col35 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
              Statistics: Num rows: 1470505756 Data size: 76466299967 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col37 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                Statistics: Num rows: 1617556366 Data size: 84112931786 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-81
    Conditional Operator

  Stage: Stage-148
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-78
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
                Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              sort order: ++++++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string), KEY._col10 (type: string), KEY._col11 (type: string), KEY._col12 (type: string), KEY._col13 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1779312041 Data size: 92524226970 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col13 (type: string), _col1 (type: int), _col11 (type: string), _col12 (type: string), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col0 (type: string), _col2 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
            outputColumnNames: _col0, _col1, _col10, _col11, _col13, _col14, _col15, _col16, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
            Statistics: Num rows: 1779312041 Data size: 92524226970 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Conditional Operator

  Stage: Stage-146
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)

  Stage: Stage-75
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col15, _col16, _col30, _col31, _col32, _col33
              Statistics: Num rows: 1957243287 Data size: 101776651872 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col30 <= _col13) (type: boolean)
                Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col3 (type: string), _col30 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
                  outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col20 (type: bigint)
              sort order: +++
              Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col12 (type: bigint), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: string), VALUE._col5 (type: string), VALUE._col6 (type: string), VALUE._col7 (type: string), VALUE._col8 (type: string), 2000 (type: int), VALUE._col9 (type: bigint), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), 2001 (type: int), KEY.reducesinkkey2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20
          Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-147
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)

  Stage: Stage-76
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col15, _col16, _col30, _col31, _col32, _col33
              Statistics: Num rows: 1957243287 Data size: 101776651872 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col30 <= _col13) (type: boolean)
                Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col3 (type: string), _col30 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
                  outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              sort order: +++
              Map-reduce partition columns: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              Statistics: Num rows: 1779312041 Data size: 92524226970 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              sort order: +++
              Map-reduce partition columns: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              Statistics: Num rows: 1779312041 Data size: 92524226970 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
            1 _col2 (type: string), _col1 (type: int), _col3 (type: string)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col15, _col16, _col30, _col31, _col32, _col33
          Statistics: Num rows: 1957243287 Data size: 101776651872 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col30 <= _col13) (type: boolean)
            Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col3 (type: string), _col30 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
              outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 652414429 Data size: 33925550624 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-149
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)

  Stage: Stage-79
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 0 to 2
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
                  Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
                    outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
                    Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
                      keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                      Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-150
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-80
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
                Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1617556366 Data size: 84112931786 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col9 (type: float), _col10 (type: float), _col11 (type: float), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 174230370 Data size: 2787685920 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
          Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
            outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
            Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
              keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-153
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col17 (type: int)
                1 _col0 (type: int)

  Stage: Stage-85
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ad2
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col17 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                  Statistics: Num rows: 1336823386 Data size: 69514816646 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col17 (type: int)
              sort order: +
              Map-reduce partition columns: _col17 (type: int)
              Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col35 (type: int), _col37 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string)
          TableScan
            alias: ad2
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col17 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
          Statistics: Num rows: 1336823386 Data size: 69514816646 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-155
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-88
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ad1
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
                  Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 1104812668 Data size: 57450259202 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col35 (type: int), _col37 (type: int)
          TableScan
            alias: ad1
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
          Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-158
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)

  Stage: Stage-94
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd2
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
                  Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (_col30 <> _col32) (type: boolean)
                    Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col1 (type: int), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float)
                      outputColumnNames: _col1, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col4, _col5, _col7, _col9
                      Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col15 (type: int)
              sort order: +
              Map-reduce partition columns: _col15 (type: int)
              Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col30 (type: string)
          TableScan
            alias: cd2
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col15 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
          Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col30 <> _col32) (type: boolean)
            Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: int), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float)
              outputColumnNames: _col1, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col4, _col5, _col7, _col9
              Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-160
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)

  Stage: Stage-97
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd1
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
                  Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int)
              sort order: +
              Map-reduce partition columns: _col3 (type: int)
              Statistics: Num rows: 686001671 Data size: 35672087090 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string)
          TableScan
            alias: cd1
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
          Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-163
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col18 (type: int)
                1 _col0 (type: int)

  Stage: Stage-101
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25
                  Statistics: Num rows: 623637870 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col18 (type: int)
              sort order: +
              Map-reduce partition columns: _col18 (type: int)
              Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col23 (type: int)
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col18 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25
          Statistics: Num rows: 623637870 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-165
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)

  Stage: Stage-104
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col23
                  Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col19 (type: int)
              sort order: +
              Map-reduce partition columns: _col19 (type: int)
              Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col18 (type: int)
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col19 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col23
          Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-167
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-107
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col18 (type: int), _col19 (type: int)
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-169
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-110
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 425953021 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float)
          TableScan
            alias: customer
            Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_order_number is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_ext_list_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_order_number is not null and cr_item_sk is not null) (type: boolean)
              Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_refunded_cash (type: float), cr_reversed_charge (type: float), cr_store_credit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float), _col4 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col5, _col6, _col7
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col2 (type: float), ((_col5 + _col6) + _col7) (type: float)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 522691112 Data size: 8363057794 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > (2.0 * _col2)) (type: boolean)
            Statistics: Num rows: 174230370 Data size: 2787685920 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 174230370 Data size: 2787685920 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_customer_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null and ss_cdemo_sk is not null and ss_promo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_promo_sk (type: int), ss_ticket_number (type: bigint), ss_wholesale_cost (type: float), ss_list_price (type: float), ss_coupon_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col8 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col8 (type: bigint)
                  Statistics: Num rows: 387230011 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col8 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11
          Statistics: Num rows: 425953021 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-145
    Conditional Operator

  Stage: Stage-190
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-143
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-142
    Conditional Operator

  Stage: Stage-188
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-140
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-139
    Conditional Operator

  Stage: Stage-186
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-137
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col23
              Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-136
    Conditional Operator

  Stage: Stage-184
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-134
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col18 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25
              Statistics: Num rows: 623637870 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-183
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_7:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_7:store 
          TableScan
            alias: store
            Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_store_name is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-133
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28
              Statistics: Num rows: 686001671 Data size: 35672087090 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-132
    Conditional Operator

  Stage: Stage-181
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_8:cd1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_8:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-130
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
              Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-129
    Conditional Operator

  Stage: Stage-179
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_9:cd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_9:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-127
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
              Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col30 <> _col32) (type: boolean)
                Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: int), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float)
                  outputColumnNames: _col1, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col4, _col5, _col7, _col9
                  Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-178
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_2:promotion 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_3:hd1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_4:hd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_2:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_promo_sk is not null (type: boolean)
              Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_3:hd1 
          TableScan
            alias: hd1
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_4:hd2 
          TableScan
            alias: hd2
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col16 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-124
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28
              Statistics: Num rows: 913068282 Data size: 47479551002 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col4 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col5, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col35
                Statistics: Num rows: 1004375131 Data size: 52227507234 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col16 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col5, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37
                  Statistics: Num rows: 1104812668 Data size: 57450259202 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-123
    Conditional Operator

  Stage: Stage-176
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_5:ad1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_5:ad1 
          TableScan
            alias: ad1
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-121
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
              Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-120
    Conditional Operator

  Stage: Stage-174
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_6:ad2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_6:ad2 
          TableScan
            alias: ad2
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col17 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-118
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col17 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
              Statistics: Num rows: 1336823386 Data size: 69514816646 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-173
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_7:ib1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_8:ib2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_7:ib1 
          TableScan
            alias: ib1
            Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col35 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_8:ib2 
          TableScan
            alias: ib2
            Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 82 Data size: 328 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col37 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-116
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col35 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
              Statistics: Num rows: 1470505756 Data size: 76466299967 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col37 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                Statistics: Num rows: 1617556366 Data size: 84112931786 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-115
    Conditional Operator

  Stage: Stage-170
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-112
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
                Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              sort order: ++++++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string), KEY._col10 (type: string), KEY._col11 (type: string), KEY._col12 (type: string), KEY._col13 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1779312041 Data size: 92524226970 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col0 (type: string), _col2 (type: string)
            outputColumnNames: _col1, _col13, _col14, _col15, _col16, _col2, _col3
            Statistics: Num rows: 1779312041 Data size: 92524226970 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-171
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:$hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)

  Stage: Stage-113
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 0 to 2
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
                  Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
                    outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
                    Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
                      keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                      Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-172
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-114
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
                Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1617556366 Data size: 84112931786 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col9 (type: float), _col10 (type: float), _col11 (type: float), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 84061 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 518 Data size: 107745 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 174230370 Data size: 2787685920 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
          Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col9 (type: float), _col10 (type: float), _col11 (type: float)
            outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col9, _col10, _col11
            Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(), sum(_col9), sum(_col10), sum(_col11)
              keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 3558624082 Data size: 185048453940 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-175
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col17 (type: int)
                1 _col0 (type: int)

  Stage: Stage-119
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ad2
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col17 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                  Statistics: Num rows: 1336823386 Data size: 69514816646 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col17 (type: int)
              sort order: +
              Map-reduce partition columns: _col17 (type: int)
              Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col35 (type: int), _col37 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string)
          TableScan
            alias: ad2
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col17 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col9, _col10, _col11, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
          Statistics: Num rows: 1336823386 Data size: 69514816646 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-177
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-122
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ad1
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
                  Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 1104812668 Data size: 57450259202 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col35 (type: int), _col37 (type: int)
          TableScan
            alias: ad1
            Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 105212 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col9, _col10, _col11, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
          Statistics: Num rows: 1215293961 Data size: 63195286491 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-180
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)

  Stage: Stage-128
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd2
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
                  Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (_col30 <> _col32) (type: boolean)
                    Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col1 (type: int), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float)
                      outputColumnNames: _col1, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col4, _col5, _col7, _col9
                      Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col15 (type: int)
              sort order: +
              Map-reduce partition columns: _col15 (type: int)
              Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col30 (type: string)
          TableScan
            alias: cd2
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col15 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
          Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col30 <> _col32) (type: boolean)
            Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: int), _col10 (type: float), _col11 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float)
              outputColumnNames: _col1, _col10, _col11, _col16, _col17, _col23, _col25, _col27, _col28, _col4, _col5, _col7, _col9
              Statistics: Num rows: 830062057 Data size: 43163227249 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-182
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)

  Stage: Stage-131
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd1
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
                  Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int)
              sort order: +
              Map-reduce partition columns: _col3 (type: int)
              Statistics: Num rows: 686001671 Data size: 35672087090 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string)
          TableScan
            alias: cd1
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
          Statistics: Num rows: 754601854 Data size: 39239296649 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-185
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col18 (type: int)
                1 _col0 (type: int)

  Stage: Stage-135
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25
                  Statistics: Num rows: 623637870 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col18 (type: int)
              sort order: +
              Map-reduce partition columns: _col18 (type: int)
              Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col23 (type: int)
          TableScan
            alias: d3
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col18 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col23, _col25
          Statistics: Num rows: 623637870 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-187
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)

  Stage: Stage-138
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col23
                  Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col19 (type: int)
              sort order: +
              Map-reduce partition columns: _col19 (type: int)
              Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col18 (type: int)
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col19 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col23
          Statistics: Num rows: 566943506 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-189
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-141
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col15 (type: int), _col16 (type: int), _col17 (type: int), _col18 (type: int), _col19 (type: int)
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 515403177 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-191
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-144
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 425953021 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: float), _col10 (type: float), _col11 (type: float)
          TableScan
            alias: customer
            Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4277191 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 468548333 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-72
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_order_number is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_ext_list_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_order_number is not null and cr_item_sk is not null) (type: boolean)
              Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_refunded_cash (type: float), cr_reversed_charge (type: float), cr_store_credit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 46218554 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float), _col4 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col5, _col6, _col7
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col2 (type: float), ((_col5 + _col6) + _col7) (type: float)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-73
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 522691112 Data size: 8363057794 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > (2.0 * _col2)) (type: boolean)
            Statistics: Num rows: 174230370 Data size: 2787685920 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 174230370 Data size: 2787685920 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query65.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage , consists of Stage-27, Stage-5
  Stage-27 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-27
  Stage-6 depends on stages: Stage-5, Stage-18
  Stage-17 depends on stages: Stage-6 , consists of Stage-24, Stage-25, Stage-26, Stage-1
  Stage-24 has a backup stage: Stage-1
  Stage-14 depends on stages: Stage-24
  Stage-13 depends on stages: Stage-1, Stage-9, Stage-14, Stage-15, Stage-16 , consists of Stage-22, Stage-23, Stage-2
  Stage-22 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-22
  Stage-3 depends on stages: Stage-2, Stage-11, Stage-12
  Stage-23 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-23
  Stage-2
  Stage-25 has a backup stage: Stage-1
  Stage-15 depends on stages: Stage-25
  Stage-26 has a backup stage: Stage-1
  Stage-16 depends on stages: Stage-26
  Stage-1
  Stage-5
  Stage-21 is a root stage , consists of Stage-28, Stage-8
  Stage-28 has a backup stage: Stage-8
  Stage-20 depends on stages: Stage-28
  Stage-9 depends on stages: Stage-8, Stage-20
  Stage-8
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-19
    Conditional Operator

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1212 AND 1223 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: int), _col1 (type: int), _col3 (type: float)
                    outputColumnNames: _col2, _col1, _col3
                    Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col2 (type: int), _col1 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 692173659 Data size: 11074778548 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col2 (type: double)
            outputColumnNames: _col1, _col2
            Statistics: Num rows: 692173659 Data size: 11074778548 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col2)
              keys: _col1 (type: int)
              mode: complete
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 346086829 Data size: 5537389266 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: int), _col1 (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 346086829 Data size: 5537389266 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
        $hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string), i_current_price (type: float), i_wholesale_cost (type: float), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 
                    1 
                    2 

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 0 to 2
                  keys:
                    0 
                    1 
                    2 
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 10532555640834975 Data size: 3509818757511168055 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col11
              Statistics: Num rows: 11585811456034168 Data size: 3860800716942884864 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col11 <= (0.1 * _col8)) (type: boolean)
                Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col3 (type: string), _col11 (type: double), _col4 (type: float), _col5 (type: float), _col6 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: float), _col4 (type: float), _col5 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: float), VALUE._col2 (type: float), VALUE._col3 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 33300 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 33300 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col11
              Statistics: Num rows: 11585811456034168 Data size: 3860800716942884864 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col11 <= (0.1 * _col8)) (type: boolean)
                Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col3 (type: string), _col11 (type: double), _col4 (type: float), _col5 (type: float), _col6 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col2 (type: int), _col7 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col2 (type: int), _col7 (type: int)
              Statistics: Num rows: 10532555640834975 Data size: 3509818757511168055 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col3 (type: string), _col4 (type: float), _col5 (type: float), _col6 (type: string), _col8 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col0 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col0 (type: int)
              Statistics: Num rows: 692173659 Data size: 11074778548 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
            1 _col0 (type: int), _col1 (type: int), _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col11
          Statistics: Num rows: 11585811456034168 Data size: 3860800716942884864 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col11 <= (0.1 * _col8)) (type: boolean)
            Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col3 (type: string), _col11 (type: double), _col4 (type: float), _col5 (type: float), _col6 (type: string)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 3861937152011389 Data size: 1286933572314294784 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
        $hdt$_0:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 
                    1 
                    2 

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string), i_current_price (type: float), i_wholesale_cost (type: float), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 0 to 2
                  keys:
                    0 
                    1 
                    2 
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 10532555640834975 Data size: 3509818757511168055 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:store 
          Fetch Operator
            limit: -1
        $hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 
                    1 
                    2 
        $hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string), i_current_price (type: float), i_wholesale_cost (type: float), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 
                    1 
                    2 

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 
                1 
                2 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
              Statistics: Num rows: 10532555640834975 Data size: 3509818757511168055 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  sort order: 
                  Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string), i_current_price (type: float), i_wholesale_cost (type: float), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  sort order: 
                  Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: string), _col2 (type: float), _col3 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 346086829 Data size: 5537389266 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 
            1 
            2 
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 10532555640834975 Data size: 3509818757511168055 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1212 AND 1223 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: int), _col1 (type: int), _col3 (type: float)
            outputColumnNames: _col2, _col1, _col3
            Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col2 (type: int), _col1 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1212 AND 1223 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: int), _col1 (type: int), _col3 (type: float)
                    outputColumnNames: _col2, _col1, _col3
                    Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col2 (type: int), _col1 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 692173659 Data size: 11074778548 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1212 AND 1223 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: int), _col1 (type: int), _col3 (type: float)
            outputColumnNames: _col2, _col1, _col3
            Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col2 (type: int), _col1 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query66.sql
STAGE DEPENDENCIES:
  Stage-36 is a root stage
  Stage-26 depends on stages: Stage-36
  Stage-25 depends on stages: Stage-26 , consists of Stage-34, Stage-35, Stage-2
  Stage-34 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-34
  Stage-33 depends on stages: Stage-2, Stage-23, Stage-24
  Stage-5 depends on stages: Stage-33
  Stage-6 depends on stages: Stage-5, Stage-16
  Stage-7 depends on stages: Stage-6
  Stage-35 has a backup stage: Stage-2
  Stage-24 depends on stages: Stage-35
  Stage-2
  Stage-40 is a root stage
  Stage-32 depends on stages: Stage-40
  Stage-31 depends on stages: Stage-32 , consists of Stage-38, Stage-39, Stage-13
  Stage-38 has a backup stage: Stage-13
  Stage-29 depends on stages: Stage-38
  Stage-37 depends on stages: Stage-13, Stage-29, Stage-30
  Stage-16 depends on stages: Stage-37
  Stage-39 has a backup stage: Stage-13
  Stage-30 depends on stages: Stage-39
  Stage-13
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 1 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 1 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string), w_warehouse_sq_ft (type: int), w_city (type: string), w_county (type: string), w_state (type: string), w_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 1 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_warehouse_sk is not null and ws_sold_date_sk is not null and ws_sold_time_sk is not null and ws_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_sold_time_sk (type: int), ws_ship_mode_sk (type: int), ws_warehouse_sk (type: int), ws_quantity (type: int), ws_sales_price (type: float), ws_net_paid_inc_tax (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13
                  Statistics: Num rows: 298852571 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
              Statistics: Num rows: 328737835 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:ship_mode 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 638472 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_time BETWEEN 49530 AND 78330 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:ship_mode 
          TableScan
            alias: ship_mode
            Statistics: Num rows: 10 Data size: 1113 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((sm_carrier) IN ('DIAMOND', 'AIRBORNE') and sm_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 5 Data size: 556 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sm_ship_mode_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 5 Data size: 556 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
              Statistics: Num rows: 361611626 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                Statistics: Num rows: 397772797 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col8 (type: string), _col9 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string), CASE WHEN ((_col16 = 1)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 1)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                  Statistics: Num rows: 397772797 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29)
                    keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                    Statistics: Num rows: 397772797 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                      Statistics: Num rows: 397772797 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
          Statistics: Num rows: 198886398 Data size: 5568819181 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), (_col6 / UDFToDouble(_col1)) (type: double), (_col7 / UDFToDouble(_col1)) (type: double), (_col8 / UDFToDouble(_col1)) (type: double), (_col9 / UDFToDouble(_col1)) (type: double), (_col10 / UDFToDouble(_col1)) (type: double), (_col11 / UDFToDouble(_col1)) (type: double), (_col12 / UDFToDouble(_col1)) (type: double), (_col13 / UDFToDouble(_col1)) (type: double), (_col14 / UDFToDouble(_col1)) (type: double), (_col15 / UDFToDouble(_col1)) (type: double), (_col16 / UDFToDouble(_col1)) (type: double), (_col17 / UDFToDouble(_col1)) (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29), sum(_col30), sum(_col31), sum(_col32), sum(_col33), sum(_col34), sum(_col35), sum(_col36), sum(_col37), sum(_col38), sum(_col39), sum(_col40), sum(_col41)
                  keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                  Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double)
          TableScan
            Union
              Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), (_col6 / UDFToDouble(_col1)) (type: double), (_col7 / UDFToDouble(_col1)) (type: double), (_col8 / UDFToDouble(_col1)) (type: double), (_col9 / UDFToDouble(_col1)) (type: double), (_col10 / UDFToDouble(_col1)) (type: double), (_col11 / UDFToDouble(_col1)) (type: double), (_col12 / UDFToDouble(_col1)) (type: double), (_col13 / UDFToDouble(_col1)) (type: double), (_col14 / UDFToDouble(_col1)) (type: double), (_col15 / UDFToDouble(_col1)) (type: double), (_col16 / UDFToDouble(_col1)) (type: double), (_col17 / UDFToDouble(_col1)) (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29), sum(_col30), sum(_col31), sum(_col32), sum(_col33), sum(_col34), sum(_col35), sum(_col36), sum(_col37), sum(_col38), sum(_col39), sum(_col40), sum(_col41)
                  keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                  Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    Statistics: Num rows: 596430348 Data size: 16700049828 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23), sum(VALUE._col24), sum(VALUE._col25), sum(VALUE._col26), sum(VALUE._col27), sum(VALUE._col28), sum(VALUE._col29), sum(VALUE._col30), sum(VALUE._col31), sum(VALUE._col32), sum(VALUE._col33), sum(VALUE._col34), sum(VALUE._col35)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
          Statistics: Num rows: 298215174 Data size: 8350024914 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: int), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col2 (type: string), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col3 (type: string), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col4 (type: string), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double), _col5 (type: string), _col6 (type: double), _col7 (type: double)
            outputColumnNames: _col0, _col1, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col2, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col3, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col4, _col40, _col41, _col42, _col43, _col5, _col8, _col9
            Statistics: Num rows: 298215174 Data size: 8350024914 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 298215174 Data size: 8350024914 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double), _col42 (type: double), _col43 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: int), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: string), 'DIAMOND,AIRBORNE' (type: string), 2002 (type: int), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: double), VALUE._col20 (type: double), VALUE._col21 (type: double), VALUE._col22 (type: double), VALUE._col23 (type: double), VALUE._col24 (type: double), VALUE._col25 (type: double), VALUE._col26 (type: double), VALUE._col27 (type: double), VALUE._col28 (type: double), VALUE._col29 (type: double), VALUE._col30 (type: double), VALUE._col31 (type: double), VALUE._col32 (type: double), VALUE._col33 (type: double), VALUE._col34 (type: double), VALUE._col35 (type: double), VALUE._col36 (type: double), VALUE._col37 (type: double), VALUE._col38 (type: double), VALUE._col39 (type: double), VALUE._col40 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41, _col42, _col43
          Statistics: Num rows: 298215174 Data size: 8350024914 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2800 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2800 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                  Statistics: Num rows: 328737835 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 298852571 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col8 (type: string), _col9 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
          Statistics: Num rows: 328737835 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 1 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 1 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string), w_warehouse_sq_ft (type: int), w_city (type: string), w_county (type: string), w_state (type: string), w_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 1 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 543055689 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is not null and cs_sold_date_sk is not null and cs_sold_time_sk is not null and cs_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 543055689 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_sold_time_sk (type: int), cs_ship_mode_sk (type: int), cs_warehouse_sk (type: int), cs_quantity (type: int), cs_ext_sales_price (type: float), cs_net_paid_inc_ship_tax (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 543055689 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13
                  Statistics: Num rows: 597361270 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
              Statistics: Num rows: 657097411 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:ship_mode 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 638472 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_time BETWEEN 49530 AND 78330 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:ship_mode 
          TableScan
            alias: ship_mode
            Statistics: Num rows: 10 Data size: 1113 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((sm_carrier) IN ('DIAMOND', 'AIRBORNE') and sm_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 5 Data size: 556 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sm_ship_mode_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 5 Data size: 556 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
              Statistics: Num rows: 722807167 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                Statistics: Num rows: 795087900 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col8 (type: string), _col9 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string), CASE WHEN ((_col16 = 1)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col5 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 1)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col6 * UDFToFloat(_col4))) ELSE (0) END (type: float)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                  Statistics: Num rows: 795087900 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29)
                    keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                    Statistics: Num rows: 795087900 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                      Statistics: Num rows: 795087900 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
          Statistics: Num rows: 397543950 Data size: 11131230647 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                  Statistics: Num rows: 657097411 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 597361270 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col8 (type: string), _col9 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13, _col16
          Statistics: Num rows: 657097411 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query67.sql
STAGE DEPENDENCIES:
  Stage-15 is a root stage , consists of Stage-19, Stage-1
  Stage-19 has a backup stage: Stage-1
  Stage-14 depends on stages: Stage-19
  Stage-18 depends on stages: Stage-1, Stage-14
  Stage-13 depends on stages: Stage-18
  Stage-12 depends on stages: Stage-13 , consists of Stage-16, Stage-17, Stage-3
  Stage-16 has a backup stage: Stage-3
  Stage-10 depends on stages: Stage-16
  Stage-4 depends on stages: Stage-3, Stage-10, Stage-11
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5
  Stage-17 has a backup stage: Stage-3
  Stage-11 depends on stages: Stage-17
  Stage-3
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-15
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 515871 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 57319 Data size: 1146382 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_moy (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col2, _col3, _col4
                Statistics: Num rows: 57319 Data size: 1146382 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col7, _col8, _col9
                  Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col7, _col8, _col9, _col11
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col7, _col8, _col9, _col11, _col13, _col14, _col15, _col16
              Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col15 (type: string), _col14 (type: string), _col13 (type: string), _col16 (type: string), _col7 (type: int), _col9 (type: int), _col8 (type: int), _col11 (type: string), COALESCE((_col4 * UDFToFloat(_col3)),0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col8)
                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), 0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 12060434340 Data size: 241208687412 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: int)
              sort order: +++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: int)
              Statistics: Num rows: 12060434340 Data size: 241208687412 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col9 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int), KEY._col5 (type: int), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9
          Statistics: Num rows: 6030217170 Data size: 120604343706 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col9 (type: double), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string)
            outputColumnNames: _col0, _col1, _col16, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 6030217170 Data size: 120604343706 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col16 (type: double)
              sort order: +-
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 6030217170 Data size: 120604343706 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col16
          Statistics: Num rows: 6030217170 Data size: 120604343706 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: int, _col5: int, _col6: int, _col7: string, _col16: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col16 DESC NULLS LAST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: _col16
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 6030217170 Data size: 120604343706 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (rank_window_0 <= 100) (type: boolean)
              Statistics: Num rows: 2010072390 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col16 (type: double), rank_window_0 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 2010072390 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: double), _col9 (type: int)
              sort order: ++++++++++
              Statistics: Num rows: 2010072390 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey6 (type: int), KEY.reducesinkkey7 (type: string), KEY.reducesinkkey8 (type: double), KEY.reducesinkkey9 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 2010072390 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col7, _col8, _col9, _col11, _col13, _col14, _col15, _col16
                  Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col15 (type: string), _col14 (type: string), _col13 (type: string), _col16 (type: string), _col7 (type: int), _col9 (type: int), _col8 (type: int), _col11 (type: string), COALESCE((_col4 * UDFToFloat(_col3)),0) (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col8)
                      keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), 0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                      Statistics: Num rows: 12060434340 Data size: 241208687412 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1218225665 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col11 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 43279 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col7, _col8, _col9, _col11, _col13, _col14, _col15, _col16
          Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col15 (type: string), _col14 (type: string), _col13 (type: string), _col16 (type: string), _col7 (type: int), _col9 (type: int), _col8 (type: int), _col11 (type: string), COALESCE((_col4 * UDFToFloat(_col3)),0) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
            Statistics: Num rows: 1340048260 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col8)
              keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), 0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 12060434340 Data size: 241208687412 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1006798028 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 515871 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 57319 Data size: 1146382 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_moy (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col2, _col3, _col4
                Statistics: Num rows: 57319 Data size: 1146382 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 57319 Data size: 1146382 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col7, _col8, _col9
          Statistics: Num rows: 1107477854 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query68.sql
STAGE DEPENDENCIES:
  Stage-27 is a root stage , consists of Stage-35, Stage-1
  Stage-35 has a backup stage: Stage-1
  Stage-26 depends on stages: Stage-35
  Stage-34 depends on stages: Stage-1, Stage-26
  Stage-24 depends on stages: Stage-34
  Stage-23 depends on stages: Stage-24 , consists of Stage-32, Stage-33, Stage-4
  Stage-32 has a backup stage: Stage-4
  Stage-21 depends on stages: Stage-32
  Stage-5 depends on stages: Stage-4, Stage-21, Stage-22
  Stage-20 depends on stages: Stage-5 , consists of Stage-30, Stage-31, Stage-6
  Stage-30 has a backup stage: Stage-6
  Stage-18 depends on stages: Stage-30
  Stage-17 depends on stages: Stage-6, Stage-18, Stage-19 , consists of Stage-28, Stage-29, Stage-7
  Stage-28 has a backup stage: Stage-7
  Stage-15 depends on stages: Stage-28
  Stage-8 depends on stages: Stage-7, Stage-15, Stage-16
  Stage-29 has a backup stage: Stage-7
  Stage-16 depends on stages: Stage-29
  Stage-7
  Stage-31 has a backup stage: Stage-6
  Stage-19 depends on stages: Stage-31
  Stage-6
  Stage-33 has a backup stage: Stage-4
  Stage-22 depends on stages: Stage-33
  Stage-4
  Stage-1
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-27
    Conditional Operator

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and d_dom BETWEEN 1 AND 2 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_ext_sales_price (type: float), ss_ext_list_price (type: float), ss_ext_tax (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 553738927 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_city) IN ('Rosedale', 'Bethlehem') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 4) or (hd_vehicle_count = 2)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 12636 Data size: 151640 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 12636 Data size: 151640 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7, _col8
              Statistics: Num rows: 609112832 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col8
                Statistics: Num rows: 670024129 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col8, _col18
              Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col18 (type: string), _col6 (type: float), _col7 (type: float), _col8 (type: float)
                outputColumnNames: _col1, _col3, _col5, _col18, _col6, _col7, _col8
                Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col6), sum(_col7), sum(_col8)
                  keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col18 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
              Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 368513278 Data size: 14740531196 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: bigint), _col0 (type: int), _col3 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 368513278 Data size: 14740531196 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col8, _col9
              Statistics: Num rows: 405364614 Data size: 16214584667 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:current_addr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:current_addr 
          TableScan
            alias: current_addr
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col8, _col9, _col11
              Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col11 <> _col2) (type: boolean)
                Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col9 (type: string), _col8 (type: string), _col11 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col5 (type: double), _col4 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col4 (type: bigint)
              sort order: ++
              Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col5 (type: double), _col6 (type: double), _col7 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey1 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 4000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 4000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: current_addr
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col8, _col9, _col11
                  Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (_col11 <> _col2) (type: boolean)
                    Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col9 (type: string), _col8 (type: string), _col11 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col5 (type: double), _col4 (type: double)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: int)
              sort order: +
              Map-reduce partition columns: _col7 (type: int)
              Statistics: Num rows: 405364614 Data size: 16214584667 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col8 (type: string), _col9 (type: string)
          TableScan
            alias: current_addr
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col8, _col9, _col11
          Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col11 <> _col2) (type: boolean)
            Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col9 (type: string), _col8 (type: string), _col11 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col5 (type: double), _col4 (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 445901085 Data size: 17836043520 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col8, _col9
                  Statistics: Num rows: 405364614 Data size: 16214584667 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 368513278 Data size: 14740531196 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 493522 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col8, _col9
          Statistics: Num rows: 405364614 Data size: 16214584667 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col8, _col18
                  Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col18 (type: string), _col6 (type: float), _col7 (type: float), _col8 (type: float)
                    outputColumnNames: _col1, _col3, _col5, _col18, _col6, _col7, _col8
                    Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col6), sum(_col7), sum(_col8)
                      keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col18 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int)
              sort order: +
              Map-reduce partition columns: _col3 (type: int)
              Statistics: Num rows: 670024129 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col5 (type: bigint), _col6 (type: float), _col7 (type: float), _col8 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col8, _col18
          Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col18 (type: string), _col6 (type: float), _col7 (type: float), _col8 (type: float)
            outputColumnNames: _col1, _col3, _col5, _col18, _col6, _col7, _col8
            Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col6), sum(_col7), sum(_col8)
              keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col18 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 737026557 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_ext_sales_price (type: float), ss_ext_list_price (type: float), ss_ext_tax (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 503399014 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: bigint), _col6 (type: float), _col7 (type: float), _col8 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and d_dom BETWEEN 1 AND 2 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 553738927 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query70.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage , consists of Stage-26, Stage-1
  Stage-26 has a backup stage: Stage-1
  Stage-18 depends on stages: Stage-26
  Stage-25 depends on stages: Stage-1, Stage-18
  Stage-17 depends on stages: Stage-25
  Stage-16 depends on stages: Stage-12, Stage-17 , consists of Stage-24, Stage-3
  Stage-24 has a backup stage: Stage-3
  Stage-15 depends on stages: Stage-24
  Stage-4 depends on stages: Stage-3, Stage-15
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5
  Stage-3
  Stage-1
  Stage-29 is a root stage
  Stage-23 depends on stages: Stage-29
  Stage-22 depends on stages: Stage-23 , consists of Stage-27, Stage-28, Stage-10
  Stage-27 has a backup stage: Stage-10
  Stage-20 depends on stages: Stage-27
  Stage-11 depends on stages: Stage-10, Stage-20, Stage-21
  Stage-12 depends on stages: Stage-11
  Stage-28 has a backup stage: Stage-10
  Stage-21 depends on stages: Stage-28
  Stage-10
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-19
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_store_sk (type: int), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:s 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:s 
          TableScan
            alias: s
            Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_state is not null) (type: boolean)
              Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_county (type: string), s_state (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col6, _col7
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: string)
                1 _col0 (type: string)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Semi Join 0 to 1
              keys:
                0 _col7 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col6, _col7
              Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col2 (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 6700241310 Data size: 80402895804 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 6700241310 Data size: 80402895804 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col3 (type: double), _col2 (type: int)
            outputColumnNames: _col0, _col1, _col4, _col5
            Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int), CASE WHEN ((_col5 = 2)) THEN (_col0) ELSE (null) END (type: string), _col4 (type: double)
              sort order: +++
              Map-reduce partition columns: _col5 (type: int), CASE WHEN ((_col5 = 2)) THEN (_col0) ELSE (null) END (type: string)
              Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey0 (type: int)
          outputColumnNames: _col0, _col1, _col4, _col5
          Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col4: double, _col5: int
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col4 ASC NULLS FIRST
                  partition by: _col5, CASE WHEN ((_col5 = 2)) THEN (_col0) ELSE (null) END
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: _col4
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col4 (type: double), _col0 (type: string), _col1 (type: string), _col5 (type: int), rank_window_0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int), CASE WHEN ((_col3 = 0)) THEN (_col1) ELSE (null) END (type: string), _col4 (type: int)
              sort order: -++
              Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: double), _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: double), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: int), KEY.reducesinkkey2 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 3350120655 Data size: 40201447902 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: string)
              sort order: +
              Map-reduce partition columns: _col7 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col6 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col7 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col6, _col7
          Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col2 (type: float)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 6700241310 Data size: 80402895804 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_store_sk (type: int), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: float)
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_4:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_state is not null) (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_store_sk (type: int), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_5:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_5:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: float)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double)
              sort order: +-
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col1 DESC NULLS LAST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: _col1
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (rank_window_0 <= 5) (type: boolean)
              Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string)
                outputColumnNames: _col0
                Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 338396018 Data size: 4060752219 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col4 (type: string), _col2 (type: float)
                    outputColumnNames: _col4, _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col4 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: float)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query71.sql
STAGE DEPENDENCIES:
  Stage-18 is a root stage , consists of Stage-26, Stage-5
  Stage-26 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-26
  Stage-16 depends on stages: Stage-5, Stage-8, Stage-10, Stage-17, Stage-19, Stage-21 , consists of Stage-24, Stage-25, Stage-1
  Stage-24 has a backup stage: Stage-1
  Stage-14 depends on stages: Stage-24
  Stage-23 depends on stages: Stage-1, Stage-14, Stage-15
  Stage-3 depends on stages: Stage-23
  Stage-4 depends on stages: Stage-3
  Stage-25 has a backup stage: Stage-1
  Stage-15 depends on stages: Stage-25
  Stage-1
  Stage-5
  Stage-20 is a root stage , consists of Stage-27, Stage-8
  Stage-27 has a backup stage: Stage-8
  Stage-19 depends on stages: Stage-27
  Stage-8
  Stage-22 is a root stage , consists of Stage-28, Stage-10
  Stage-28 has a backup stage: Stage-10
  Stage-21 depends on stages: Stage-28
  Stage-10
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-18
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_item_sk is not null and ws_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_sold_time_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: float), _col2 (type: int), _col1 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        hdfs://dc1master:9000/tmp/hive/wentingt/108991a2-4b3f-43ac-96a3-5c90dae7462e/hive_2018-02-11_16-39-09_376_3345775903460197058-1/-mr-10007 
          Fetch Operator
            limit: -1
        hdfs://dc1master:9000/tmp/hive/wentingt/108991a2-4b3f-43ac-96a3-5c90dae7462e/hive_2018-02-11_16-39-09_376_3345775903460197058-1/-mr-10008 
          Fetch Operator
            limit: -1
        hdfs://dc1master:9000/tmp/hive/wentingt/108991a2-4b3f-43ac-96a3-5c90dae7462e/hive_2018-02-11_16-39-09_376_3345775903460197058-1/-mr-10009 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        hdfs://dc1master:9000/tmp/hive/wentingt/108991a2-4b3f-43ac-96a3-5c90dae7462e/hive_2018-02-11_16-39-09_376_3345775903460197058-1/-mr-10007 
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: int)
                  1 _col1 (type: int)
        hdfs://dc1master:9000/tmp/hive/wentingt/108991a2-4b3f-43ac-96a3-5c90dae7462e/hive_2018-02-11_16-39-09_376_3345775903460197058-1/-mr-10008 
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: int)
                  1 _col1 (type: int)
        hdfs://dc1master:9000/tmp/hive/wentingt/108991a2-4b3f-43ac-96a3-5c90dae7462e/hive_2018-02-11_16-39-09_376_3345775903460197058-1/-mr-10009 
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: int)
                  1 _col1 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col1, _col2, _col4, _col6
                  Statistics: Num rows: 3247993768 Data size: 51967900327 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:time_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 45605 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((t_meal_time = 'breakfast') or (t_meal_time = 'dinner')) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 45604 Data size: 5107667 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int), t_hour (type: int), t_minute (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 45604 Data size: 5107667 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col4, _col8, _col9
              Statistics: Num rows: 3572793222 Data size: 57164691598 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: string), _col8 (type: int), _col9 (type: int), _col4 (type: float)
                outputColumnNames: _col1, _col2, _col8, _col9, _col4
                Statistics: Num rows: 3572793222 Data size: 57164691598 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col1 (type: int), _col2 (type: string), _col8 (type: int), _col9 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 3572793222 Data size: 57164691598 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: string), _col2 (type: int), _col3 (type: int)
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: string), _col2 (type: int), _col3 (type: int)
                    Statistics: Num rows: 3572793222 Data size: 57164691598 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string), KEY._col2 (type: int), KEY._col3 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 1786396611 Data size: 28582345799 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: double), _col0 (type: int)
              sort order: -+
              Statistics: Num rows: 1786396611 Data size: 28582345799 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: string), VALUE._col1 (type: int), VALUE._col2 (type: int), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 1786396611 Data size: 28582345799 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1786396611 Data size: 28582345799 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:item 
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col1 (type: int)
                outputColumnNames: _col1, _col2, _col4, _col6
                Statistics: Num rows: 3247993768 Data size: 51967900327 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col1 (type: int)
                outputColumnNames: _col1, _col2, _col4, _col6
                Statistics: Num rows: 3247993768 Data size: 51967900327 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col1 (type: int)
                outputColumnNames: _col1, _col2, _col4, _col6
                Statistics: Num rows: 3247993768 Data size: 51967900327 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 156115 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 78057 Data size: 8742384 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string)
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col1 (type: int)
                sort order: +
                Map-reduce partition columns: _col1 (type: int)
                Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
                value expressions: _col0 (type: float), _col2 (type: int)
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col1 (type: int)
                sort order: +
                Map-reduce partition columns: _col1 (type: int)
                Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
                value expressions: _col0 (type: float), _col2 (type: int)
          TableScan
            Union
              Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col1 (type: int)
                sort order: +
                Map-reduce partition columns: _col1 (type: int)
                Statistics: Num rows: 2952721544 Data size: 47243544728 Basic stats: COMPLETE Column stats: NONE
                value expressions: _col0 (type: float), _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col1, _col2, _col4, _col6
          Statistics: Num rows: 3247993768 Data size: 51967900327 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_item_sk is not null and ws_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_sold_time_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col3 (type: float), _col2 (type: int), _col1 (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 522992001 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_item_sk is not null and cs_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_sold_time_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: float), _col2 (type: int), _col1 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_item_sk is not null and cs_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_sold_time_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col3 (type: float), _col2 (type: int), _col1 (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1045382224 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_sold_time_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: float), _col2 (type: int), _col1 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_sold_time_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col3 (type: float), _col2 (type: int), _col1 (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query72.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-56 depends on stages: Stage-1
  Stage-42 depends on stages: Stage-56
  Stage-41 depends on stages: Stage-42 , consists of Stage-54, Stage-55, Stage-3
  Stage-54 has a backup stage: Stage-3
  Stage-39 depends on stages: Stage-54
  Stage-38 depends on stages: Stage-3, Stage-39, Stage-40 , consists of Stage-52, Stage-53, Stage-4
  Stage-52 has a backup stage: Stage-4
  Stage-36 depends on stages: Stage-52
  Stage-51 depends on stages: Stage-4, Stage-36, Stage-37
  Stage-35 depends on stages: Stage-51
  Stage-34 depends on stages: Stage-35 , consists of Stage-49, Stage-50, Stage-6
  Stage-49 has a backup stage: Stage-6
  Stage-32 depends on stages: Stage-49
  Stage-31 depends on stages: Stage-6, Stage-32, Stage-33 , consists of Stage-47, Stage-48, Stage-7
  Stage-47 has a backup stage: Stage-7
  Stage-29 depends on stages: Stage-47
  Stage-28 depends on stages: Stage-7, Stage-29, Stage-30 , consists of Stage-45, Stage-46, Stage-8
  Stage-45 has a backup stage: Stage-8
  Stage-26 depends on stages: Stage-45
  Stage-44 depends on stages: Stage-8, Stage-26, Stage-27
  Stage-25 depends on stages: Stage-44
  Stage-24 depends on stages: Stage-25 , consists of Stage-43, Stage-10
  Stage-43 has a backup stage: Stage-10
  Stage-23 depends on stages: Stage-43
  Stage-11 depends on stages: Stage-10, Stage-23
  Stage-12 depends on stages: Stage-11
  Stage-10
  Stage-46 has a backup stage: Stage-8
  Stage-27 depends on stages: Stage-46
  Stage-8
  Stage-48 has a backup stage: Stage-7
  Stage-30 depends on stages: Stage-48
  Stage-7
  Stage-50 has a backup stage: Stage-6
  Stage-33 depends on stages: Stage-50
  Stage-6
  Stage-53 has a backup stage: Stage-4
  Stage-37 depends on stages: Stage-53
  Stage-4
  Stage-55 has a backup stage: Stage-3
  Stage-40 depends on stages: Stage-55
  Stage-3
  Stage-0 depends on stages: Stage-12

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_bill_cdemo_sk is not null and cs_bill_hdemo_sk is not null and cs_sold_date_sk is not null and cs_ship_date_sk is not null) (type: boolean)
              Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_ship_date_sk (type: int), cs_bill_cdemo_sk (type: int), cs_bill_hdemo_sk (type: int), cs_item_sk (type: int), cs_promo_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col4 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col4 (type: int)
                  Statistics: Num rows: 422376647 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: bigint), _col7 (type: int)
          TableScan
            alias: inventory
            Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 72806832 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col10, _col11
          Statistics: Num rows: 464614321 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col11 < _col7) (type: boolean)
            Statistics: Num rows: 154871440 Data size: 5575371850 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: int), _col10 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col8 (type: int)
              outputColumnNames: _col0, _col1, _col10, _col2, _col3, _col4, _col5, _col6, _col8
              Statistics: Num rows: 154871440 Data size: 5575371850 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-56
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7 Data size: 826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col10 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col8, _col13
              Statistics: Num rows: 170358587 Data size: 6132909167 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-41
    Conditional Operator

  Stage: Stage-54
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col8, _col13, _col15
              Statistics: Num rows: 187394449 Data size: 6746200229 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-38
    Conditional Operator

  Stage: Stage-52
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:customer_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col13, _col15
              Statistics: Num rows: 206133898 Data size: 7420820412 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-51
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 1458 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_buy_potential = '1001-5000') and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 729 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 729 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col5, _col6, _col8, _col13, _col15
              Statistics: Num rows: 226747292 Data size: 8162902630 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-34
    Conditional Operator

  Stage: Stage-49
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_5:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_5:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 92119 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col6, _col8, _col13, _col15, _col21, _col22
              Statistics: Num rows: 249422026 Data size: 8979193087 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Conditional Operator

  Stage: Stage-47
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_6:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_6:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col22 (type: int), _col8 (type: int)
                    1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col22 (type: int), _col8 (type: int)
                1 _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col1, _col4, _col5, _col6, _col13, _col15, _col21, _col22
              Statistics: Num rows: 274364234 Data size: 9877112609 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Conditional Operator

  Stage: Stage-45
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_7:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_7:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col13, _col15, _col21, _col22, _col27
              Statistics: Num rows: 301800663 Data size: 10864824105 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col27) > (UDFToDouble(_col21) + 5.0)) (type: boolean)
                Statistics: Num rows: 100600221 Data size: 3621608035 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col13 (type: string), _col15 (type: string), _col22 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint)
                  outputColumnNames: _col13, _col15, _col22, _col4, _col5, _col6
                  Statistics: Num rows: 100600221 Data size: 3621608035 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-44
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: p_promo_sk (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 16221 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col5 (type: int)
                  1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col6, _col13, _col15, _col22, _col28
              Statistics: Num rows: 110660245 Data size: 3983768924 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:catalog_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:catalog_returns 
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int), _col6 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col4 (type: int), _col6 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col13, _col15, _col22, _col28
              Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col15 (type: string), _col13 (type: string), _col22 (type: int), CASE WHEN (_col28 is null) THEN (1) ELSE (0) END (type: int), CASE WHEN (_col28 is not null) THEN (1) ELSE (0) END (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(_col3), count(_col4), count()
                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 60863136 Data size: 2191072955 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint), _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: -+++
              Statistics: Num rows: 60863136 Data size: 2191072955 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 60863136 Data size: 2191072955 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int), _col6 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col4 (type: int), _col6 (type: bigint)
              Statistics: Num rows: 110660245 Data size: 3983768924 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col13 (type: string), _col15 (type: string), _col22 (type: int), _col28 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col4 (type: int), _col6 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col13, _col15, _col22, _col28
          Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col15 (type: string), _col13 (type: string), _col22 (type: int), CASE WHEN (_col28 is null) THEN (1) ELSE (0) END (type: int), CASE WHEN (_col28 is not null) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(_col3), count(_col4), count()
              keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 121726272 Data size: 4382145911 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-46
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d3
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col5, _col6, _col13, _col15, _col21, _col22, _col27
                  Statistics: Num rows: 301800663 Data size: 10864824105 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (UDFToDouble(_col27) > (UDFToDouble(_col21) + 5.0)) (type: boolean)
                    Statistics: Num rows: 100600221 Data size: 3621608035 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col13 (type: string), _col15 (type: string), _col22 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint)
                      outputColumnNames: _col13, _col15, _col22, _col4, _col5, _col6
                      Statistics: Num rows: 100600221 Data size: 3621608035 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 274364234 Data size: 9877112609 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col13 (type: string), _col15 (type: string), _col21 (type: string), _col22 (type: int)
          TableScan
            alias: d3
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col5, _col6, _col13, _col15, _col21, _col22, _col27
          Statistics: Num rows: 301800663 Data size: 10864824105 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (UDFToDouble(_col27) > (UDFToDouble(_col21) + 5.0)) (type: boolean)
            Statistics: Num rows: 100600221 Data size: 3621608035 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col13 (type: string), _col15 (type: string), _col22 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint)
              outputColumnNames: _col13, _col15, _col22, _col4, _col5, _col6
              Statistics: Num rows: 100600221 Data size: 3621608035 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col22 (type: int), _col8 (type: int)
                1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col22 (type: int), _col8 (type: int)
                    1 _col1 (type: int), _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col6, _col13, _col15, _col21, _col22
                  Statistics: Num rows: 274364234 Data size: 9877112609 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col22 (type: int), _col8 (type: int)
              sort order: ++
              Map-reduce partition columns: _col22 (type: int), _col8 (type: int)
              Statistics: Num rows: 249422026 Data size: 8979193087 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col13 (type: string), _col15 (type: string), _col21 (type: string)
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col0 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col0 (type: int)
                  Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col22 (type: int), _col8 (type: int)
            1 _col1 (type: int), _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col6, _col13, _col15, _col21, _col22
          Statistics: Num rows: 274364234 Data size: 9877112609 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-50
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d1
            Statistics: Num rows: 92119 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col4, _col5, _col6, _col8, _col13, _col15, _col21, _col22
                  Statistics: Num rows: 249422026 Data size: 8979193087 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 226747292 Data size: 8162902630 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col8 (type: int), _col13 (type: string), _col15 (type: string)
          TableScan
            alias: d1
            Statistics: Num rows: 92119 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 46059 Data size: 5158662 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col4, _col5, _col6, _col8, _col13, _col15, _col21, _col22
          Statistics: Num rows: 249422026 Data size: 8979193087 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-53
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col13, _col15
                  Statistics: Num rows: 206133898 Data size: 7420820412 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 187394449 Data size: 6746200229 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col8 (type: int), _col13 (type: string), _col15 (type: string)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 775577 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 387788 Data size: 40329995 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col13, _col15
          Statistics: Num rows: 206133898 Data size: 7420820412 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-55
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col8, _col13, _col15
                  Statistics: Num rows: 187394449 Data size: 6746200229 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 170358587 Data size: 6132909167 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int), _col6 (type: bigint), _col8 (type: int), _col13 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col8, _col13, _col15
          Statistics: Num rows: 187394449 Data size: 6746200229 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query73.sql
STAGE DEPENDENCIES:
  Stage-17 is a root stage , consists of Stage-21, Stage-1
  Stage-21 has a backup stage: Stage-1
  Stage-16 depends on stages: Stage-21
  Stage-20 depends on stages: Stage-1, Stage-16
  Stage-4 depends on stages: Stage-20
  Stage-13 depends on stages: Stage-4 , consists of Stage-18, Stage-19, Stage-5
  Stage-18 has a backup stage: Stage-5
  Stage-11 depends on stages: Stage-18
  Stage-6 depends on stages: Stage-5, Stage-11, Stage-12
  Stage-19 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-19
  Stage-5
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and d_dom BETWEEN 1 AND 2 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4
                  Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_county) IN ('Kittitas County', 'Adams County', 'Richland County', 'Furnas County') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 185 Data size: 19283 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 1354 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_buy_potential = '1001-5000') or (hd_buy_potential = '5001-10000')) and (hd_vehicle_count > 0) and CASE WHEN ((hd_vehicle_count > 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) > 1.0)) ELSE (null) END and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 225 Data size: 25200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 225 Data size: 25200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col4
                Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count()
                  keys: _col1 (type: int), _col4 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: bigint)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                    Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col2 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 558353442 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col0 (type: int), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 558353442 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: _col2 BETWEEN 1 AND 5 (type: boolean)
              Statistics: Num rows: 62039271 Data size: 1488942506 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
              Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint)
              sort order: -
              Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 62039271 Data size: 1488942506 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: bigint)
          TableScan
            alias: customer
            Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 254090 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
          Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 68243199 Data size: 1637836792 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and d_dom BETWEEN 1 AND 2 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 47765 Data size: 573180 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query75.sql
STAGE DEPENDENCIES:
  Stage-50 is a root stage , consists of Stage-91, Stage-1
  Stage-91 has a backup stage: Stage-1
  Stage-49 depends on stages: Stage-91
  Stage-48 depends on stages: Stage-1, Stage-49 , consists of Stage-89, Stage-90, Stage-2
  Stage-89 has a backup stage: Stage-2
  Stage-46 depends on stages: Stage-89
  Stage-45 depends on stages: Stage-2, Stage-46, Stage-47 , consists of Stage-88, Stage-3
  Stage-88 has a backup stage: Stage-3
  Stage-44 depends on stages: Stage-88
  Stage-4 depends on stages: Stage-3, Stage-12, Stage-18, Stage-44, Stage-51, Stage-58
  Stage-43 depends on stages: Stage-4, Stage-25 , consists of Stage-86, Stage-87, Stage-5
  Stage-86 has a backup stage: Stage-5
  Stage-41 depends on stages: Stage-86
  Stage-6 depends on stages: Stage-5, Stage-41, Stage-42
  Stage-87 has a backup stage: Stage-5
  Stage-42 depends on stages: Stage-87
  Stage-5
  Stage-3
  Stage-90 has a backup stage: Stage-2
  Stage-47 depends on stages: Stage-90
  Stage-2
  Stage-1
  Stage-57 is a root stage , consists of Stage-95, Stage-10
  Stage-95 has a backup stage: Stage-10
  Stage-56 depends on stages: Stage-95
  Stage-55 depends on stages: Stage-10, Stage-56 , consists of Stage-93, Stage-94, Stage-11
  Stage-93 has a backup stage: Stage-11
  Stage-53 depends on stages: Stage-93
  Stage-52 depends on stages: Stage-11, Stage-53, Stage-54 , consists of Stage-92, Stage-12
  Stage-92 has a backup stage: Stage-12
  Stage-51 depends on stages: Stage-92
  Stage-12
  Stage-94 has a backup stage: Stage-11
  Stage-54 depends on stages: Stage-94
  Stage-11
  Stage-10
  Stage-64 is a root stage , consists of Stage-99, Stage-16
  Stage-99 has a backup stage: Stage-16
  Stage-63 depends on stages: Stage-99
  Stage-62 depends on stages: Stage-16, Stage-63 , consists of Stage-97, Stage-98, Stage-17
  Stage-97 has a backup stage: Stage-17
  Stage-60 depends on stages: Stage-97
  Stage-59 depends on stages: Stage-17, Stage-60, Stage-61 , consists of Stage-96, Stage-18
  Stage-96 has a backup stage: Stage-18
  Stage-58 depends on stages: Stage-96
  Stage-18
  Stage-98 has a backup stage: Stage-17
  Stage-61 depends on stages: Stage-98
  Stage-17
  Stage-16
  Stage-71 is a root stage , consists of Stage-103, Stage-22
  Stage-103 has a backup stage: Stage-22
  Stage-70 depends on stages: Stage-103
  Stage-69 depends on stages: Stage-22, Stage-70 , consists of Stage-101, Stage-102, Stage-23
  Stage-101 has a backup stage: Stage-23
  Stage-67 depends on stages: Stage-101
  Stage-66 depends on stages: Stage-23, Stage-67, Stage-68 , consists of Stage-100, Stage-24
  Stage-100 has a backup stage: Stage-24
  Stage-65 depends on stages: Stage-100
  Stage-25 depends on stages: Stage-24, Stage-31, Stage-37, Stage-65, Stage-72, Stage-79
  Stage-24
  Stage-102 has a backup stage: Stage-23
  Stage-68 depends on stages: Stage-102
  Stage-23
  Stage-22
  Stage-78 is a root stage , consists of Stage-107, Stage-29
  Stage-107 has a backup stage: Stage-29
  Stage-77 depends on stages: Stage-107
  Stage-76 depends on stages: Stage-29, Stage-77 , consists of Stage-105, Stage-106, Stage-30
  Stage-105 has a backup stage: Stage-30
  Stage-74 depends on stages: Stage-105
  Stage-73 depends on stages: Stage-30, Stage-74, Stage-75 , consists of Stage-104, Stage-31
  Stage-104 has a backup stage: Stage-31
  Stage-72 depends on stages: Stage-104
  Stage-31
  Stage-106 has a backup stage: Stage-30
  Stage-75 depends on stages: Stage-106
  Stage-30
  Stage-29
  Stage-85 is a root stage , consists of Stage-111, Stage-35
  Stage-111 has a backup stage: Stage-35
  Stage-84 depends on stages: Stage-111
  Stage-83 depends on stages: Stage-35, Stage-84 , consists of Stage-109, Stage-110, Stage-36
  Stage-109 has a backup stage: Stage-36
  Stage-81 depends on stages: Stage-109
  Stage-80 depends on stages: Stage-36, Stage-81, Stage-82 , consists of Stage-108, Stage-37
  Stage-108 has a backup stage: Stage-37
  Stage-79 depends on stages: Stage-108
  Stage-37
  Stage-110 has a backup stage: Stage-36
  Stage-82 depends on stages: Stage-110
  Stage-36
  Stage-35
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-50
    Conditional Operator

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-48
    Conditional Operator

  Stage: Stage-89
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
              Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-45
    Conditional Operator

  Stage: Stage-88
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:catalog_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:catalog_returns 
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int), _col2 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1190931071 Data size: 28582345798 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Conditional Operator

  Stage: Stage-86
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
              Statistics: Num rows: 1310024206 Data size: 31440581059 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((CAST( _col4 AS decimal(17,2)) / CAST( _col10 AS decimal(17,2))) < 0.9) (type: boolean)
                Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col10 (type: bigint), _col4 (type: bigint), (_col4 - _col10) (type: bigint), (_col5 - _col11) (type: double)
                  outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col8 (type: bigint)
              sort order: +
              Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col7 (type: bigint), _col9 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: 2001 (type: int), 2002 (type: int), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: bigint), VALUE._col5 (type: bigint), KEY.reducesinkkey0 (type: bigint), VALUE._col6 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-87
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
              Statistics: Num rows: 1310024206 Data size: 31440581059 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((CAST( _col4 AS decimal(17,2)) / CAST( _col10 AS decimal(17,2))) < 0.9) (type: boolean)
                Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col10 (type: bigint), _col4 (type: bigint), (_col4 - _col10) (type: bigint), (_col5 - _col11) (type: double)
                  outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              Statistics: Num rows: 1190931071 Data size: 28582345798 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              Statistics: Num rows: 1190931071 Data size: 28582345798 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: bigint), _col5 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
            1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
          Statistics: Num rows: 1310024206 Data size: 31440581059 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((CAST( _col4 AS decimal(17,2)) / CAST( _col10 AS decimal(17,2))) < 0.9) (type: boolean)
            Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col10 (type: bigint), _col4 (type: bigint), (_col4 - _col10) (type: bigint), (_col5 - _col11) (type: double)
              outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 436674735 Data size: 10480193678 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
              Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-90
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-57
    Conditional Operator

  Stage: Stage-95
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-93
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-52
    Conditional Operator

  Stage: Stage-92
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:store_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:store_returns 
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int), _col2 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-94
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-64
    Conditional Operator

  Stage: Stage-99
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-63
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 348661333 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-62
    Conditional Operator

  Stage: Stage-97
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
              Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-59
    Conditional Operator

  Stage: Stage-96
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:web_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:web_returns 
          TableScan
            alias: web_returns
            Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int), _col2 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
              Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: web_returns
            Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-98
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-61
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 348661333 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 348661333 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-71
    Conditional Operator

  Stage: Stage-103
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-70
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-69
    Conditional Operator

  Stage: Stage-101
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-67
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
              Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-66
    Conditional Operator

  Stage: Stage-100
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_4:catalog_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_4:catalog_returns 
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int), _col2 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-65
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 2381862142 Data size: 57164691597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1190931071 Data size: 28582345798 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
              Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 843275028 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-102
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-68
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 766613646 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 633564970 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 696921482 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-78
    Conditional Operator

  Stage: Stage-107
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-77
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-76
    Conditional Operator

  Stage: Stage-105
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-74
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-73
    Conditional Operator

  Stage: Stage-104
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_4:store_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_4:store_returns 
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int), _col2 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-72
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 1116706884 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-106
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-75
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-85
    Conditional Operator

  Stage: Stage-111
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-84
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 348661333 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-83
    Conditional Operator

  Stage: Stage-109
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-81
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
              Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-80
    Conditional Operator

  Stage: Stage-108
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_4:web_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_4:web_returns 
          TableScan
            alias: web_returns
            Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int), _col2 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-79
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
              Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: web_returns
            Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col3, _col4, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col3 - COALESCE(_col15,0)) (type: int), (_col4 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 421880230 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-110
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-82
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 348661333 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 383527474 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 316964842 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: bigint), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 145707 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 72853 Data size: 8742379 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
          Statistics: Num rows: 348661333 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query76.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage , consists of Stage-32, Stage-1
  Stage-32 has a backup stage: Stage-1
  Stage-18 depends on stages: Stage-32
  Stage-17 depends on stages: Stage-1, Stage-18 , consists of Stage-30, Stage-31, Stage-2
  Stage-30 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-30
  Stage-3 depends on stages: Stage-2, Stage-8, Stage-12, Stage-15, Stage-16, Stage-20, Stage-21, Stage-25, Stage-26
  Stage-4 depends on stages: Stage-3
  Stage-31 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-31
  Stage-2
  Stage-1
  Stage-24 is a root stage , consists of Stage-35, Stage-7
  Stage-35 has a backup stage: Stage-7
  Stage-23 depends on stages: Stage-35
  Stage-22 depends on stages: Stage-7, Stage-23 , consists of Stage-33, Stage-34, Stage-8
  Stage-33 has a backup stage: Stage-8
  Stage-20 depends on stages: Stage-33
  Stage-34 has a backup stage: Stage-8
  Stage-21 depends on stages: Stage-34
  Stage-8
  Stage-7
  Stage-29 is a root stage , consists of Stage-38, Stage-11
  Stage-38 has a backup stage: Stage-11
  Stage-28 depends on stages: Stage-38
  Stage-27 depends on stages: Stage-11, Stage-28 , consists of Stage-36, Stage-37, Stage-12
  Stage-36 has a backup stage: Stage-12
  Stage-25 depends on stages: Stage-36
  Stage-37 has a backup stage: Stage-12
  Stage-26 depends on stages: Stage-37
  Stage-12
  Stage-11
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-19
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_addr_sk is null and ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 629248768 Data size: 10067980288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 629248768 Data size: 10067980288 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3, _col5
                  Statistics: Num rows: 692173659 Data size: 11074778556 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col7, _col8
              Statistics: Num rows: 761391041 Data size: 12182256675 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'store' (type: string), 'ss_addr_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 761391041 Data size: 12182256675 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(), sum(_col5)
                keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                  sort order: +++++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                  Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col5 (type: bigint), _col6 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(), sum(_col5)
                keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                  sort order: +++++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                  Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col5 (type: bigint), _col6 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(), sum(_col5)
                keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                  sort order: +++++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                  Statistics: Num rows: 1623996882 Data size: 25983950161 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col5 (type: bigint), _col6 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 811998441 Data size: 12991975080 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
              sort order: +++++
              Statistics: Num rows: 811998441 Data size: 12991975080 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col5 (type: bigint), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: int), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 811998441 Data size: 12991975080 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col7, _col8
                  Statistics: Num rows: 761391041 Data size: 12182256675 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: 'store' (type: string), 'ss_addr_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 761391041 Data size: 12182256675 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 692173659 Data size: 11074778556 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col5 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col7, _col8
          Statistics: Num rows: 761391041 Data size: 12182256675 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'store' (type: string), 'ss_addr_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 761391041 Data size: 12182256675 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_addr_sk is null and ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 629248768 Data size: 10067980288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 629248768 Data size: 10067980288 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 629248768 Data size: 10067980288 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col3, _col5
          Statistics: Num rows: 692173659 Data size: 11074778556 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_web_page_sk is null and ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 237723632 Data size: 3803578112 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 237723632 Data size: 3803578112 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3, _col5
                  Statistics: Num rows: 261496000 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col7, _col8
              Statistics: Num rows: 287645606 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'web' (type: string), 'ws_web_page_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 287645606 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col7, _col8
                  Statistics: Num rows: 287645606 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: 'web' (type: string), 'ws_web_page_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 287645606 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 261496000 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col5 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col7, _col8
          Statistics: Num rows: 287645606 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'web' (type: string), 'ws_web_page_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 287645606 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 475447264 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_web_page_sk is null and ws_item_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 237723632 Data size: 3803578112 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 237723632 Data size: 3803578112 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 237723632 Data size: 3803578112 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col3, _col5
          Statistics: Num rows: 261496000 Data size: 4183936013 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 475173728 Data size: 7602779648 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col2, _col3
                Statistics: Num rows: 475173728 Data size: 7602779648 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3, _col5
                  Statistics: Num rows: 522691112 Data size: 8363057794 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-27
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col7, _col8
              Statistics: Num rows: 574960235 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'catalog' (type: string), 'cs_warehouse_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 574960235 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col7, _col8
                  Statistics: Num rows: 574960235 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: 'catalog' (type: string), 'cs_warehouse_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 574960235 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 522691112 Data size: 8363057794 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col5 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col7, _col8
          Statistics: Num rows: 574960235 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'catalog' (type: string), 'cs_warehouse_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col3 (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 574960235 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 950347456 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is null and cs_item_sk is not null and cs_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 475173728 Data size: 7602779648 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float)
                outputColumnNames: _col0, _col2, _col3
                Statistics: Num rows: 475173728 Data size: 7602779648 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col2 (type: int)
                  Statistics: Num rows: 475173728 Data size: 7602779648 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col3, _col5
          Statistics: Num rows: 522691112 Data size: 8363057794 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query79.sql
STAGE DEPENDENCIES:
  Stage-17 is a root stage , consists of Stage-21, Stage-1
  Stage-21 has a backup stage: Stage-1
  Stage-16 depends on stages: Stage-21
  Stage-20 depends on stages: Stage-1, Stage-16
  Stage-4 depends on stages: Stage-20
  Stage-13 depends on stages: Stage-4 , consists of Stage-18, Stage-19, Stage-5
  Stage-18 has a backup stage: Stage-5
  Stage-11 depends on stages: Stage-18
  Stage-6 depends on stages: Stage-5, Stage-11, Stage-12
  Stage-19 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-19
  Stage-5
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and (d_dow = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_coupon_amt (type: float), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 615265475 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 356 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_number_employees BETWEEN 200 AND 295 and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 39 Data size: 4213 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_city (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 39 Data size: 4213 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 8) or (hd_vehicle_count > 0)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 10530 Data size: 126367 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 10530 Data size: 126367 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7, _col13
              Statistics: Num rows: 676792037 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col13
                Statistics: Num rows: 744471256 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col13 (type: string), _col6 (type: float), _col7 (type: float)
                  outputColumnNames: _col1, _col3, _col5, _col13, _col6, _col7
                  Statistics: Num rows: 744471256 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col6), sum(_col7)
                    keys: _col1 (type: int), _col3 (type: int), _col5 (type: bigint), _col13 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 744471256 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                      sort order: ++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                      Statistics: Num rows: 744471256 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col4 (type: double), _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 372235628 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: bigint), _col0 (type: int), _col3 (type: string), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 372235628 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7
              Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), substr(_col2, 1, 30) (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col5 (type: double)
              sort order: ++++
              Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: double), KEY.reducesinkkey3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7
                  Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), substr(_col2, 1, 30) (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 372235628 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7
          Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), substr(_col2, 1, 30) (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 409459199 Data size: 14740531216 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_coupon_amt (type: float), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 559332238 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: bigint), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and (d_dow = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 615265475 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query7.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-17 depends on stages: Stage-1 , consists of Stage-21, Stage-22, Stage-2
  Stage-21 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-21
  Stage-14 depends on stages: Stage-2, Stage-15, Stage-16 , consists of Stage-19, Stage-20, Stage-3
  Stage-19 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-19
  Stage-18 depends on stages: Stage-3, Stage-12, Stage-13
  Stage-5 depends on stages: Stage-18
  Stage-6 depends on stages: Stage-5
  Stage-20 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-20
  Stage-3
  Stage-22 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-22
  Stage-2
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_cdemo_sk is not null and ss_sold_date_sk is not null and ss_item_sk is not null and ss_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_cdemo_sk (type: int), ss_promo_sk (type: int), ss_quantity (type: int), ss_list_price (type: float), ss_sales_price (type: float), ss_coupon_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col2 (type: int)
                  Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 265329 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'F') and (cd_marital_status = 'W') and (cd_education_status = 'Primary') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 33166 Data size: 10082473 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 692173659 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col15
              Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 318 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((p_channel_email = 'N') or (p_channel_event = 'N')) and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 318 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 318 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col5, _col6, _col7, _col15
              Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col15 (type: string), _col4 (type: int), _col5 (type: float), _col7 (type: float), _col6 (type: float)
                outputColumnNames: _col15, _col4, _col5, _col7, _col6
                Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col4), avg(_col5), avg(_col7), avg(_col6)
                  keys: _col15 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>), _col4 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 460641599 Data size: 14740531200 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 460641599 Data size: 14740531200 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 460641599 Data size: 14740531200 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col15
                  Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col15
          Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 692173659 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query80.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-43 depends on stages: Stage-1 , consists of Stage-64, Stage-65, Stage-2
  Stage-64 has a backup stage: Stage-2
  Stage-41 depends on stages: Stage-64
  Stage-63 depends on stages: Stage-2, Stage-41, Stage-42
  Stage-40 depends on stages: Stage-63
  Stage-39 depends on stages: Stage-40 , consists of Stage-61, Stage-62, Stage-4
  Stage-61 has a backup stage: Stage-4
  Stage-37 depends on stages: Stage-61
  Stage-60 depends on stages: Stage-4, Stage-37, Stage-38
  Stage-6 depends on stages: Stage-60
  Stage-7 depends on stages: Stage-6, Stage-19, Stage-30
  Stage-8 depends on stages: Stage-7
  Stage-62 has a backup stage: Stage-4
  Stage-38 depends on stages: Stage-62
  Stage-4
  Stage-65 has a backup stage: Stage-2
  Stage-42 depends on stages: Stage-65
  Stage-2
  Stage-14 is a root stage
  Stage-51 depends on stages: Stage-14 , consists of Stage-70, Stage-71, Stage-15
  Stage-70 has a backup stage: Stage-15
  Stage-49 depends on stages: Stage-70
  Stage-69 depends on stages: Stage-15, Stage-49, Stage-50
  Stage-48 depends on stages: Stage-69
  Stage-47 depends on stages: Stage-48 , consists of Stage-67, Stage-68, Stage-17
  Stage-67 has a backup stage: Stage-17
  Stage-45 depends on stages: Stage-67
  Stage-66 depends on stages: Stage-17, Stage-45, Stage-46
  Stage-19 depends on stages: Stage-66
  Stage-68 has a backup stage: Stage-17
  Stage-46 depends on stages: Stage-68
  Stage-17
  Stage-71 has a backup stage: Stage-15
  Stage-50 depends on stages: Stage-71
  Stage-15
  Stage-25 is a root stage
  Stage-59 depends on stages: Stage-25 , consists of Stage-76, Stage-77, Stage-26
  Stage-76 has a backup stage: Stage-26
  Stage-57 depends on stages: Stage-76
  Stage-75 depends on stages: Stage-26, Stage-57, Stage-58
  Stage-56 depends on stages: Stage-75
  Stage-55 depends on stages: Stage-56 , consists of Stage-73, Stage-74, Stage-28
  Stage-73 has a backup stage: Stage-28
  Stage-53 depends on stages: Stage-73
  Stage-72 depends on stages: Stage-28, Stage-53, Stage-54
  Stage-30 depends on stages: Stage-72
  Stage-74 has a backup stage: Stage-28
  Stage-54 depends on stages: Stage-74
  Stage-28
  Stage-77 has a backup stage: Stage-26
  Stage-58 depends on stages: Stage-77
  Stage-26
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_store_sk is not null and ss_item_sk is not null and ss_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_promo_sk (type: int), ss_ticket_number (type: bigint), ss_ext_sales_price (type: float), ss_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col4 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 629248768 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_amt (type: float), sr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col4 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col9, _col10
          Statistics: Num rows: 692173659 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Conditional Operator

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
              Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-39
    Conditional Operator

  Stage: Stage-61
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-60
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_5:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_5:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 623 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_channel_tv = 'N') and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 311 Data size: 32389 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 311 Data size: 32389 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 1013411540 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col14 (type: string), _col5 (type: float), COALESCE(_col9,0) (type: float), (_col6 - COALESCE(_col10,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1013411540 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3)
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1013411540 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 1013411540 Data size: 32429169379 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 506705770 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'store channel' (type: string), concat('store', _col0) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 506705770 Data size: 16214584689 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 1080769992 Data size: 34584639897 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col2), sum(_col3), sum(_col4)
                keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3242309976 Data size: 103753919691 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  Statistics: Num rows: 3242309976 Data size: 103753919691 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1080769992 Data size: 34584639897 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col2), sum(_col3), sum(_col4)
                keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3242309976 Data size: 103753919691 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  Statistics: Num rows: 3242309976 Data size: 103753919691 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 1080769992 Data size: 34584639897 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col2), sum(_col3), sum(_col4)
                keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3242309976 Data size: 103753919691 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  Statistics: Num rows: 3242309976 Data size: 103753919691 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col3, _col4, _col5
          Statistics: Num rows: 1621154988 Data size: 51876959845 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 1621154988 Data size: 51876959845 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 1621154988 Data size: 51876959845 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 1621154988 Data size: 51876959845 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-62
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
                  Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 837530163 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: float), _col10 (type: float), _col14 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
          Statistics: Num rows: 921283199 Data size: 29481062433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
                  Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 692173659 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: float), _col10 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
          Statistics: Num rows: 761391041 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_catalog_page_sk is not null and cs_item_sk is not null and cs_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_catalog_page_sk (type: int), cs_item_sk (type: int), cs_promo_sk (type: int), cs_order_number (type: bigint), cs_ext_sales_price (type: float), cs_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col2 (type: int), _col4 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col2 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 475173728 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: float)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_amount (type: float), cr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 55462265 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col2 (type: int), _col4 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col9, _col10
          Statistics: Num rows: 522691112 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-51
    Conditional Operator

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
              Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:catalog_page 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:catalog_page 
          TableScan
            alias: catalog_page
            Statistics: Num rows: 15690 Data size: 1631792 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cp_catalog_page_sk is not null (type: boolean)
              Statistics: Num rows: 15690 Data size: 1631792 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cp_catalog_page_sk (type: int), cp_catalog_page_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15690 Data size: 1631792 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col3, _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 632456272 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-47
    Conditional Operator

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 623 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_channel_tv = 'N') and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 311 Data size: 32389 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 311 Data size: 32389 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 765272121 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col14 (type: string), _col5 (type: float), COALESCE(_col9,0) (type: float), (_col6 - COALESCE(_col10,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 765272121 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3)
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 765272121 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 765272121 Data size: 24488707954 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 382636060 Data size: 12244353961 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'catalog channel' (type: string), concat('catalog_page', _col0) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 382636060 Data size: 12244353961 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
                  Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: int)
              sort order: +
              Map-reduce partition columns: _col2 (type: int)
              Statistics: Num rows: 632456272 Data size: 20238600738 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: float), _col10 (type: float), _col14 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
          Statistics: Num rows: 695701914 Data size: 22262461294 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
                  Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 522691112 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: float), _col10 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
          Statistics: Num rows: 574960235 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 237723632 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_web_site_sk is not null and ws_item_sk is not null and ws_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 237723632 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_web_site_sk (type: int), ws_promo_sk (type: int), ws_order_number (type: bigint), ws_ext_sales_price (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 237723632 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col4 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col4 (type: bigint)
                  Statistics: Num rows: 237723632 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: float)
          TableScan
            alias: web_returns
            Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_amt (type: float), wr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 25815252 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col4 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col9, _col10
          Statistics: Num rows: 261496000 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-59
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-57
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
              Statistics: Num rows: 287645606 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:web_site 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:web_site 
          TableScan
            alias: web_site
            Statistics: Num rows: 60 Data size: 6255 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: web_site_sk is not null (type: boolean)
              Statistics: Num rows: 60 Data size: 6255 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: web_site_sk (type: int), web_site_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 60 Data size: 6255 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 316410173 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 348051197 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 623 Data size: 64884 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_channel_tv = 'N') and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 311 Data size: 32389 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 311 Data size: 32389 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col6, _col9, _col10, _col14
              Statistics: Num rows: 382856324 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col14 (type: string), _col5 (type: float), COALESCE(_col9,0) (type: float), (_col6 - COALESCE(_col10,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 382856324 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3)
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 382856324 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 382856324 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 191428162 Data size: 6125701247 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'web channel' (type: string), concat('web_site', _col0) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 191428162 Data size: 6125701247 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
                  Statistics: Num rows: 348051197 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 316410173 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: float), _col10 (type: float), _col14 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 2185610 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 728536 Data size: 5828288 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col5, _col6, _col9, _col10, _col14
          Statistics: Num rows: 348051197 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
                  Statistics: Num rows: 287645606 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 261496000 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: float), _col10 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col9, _col10
          Statistics: Num rows: 287645606 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query82.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-10 depends on stages: Stage-1 , consists of Stage-11, Stage-12, Stage-2
  Stage-11 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-11
  Stage-3 depends on stages: Stage-2, Stage-8, Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-12 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-12
  Stage-2
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 82475 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id) IN (437, 129, 727, 663) and i_current_price BETWEEN 30 AND 60 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 4582 Data size: 971394 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 4582 Data size: 971394 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 4582 Data size: 971394 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: float)
          TableScan
            alias: inventory
            Statistics: Num rows: 97075776 Data size: 1164909312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_quantity_on_hand BETWEEN 100 AND 500 and inv_item_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10786197 Data size: 129434364 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_date_sk (type: int), inv_item_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10786197 Data size: 129434364 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 10786197 Data size: 129434364 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: store_sales
            Statistics: Num rows: 5033990144 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 5033990144 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 5033990144 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 5033990144 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col0 (type: int)
            1 _col1 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col5
          Statistics: Num rows: 11074778556 Data size: 44299114227 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-11
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-30' AND '2002-07-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3
              Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col1 (type: string), _col2 (type: string), _col3 (type: float)
                mode: hash
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float)
              Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 6091128337 Data size: 24364513350 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 6091128337 Data size: 24364513350 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string), _col2 (type: float)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: float)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 6091128337 Data size: 24364513350 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-30' AND '2002-07-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col1 (type: string), _col2 (type: string), _col3 (type: float)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 11074778556 Data size: 44299114227 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-30' AND '2002-07-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3
          Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col1 (type: string), _col2 (type: string), _col3 (type: float)
            mode: hash
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 12182256675 Data size: 48729026705 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query83.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-44 depends on stages: Stage-11 , consists of Stage-72, Stage-73, Stage-9
  Stage-72 has a backup stage: Stage-9
  Stage-42 depends on stages: Stage-72
  Stage-10 depends on stages: Stage-9, Stage-42, Stage-43
  Stage-36 depends on stages: Stage-2, Stage-10, Stage-37, Stage-38 , consists of Stage-70, Stage-71, Stage-3
  Stage-70 has a backup stage: Stage-3
  Stage-34 depends on stages: Stage-70
  Stage-4 depends on stages: Stage-3, Stage-34, Stage-35
  Stage-33 depends on stages: Stage-4, Stage-15, Stage-24 , consists of Stage-67, Stage-68, Stage-69, Stage-5
  Stage-67 has a backup stage: Stage-5
  Stage-30 depends on stages: Stage-67
  Stage-6 depends on stages: Stage-5, Stage-30, Stage-31, Stage-32
  Stage-68 has a backup stage: Stage-5
  Stage-31 depends on stages: Stage-68
  Stage-69 has a backup stage: Stage-5
  Stage-32 depends on stages: Stage-69
  Stage-5
  Stage-71 has a backup stage: Stage-3
  Stage-35 depends on stages: Stage-71
  Stage-3
  Stage-73 has a backup stage: Stage-9
  Stage-43 depends on stages: Stage-73
  Stage-9
  Stage-20 is a root stage
  Stage-55 depends on stages: Stage-20 , consists of Stage-76, Stage-77, Stage-18
  Stage-76 has a backup stage: Stage-18
  Stage-53 depends on stages: Stage-76
  Stage-19 depends on stages: Stage-18, Stage-53, Stage-54
  Stage-47 depends on stages: Stage-13, Stage-19, Stage-48, Stage-49 , consists of Stage-74, Stage-75, Stage-14
  Stage-74 has a backup stage: Stage-14
  Stage-45 depends on stages: Stage-74
  Stage-15 depends on stages: Stage-14, Stage-45, Stage-46
  Stage-75 has a backup stage: Stage-14
  Stage-46 depends on stages: Stage-75
  Stage-14
  Stage-77 has a backup stage: Stage-18
  Stage-54 depends on stages: Stage-77
  Stage-18
  Stage-29 is a root stage
  Stage-66 depends on stages: Stage-29 , consists of Stage-80, Stage-81, Stage-27
  Stage-80 has a backup stage: Stage-27
  Stage-64 depends on stages: Stage-80
  Stage-28 depends on stages: Stage-27, Stage-64, Stage-65
  Stage-58 depends on stages: Stage-22, Stage-28, Stage-59, Stage-60 , consists of Stage-78, Stage-79, Stage-23
  Stage-78 has a backup stage: Stage-23
  Stage-56 depends on stages: Stage-78
  Stage-24 depends on stages: Stage-23, Stage-56, Stage-57
  Stage-79 has a backup stage: Stage-23
  Stage-57 depends on stages: Stage-79
  Stage-23
  Stage-81 has a backup stage: Stage-27
  Stage-65 depends on stages: Stage-81
  Stage-27
  Stage-41 is a root stage , consists of Stage-84, Stage-1
  Stage-84 has a backup stage: Stage-1
  Stage-40 depends on stages: Stage-84
  Stage-39 depends on stages: Stage-1, Stage-40 , consists of Stage-82, Stage-83, Stage-2
  Stage-82 has a backup stage: Stage-2
  Stage-37 depends on stages: Stage-82
  Stage-83 has a backup stage: Stage-2
  Stage-38 depends on stages: Stage-83
  Stage-2
  Stage-1
  Stage-52 is a root stage , consists of Stage-87, Stage-12
  Stage-87 has a backup stage: Stage-12
  Stage-51 depends on stages: Stage-87
  Stage-50 depends on stages: Stage-12, Stage-51 , consists of Stage-85, Stage-86, Stage-13
  Stage-85 has a backup stage: Stage-13
  Stage-48 depends on stages: Stage-85
  Stage-86 has a backup stage: Stage-13
  Stage-49 depends on stages: Stage-86
  Stage-13
  Stage-12
  Stage-63 is a root stage , consists of Stage-90, Stage-21
  Stage-90 has a backup stage: Stage-21
  Stage-62 depends on stages: Stage-90
  Stage-61 depends on stages: Stage-21, Stage-62 , consists of Stage-88, Stage-89, Stage-22
  Stage-88 has a backup stage: Stage-22
  Stage-59 depends on stages: Stage-88
  Stage-89 has a backup stage: Stage-22
  Stage-60 depends on stages: Stage-89
  Stage-22
  Stage-21
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date) IN ('1998-01-02', '1998-10-15', '1998-11-10') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: d_week_seq
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: d_week_seq (type: int)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 24801 Data size: 2579307 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Conditional Operator

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: string)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 54563 Data size: 5674591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-36
    Conditional Operator

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: int)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 94676136 Data size: 1136113641 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Conditional Operator

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: bigint)
              sort order: ++
              Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: bigint), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: decimal(25,6))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: double), VALUE._col1 (type: bigint), VALUE._col2 (type: double), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: decimal(25,6))
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1200 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 94676136 Data size: 1136113641 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 61516899 Data size: 738202796 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 28633419 Data size: 343601036 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
            2 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5
          Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 208287503 Data size: 2499450064 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: int)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 172138427 Data size: 2065661133 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 54563 Data size: 5674591 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: int)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 189352273 Data size: 2272227295 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 24801 Data size: 2579307 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col0 (type: string)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date) IN ('1998-01-02', '1998-10-15', '1998-11-10') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: d_week_seq
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: d_week_seq (type: int)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 24801 Data size: 2579307 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-55
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_4:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_4:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: string)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 54563 Data size: 5674591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-47
    Conditional Operator

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: int)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 61516899 Data size: 738202796 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: int)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 111848906 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 54563 Data size: 5674591 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: int)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 123033799 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_4:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_4:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 24801 Data size: 2579307 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col0 (type: string)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date) IN ('1998-01-02', '1998-10-15', '1998-11-10') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: d_week_seq
                Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: d_week_seq (type: int)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 49603 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 24801 Data size: 2579307 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Conditional Operator

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_5:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_5:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: string)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 54563 Data size: 5674591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-58
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: int)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 28633419 Data size: 343601036 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-57
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col2 (type: int)
                outputColumnNames: _col4, _col2
                Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 52060761 Data size: 624729143 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 54563 Data size: 5674591 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col2 (type: int)
            outputColumnNames: _col4, _col2
            Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 57266838 Data size: 687202072 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_5:$hdt$_5:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_5:$hdt$_5:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-65
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 24801 Data size: 2579307 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0
          Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col0 (type: string)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 109126 Data size: 11349182 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Conditional Operator

  Stage: Stage-84
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: int), sr_item_sk (type: int), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 156489476 Data size: 1877873717 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-39
    Conditional Operator

  Stage: Stage-82
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col6
              Statistics: Num rows: 172138427 Data size: 2065661133 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-83
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col6
                  Statistics: Num rows: 172138427 Data size: 2065661133 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 156489476 Data size: 1877873717 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col6
          Statistics: Num rows: 172138427 Data size: 2065661133 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_returns
            Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: int), sr_item_sk (type: int), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 142263157 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 156489476 Data size: 1877873717 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-52
    Conditional Operator

  Stage: Stage-87
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_item_sk is not null and cr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_returned_date_sk (type: int), cr_item_sk (type: int), cr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 101680822 Data size: 1220169869 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-50
    Conditional Operator

  Stage: Stage-85
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col6
              Statistics: Num rows: 111848906 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-86
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col6
                  Statistics: Num rows: 111848906 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 101680822 Data size: 1220169869 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col6
          Statistics: Num rows: 111848906 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_item_sk is not null and cr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_returned_date_sk (type: int), cr_item_sk (type: int), cr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 92437109 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 101680822 Data size: 1220169869 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-63
    Conditional Operator

  Stage: Stage-90
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_returns
            Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wr_item_sk is not null and wr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_returned_date_sk (type: int), wr_item_sk (type: int), wr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4
                  Statistics: Num rows: 47327964 Data size: 567935573 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-61
    Conditional Operator

  Stage: Stage-88
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col6
              Statistics: Num rows: 52060761 Data size: 624729143 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-89
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col6
                  Statistics: Num rows: 52060761 Data size: 624729143 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 47327964 Data size: 567935573 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col4 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col6
          Statistics: Num rows: 52060761 Data size: 624729143 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_returns
            Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wr_item_sk is not null and wr_returned_date_sk is not null) (type: boolean)
              Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_returned_date_sk (type: int), wr_item_sk (type: int), wr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 43025421 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int)
          TableScan
            alias: item
            Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 168123 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4
          Statistics: Num rows: 47327964 Data size: 567935573 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query84.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-14 depends on stages: Stage-1 , consists of Stage-16, Stage-2
  Stage-16 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-16
  Stage-15 depends on stages: Stage-2, Stage-13
  Stage-5 depends on stages: Stage-15
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 329014 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 329014 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_id (type: string), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 329014 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col3 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col3 (type: int)
                  Statistics: Num rows: 329014 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col4 (type: string), _col5 (type: string)
          TableScan
            alias: customer_address
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_city = 'Hopewell') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5
          Statistics: Num rows: 361915 Data size: 112917853 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_5:store_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
        $hdt$_5:store_returns 
          TableScan
            alias: store_returns
            Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_cdemo_sk is not null (type: boolean)
              Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_cdemo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5
              Statistics: Num rows: 938936858 Data size: 3755747435 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_4:income_band 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:income_band 
          TableScan
            alias: income_band
            Statistics: Num rows: 27 Data size: 328 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ib_lower_bound >= 32287) and (ib_upper_bound <= 82287) and ib_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 3 Data size: 36 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3 Data size: 36 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col5, _col11
              Statistics: Num rows: 1032830566 Data size: 4131322268 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col11 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col4, _col5
                Statistics: Num rows: 1136113647 Data size: 4544454593 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), concat(_col5, ', ', _col4) (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1136113647 Data size: 4544454593 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Statistics: Num rows: 1136113647 Data size: 4544454593 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col1 (type: string)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1136113647 Data size: 4544454593 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 361915 Data size: 112917853 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col2 (type: int), _col4 (type: string), _col5 (type: string)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 20165024 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: store_returns
            Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_cdemo_sk is not null (type: boolean)
              Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_cdemo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 426789472 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5
          Statistics: Num rows: 938936858 Data size: 3755747435 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query85.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-40 depends on stages: Stage-1
  Stage-30 depends on stages: Stage-40
  Stage-29 depends on stages: Stage-30 , consists of Stage-38, Stage-39, Stage-3
  Stage-38 has a backup stage: Stage-3
  Stage-27 depends on stages: Stage-38
  Stage-26 depends on stages: Stage-3, Stage-27, Stage-28 , consists of Stage-36, Stage-37, Stage-4
  Stage-36 has a backup stage: Stage-4
  Stage-24 depends on stages: Stage-36
  Stage-23 depends on stages: Stage-4, Stage-24, Stage-25 , consists of Stage-34, Stage-35, Stage-5
  Stage-34 has a backup stage: Stage-5
  Stage-21 depends on stages: Stage-34
  Stage-20 depends on stages: Stage-5, Stage-21, Stage-22 , consists of Stage-32, Stage-33, Stage-6
  Stage-32 has a backup stage: Stage-6
  Stage-18 depends on stages: Stage-32
  Stage-31 depends on stages: Stage-6, Stage-18, Stage-19
  Stage-8 depends on stages: Stage-31
  Stage-9 depends on stages: Stage-8
  Stage-33 has a backup stage: Stage-6
  Stage-19 depends on stages: Stage-33
  Stage-6
  Stage-35 has a backup stage: Stage-5
  Stage-22 depends on stages: Stage-35
  Stage-5
  Stage-37 has a backup stage: Stage-4
  Stage-25 depends on stages: Stage-37
  Stage-4
  Stage-39 has a backup stage: Stage-3
  Stage-28 depends on stages: Stage-39
  Stage-3
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 237723632 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ws_sales_price BETWEEN 100 AND 150 or ws_sales_price BETWEEN 50 AND 100 or ws_sales_price BETWEEN 150 AND 200) and (ws_net_profit BETWEEN 100 AND 200 or ws_net_profit BETWEEN 150 AND 300 or ws_net_profit BETWEEN 50 AND 250) and ws_order_number is not null and ws_item_sk is not null and ws_web_page_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 26413734 Data size: 845239488 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_item_sk (type: int), ws_web_page_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_sales_price (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 26413734 Data size: 845239488 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 26413734 Data size: 845239488 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float)
          TableScan
            alias: web_returns
            Statistics: Num rows: 14341807 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wr_item_sk is not null and wr_order_number is not null and wr_refunded_cdemo_sk is not null and wr_returning_cdemo_sk is not null and wr_refunded_addr_sk is not null and wr_reason_sk is not null) (type: boolean)
              Statistics: Num rows: 14341807 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_refunded_cdemo_sk (type: int), wr_refunded_addr_sk (type: int), wr_returning_cdemo_sk (type: int), wr_reason_sk (type: int), wr_order_number (type: bigint), wr_fee (type: float), wr_refunded_cash (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 14341807 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col5 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col5 (type: bigint)
                  Statistics: Num rows: 14341807 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col6 (type: float), _col7 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col5 (type: bigint)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col13, _col14
          Statistics: Num rows: 29055108 Data size: 929763456 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:web_page 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:web_page 
          TableScan
            alias: web_page
            Statistics: Num rows: 21203 Data size: 84812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wp_web_page_sk is not null (type: boolean)
              Statistics: Num rows: 21203 Data size: 84812 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 21203 Data size: 84812 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col13, _col14
              Statistics: Num rows: 31960619 Data size: 1022739823 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:cd1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col8 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col5, _col6, _col9, _col10, _col11, _col13, _col14, _col17, _col18
              Statistics: Num rows: 35156681 Data size: 1125013829 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (((_col17 = 'M') and (_col18 = '4 yr Degree') and _col5 BETWEEN 100 AND 150) or ((_col17 = 'D') and (_col18 = 'Primary') and _col5 BETWEEN 50 AND 100) or ((_col17 = 'U') and (_col18 = 'Advanced Degree') and _col5 BETWEEN 150 AND 200)) (type: boolean)
                Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col10 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col17 (type: string), _col18 (type: string), _col4 (type: int), _col6 (type: float), _col9 (type: int)
                  outputColumnNames: _col0, _col10, _col11, _col13, _col14, _col17, _col18, _col4, _col6, _col9
                  Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-26
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:cd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
                    1 _col1 (type: string), _col2 (type: string), _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
                1 _col1 (type: string), _col2 (type: string), _col0 (type: int)
              outputColumnNames: _col0, _col4, _col6, _col9, _col11, _col13, _col14
              Statistics: Num rows: 3222694 Data size: 103126219 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col9 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col9 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col6, _col11, _col13, _col14, _col23
              Statistics: Num rows: 3544963 Data size: 113438843 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (((_col23) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 100 AND 200) or ((_col23) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 300) or ((_col23) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 250)) (type: boolean)
                Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col4 (type: int)
                  outputColumnNames: _col0, _col11, _col13, _col14, _col4
                  Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col11, _col13, _col14
              Statistics: Num rows: 709322 Data size: 5674585 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:reason 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:reason 
          TableScan
            alias: reason
            Statistics: Num rows: 14 Data size: 1463 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: r_reason_sk is not null (type: boolean)
              Statistics: Num rows: 14 Data size: 1463 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_reason_sk (type: int), r_reason_desc (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 14 Data size: 1463 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col13, _col14, _col28
              Statistics: Num rows: 780254 Data size: 6242043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col28 (type: string), _col4 (type: int), _col14 (type: float), _col13 (type: float)
                outputColumnNames: _col28, _col4, _col14, _col13
                Statistics: Num rows: 780254 Data size: 6242043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col4), avg(_col14), avg(_col13)
                  keys: _col28 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 780254 Data size: 6242043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 780254 Data size: 6242043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 390127 Data size: 3121021 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: substr(_col0, 1, 20) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 390127 Data size: 3121021 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
              sort order: ++++
              Statistics: Num rows: 390127 Data size: 3121021 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 390127 Data size: 3121021 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col11, _col13, _col14
                  Statistics: Num rows: 709322 Data size: 5674585 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 644839 Data size: 5158714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col11, _col13, _col14
          Statistics: Num rows: 709322 Data size: 5674585 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col9 (type: int)
                1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col9 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col4, _col6, _col11, _col13, _col14, _col23
                  Statistics: Num rows: 3544963 Data size: 113438843 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((_col23) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 100 AND 200) or ((_col23) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 300) or ((_col23) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 250)) (type: boolean)
                    Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col0 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col4 (type: int)
                      outputColumnNames: _col0, _col11, _col13, _col14, _col4
                      Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col9 (type: int)
              sort order: +
              Map-reduce partition columns: _col9 (type: int)
              Statistics: Num rows: 3222694 Data size: 103126219 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col4 (type: int), _col6 (type: float), _col11 (type: int), _col13 (type: float), _col14 (type: float)
          TableScan
            alias: customer_address
            Statistics: Num rows: 208362 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 52090 Data size: 10626388 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col9 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col4, _col6, _col11, _col13, _col14, _col23
          Statistics: Num rows: 3544963 Data size: 113438843 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (((_col23) IN ('KY', 'GA', 'NM') and _col6 BETWEEN 100 AND 200) or ((_col23) IN ('MT', 'OR', 'IN') and _col6 BETWEEN 150 AND 300) or ((_col23) IN ('WI', 'MO', 'WV') and _col6 BETWEEN 50 AND 250)) (type: boolean)
            Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col4 (type: int)
              outputColumnNames: _col0, _col11, _col13, _col14, _col4
              Statistics: Num rows: 590826 Data size: 18906436 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
                1 _col1 (type: string), _col2 (type: string), _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd2
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
                    1 _col1 (type: string), _col2 (type: string), _col0 (type: int)
                  outputColumnNames: _col0, _col4, _col6, _col9, _col11, _col13, _col14
                  Statistics: Num rows: 3222694 Data size: 103126219 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col17 (type: string), _col18 (type: string), _col10 (type: int)
              sort order: +++
              Map-reduce partition columns: _col17 (type: string), _col18 (type: string), _col10 (type: int)
              Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col4 (type: int), _col6 (type: float), _col9 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float)
          TableScan
            alias: cd2
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: string), _col2 (type: string), _col0 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col1 (type: string), _col2 (type: string), _col0 (type: int)
                  Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
            1 _col1 (type: string), _col2 (type: string), _col0 (type: int)
          outputColumnNames: _col0, _col4, _col6, _col9, _col11, _col13, _col14
          Statistics: Num rows: 3222694 Data size: 103126219 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col8 (type: int)
                1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cd1
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col4, _col5, _col6, _col9, _col10, _col11, _col13, _col14, _col17, _col18
                  Statistics: Num rows: 35156681 Data size: 1125013829 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((_col17 = 'M') and (_col18 = '4 yr Degree') and _col5 BETWEEN 100 AND 150) or ((_col17 = 'D') and (_col18 = 'Primary') and _col5 BETWEEN 50 AND 100) or ((_col17 = 'U') and (_col18 = 'Advanced Degree') and _col5 BETWEEN 150 AND 200)) (type: boolean)
                    Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col0 (type: int), _col10 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col17 (type: string), _col18 (type: string), _col4 (type: int), _col6 (type: float), _col9 (type: int)
                      outputColumnNames: _col0, _col10, _col11, _col13, _col14, _col17, _col18, _col4, _col6, _col9
                      Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col8 (type: int)
              sort order: +
              Map-reduce partition columns: _col8 (type: int)
              Statistics: Num rows: 31960619 Data size: 1022739823 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col4 (type: int), _col5 (type: float), _col6 (type: float), _col9 (type: int), _col10 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float)
          TableScan
            alias: cd1
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col8 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col4, _col5, _col6, _col9, _col10, _col11, _col13, _col14, _col17, _col18
          Statistics: Num rows: 35156681 Data size: 1125013829 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (((_col17 = 'M') and (_col18 = '4 yr Degree') and _col5 BETWEEN 100 AND 150) or ((_col17 = 'D') and (_col18 = 'Primary') and _col5 BETWEEN 50 AND 100) or ((_col17 = 'U') and (_col18 = 'Advanced Degree') and _col5 BETWEEN 150 AND 200)) (type: boolean)
            Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col10 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col17 (type: string), _col18 (type: string), _col4 (type: int), _col6 (type: float), _col9 (type: int)
              outputColumnNames: _col0, _col10, _col11, _col13, _col14, _col17, _col18, _col4, _col6, _col9
              Statistics: Num rows: 2929722 Data size: 93751107 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query87.sql
STAGE DEPENDENCIES:
  Stage-27 is a root stage , consists of Stage-42, Stage-1
  Stage-42 has a backup stage: Stage-1
  Stage-26 depends on stages: Stage-42
  Stage-25 depends on stages: Stage-1, Stage-26 , consists of Stage-40, Stage-41, Stage-2
  Stage-40 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-40
  Stage-3 depends on stages: Stage-2, Stage-23, Stage-24
  Stage-22 depends on stages: Stage-3, Stage-11 , consists of Stage-39, Stage-4
  Stage-39 has a backup stage: Stage-4
  Stage-21 depends on stages: Stage-39
  Stage-20 depends on stages: Stage-4, Stage-16, Stage-21 , consists of Stage-38, Stage-5
  Stage-38 has a backup stage: Stage-5
  Stage-19 depends on stages: Stage-38
  Stage-6 depends on stages: Stage-5, Stage-19
  Stage-5
  Stage-4
  Stage-41 has a backup stage: Stage-2
  Stage-24 depends on stages: Stage-41
  Stage-2
  Stage-1
  Stage-32 is a root stage , consists of Stage-45, Stage-9
  Stage-45 has a backup stage: Stage-9
  Stage-31 depends on stages: Stage-45
  Stage-30 depends on stages: Stage-9, Stage-31 , consists of Stage-43, Stage-44, Stage-10
  Stage-43 has a backup stage: Stage-10
  Stage-28 depends on stages: Stage-43
  Stage-11 depends on stages: Stage-10, Stage-28, Stage-29
  Stage-44 has a backup stage: Stage-10
  Stage-29 depends on stages: Stage-44
  Stage-10
  Stage-9
  Stage-37 is a root stage , consists of Stage-48, Stage-14
  Stage-48 has a backup stage: Stage-14
  Stage-36 depends on stages: Stage-48
  Stage-35 depends on stages: Stage-14, Stage-36 , consists of Stage-46, Stage-47, Stage-15
  Stage-46 has a backup stage: Stage-15
  Stage-33 depends on stages: Stage-46
  Stage-16 depends on stages: Stage-15, Stage-33, Stage-34
  Stage-47 has a backup stage: Stage-15
  Stage-34 depends on stages: Stage-47
  Stage-15
  Stage-14
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-27
    Conditional Operator

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 2768694639 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Conditional Operator

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col6, _col7
              Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                outputColumnNames: _col7, _col6, _col3
                Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1522782084 Data size: 12182256676 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 1675060328 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: _col3 is null (type: boolean)
                Statistics: Num rows: 837530164 Data size: 6700241317 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 837530164 Data size: 6700241317 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
              outputColumnNames: _col6
              Statistics: Num rows: 921283200 Data size: 7370265608 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: _col6 is null (type: boolean)
                Statistics: Num rows: 460641600 Data size: 3685132804 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  Statistics: Num rows: 460641600 Data size: 3685132804 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count()
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 837530164 Data size: 6700241317 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 575291214 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
            1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
          outputColumnNames: _col6
          Statistics: Num rows: 921283200 Data size: 7370265608 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: _col6 is null (type: boolean)
            Statistics: Num rows: 460641600 Data size: 3685132804 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              Statistics: Num rows: 460641600 Data size: 3685132804 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count()
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 1522782084 Data size: 12182256676 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 1149920471 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
            1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1675060328 Data size: 13400482634 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: _col3 is null (type: boolean)
            Statistics: Num rows: 837530164 Data size: 6700241317 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 837530164 Data size: 6700241317 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col6, _col7
                  Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                    outputColumnNames: _col7, _col6, _col3
                    Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 2768694639 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col6, _col7
          Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
            outputColumnNames: _col7, _col6, _col3
            Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 3045564168 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_customer_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2516995072 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 2768694639 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-45
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 2090764448 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Conditional Operator

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col6, _col7
              Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                outputColumnNames: _col7, _col6, _col3
                Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1149920471 Data size: 9199363772 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col6, _col7
                  Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                    outputColumnNames: _col7, _col6, _col3
                    Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 2090764448 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col6, _col7
          Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
            outputColumnNames: _col7, _col6, _col3
            Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 2299840942 Data size: 18398727545 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_sold_date_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1900694912 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 2090764448 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Conditional Operator

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_customer_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col3
                  Statistics: Num rows: 1045984003 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-35
    Conditional Operator

  Stage: Stage-46
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col6, _col7
              Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                outputColumnNames: _col7, _col6, _col3
                Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 575291214 Data size: 4602329714 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-47
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col6, _col7
                  Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                    outputColumnNames: _col7, _col6, _col3
                    Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1045984003 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 503198 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col6, _col7
          Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
            outputColumnNames: _col7, _col6, _col3
            Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1150582428 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_customer_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 950894528 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 95531 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 10614 Data size: 1146321 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col3
          Statistics: Num rows: 1045984003 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query88.sql
STAGE DEPENDENCIES:
  Stage-99 is a root stage
  Stage-4 depends on stages: Stage-99
  Stage-66 depends on stages: Stage-4, Stage-12, Stage-19, Stage-26, Stage-33, Stage-40, Stage-47, Stage-54 , consists of Stage-91, Stage-92, Stage-93, Stage-94, Stage-95, Stage-96, Stage-97, Stage-98, Stage-5
  Stage-91 has a backup stage: Stage-5
  Stage-58 depends on stages: Stage-91
  Stage-92 has a backup stage: Stage-5
  Stage-59 depends on stages: Stage-92
  Stage-93 has a backup stage: Stage-5
  Stage-60 depends on stages: Stage-93
  Stage-94 has a backup stage: Stage-5
  Stage-61 depends on stages: Stage-94
  Stage-95 has a backup stage: Stage-5
  Stage-62 depends on stages: Stage-95
  Stage-96 has a backup stage: Stage-5
  Stage-63 depends on stages: Stage-96
  Stage-97 has a backup stage: Stage-5
  Stage-64 depends on stages: Stage-97
  Stage-98 has a backup stage: Stage-5
  Stage-65 depends on stages: Stage-98
  Stage-5
  Stage-100 is a root stage
  Stage-12 depends on stages: Stage-100
  Stage-101 is a root stage
  Stage-19 depends on stages: Stage-101
  Stage-102 is a root stage
  Stage-26 depends on stages: Stage-102
  Stage-103 is a root stage
  Stage-33 depends on stages: Stage-103
  Stage-104 is a root stage
  Stage-40 depends on stages: Stage-104
  Stage-105 is a root stage
  Stage-47 depends on stages: Stage-105
  Stage-106 is a root stage
  Stage-54 depends on stages: Stage-106
  Stage-0 depends on stages: Stage-58, Stage-59, Stage-60, Stage-61, Stage-62, Stage-63, Stage-64, Stage-65, Stage-5

STAGE PLANS:
  Stage: Stage-99
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 8) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Conditional Operator

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-92
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-93
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-94
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-61
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-95
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-96
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-63
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-97
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-98
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-65
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
               Inner Join 0 to 3
               Inner Join 0 to 4
               Inner Join 0 to 5
               Inner Join 0 to 6
               Inner Join 0 to 7
          keys:
            0 
            1 
            2 
            3 
            4 
            5 
            6 
            7 
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-100
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_4:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 9) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-101
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:$hdt$_4:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_2:$hdt$_5:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:$hdt$_4:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 9) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:$hdt$_5:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-102
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:$hdt$_4:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_3:$hdt$_5:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:$hdt$_6:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:$hdt$_4:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:$hdt$_5:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 10) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:$hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-103
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:$hdt$_5:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_4:$hdt$_6:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_4:$hdt$_7:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:$hdt$_5:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:$hdt$_6:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 10) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:$hdt$_7:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-104
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:$hdt$_6:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_5:$hdt$_7:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_5:$hdt$_8:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:$hdt$_6:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:$hdt$_7:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 11) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:$hdt$_8:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-105
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_6:$hdt$_7:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_6:$hdt$_8:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_6:$hdt$_9:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_6:$hdt$_7:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:$hdt$_8:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 11) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:$hdt$_9:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-106
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_7:$hdt$_10:store 
          Fetch Operator
            limit: -1
        $hdt$_7:$hdt$_8:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_7:$hdt$_9:time_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_7:$hdt$_10:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_7:$hdt$_8:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 12637 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6318 Data size: 75820 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_7:$hdt$_9:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 12) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query89.sql
STAGE DEPENDENCIES:
  Stage-15 is a root stage , consists of Stage-19, Stage-1
  Stage-19 has a backup stage: Stage-1
  Stage-14 depends on stages: Stage-19
  Stage-13 depends on stages: Stage-1, Stage-14 , consists of Stage-17, Stage-18, Stage-2
  Stage-17 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-17
  Stage-16 depends on stages: Stage-2, Stage-11, Stage-12
  Stage-4 depends on stages: Stage-16
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5
  Stage-18 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-18
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-15
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:item 
          TableScan
            alias: item
            Statistics: Num rows: 57516 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((i_class) IN ('wallpaper', 'parenting', 'musical') or (i_class) IN ('womens', 'birdal', 'pants')) and ((i_category) IN ('Home', 'Books', 'Electronics') or (i_category) IN ('Shoes', 'Jewelry', 'Men')) and (((i_category) IN ('Home', 'Books', 'Electronics') and (i_class) IN ('wallpaper', 'parenting', 'musical')) or ((i_category) IN ('Shoes', 'Jewelry', 'Men') and (i_class) IN ('womens', 'birdal', 'pants'))) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28758 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 28758 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7
                  Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col6, _col7, _col10
              Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_company_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 188 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col7, _col10, _col12, _col13
              Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col10 (type: int), _col12 (type: string), _col13 (type: string), _col7 (type: float)
                outputColumnNames: _col1, _col2, _col3, _col10, _col12, _col13, _col7
                Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col7)
                  keys: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col10 (type: int), _col12 (type: string), _col13 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: int), _col4 (type: string), _col5 (type: string)
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: int), _col4 (type: string), _col5 (type: string)
                    Statistics: Num rows: 1675060327 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col6 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: int), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 837530163 Data size: 13400482626 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col1 (type: string), _col0 (type: string), _col4 (type: string), _col5 (type: string), _col3 (type: int), _col6 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
            Statistics: Num rows: 837530163 Data size: 13400482626 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
              Statistics: Num rows: 837530163 Data size: 13400482626 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col5 (type: int), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col1 (type: int), VALUE._col2 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 837530163 Data size: 13400482626 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: string, _col5: int, _col6: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col0 ASC NULLS FIRST, _col2 ASC NULLS FIRST, _col3 ASC NULLS FIRST, _col4 ASC NULLS FIRST
                  partition by: _col0, _col2, _col3, _col4
                  raw input shape:
                  window functions:
                      window function definition
                        alias: avg_window_0
                        arguments: _col6
                        name: avg
                        window function: GenericUDAFAverageEvaluatorDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 837530163 Data size: 13400482626 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: avg_window_0 (type: double), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: double)
              outputColumnNames: avg_window_0, _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 837530163 Data size: 13400482626 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((avg_window_0 <> 0.0)) THEN (((abs((_col6 - avg_window_0)) / avg_window_0) > 0.1)) ELSE (null) END (type: boolean)
                Statistics: Num rows: 418765081 Data size: 6700241305 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: double), avg_window_0 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 418765081 Data size: 6700241305 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: (_col6 - _col7) (type: double), _col3 (type: string)
              sort order: ++
              Statistics: Num rows: 418765081 Data size: 6700241305 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: double), _col7 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: int), VALUE._col5 (type: double), VALUE._col6 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 418765081 Data size: 6700241305 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1600 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col6, _col7, _col10
                  Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col6 (type: int), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 429893 Data size: 5158719 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col6, _col7, _col10
          Statistics: Num rows: 1522782083 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 57516 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((i_class) IN ('wallpaper', 'parenting', 'musical') or (i_class) IN ('womens', 'birdal', 'pants')) and ((i_category) IN ('Home', 'Books', 'Electronics') or (i_category) IN ('Shoes', 'Jewelry', 'Men')) and (((i_category) IN ('Home', 'Books', 'Electronics') and (i_class) IN ('wallpaper', 'parenting', 'musical')) or ((i_category) IN ('Shoes', 'Jewelry', 'Men') and (i_class) IN ('womens', 'birdal', 'pants'))) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 28758 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 28758 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 28758 Data size: 8742440 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
          TableScan
            alias: store_sales
            Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1258497536 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col1 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7
          Statistics: Num rows: 1384347319 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query90.sql
STAGE DEPENDENCIES:
  Stage-28 is a root stage
  Stage-4 depends on stages: Stage-28
  Stage-19 depends on stages: Stage-4, Stage-13 , consists of Stage-26, Stage-27, Stage-5
  Stage-26 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-26
  Stage-6 depends on stages: Stage-5, Stage-17, Stage-18
  Stage-27 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-27
  Stage-5
  Stage-29 is a root stage
  Stage-13 depends on stages: Stage-29
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:web_page 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 8) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 9478 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9478 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 638472 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_hour BETWEEN 6 AND 7 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:web_page 
          TableScan
            alias: web_page
            Statistics: Num rows: 10601 Data size: 84812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wp_char_count BETWEEN 5000 AND 5200 and wp_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 1177 Data size: 9416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1177 Data size: 9416 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_hdemo_sk is not null and ws_sold_time_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: int), ws_ship_hdemo_sk (type: int), ws_web_page_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: decimal(35,20))
              sort order: +
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: decimal(35,20))
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_4:web_page 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 8) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 9478 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9478 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 638472 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_hour BETWEEN 14 AND 15 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 567528 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_4:web_page 
          TableScan
            alias: web_page
            Statistics: Num rows: 10601 Data size: 84812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wp_char_count BETWEEN 5000 AND 5200 and wp_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 1177 Data size: 9416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1177 Data size: 9416 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_hdemo_sk is not null and ws_sold_time_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: int), ws_ship_hdemo_sk (type: int), ws_web_page_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query91.sql
STAGE DEPENDENCIES:
  Stage-38 is a root stage
  Stage-28 depends on stages: Stage-38
  Stage-27 depends on stages: Stage-28 , consists of Stage-36, Stage-37, Stage-2
  Stage-36 has a backup stage: Stage-2
  Stage-25 depends on stages: Stage-36
  Stage-24 depends on stages: Stage-2, Stage-25, Stage-26 , consists of Stage-34, Stage-35, Stage-3
  Stage-34 has a backup stage: Stage-3
  Stage-22 depends on stages: Stage-34
  Stage-21 depends on stages: Stage-3, Stage-22, Stage-23 , consists of Stage-32, Stage-33, Stage-4
  Stage-32 has a backup stage: Stage-4
  Stage-19 depends on stages: Stage-32
  Stage-18 depends on stages: Stage-4, Stage-19, Stage-20 , consists of Stage-30, Stage-31, Stage-5
  Stage-30 has a backup stage: Stage-5
  Stage-16 depends on stages: Stage-30
  Stage-29 depends on stages: Stage-5, Stage-16, Stage-17
  Stage-7 depends on stages: Stage-29
  Stage-8 depends on stages: Stage-7
  Stage-31 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-31
  Stage-5
  Stage-33 has a backup stage: Stage-4
  Stage-20 depends on stages: Stage-33
  Stage-4
  Stage-35 has a backup stage: Stage-3
  Stage-23 depends on stages: Stage-35
  Stage-3
  Stage-37 has a backup stage: Stage-2
  Stage-26 depends on stages: Stage-37
  Stage-2
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:call_center 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:call_center 
          TableScan
            alias: call_center
            Statistics: Num rows: 8 Data size: 2522 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cc_call_center_sk is not null (type: boolean)
              Statistics: Num rows: 8 Data size: 2522 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cc_call_center_sk (type: int), cc_call_center_id (type: string), cc_name (type: string), cc_manager (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 8 Data size: 2522 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_call_center_sk is not null and cr_returned_date_sk is not null and cr_returning_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_returned_date_sk (type: int), cr_returning_customer_sk (type: int), cr_call_center_sk (type: int), cr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 69327832 Data size: 1109245312 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col7
                  Statistics: Num rows: 76260616 Data size: 1220169869 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-27
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 11) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col5, _col7
              Statistics: Num rows: 83886679 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col7, _col12, _col13, _col14
              Statistics: Num rows: 92275348 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -7) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col14 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col7, _col12, _col13
              Statistics: Num rows: 101502885 Data size: 1624046199 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:customer_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = 'Unknown') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'W')) and (((cd_marital_status = 'M') and (cd_education_status = 'Unknown')) or ((cd_marital_status = 'W') and (cd_education_status = 'Advanced Degree'))) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col12 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col12 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col7, _col13, _col18, _col19
              Statistics: Num rows: 111653175 Data size: 1786450857 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_6:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_6:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 1458 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_buy_potential like '0-500%') and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 729 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 729 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col13 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col13 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col7, _col18, _col19
              Statistics: Num rows: 122818495 Data size: 1965095985 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col18 (type: string), _col19 (type: string), _col7 (type: float)
                outputColumnNames: _col1, _col2, _col3, _col18, _col19, _col7
                Statistics: Num rows: 122818495 Data size: 1965095985 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col7)
                  keys: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col18 (type: string), _col19 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 122818495 Data size: 1965095985 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
                    sort order: +++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
                    Statistics: Num rows: 122818495 Data size: 1965095985 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 61409247 Data size: 982547984 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 61409247 Data size: 982547984 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: double)
              sort order: -
              Statistics: Num rows: 61409247 Data size: 982547984 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 61409247 Data size: 982547984 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 61409247 Data size: 982547984 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col12 (type: int)
                1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = 'Unknown') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'W')) and (((cd_marital_status = 'M') and (cd_education_status = 'Unknown')) or ((cd_marital_status = 'W') and (cd_education_status = 'Advanced Degree'))) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col12 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col7, _col13, _col18, _col19
                  Statistics: Num rows: 111653175 Data size: 1786450857 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col12 (type: int)
              sort order: +
              Map-reduce partition columns: _col12 (type: int)
              Statistics: Num rows: 101502885 Data size: 1624046199 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col7 (type: float), _col13 (type: int)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 395392 Data size: 80660096 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = 'Unknown') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'W')) and (((cd_marital_status = 'M') and (cd_education_status = 'Unknown')) or ((cd_marital_status = 'W') and (cd_education_status = 'Advanced Degree'))) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 197696 Data size: 40330048 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col12 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col7, _col13, _col18, _col19
          Statistics: Num rows: 111653175 Data size: 1786450857 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col14 (type: int)
                1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -7) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col7, _col12, _col13
                  Statistics: Num rows: 101502885 Data size: 1624046199 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col14 (type: int)
              sort order: +
              Map-reduce partition columns: _col14 (type: int)
              Statistics: Num rows: 92275348 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col7 (type: float), _col12 (type: int), _col13 (type: int)
          TableScan
            alias: customer_address
            Statistics: Num rows: 5313245 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -7) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2656622 Data size: 21252977 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col14 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col7, _col12, _col13
          Statistics: Num rows: 101502885 Data size: 1624046199 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col7, _col12, _col13, _col14
                  Statistics: Num rows: 92275348 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int)
              sort order: +
              Map-reduce partition columns: _col5 (type: int)
              Statistics: Num rows: 83886679 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col7 (type: float)
          TableScan
            alias: customer
            Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 6415787 Data size: 102652592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col7, _col12, _col13, _col14
          Statistics: Num rows: 92275348 Data size: 1476405604 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 11) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col5, _col7
                  Statistics: Num rows: 83886679 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 76260616 Data size: 1220169869 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col5 (type: int), _col7 (type: float)
          TableScan
            alias: date_dim
            Statistics: Num rows: 859786 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 11) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 214946 Data size: 2579353 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col5, _col7
          Statistics: Num rows: 83886679 Data size: 1342186884 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query92.sql
STAGE DEPENDENCIES:
  Stage-10 is a root stage , consists of Stage-13, Stage-1
  Stage-13 has a backup stage: Stage-1
  Stage-9 depends on stages: Stage-13
  Stage-2 depends on stages: Stage-1, Stage-9
  Stage-3 depends on stages: Stage-2, Stage-7
  Stage-4 depends on stages: Stage-3
  Stage-1
  Stage-12 is a root stage , consists of Stage-14, Stage-6
  Stage-14 has a backup stage: Stage-6
  Stage-11 depends on stages: Stage-14
  Stage-7 depends on stages: Stage-6, Stage-11
  Stage-6
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-10
    Conditional Operator

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_month_seq >= 1206) and (d_month_seq <= 1217) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: int), _col1 (type: int)
                    outputColumnNames: _col2, _col1
                    Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col2 (type: int), _col1 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int)
            1 _col0 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col2
          Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CASE WHEN ((_col0 is not null and _col2 is null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is null and _col2 is not null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is not null and _col2 is not null)) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col0), sum(_col1), sum(_col2)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: d1
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_month_seq >= 1206) and (d_month_seq <= 1217) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: int), _col1 (type: int)
            outputColumnNames: _col2, _col1
            Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col2 (type: int), _col1 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_month_seq >= 1206) and (d_month_seq <= 1217) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col1 (type: int), _col2 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: d2
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_month_seq >= 1206) and (d_month_seq <= 1217) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col1 (type: int), _col2 (type: int)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query93.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-8 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 838998357 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_reason_sk is not null and sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_reason_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 85357894 Data size: 1707157888 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col2 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col6, _col8
          Statistics: Num rows: 922898212 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:reason 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:reason 
          TableScan
            alias: reason
            Statistics: Num rows: 14 Data size: 1463 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((r_reason_desc = 'Did not like the warranty') and r_reason_sk is not null) (type: boolean)
              Statistics: Num rows: 7 Data size: 731 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_reason_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 7 Data size: 731 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col8
              Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), CASE WHEN (_col8 is not null) THEN ((UDFToFloat((_col3 - _col8)) * _col4)) ELSE ((UDFToFloat(_col3) * _col4)) END (type: float)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 1015188055 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 507594027 Data size: 12182256664 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double), _col0 (type: int)
              sort order: ++
              Statistics: Num rows: 507594027 Data size: 12182256664 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: int), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 507594027 Data size: 12182256664 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2400 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query94.sql
STAGE DEPENDENCIES:
  Stage-7 is a root stage
  Stage-23 depends on stages: Stage-7 , consists of Stage-30, Stage-1
  Stage-30 has a backup stage: Stage-1
  Stage-22 depends on stages: Stage-30
  Stage-21 depends on stages: Stage-1, Stage-22 , consists of Stage-28, Stage-29, Stage-2
  Stage-28 has a backup stage: Stage-2
  Stage-19 depends on stages: Stage-28
  Stage-27 depends on stages: Stage-2, Stage-19, Stage-20
  Stage-18 depends on stages: Stage-27
  Stage-17 depends on stages: Stage-18 , consists of Stage-25, Stage-26, Stage-4
  Stage-25 has a backup stage: Stage-4
  Stage-15 depends on stages: Stage-25
  Stage-14 depends on stages: Stage-4, Stage-15, Stage-16 , consists of Stage-24, Stage-5
  Stage-24 has a backup stage: Stage-5
  Stage-13 depends on stages: Stage-24
  Stage-6 depends on stages: Stage-5, Stage-13
  Stage-5
  Stage-26 has a backup stage: Stage-4
  Stage-16 depends on stages: Stage-26
  Stage-4
  Stage-29 has a backup stage: Stage-2
  Stage-20 depends on stages: Stage-29
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws2
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: ws3
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col0 <> _col2) (type: boolean)
            Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:ca 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:ca 
          TableScan
            alias: ca
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'TX') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5
              Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:s 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:s 
          TableScan
            alias: s
            Statistics: Num rows: 60 Data size: 6255 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((web_company_name = 'pri') and web_site_sk is not null) (type: boolean)
              Statistics: Num rows: 30 Data size: 3127 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: web_site_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 30 Data size: 3127 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col5
              Statistics: Num rows: 928136530 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:d 
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1999-05-01' AND '1999-07-01' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5
              Statistics: Num rows: 1020950205 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:wr1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:wr1 
          TableScan
            alias: wr1
            Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col3, _col4, _col5, _col12
              Statistics: Num rows: 1123045249 Data size: 13476543036 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: _col12 is null (type: boolean)
                Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
                  outputColumnNames: _col3, _col4, _col5
                  Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                    keys: _col3 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col0:0._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col3 (type: bigint)
              Statistics: Num rows: 1020950205 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col5 (type: float)
          TableScan
            alias: wr1
            Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col3, _col4, _col5, _col12
          Statistics: Num rows: 1123045249 Data size: 13476543036 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: _col12 is null (type: boolean)
            Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
              outputColumnNames: _col3, _col4, _col5
              Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                keys: _col3 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 561522624 Data size: 6738271512 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1999-05-01' AND '1999-07-01' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5
                  Statistics: Num rows: 1020950205 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 928136530 Data size: 11137638391 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1999-05-01' AND '1999-07-01' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5
          Statistics: Num rows: 1020950205 Data size: 12251402495 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ca
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'TX') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
          TableScan
            alias: ca
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'TX') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5
          Statistics: Num rows: 843760464 Data size: 10125125591 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col3 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col3 (type: bigint)
                  Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query95.sql
STAGE DEPENDENCIES:
  Stage-6 is a root stage
  Stage-22 depends on stages: Stage-6, Stage-8, Stage-23, Stage-24 , consists of Stage-31, Stage-1
  Stage-31 has a backup stage: Stage-1
  Stage-21 depends on stages: Stage-31
  Stage-20 depends on stages: Stage-1, Stage-21 , consists of Stage-29, Stage-30, Stage-2
  Stage-29 has a backup stage: Stage-2
  Stage-18 depends on stages: Stage-29
  Stage-28 depends on stages: Stage-2, Stage-18, Stage-19
  Stage-17 depends on stages: Stage-28
  Stage-16 depends on stages: Stage-17 , consists of Stage-26, Stage-27, Stage-4
  Stage-26 has a backup stage: Stage-4
  Stage-14 depends on stages: Stage-26
  Stage-5 depends on stages: Stage-4, Stage-14, Stage-15
  Stage-27 has a backup stage: Stage-4
  Stage-15 depends on stages: Stage-27
  Stage-4
  Stage-30 has a backup stage: Stage-2
  Stage-19 depends on stages: Stage-30
  Stage-2
  Stage-1
  Stage-9 is a root stage
  Stage-25 depends on stages: Stage-9 , consists of Stage-32, Stage-33, Stage-8
  Stage-32 has a backup stage: Stage-8
  Stage-23 depends on stages: Stage-32
  Stage-33 has a backup stage: Stage-8
  Stage-24 depends on stages: Stage-33
  Stage-8
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws2
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: ws3
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col0 <> _col2) (type: boolean)
            Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                       Left Semi Join 0 to 2
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                    2 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 1687520928 Data size: 20250251182 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:ca 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:ca 
          TableScan
            alias: ca
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'GA') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5
              Statistics: Num rows: 1856273061 Data size: 22275276783 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:s 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:s 
          TableScan
            alias: s
            Statistics: Num rows: 60 Data size: 6255 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((web_company_name = 'pri') and web_site_sk is not null) (type: boolean)
              Statistics: Num rows: 30 Data size: 3127 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: web_site_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 30 Data size: 3127 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col5
              Statistics: Num rows: 2041900411 Data size: 24502804992 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:d 
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-01' AND '2002-06-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5
              Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                keys: _col3 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col0:0._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-01' AND '2002-06-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5
                  Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                    keys: _col3 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 2041900411 Data size: 24502804992 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
          TableScan
            alias: d
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-01' AND '2002-06-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5
          Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
            keys: _col3 (type: bigint)
            mode: hash
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 2246090500 Data size: 26953086075 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ca
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'GA') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 1856273061 Data size: 22275276783 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 1687520928 Data size: 20250251182 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
          TableScan
            alias: ca
            Statistics: Num rows: 408711 Data size: 42505964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'GA') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 204355 Data size: 21252929 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1856273061 Data size: 22275276783 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col3 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col3 (type: bigint)
                  Statistics: Num rows: 271684150 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
               Left Semi Join 0 to 2
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
            2 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1687520928 Data size: 20250251182 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws4
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: ws5
            Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 633929685 Data size: 7607156224 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col0 <> _col2) (type: boolean)
            Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: wr
            Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:wr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:wr 
          TableScan
            alias: wr
            Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: wr
            Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 64538132 Data size: 516305056 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 697322668 Data size: 8367872027 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0
          Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col0 (type: bigint)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 767054951 Data size: 9204659429 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query96.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage
  Stage-4 depends on stages: Stage-12
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 18956 Data size: 151653 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 5) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 9478 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9478 Data size: 75826 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 425648 Data size: 5107780 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 8) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 70941 Data size: 851292 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 369 Data size: 38462 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 184 Data size: 19178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 2233413770 Data size: 26800965268 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query97.sql
STAGE DEPENDENCIES:
  Stage-10 is a root stage , consists of Stage-13, Stage-1
  Stage-13 has a backup stage: Stage-1
  Stage-9 depends on stages: Stage-13
  Stage-2 depends on stages: Stage-1, Stage-9
  Stage-3 depends on stages: Stage-2, Stage-7
  Stage-4 depends on stages: Stage-3
  Stage-1
  Stage-12 is a root stage , consists of Stage-14, Stage-6
  Stage-14 has a backup stage: Stage-6
  Stage-11 depends on stages: Stage-14
  Stage-7 depends on stages: Stage-6, Stage-11
  Stage-6
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-10
    Conditional Operator

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: int), _col1 (type: int)
                    outputColumnNames: _col2, _col1
                    Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col2 (type: int), _col1 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 922898212 Data size: 11074778550 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int)
            1 _col0 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col2
          Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CASE WHEN ((_col0 is not null and _col2 is null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is null and _col2 is not null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is not null and _col2 is not null)) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1015188055 Data size: 12182256669 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col0), sum(_col1), sum(_col2)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_customer_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: int), _col1 (type: int)
            outputColumnNames: _col2, _col1
            Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col2 (type: int), _col1 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col1 (type: int), _col2 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 696921482 Data size: 8363057788 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_sold_date_sk is not null (type: boolean)
              Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1267129941 Data size: 15205559296 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: date_dim
            Statistics: Num rows: 1289679 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 143297 Data size: 1146376 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col1 (type: int), _col2 (type: int)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1393842965 Data size: 16726115588 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query98.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage , consists of Stage-15, Stage-1
  Stage-15 has a backup stage: Stage-1
  Stage-11 depends on stages: Stage-15
  Stage-10 depends on stages: Stage-1, Stage-11 , consists of Stage-13, Stage-14, Stage-2
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-3 depends on stages: Stage-2, Stage-8, Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-14 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-14
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 42855 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 2001-01-12 AND 2001-02-11 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
                outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
                Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
              sort order: +++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col3 (type: string), _col0 (type: string), _col1 (type: string), _col4 (type: float), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: string)
              sort order: +
              Map-reduce partition columns: _col3 (type: string)
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col3 (type: float), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: float, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col3 ASC NULLS FIRST
                  partition by: _col3
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col5
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col0 (type: string), _col5 (type: double), ((_col5 * 100.0) / sum_window_0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col0 (type: string), _col6 (type: double)
              sort order: +++++
              Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: float), KEY.reducesinkkey2 (type: string), VALUE._col1 (type: double), KEY.reducesinkkey4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1015188055 Data size: 12182256670 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 2001-01-12 AND 2001-02-11 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
                    outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
                    Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            alias: date_dim
            Statistics: Num rows: 99206 Data size: 10317438 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 2001-01-12 AND 2001-02-11 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 11022 Data size: 1146289 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col2 (type: float)
            outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col2
            Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 2030376111 Data size: 24364513352 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 1677996714 Data size: 20135960576 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float)
          TableScan
            alias: item
            Statistics: Num rows: 42855 Data size: 17484880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 21428 Data size: 8742644 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: float), _col4 (type: string), _col5 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 1845796425 Data size: 22149557113 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

