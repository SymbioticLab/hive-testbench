@@@sample-queries-tpch/tpch_query10.sql
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-15 depends on stages: Stage-20
  Stage-14 depends on stages: Stage-15 , consists of Stage-18, Stage-19, Stage-2
  Stage-18 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-18
  Stage-11 depends on stages: Stage-2, Stage-12, Stage-13 , consists of Stage-16, Stage-17, Stage-3
  Stage-16 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-16
  Stage-4 depends on stages: Stage-3, Stage-9, Stage-10
  Stage-5 depends on stages: Stage-4
  Stage-17 has a backup stage: Stage-3
  Stage-10 depends on stages: Stage-17
  Stage-3
  Stage-19 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-19
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:nation 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:nation 
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: n_nationkey is not null (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_name (type: string), c_address (type: string), c_nationkey (type: bigint), c_phone (type: string), c_acctbal (type: double), c_comment (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8
                  Statistics: Num rows: 1650000 Data size: 960300020 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:orders 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:orders 
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-07-01') and (o_orderdate < '1993-10-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9
              Statistics: Num rows: 1833332 Data size: 971666299 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_returnflag = 'R') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col9 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col9 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col13, _col14
              Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: bigint), _col1 (type: string), _col5 (type: double), _col4 (type: string), _col8 (type: string), _col2 (type: string), _col6 (type: string), (_col13 * (1.0 - _col14)) (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col7)
                  keys: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              sort order: +++++++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col7 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: string), KEY._col2 (type: double), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 16496164 Data size: 13284890777 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), _col1 (type: string), _col7 (type: double), _col2 (type: double), _col4 (type: string), _col5 (type: string), _col3 (type: string), _col6 (type: string)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 16496164 Data size: 13284890777 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: double)
              sort order: -
              Statistics: Num rows: 16496164 Data size: 13284890777 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: bigint), _col1 (type: string), _col3 (type: double), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: string), KEY.reducesinkkey0 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: string), VALUE._col4 (type: string), VALUE._col5 (type: string), VALUE._col6 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 16496164 Data size: 13284890777 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 20
            Statistics: Num rows: 20 Data size: 16100 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 20 Data size: 16100 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col9 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_returnflag = 'R') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col9 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col13, _col14
                  Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: string), _col5 (type: double), _col4 (type: string), _col8 (type: string), _col2 (type: string), _col6 (type: string), (_col13 * (1.0 - _col14)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col7)
                      keys: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col9 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col9 (type: bigint)
              Statistics: Num rows: 1833332 Data size: 971666299 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col1 (type: string), _col2 (type: string), _col4 (type: string), _col5 (type: double), _col6 (type: string), _col8 (type: string)
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_returnflag = 'R') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 29993026 Data size: 24154347078 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col9 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col13, _col14
          Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), _col1 (type: string), _col5 (type: double), _col4 (type: string), _col8 (type: string), _col2 (type: string), _col6 (type: string), (_col13 * (1.0 - _col14)) (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col7)
              keys: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 32992329 Data size: 26569782361 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-07-01') and (o_orderdate < '1993-10-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9
                  Statistics: Num rows: 1833332 Data size: 971666299 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 1650000 Data size: 960300020 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col5 (type: double), _col6 (type: string), _col8 (type: string)
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-07-01') and (o_orderdate < '1993-10-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9
          Statistics: Num rows: 1833332 Data size: 971666299 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 20
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query11.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q11_part_tmp_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q11_sum_tmp_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: ps_partkey bigint, part_value double
          expanded text: select
	`partsupp`.`ps_partkey`,
	sum(`partsupp`.`ps_supplycost` * `partsupp`.`ps_availqty`) as `part_value`
from
	`tpch_flat_orc_10`.`partsupp`,
	`tpch_flat_orc_10`.`supplier`,
	`tpch_flat_orc_10`.`nation`
where
	`partsupp`.`ps_suppkey` = `supplier`.`s_suppkey`
	and `supplier`.`s_nationkey` = `nation`.`n_nationkey`
	and `nation`.`n_name` = 'GERMANY'
group by `partsupp`.`ps_partkey`
          name: tpch_flat_orc_10.q11_part_tmp_cached
          original text: select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as part_value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'GERMANY'
group by ps_partkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query12.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-2
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipmode) IN ('REG AIR', 'MAIL') and (l_commitdate < l_receiptdate) and (l_shipdate < l_commitdate) and (l_receiptdate >= '1995-01-01') and (l_receiptdate < '1996-01-01') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 370284 Data size: 298201597 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_shipmode (type: string)
                outputColumnNames: _col0, _col4
                Statistics: Num rows: 370284 Data size: 298201597 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 370284 Data size: 298201597 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col6
          Statistics: Num rows: 16500000 Data size: 8745000189 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: string), CASE WHEN (((_col1 = '1-URGENT') or (_col1 = '2-HIGH'))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col1 <> '1-URGENT') and (_col1 <> '2-HIGH'))) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 16500000 Data size: 8745000189 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 16500000 Data size: 8745000189 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 16500000 Data size: 8745000189 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query13.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: c_custkey (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: bigint)
                sort order: +
                Map-reduce partition columns: _col0 (type: bigint)
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (not (o_comment like '%unusual%accounts%')) (type: boolean)
              Statistics: Num rows: 7500000 Data size: 3975000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7500000 Data size: 3975000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7500000 Data size: 3975000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: count(_col1)
            keys: _col0 (type: bigint)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 8250000 Data size: 4372500094 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 4125000 Data size: 2186250047 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint)
            outputColumnNames: _col1
            Statistics: Num rows: 4125000 Data size: 2186250047 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              keys: _col1 (type: bigint)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 4125000 Data size: 2186250047 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 4125000 Data size: 2186250047 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 2062500 Data size: 1093125023 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint), _col0 (type: bigint)
              sort order: --
              Statistics: Num rows: 2062500 Data size: 1093125023 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 2062500 Data size: 1093125023 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 2062500 Data size: 1093125023 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query14.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1995-08-01') and (l_shipdate < '1995-09-01') and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_partkey is not null (type: boolean)
              Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint), p_type (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col2, _col5
          Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CASE WHEN ((_col5 like 'PROMO%')) THEN ((_col1 * (1.0 - _col2))) ELSE (0) END (type: double), (_col1 * (1.0 - _col2)) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col0), sum(_col1)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: ((100.0 * _col0) / _col1) (type: double)
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query15.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: revenue_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: max_revenue_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: supplier_no bigint, total_revenue double
          expanded text: select
	`lineitem`.`l_suppkey` as `supplier_no`,
	sum(`lineitem`.`l_extendedprice` * (1 - `lineitem`.`l_discount`)) as `total_revenue`
from
	`tpch_flat_orc_10`.`lineitem`
where
	`lineitem`.`l_shipdate` >= '1996-01-01'
	and `lineitem`.`l_shipdate` < '1996-04-01'
group by `lineitem`.`l_suppkey`
          name: tpch_flat_orc_10.revenue_cached
          original text: select
	l_suppkey as supplier_no,
	sum(l_extendedprice * (1 - l_discount)) as total_revenue
from
	lineitem
where
	l_shipdate >= '1996-01-01'
	and l_shipdate < '1996-04-01'
group by l_suppkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query16.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-13 depends on stages: Stage-1, Stage-7 , consists of Stage-15, Stage-16, Stage-2
  Stage-15 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-15
  Stage-10 depends on stages: Stage-2, Stage-8, Stage-11, Stage-12 , consists of Stage-14, Stage-3
  Stage-14 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-14
  Stage-4 depends on stages: Stage-3, Stage-9
  Stage-5 depends on stages: Stage-4
  Stage-3
  Stage-16 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-16
  Stage-2
  Stage-7 is a root stage
  Stage-8 is a root stage
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: partsupp
            Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ps_partkey is not null (type: boolean)
              Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_size) IN (22, 14, 27, 49, 21, 33, 35, 28) and (p_brand <> 'Brand#34') and p_partkey is not null and (not (p_type like 'ECONOMY BRUSHED%'))) (type: boolean)
              Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint), p_brand (type: string), p_type (type: string), p_size (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col5
          Statistics: Num rows: 8800000 Data size: 2068000044 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 8800000 Data size: 2217600044 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9
              Statistics: Num rows: 9680000 Data size: 2439360101 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((_col6 = 0) or (_col9 is null and _col1 is not null and (_col7 >= _col6))) (type: boolean)
                Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
                  outputColumnNames: _col3, _col4, _col5, _col1
                  Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(DISTINCT _col1)
                    keys: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: bigint)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col3:0._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 3226666 Data size: 813119865 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: bigint), _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: -+++
              Statistics: Num rows: 3226666 Data size: 813119865 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 3226666 Data size: 813119865 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 3226666 Data size: 813119865 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 8800000 Data size: 2217600044 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: bigint), _col7 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 25000 Data size: 11975000 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: boolean)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9
          Statistics: Num rows: 9680000 Data size: 2439360101 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((_col6 = 0) or (_col9 is null and _col1 is not null and (_col7 >= _col6))) (type: boolean)
            Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col5, _col1
              Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT _col1)
                keys: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 6453333 Data size: 1626239983 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 8800000 Data size: 2217600044 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 8800000 Data size: 2068000044 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col3 (type: string), _col4 (type: string), _col5 (type: int)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 8800000 Data size: 2217600044 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_comment like '%Customer%Complaints%') (type: boolean)
              Statistics: Num rows: 50000 Data size: 23950000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint)
                outputColumnNames: s_suppkey
                Statistics: Num rows: 50000 Data size: 23950000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), count(s_suppkey)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: bigint), _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), count(VALUE._col1)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_comment like '%Customer%Complaints%') (type: boolean)
              Statistics: Num rows: 50000 Data size: 23950000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint)
                outputColumnNames: s_suppkey
                Statistics: Num rows: 50000 Data size: 23950000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: s_suppkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 50000 Data size: 23950000 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 50000 Data size: 23950000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25000 Data size: 11975000 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), true (type: boolean)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 25000 Data size: 11975000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query17.sql
STAGE DEPENDENCIES:
  Stage-5 is a root stage
  Stage-13 depends on stages: Stage-5 , consists of Stage-16, Stage-17, Stage-1
  Stage-16 has a backup stage: Stage-1
  Stage-11 depends on stages: Stage-16
  Stage-2 depends on stages: Stage-1, Stage-11, Stage-12
  Stage-10 depends on stages: Stage-2, Stage-6 , consists of Stage-14, Stage-15, Stage-3
  Stage-14 has a backup stage: Stage-3
  Stage-8 depends on stages: Stage-14
  Stage-4 depends on stages: Stage-3, Stage-8, Stage-9
  Stage-15 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-15
  Stage-3
  Stage-17 has a backup stage: Stage-1
  Stage-12 depends on stages: Stage-17
  Stage-1
  Stage-6 is a root stage
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_brand = 'Brand#23') and (p_container = 'MED BOX') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: p_partkey
                Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: p_partkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 250000 Data size: 154500000 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: avg(_col1)
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: struct<count:bigint,sum:double,input:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 32992329 Data size: 26569782362 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), (0.2 * _col1) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 32992329 Data size: 26569782362 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col2 < _col1) (type: boolean)
                Statistics: Num rows: 24194375 Data size: 19484507487 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: double)
                  outputColumnNames: _col4
                  Statistics: Num rows: 24194375 Data size: 19484507487 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col4)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CAST( (_col0 / 7.0) AS decimal(32,2)) (type: decimal(32,2))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col2 < _col1) (type: boolean)
                Statistics: Num rows: 24194375 Data size: 19484507487 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: double)
                  outputColumnNames: _col4
                  Statistics: Num rows: 24194375 Data size: 19484507487 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col4)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 32992329 Data size: 26569782362 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col2 < _col1) (type: boolean)
            Statistics: Num rows: 24194375 Data size: 19484507487 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col4 (type: double)
              outputColumnNames: _col4
              Statistics: Num rows: 24194375 Data size: 19484507487 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: avg(_col1)
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 250000 Data size: 154500000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: avg(_col1)
            keys: _col0 (type: bigint)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double), l_extendedprice (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_brand = 'Brand#23') and (p_container = 'MED BOX') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 500000 Data size: 309000000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: double), _col0 (type: bigint), _col2 (type: double)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query18.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q18_tmp_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q18_large_volume_customer_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: l_orderkey bigint, t_sum_quantity double
          expanded text: select
	`lineitem`.`l_orderkey`,
	sum(`lineitem`.`l_quantity`) as `t_sum_quantity`
from
	`tpch_flat_orc_10`.`lineitem`
where
	`lineitem`.`l_orderkey` is not null
group by
	`lineitem`.`l_orderkey`
          name: tpch_flat_orc_10.q18_tmp_cached
          original text: select
	l_orderkey,
	sum(l_quantity) as t_sum_quantity
from
	lineitem
where
	l_orderkey is not null
group by
	l_orderkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query19.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipmode) IN ('AIR', 'AIR REG') and (l_shipinstruct = 'DELIVER IN PERSON') and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 14996513 Data size: 12077173539 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14996513 Data size: 12077173539 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 14996513 Data size: 12077173539 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_partkey is not null (type: boolean)
              Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint), p_brand (type: string), p_size (type: int), p_container (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: int), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col2, _col3, _col7, _col8, _col9
          Statistics: Num rows: 16496164 Data size: 13284891180 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (((_col7 = 'Brand#32') and (_col9) IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and (_col1 >= 7.0) and (_col1 <= 17.0) and _col8 BETWEEN 1 AND 5) or ((_col7 = 'Brand#35') and (_col9) IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and (_col1 >= 15.0) and (_col1 <= 25.0) and _col8 BETWEEN 1 AND 10) or ((_col7 = 'Brand#24') and (_col9) IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and (_col1 >= 26.0) and (_col1 <= 36.0) and _col8 BETWEEN 1 AND 15)) (type: boolean)
            Statistics: Num rows: 152742 Data size: 123008042 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: (_col2 * (1.0 - _col3)) (type: double)
              outputColumnNames: _col0
              Statistics: Num rows: 152742 Data size: 123008042 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col0)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query1.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_shipdate <= '1998-09-16') (type: boolean)
              Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_returnflag (type: string), l_linestatus (type: string), l_quantity (type: double), l_extendedprice (type: double), (l_extendedprice * (1.0 - l_discount)) (type: double), ((l_extendedprice * (1.0 - l_discount)) * (1.0 + l_tax)) (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), avg(_col2), avg(_col3), avg(_col6), count()
                  keys: _col0 (type: string), _col1 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                    Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: struct<count:bigint,sum:double,input:double>), _col7 (type: struct<count:bigint,sum:double,input:double>), _col8 (type: struct<count:bigint,sum:double,input:double>), _col9 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), avg(VALUE._col4), avg(VALUE._col5), avg(VALUE._col6), count(VALUE._col7)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query20.sql
STAGE DEPENDENCIES:
  Stage-3 is a root stage
  Stage-14 depends on stages: Stage-3, Stage-7 , consists of Stage-20, Stage-21, Stage-4
  Stage-20 has a backup stage: Stage-4
  Stage-12 depends on stages: Stage-20
  Stage-11 depends on stages: Stage-4, Stage-12, Stage-13 , consists of Stage-19, Stage-1
  Stage-19 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-19
  Stage-2 depends on stages: Stage-1, Stage-10
  Stage-1
  Stage-21 has a backup stage: Stage-4
  Stage-13 depends on stages: Stage-21
  Stage-4
  Stage-24 is a root stage
  Stage-18 depends on stages: Stage-24
  Stage-17 depends on stages: Stage-18 , consists of Stage-22, Stage-23, Stage-6
  Stage-22 has a backup stage: Stage-6
  Stage-15 depends on stages: Stage-22
  Stage-7 depends on stages: Stage-6, Stage-15, Stage-16
  Stage-23 has a backup stage: Stage-6
  Stage-16 depends on stages: Stage-23
  Stage-6
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: partsupp
            Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_availqty (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint), _col2 (type: int)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_name like 'forest%') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 8800000 Data size: 2068000044 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 9680000 Data size: 2274800097 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col2) > _col4) (type: boolean)
                Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_suppkey is not null (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_name (type: string), s_address (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: string), _col2 (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_suppkey is not null (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_name (type: string), s_address (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: string), _col2 (type: string)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 3549332 Data size: 834093214 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 9680000 Data size: 2274800097 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col2) > _col4) (type: boolean)
                Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint), _col0 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
              Statistics: Num rows: 8800000 Data size: 2068000044 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col2 (type: bigint), _col0 (type: bigint)
              Statistics: Num rows: 3665813 Data size: 2952197243 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint), _col0 (type: bigint)
            1 _col2 (type: bigint), _col0 (type: bigint)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 9680000 Data size: 2274800097 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (UDFToDouble(_col2) > _col4) (type: boolean)
            Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 3226666 Data size: 758266542 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:$hdt$_4:$hdt$_5:nation 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:$hdt$_4:$hdt$_5:nation 
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((n_name = 'CANADA') and n_nationkey is not null) (type: boolean)
              Statistics: Num rows: 12 Data size: 3180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 12 Data size: 3180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_nationkey is not null and s_suppkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1994-01-01') and (l_shipdate <= '1995-01-01') and l_suppkey is not null and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: double)
                    outputColumnNames: _col1, _col0, _col2
                    Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col1 (type: bigint), _col0 (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 3665813 Data size: 2952197243 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), (0.5 * _col2) (type: double), _col0 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 3665813 Data size: 2952197243 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:$hdt$_3:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:$hdt$_3:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1994-01-01') and (l_shipdate <= '1995-01-01') and l_suppkey is not null and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: double)
                outputColumnNames: _col1, _col0, _col2
                Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col1 (type: bigint), _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1994-01-01') and (l_shipdate <= '1995-01-01') and l_suppkey is not null and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: double)
            outputColumnNames: _col1, _col0, _col2
            Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col1 (type: bigint), _col0 (type: bigint)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 7331627 Data size: 5904395292 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query21.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-0
  Stage-2 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_receiptdate > l_commitdate) and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint)
                outputColumnNames: l_orderkey, l_suppkey
                Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(DISTINCT l_suppkey)
                  keys: l_orderkey (type: bigint), l_suppkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col1 (type: bigint)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col1:0._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 = 1) (type: boolean)
            Statistics: Num rows: 1 Data size: 805 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: bigint), 1 (type: bigint)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 805 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 805 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: tpch_flat_orc_10.l3

  Stage: Stage-0
    Move Operator
      files:
          hdfs directory: true
          destination: hdfs://dc1master:9000/tmp/hive/wentingt/80376867-45f8-4729-bb26-b84aac77a8e7/_tmp_space.db/9014c3e1-0271-4f0d-a450-64b9a21ce2d8

  Stage: Stage-3
      Create Table Operator:
        Create Table
          columns: l_orderkey bigint, cntsupp bigint
          input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
          location: hdfs://dc1master:9000/tmp/hive/wentingt/80376867-45f8-4729-bb26-b84aac77a8e7/_tmp_space.db/9014c3e1-0271-4f0d-a450-64b9a21ce2d8
          output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
          serde name: org.apache.hadoop.hive.ql.io.orc.OrcSerde
          name: tpch_flat_orc_10.l3
          isTemporary: true

  Stage: Stage-2
    Stats-Aggr Operator

@@@sample-queries-tpch/tpch_query22.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q22_customer_tmp_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q22_customer_tmp1_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q22_orders_tmp_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          if not exists: true
          or replace: false
          columns: c_acctbal double, c_custkey bigint, cntrycode string
          expanded text: select
	`customer`.`c_acctbal`,
	`customer`.`c_custkey`,
	substr(`customer`.`c_phone`, 1, 2) as `cntrycode`
from
	`tpch_flat_orc_10`.`customer`
where
	substr(`customer`.`c_phone`, 1, 2) = '13' or
	substr(`customer`.`c_phone`, 1, 2) = '31' or
	substr(`customer`.`c_phone`, 1, 2) = '23' or
	substr(`customer`.`c_phone`, 1, 2) = '29' or
	substr(`customer`.`c_phone`, 1, 2) = '30' or
	substr(`customer`.`c_phone`, 1, 2) = '18' or
	substr(`customer`.`c_phone`, 1, 2) = '17'
          name: tpch_flat_orc_10.q22_customer_tmp_cached
          original text: select
	c_acctbal,
	c_custkey,
	substr(c_phone, 1, 2) as cntrycode
from
	customer
where
	substr(c_phone, 1, 2) = '13' or
	substr(c_phone, 1, 2) = '31' or
	substr(c_phone, 1, 2) = '23' or
	substr(c_phone, 1, 2) = '29' or
	substr(c_phone, 1, 2) = '30' or
	substr(c_phone, 1, 2) = '18' or
	substr(c_phone, 1, 2) = '17'
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query2.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q2_min_ps_supplycost

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: min_p_partkey bigint, min_ps_supplycost double
          expanded text: select
	`part`.`p_partkey` as `min_p_partkey`,
	min(`partsupp`.`ps_supplycost`) as `min_ps_supplycost`
from
	`tpch_flat_orc_10`.`part`,
	`tpch_flat_orc_10`.`partsupp`,
	`tpch_flat_orc_10`.`supplier`,
	`tpch_flat_orc_10`.`nation`,
	`tpch_flat_orc_10`.`region`
where
	`part`.`p_partkey` = `partsupp`.`ps_partkey`
	and `supplier`.`s_suppkey` = `partsupp`.`ps_suppkey`
	and `supplier`.`s_nationkey` = `nation`.`n_nationkey`
	and `nation`.`n_regionkey` = `region`.`r_regionkey`
	and `region`.`r_name` = 'EUROPE'
group by
	`part`.`p_partkey`
          name: tpch_flat_orc_10.q2_min_ps_supplycost
          original text: select
	p_partkey as min_p_partkey,
	min(ps_supplycost) as min_ps_supplycost
from
	part,
	partsupp,
	supplier,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
group by
	p_partkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query3.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-9 depends on stages: Stage-1 , consists of Stage-10, Stage-11, Stage-2
  Stage-10 has a backup stage: Stage-2
  Stage-7 depends on stages: Stage-10
  Stage-3 depends on stages: Stage-2, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-11 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-11
  Stage-2
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate < '1995-03-22') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 5000000 Data size: 2650000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint), o_orderdate (type: string), o_shippriority (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 5000000 Data size: 2650000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 5000000 Data size: 2650000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_mktsegment = 'BUILDING') and c_custkey is not null) (type: boolean)
              Statistics: Num rows: 750000 Data size: 436500000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 750000 Data size: 436500000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 750000 Data size: 436500000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col2, _col3
          Statistics: Num rows: 5500000 Data size: 2915000063 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-10
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate > '1995-03-22') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8
              Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: bigint), _col2 (type: string), _col3 (type: int), (_col7 * (1.0 - _col8)) (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col1 (type: string), _col0 (type: bigint), _col2 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: bigint), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: bigint), _col2 (type: int)
              Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: bigint), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 10997442 Data size: 8856593422 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col3 (type: double), _col0 (type: string), _col2 (type: int)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 10997442 Data size: 8856593422 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double), _col2 (type: string)
              sort order: -+
              Statistics: Num rows: 10997442 Data size: 8856593422 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: bigint), _col3 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: bigint), KEY.reducesinkkey0 (type: double), KEY.reducesinkkey1 (type: string), VALUE._col1 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 10997442 Data size: 8856593422 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 10
            Statistics: Num rows: 10 Data size: 8050 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 10 Data size: 8050 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-11
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate > '1995-03-22') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col3, _col6, _col7, _col8
                  Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: bigint), _col2 (type: string), _col3 (type: int), (_col7 * (1.0 - _col8)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col1 (type: string), _col0 (type: bigint), _col2 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 5500000 Data size: 2915000063 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: string), _col3 (type: int)
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate > '1995-03-22') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 19995350 Data size: 16102897515 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8
          Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: bigint), _col2 (type: string), _col3 (type: int), (_col7 * (1.0 - _col8)) (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col1 (type: string), _col0 (type: bigint), _col2 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 21994885 Data size: 17713187650 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query4.sql
STAGE DEPENDENCIES:
  Stage-4 is a root stage
  Stage-7 depends on stages: Stage-4 , consists of Stage-8, Stage-9, Stage-1
  Stage-8 has a backup stage: Stage-1
  Stage-5 depends on stages: Stage-8
  Stage-2 depends on stages: Stage-1, Stage-5, Stage-6
  Stage-3 depends on stages: Stage-2
  Stage-9 has a backup stage: Stage-1
  Stage-6 depends on stages: Stage-9
  Stage-1
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_orderkey = l_orderkey) and (l_commitdate < l_receiptdate)) (type: boolean)
              Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint)
                outputColumnNames: l_orderkey
                Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: l_orderkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 9997675 Data size: 8051448757 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 4998837 Data size: 4025723975 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Conditional Operator

  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: o
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1996-05-01') and (o_orderdate < '1996-08-01')) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2
                  Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count()
                    keys: _col2 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 2749360 Data size: 2214148234 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 2749360 Data size: 2214148234 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 2749360 Data size: 2214148234 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 2749360 Data size: 2214148234 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:o 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:o 
          TableScan
            alias: o
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1996-05-01') and (o_orderdate < '1996-08-01')) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2
              Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count()
                keys: _col2 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: o
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1996-05-01') and (o_orderdate < '1996-08-01')) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 4998837 Data size: 4025723975 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2
          Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: count()
            keys: _col2 (type: string)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 5498720 Data size: 4428296468 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query5.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-17 depends on stages: Stage-1, Stage-18 , consists of Stage-22, Stage-23, Stage-2
  Stage-22 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-22
  Stage-14 depends on stages: Stage-2, Stage-15, Stage-16 , consists of Stage-20, Stage-21, Stage-3
  Stage-20 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-20
  Stage-4 depends on stages: Stage-3, Stage-12, Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-21 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-21
  Stage-3
  Stage-23 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-23
  Stage-2
  Stage-24 is a root stage
  Stage-18 depends on stages: Stage-24
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_orderkey is not null and l_suppkey is not null) (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-01-01') and (o_orderdate < '1994-01-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col2, _col3, _col5
          Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col3, _col5, _col8, _col10
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: bigint), _col8 (type: bigint)
                    1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: bigint), _col8 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col10
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), (_col2 * (1.0 - _col3)) (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double)
              sort order: -
              Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: bigint), _col8 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: bigint), _col8 (type: bigint)
                    1 _col0 (type: bigint), _col1 (type: bigint)
                  outputColumnNames: _col2, _col3, _col10
                  Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: string), (_col2 * (1.0 - _col3)) (type: double)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1)
                      keys: _col0 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint), _col8 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col5 (type: bigint), _col8 (type: bigint)
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: double), _col10 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                  Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: bigint), _col8 (type: bigint)
            1 _col0 (type: bigint), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col10
          Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), (_col2 * (1.0 - _col3)) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col0 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col3, _col5, _col8, _col10
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: double), _col5 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2, _col3, _col5, _col8, _col10
          Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_2:supplier 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:$hdt$_4:region 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_2:supplier 
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)
        $hdt$_0:$hdt$_2:$hdt$_4:region 
          TableScan
            alias: region
            Statistics: Num rows: 5 Data size: 1240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((r_name = 'AFRICA') and r_regionkey is not null) (type: boolean)
              Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_regionkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (n_nationkey is not null and n_regionkey is not null) (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string), n_regionkey (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 27 Data size: 7287 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col1 (type: bigint)
                    outputColumnNames: _col1, _col5, _col6
                    Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col5 (type: bigint), _col6 (type: bigint), _col1 (type: string)
                      outputColumnNames: _col0, _col1, _col3
                      Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query6.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1993-01-01') and (l_shipdate < '1994-01-01') and l_discount BETWEEN 0.05 AND 0.07 and (l_quantity < 25.0)) (type: boolean)
              Statistics: Num rows: 246856 Data size: 198801064 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: (l_extendedprice * l_discount) (type: double)
                outputColumnNames: _col0
                Statistics: Num rows: 246856 Data size: 198801064 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col0)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query7.sql
STAGE DEPENDENCIES:
  Stage-6 is a root stage
  Stage-17 depends on stages: Stage-6, Stage-18 , consists of Stage-21, Stage-22, Stage-7
  Stage-21 has a backup stage: Stage-7
  Stage-15 depends on stages: Stage-21
  Stage-13 depends on stages: Stage-7, Stage-14, Stage-15, Stage-16 , consists of Stage-19, Stage-20, Stage-2
  Stage-19 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-19
  Stage-3 depends on stages: Stage-2, Stage-11, Stage-12
  Stage-4 depends on stages: Stage-3
  Stage-20 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-20
  Stage-2
  Stage-22 has a backup stage: Stage-7
  Stage-16 depends on stages: Stage-22
  Stage-7
  Stage-23 is a root stage
  Stage-14 depends on stages: Stage-23
  Stage-24 is a root stage
  Stage-18 depends on stages: Stage-24
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (o_orderkey is not null and o_custkey is not null) (type: boolean)
              Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' and l_suppkey is not null and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double), l_shipdate (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 6665116 Data size: 5367631968 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6
          Statistics: Num rows: 16500000 Data size: 8745000189 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col4, _col5, _col6, _col10
              Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), _col10 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: string)
                outputColumnNames: _col1, _col10, _col4, _col5, _col6
                Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col3, _col8, _col9, _col10, _col14
              Statistics: Num rows: 19965000 Data size: 10581450686 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: double), _col9 (type: double), _col10 (type: string), _col14 (type: string), _col3 (type: string)
                outputColumnNames: _col4, _col5, _col6, _col12, _col14
                Statistics: Num rows: 19965000 Data size: 10581450686 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (((_col12 = 'KENYA') and (_col14 = 'PERU')) or ((_col12 = 'PERU') and (_col14 = 'KENYA'))) (type: boolean)
                  Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col12 (type: string), _col14 (type: string), year(_col6) (type: int), (_col4 * (1.0 - _col5)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 4991250 Data size: 2645362671 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Statistics: Num rows: 4991250 Data size: 2645362671 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 4991250 Data size: 2645362671 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 4991250 Data size: 2645362671 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col3, _col8, _col9, _col10, _col14
              Statistics: Num rows: 19965000 Data size: 10581450686 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: double), _col9 (type: double), _col10 (type: string), _col14 (type: string), _col3 (type: string)
                outputColumnNames: _col4, _col5, _col6, _col12, _col14
                Statistics: Num rows: 19965000 Data size: 10581450686 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (((_col12 = 'KENYA') and (_col14 = 'PERU')) or ((_col12 = 'PERU') and (_col14 = 'KENYA'))) (type: boolean)
                  Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col12 (type: string), _col14 (type: string), year(_col6) (type: int), (_col4 * (1.0 - _col5)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 1650000 Data size: 960300020 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: string), _col10 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col3, _col8, _col9, _col10, _col14
          Statistics: Num rows: 19965000 Data size: 10581450686 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: double), _col9 (type: double), _col10 (type: string), _col14 (type: string), _col3 (type: string)
            outputColumnNames: _col4, _col5, _col6, _col12, _col14
            Statistics: Num rows: 19965000 Data size: 10581450686 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((_col12 = 'KENYA') and (_col14 = 'PERU')) or ((_col12 = 'PERU') and (_col14 = 'KENYA'))) (type: boolean)
              Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col12 (type: string), _col14 (type: string), year(_col6) (type: int), (_col4 * (1.0 - _col5)) (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 9982500 Data size: 5290725343 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col4, _col5, _col6, _col10
              Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), _col10 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: string)
                outputColumnNames: _col1, _col10, _col4, _col5, _col6
                Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col3 (type: bigint)
              Statistics: Num rows: 16500000 Data size: 8745000189 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col4, _col5, _col6, _col10
          Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col10 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: string)
            outputColumnNames: _col1, _col10, _col4, _col5, _col6
            Statistics: Num rows: 18150000 Data size: 9619500416 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:n2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:n2 
          TableScan
            alias: n2
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((n_name = 'PERU') or (n_name = 'KENYA')) and n_nationkey is not null) (type: boolean)
              Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 1650000 Data size: 960300020 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:$hdt$_4:$hdt$_5:n1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:$hdt$_4:$hdt$_5:n1 
          TableScan
            alias: n1
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((n_name = 'KENYA') or (n_name = 'PERU')) and n_nationkey is not null) (type: boolean)
              Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query8.sql
STAGE DEPENDENCIES:
  Stage-6 is a root stage
  Stage-20 depends on stages: Stage-6, Stage-10, Stage-21, Stage-22 , consists of Stage-27, Stage-28, Stage-7
  Stage-27 has a backup stage: Stage-7
  Stage-18 depends on stages: Stage-27
  Stage-16 depends on stages: Stage-7, Stage-17, Stage-18, Stage-19 , consists of Stage-25, Stage-26, Stage-2
  Stage-25 has a backup stage: Stage-2
  Stage-14 depends on stages: Stage-25
  Stage-3 depends on stages: Stage-2, Stage-14, Stage-15
  Stage-4 depends on stages: Stage-3
  Stage-26 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-26
  Stage-2
  Stage-28 has a backup stage: Stage-7
  Stage-19 depends on stages: Stage-28
  Stage-7
  Stage-9 is a root stage
  Stage-23 depends on stages: Stage-9, Stage-24 , consists of Stage-29, Stage-30, Stage-10
  Stage-29 has a backup stage: Stage-10
  Stage-21 depends on stages: Stage-29
  Stage-30 has a backup stage: Stage-10
  Stage-22 depends on stages: Stage-30
  Stage-10
  Stage-31 is a root stage
  Stage-17 depends on stages: Stage-31
  Stage-32 is a root stage
  Stage-24 depends on stages: Stage-32
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_partkey is not null and l_suppkey is not null and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_partkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_type = 'ECONOMY BURNISHED NICKEL') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col4
          Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col2, _col3, _col4, _col11
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col11 (type: string), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
                outputColumnNames: _col11, _col2, _col3, _col4
                Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col3, _col7, _col8, _col15
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: year(_col15) (type: int), CASE WHEN ((_col3 = 'PERU')) THEN ((_col7 * (1.0 - _col8))) ELSE (0) END (type: double), (_col7 * (1.0 - _col8)) (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), (_col1 / _col2) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 39920719 Data size: 32149437648 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col3, _col7, _col8, _col15
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: year(_col15) (type: int), CASE WHEN ((_col3 = 'PERU')) THEN ((_col7 * (1.0 - _col8))) ELSE (0) END (type: double), (_col7 * (1.0 - _col8)) (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col2 (type: bigint)
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double), _col11 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col2 (type: bigint)
          outputColumnNames: _col3, _col7, _col8, _col15
          Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: year(_col15) (type: int), CASE WHEN ((_col3 = 'PERU')) THEN ((_col7 * (1.0 - _col8))) ELSE (0) END (type: double), (_col7 * (1.0 - _col8)) (type: double)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col2, _col3, _col4, _col11
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col11 (type: string), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
                outputColumnNames: _col11, _col2, _col3, _col4
                Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col2 (type: bigint)
              Statistics: Num rows: 2016665 Data size: 1068832952 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col2 (type: bigint)
          outputColumnNames: _col2, _col3, _col4, _col11
          Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col11 (type: string), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col11, _col2, _col3, _col4
            Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 1500000 Data size: 873000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' and o_orderkey is not null and o_custkey is not null) (type: boolean)
              Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 1666666 Data size: 883332980 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 1833332 Data size: 971666299 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 2016665 Data size: 1068832952 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 2016665 Data size: 1068832952 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 1833332 Data size: 971666299 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 27 Data size: 7287 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 2016665 Data size: 1068832952 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:n2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:n2 
          TableScan
            alias: n2
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: n_nationkey is not null (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$hdt$_6:$hdt$_7:region 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$hdt$_6:$hdt$_7:region 
          TableScan
            alias: region
            Statistics: Num rows: 5 Data size: 1240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((r_name = 'AMERICA') and r_regionkey is not null) (type: boolean)
              Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_regionkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: n1
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (n_nationkey is not null and n_regionkey is not null) (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_regionkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 27 Data size: 7287 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query9.sql
STAGE DEPENDENCIES:
  Stage-7 is a root stage
  Stage-21 depends on stages: Stage-7 , consists of Stage-26, Stage-27, Stage-8
  Stage-26 has a backup stage: Stage-8
  Stage-19 depends on stages: Stage-26
  Stage-17 depends on stages: Stage-8, Stage-18, Stage-19, Stage-20 , consists of Stage-24, Stage-25, Stage-2
  Stage-24 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-24
  Stage-14 depends on stages: Stage-2, Stage-15, Stage-16 , consists of Stage-22, Stage-23, Stage-3
  Stage-22 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-22
  Stage-4 depends on stages: Stage-3, Stage-12, Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-23 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-23
  Stage-3
  Stage-25 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-25
  Stage-2
  Stage-27 has a backup stage: Stage-8
  Stage-20 depends on stages: Stage-27
  Stage-8
  Stage-28 is a root stage
  Stage-18 depends on stages: Stage-28
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_partkey is not null and l_suppkey is not null and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 59986052 Data size: 48308694157 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            alias: part
            Statistics: Num rows: 2000000 Data size: 1236000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_name like '%plum%') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 1000000 Data size: 618000000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_3:partsupp 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_3:partsupp 
          TableScan
            alias: partsupp
            Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_supplycost (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint), _col1 (type: bigint)
                    1 _col1 (type: bigint), _col0 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: bigint), _col1 (type: bigint)
                1 _col1 (type: bigint), _col0 (type: bigint)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col10
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: double), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
                outputColumnNames: _col2, _col3, _col5, _col6, _col7, _col8
                Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col10, _col11, _col12
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:orders 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:orders 
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col3, _col6, _col10, _col11, _col12, _col16
              Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col3 (type: string), year(_col16) (type: int), ((_col11 * (1.0 - _col12)) - (_col6 * _col10)) (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col0 (type: string), _col1 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int)
              Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 43912792 Data size: 35364382622 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int)
              sort order: +-
              Statistics: Num rows: 43912792 Data size: 35364382622 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: int), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 43912792 Data size: 35364382622 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 43912792 Data size: 35364382622 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col3, _col6, _col10, _col11, _col12, _col16
                  Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: string), year(_col16) (type: int), ((_col11 * (1.0 - _col12)) - (_col6 * _col10)) (type: double)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col0 (type: string), _col1 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col7 (type: bigint)
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string), _col6 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double)
          TableScan
            alias: orders
            Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 15000000 Data size: 7950000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col3, _col6, _col10, _col11, _col12, _col16
          Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col3 (type: string), year(_col16) (type: int), ((_col11 * (1.0 - _col12)) - (_col6 * _col10)) (type: double)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col0 (type: string), _col1 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 87825584 Data size: 70728765245 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col10, _col11, _col12
              Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col5 (type: bigint)
              Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col5 (type: bigint)
          outputColumnNames: _col3, _col6, _col7, _col10, _col11, _col12
          Statistics: Num rows: 79841439 Data size: 64298876102 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: bigint), _col1 (type: bigint)
                1 _col1 (type: bigint), _col0 (type: bigint)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: partsupp
            Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_supplycost (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint), _col1 (type: bigint)
                    1 _col1 (type: bigint), _col0 (type: bigint)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col10
                  Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: double), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
                    outputColumnNames: _col2, _col3, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col2 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 65984658 Data size: 53139564724 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            alias: partsupp
            Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_supplycost (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint), _col0 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
                  Statistics: Num rows: 8000000 Data size: 1880000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: bigint), _col1 (type: bigint)
            1 _col1 (type: bigint), _col0 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col10
          Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: double), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col2, _col3, _col5, _col6, _col7, _col8
            Statistics: Num rows: 72583125 Data size: 58453522463 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:nation 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:nation 
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: n_nationkey is not null (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 100000 Data size: 47900000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 110000 Data size: 52690001 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

