@@@sample-queries-tpch/tpch_query10.sql
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-15 depends on stages: Stage-20
  Stage-14 depends on stages: Stage-15 , consists of Stage-18, Stage-19, Stage-2
  Stage-18 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-18
  Stage-11 depends on stages: Stage-2, Stage-12, Stage-13 , consists of Stage-16, Stage-17, Stage-3
  Stage-16 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-16
  Stage-4 depends on stages: Stage-3, Stage-9, Stage-10
  Stage-5 depends on stages: Stage-4
  Stage-17 has a backup stage: Stage-3
  Stage-10 depends on stages: Stage-17
  Stage-3
  Stage-19 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-19
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:nation 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:nation 
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: n_nationkey is not null (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_name (type: string), c_address (type: string), c_nationkey (type: bigint), c_phone (type: string), c_acctbal (type: double), c_comment (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8
                  Statistics: Num rows: 330000 Data size: 192060004 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:orders 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:orders 
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-07-01') and (o_orderdate < '1993-10-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9
              Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_returnflag = 'R') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col9 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col9 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col13, _col14
              Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: bigint), _col1 (type: string), _col5 (type: double), _col4 (type: string), _col8 (type: string), _col2 (type: string), _col6 (type: string), (_col13 * (1.0 - _col14)) (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col7)
                  keys: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              sort order: +++++++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col7 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: string), KEY._col2 (type: double), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 3299448 Data size: 2659355467 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), _col1 (type: string), _col7 (type: double), _col2 (type: double), _col4 (type: string), _col5 (type: string), _col3 (type: string), _col6 (type: string)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 3299448 Data size: 2659355467 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: double)
              sort order: -
              Statistics: Num rows: 3299448 Data size: 2659355467 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: bigint), _col1 (type: string), _col3 (type: double), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: string), KEY.reducesinkkey0 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: string), VALUE._col4 (type: string), VALUE._col5 (type: string), VALUE._col6 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 3299448 Data size: 2659355467 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 20
            Statistics: Num rows: 20 Data size: 16120 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 20 Data size: 16120 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col9 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_returnflag = 'R') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col9 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col13, _col14
                  Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: string), _col5 (type: double), _col4 (type: string), _col8 (type: string), _col2 (type: string), _col6 (type: string), (_col13 * (1.0 - _col14)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col7)
                      keys: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col9 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col9 (type: bigint)
              Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col1 (type: string), _col2 (type: string), _col4 (type: string), _col5 (type: double), _col6 (type: string), _col8 (type: string)
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_returnflag = 'R') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 5998998 Data size: 4835192388 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col9 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col13, _col14
          Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), _col1 (type: string), _col5 (type: double), _col4 (type: string), _col8 (type: string), _col2 (type: string), _col6 (type: string), (_col13 * (1.0 - _col14)) (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col7)
              keys: _col0 (type: bigint), _col1 (type: string), _col2 (type: double), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 6598897 Data size: 5318711742 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-07-01') and (o_orderdate < '1993-10-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9
                  Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 330000 Data size: 192060004 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col5 (type: double), _col6 (type: string), _col8 (type: string)
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-07-01') and (o_orderdate < '1993-10-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col8, _col9
          Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 20
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query11.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q11_part_tmp_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q11_sum_tmp_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: ps_partkey bigint, part_value double
          expanded text: select
	`partsupp`.`ps_partkey`,
	sum(`partsupp`.`ps_supplycost` * `partsupp`.`ps_availqty`) as `part_value`
from
	`tpch_flat_orc_2`.`partsupp`,
	`tpch_flat_orc_2`.`supplier`,
	`tpch_flat_orc_2`.`nation`
where
	`partsupp`.`ps_suppkey` = `supplier`.`s_suppkey`
	and `supplier`.`s_nationkey` = `nation`.`n_nationkey`
	and `nation`.`n_name` = 'GERMANY'
group by `partsupp`.`ps_partkey`
          name: tpch_flat_orc_2.q11_part_tmp_cached
          original text: select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as part_value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'GERMANY'
group by ps_partkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query12.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-2
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipmode) IN ('REG AIR', 'MAIL') and (l_commitdate < l_receiptdate) and (l_shipdate < l_commitdate) and (l_receiptdate >= '1995-01-01') and (l_receiptdate < '1996-01-01') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 74061 Data size: 59693166 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_shipmode (type: string)
                outputColumnNames: _col0, _col4
                Statistics: Num rows: 74061 Data size: 59693166 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 74061 Data size: 59693166 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col6
          Statistics: Num rows: 3300000 Data size: 1749000037 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: string), CASE WHEN (((_col1 = '1-URGENT') or (_col1 = '2-HIGH'))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col1 <> '1-URGENT') and (_col1 <> '2-HIGH'))) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 3300000 Data size: 1749000037 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 3300000 Data size: 1749000037 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 3300000 Data size: 1749000037 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query13.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: c_custkey (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: bigint)
                sort order: +
                Map-reduce partition columns: _col0 (type: bigint)
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (not (o_comment like '%unusual%accounts%')) (type: boolean)
              Statistics: Num rows: 1500000 Data size: 795000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1500000 Data size: 795000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 1500000 Data size: 795000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: count(_col1)
            keys: _col0 (type: bigint)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 1650000 Data size: 874500018 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 825000 Data size: 437250009 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint)
            outputColumnNames: _col1
            Statistics: Num rows: 825000 Data size: 437250009 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              keys: _col1 (type: bigint)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 825000 Data size: 437250009 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 825000 Data size: 437250009 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 412500 Data size: 218625004 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint), _col0 (type: bigint)
              sort order: --
              Statistics: Num rows: 412500 Data size: 218625004 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 412500 Data size: 218625004 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 412500 Data size: 218625004 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query14.sql
STAGE DEPENDENCIES:
  Stage-5 is a root stage
  Stage-2 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-5
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_partkey is not null (type: boolean)
              Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint), p_type (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1995-08-01') and (l_shipdate < '1995-09-01') and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col5
                  Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: CASE WHEN ((_col5 like 'PROMO%')) THEN ((_col1 * (1.0 - _col2))) ELSE (0) END (type: double), (_col1 * (1.0 - _col2)) (type: double)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col0), sum(_col1)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        sort order: 
                        Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col0 (type: double), _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: ((100.0 * _col0) / _col1) (type: double)
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query15.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: revenue_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: max_revenue_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: supplier_no bigint, total_revenue double
          expanded text: select
	`lineitem`.`l_suppkey` as `supplier_no`,
	sum(`lineitem`.`l_extendedprice` * (1 - `lineitem`.`l_discount`)) as `total_revenue`
from
	`tpch_flat_orc_2`.`lineitem`
where
	`lineitem`.`l_shipdate` >= '1996-01-01'
	and `lineitem`.`l_shipdate` < '1996-04-01'
group by `lineitem`.`l_suppkey`
          name: tpch_flat_orc_2.revenue_cached
          original text: select
	l_suppkey as supplier_no,
	sum(l_extendedprice * (1 - l_discount)) as total_revenue
from
	lineitem
where
	l_shipdate >= '1996-01-01'
	and l_shipdate < '1996-04-01'
group by l_suppkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query16.sql
STAGE DEPENDENCIES:
  Stage-7 is a root stage
  Stage-13 depends on stages: Stage-7, Stage-14 , consists of Stage-16, Stage-17, Stage-2
  Stage-16 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-16
  Stage-10 depends on stages: Stage-2, Stage-8, Stage-11, Stage-12 , consists of Stage-15, Stage-3
  Stage-15 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-15
  Stage-4 depends on stages: Stage-3, Stage-9
  Stage-5 depends on stages: Stage-4
  Stage-3
  Stage-17 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-17
  Stage-2
  Stage-8 is a root stage
  Stage-18 is a root stage
  Stage-14 depends on stages: Stage-18
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_comment like '%Customer%Complaints%') (type: boolean)
              Statistics: Num rows: 10000 Data size: 4790000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint)
                outputColumnNames: s_suppkey
                Statistics: Num rows: 10000 Data size: 4790000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), count(s_suppkey)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: bigint), _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), count(VALUE._col1)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1760000 Data size: 443520008 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9
              Statistics: Num rows: 1936000 Data size: 487872019 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((_col6 = 0) or (_col9 is null and _col1 is not null and (_col7 >= _col6))) (type: boolean)
                Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
                  outputColumnNames: _col3, _col4, _col5, _col1
                  Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(DISTINCT _col1)
                    keys: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: bigint)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col3:0._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 645333 Data size: 162623922 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: bigint), _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: -+++
              Statistics: Num rows: 645333 Data size: 162623922 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 645333 Data size: 162623922 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 645333 Data size: 162623922 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 1760000 Data size: 443520008 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: bigint), _col7 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 5000 Data size: 2395000 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: boolean)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col9
          Statistics: Num rows: 1936000 Data size: 487872019 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((_col6 = 0) or (_col9 is null and _col1 is not null and (_col7 >= _col6))) (type: boolean)
            Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
              outputColumnNames: _col3, _col4, _col5, _col1
              Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT _col1)
                keys: _col3 (type: string), _col4 (type: string), _col5 (type: int), _col1 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1290666 Data size: 325247844 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1760000 Data size: 443520008 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1760000 Data size: 413600008 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col3 (type: string), _col4 (type: string), _col5 (type: int)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 1760000 Data size: 443520008 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_comment like '%Customer%Complaints%') (type: boolean)
              Statistics: Num rows: 10000 Data size: 4790000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint)
                outputColumnNames: s_suppkey
                Statistics: Num rows: 10000 Data size: 4790000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: s_suppkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 10000 Data size: 4790000 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 10000 Data size: 4790000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 5000 Data size: 2395000 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), true (type: boolean)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 5000 Data size: 2395000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_size) IN (22, 14, 27, 49, 21, 33, 35, 28) and (p_brand <> 'Brand#34') and p_partkey is not null and (not (p_type like 'ECONOMY BRUSHED%'))) (type: boolean)
              Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint), p_brand (type: string), p_type (type: string), p_size (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: partsupp
            Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ps_partkey is not null (type: boolean)
              Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col3, _col4, _col5
                  Statistics: Num rows: 1760000 Data size: 413600008 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query17.sql
STAGE DEPENDENCIES:
  Stage-5 is a root stage
  Stage-13 depends on stages: Stage-5 , consists of Stage-17, Stage-18, Stage-1
  Stage-17 has a backup stage: Stage-1
  Stage-11 depends on stages: Stage-17
  Stage-2 depends on stages: Stage-1, Stage-11, Stage-12
  Stage-10 depends on stages: Stage-2, Stage-14 , consists of Stage-15, Stage-16, Stage-3
  Stage-15 has a backup stage: Stage-3
  Stage-8 depends on stages: Stage-15
  Stage-4 depends on stages: Stage-3, Stage-8, Stage-9
  Stage-16 has a backup stage: Stage-3
  Stage-9 depends on stages: Stage-16
  Stage-3
  Stage-18 has a backup stage: Stage-1
  Stage-12 depends on stages: Stage-18
  Stage-1
  Stage-19 is a root stage
  Stage-14 depends on stages: Stage-19
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_brand = 'Brand#23') and (p_container = 'MED BOX') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: p_partkey
                Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: p_partkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 50000 Data size: 30900000 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: avg(_col1)
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: struct<count:bigint,sum:double,input:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 6598897 Data size: 5318711338 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), (0.2 * _col1) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 6598897 Data size: 5318711338 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col2 < _col1) (type: boolean)
                Statistics: Num rows: 4839191 Data size: 3900388426 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: double)
                  outputColumnNames: _col4
                  Statistics: Num rows: 4839191 Data size: 3900388426 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col4)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CAST( (_col0 / 7.0) AS decimal(32,2)) (type: decimal(32,2))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col2 < _col1) (type: boolean)
                Statistics: Num rows: 4839191 Data size: 3900388426 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: double)
                  outputColumnNames: _col4
                  Statistics: Num rows: 4839191 Data size: 3900388426 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col4)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 6598897 Data size: 5318711338 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col2 < _col1) (type: boolean)
            Statistics: Num rows: 4839191 Data size: 3900388426 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col4 (type: double)
              outputColumnNames: _col4
              Statistics: Num rows: 4839191 Data size: 3900388426 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: avg(_col1)
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 50000 Data size: 30900000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: avg(_col1)
            keys: _col0 (type: bigint)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_brand = 'Brand#23') and (p_container = 'MED BOX') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 100000 Data size: 61800000 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: l_partkey is not null (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double), l_extendedprice (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: double), _col0 (type: bigint), _col2 (type: double)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query18.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q18_tmp_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q18_large_volume_customer_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: l_orderkey bigint, t_sum_quantity double
          expanded text: select
	`lineitem`.`l_orderkey`,
	sum(`lineitem`.`l_quantity`) as `t_sum_quantity`
from
	`tpch_flat_orc_2`.`lineitem`
where
	`lineitem`.`l_orderkey` is not null
group by
	`lineitem`.`l_orderkey`
          name: tpch_flat_orc_2.q18_tmp_cached
          original text: select
	l_orderkey,
	sum(l_quantity) as t_sum_quantity
from
	lineitem
where
	l_orderkey is not null
group by
	l_orderkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query19.sql
STAGE DEPENDENCIES:
  Stage-5 is a root stage
  Stage-2 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-5
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_partkey is not null (type: boolean)
              Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint), p_brand (type: string), p_size (type: int), p_container (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipmode) IN ('AIR', 'AIR REG') and (l_shipinstruct = 'DELIVER IN PERSON') and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 2999499 Data size: 2417596194 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_quantity (type: double), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2999499 Data size: 2417596194 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col7, _col8, _col9
                  Statistics: Num rows: 3299448 Data size: 2659355871 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (((_col7 = 'Brand#32') and (_col9) IN ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and (_col1 >= 7.0) and (_col1 <= 17.0) and _col8 BETWEEN 1 AND 5) or ((_col7 = 'Brand#35') and (_col9) IN ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and (_col1 >= 15.0) and (_col1 <= 25.0) and _col8 BETWEEN 1 AND 10) or ((_col7 = 'Brand#24') and (_col9) IN ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and (_col1 >= 26.0) and (_col1 <= 36.0) and _col8 BETWEEN 1 AND 15)) (type: boolean)
                    Statistics: Num rows: 30549 Data size: 24622501 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: (_col2 * (1.0 - _col3)) (type: double)
                      outputColumnNames: _col0
                      Statistics: Num rows: 30549 Data size: 24622501 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col0)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query1.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_shipdate <= '1998-09-16') (type: boolean)
              Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_returnflag (type: string), l_linestatus (type: string), l_quantity (type: double), l_extendedprice (type: double), (l_extendedprice * (1.0 - l_discount)) (type: double), ((l_extendedprice * (1.0 - l_discount)) * (1.0 + l_tax)) (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), avg(_col2), avg(_col3), avg(_col6), count()
                  keys: _col0 (type: string), _col1 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                    Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: struct<count:bigint,sum:double,input:double>), _col7 (type: struct<count:bigint,sum:double,input:double>), _col8 (type: struct<count:bigint,sum:double,input:double>), _col9 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), avg(VALUE._col4), avg(VALUE._col5), avg(VALUE._col6), count(VALUE._col7)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query20.sql
STAGE DEPENDENCIES:
  Stage-23 is a root stage
  Stage-15 depends on stages: Stage-23
  Stage-14 depends on stages: Stage-7, Stage-15 , consists of Stage-21, Stage-22, Stage-4
  Stage-21 has a backup stage: Stage-4
  Stage-12 depends on stages: Stage-21
  Stage-11 depends on stages: Stage-4, Stage-12, Stage-13 , consists of Stage-20, Stage-1
  Stage-20 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-20
  Stage-2 depends on stages: Stage-1, Stage-10
  Stage-1
  Stage-22 has a backup stage: Stage-4
  Stage-13 depends on stages: Stage-22
  Stage-4
  Stage-26 is a root stage
  Stage-19 depends on stages: Stage-26
  Stage-18 depends on stages: Stage-19 , consists of Stage-24, Stage-25, Stage-6
  Stage-24 has a backup stage: Stage-6
  Stage-16 depends on stages: Stage-24
  Stage-7 depends on stages: Stage-6, Stage-16, Stage-17
  Stage-25 has a backup stage: Stage-6
  Stage-17 depends on stages: Stage-25
  Stage-6
  Stage-0 depends on stages: Stage-2

STAGE PLANS:
  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_name like 'forest%') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: partsupp
            Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_availqty (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1760000 Data size: 413600008 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 1936000 Data size: 454960018 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col2) > _col4) (type: boolean)
                Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_suppkey is not null (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_name (type: string), s_address (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: string), _col2 (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_suppkey is not null (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_name (type: string), s_address (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: string), _col2 (type: string)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 709866 Data size: 166818589 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint), _col0 (type: bigint)
                1 _col2 (type: bigint), _col0 (type: bigint)
              outputColumnNames: _col1, _col2, _col4
              Statistics: Num rows: 1936000 Data size: 454960018 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col2) > _col4) (type: boolean)
                Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint), _col0 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
              Statistics: Num rows: 1760000 Data size: 413600008 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col2 (type: bigint), _col0 (type: bigint)
              Statistics: Num rows: 733210 Data size: 590967272 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint), _col0 (type: bigint)
            1 _col2 (type: bigint), _col0 (type: bigint)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 1936000 Data size: 454960018 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (UDFToDouble(_col2) > _col4) (type: boolean)
            Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 645333 Data size: 151653260 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:$hdt$_4:$hdt$_5:nation 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:$hdt$_4:$hdt$_5:nation 
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((n_name = 'CANADA') and n_nationkey is not null) (type: boolean)
              Statistics: Num rows: 12 Data size: 3180 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 12 Data size: 3180 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_nationkey is not null and s_suppkey is not null) (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1994-01-01') and (l_shipdate <= '1995-01-01') and l_suppkey is not null and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: double)
                    outputColumnNames: _col1, _col0, _col2
                    Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col1 (type: bigint), _col0 (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 733210 Data size: 590967272 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), (0.5 * _col2) (type: double), _col0 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 733210 Data size: 590967272 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:$hdt$_3:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:$hdt$_3:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1994-01-01') and (l_shipdate <= '1995-01-01') and l_suppkey is not null and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: double)
                outputColumnNames: _col1, _col0, _col2
                Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col1 (type: bigint), _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1994-01-01') and (l_shipdate <= '1995-01-01') and l_suppkey is not null and l_partkey is not null) (type: boolean)
              Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: double)
            outputColumnNames: _col1, _col0, _col2
            Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col1 (type: bigint), _col0 (type: bigint)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1466421 Data size: 1181935351 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query21.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-0
  Stage-2 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_receiptdate > l_commitdate) and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint)
                outputColumnNames: l_orderkey, l_suppkey
                Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(DISTINCT l_suppkey)
                  keys: l_orderkey (type: bigint), l_suppkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col1 (type: bigint)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col1:0._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 = 1) (type: boolean)
            Statistics: Num rows: 1 Data size: 806 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: bigint), 1 (type: bigint)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 806 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 806 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
                    output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
                    serde: org.apache.hadoop.hive.ql.io.orc.OrcSerde
                    name: tpch_flat_orc_2.l3

  Stage: Stage-0
    Move Operator
      files:
          hdfs directory: true
          destination: hdfs://dc1master:9000/tmp/hive/wentingt/6f364b09-8f37-4fcf-b20d-a81822dc6a14/_tmp_space.db/83b9b32e-3e57-44fe-9e7c-ffc51b4d9595

  Stage: Stage-3
      Create Table Operator:
        Create Table
          columns: l_orderkey bigint, cntsupp bigint
          input format: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
          location: hdfs://dc1master:9000/tmp/hive/wentingt/6f364b09-8f37-4fcf-b20d-a81822dc6a14/_tmp_space.db/83b9b32e-3e57-44fe-9e7c-ffc51b4d9595
          output format: org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat
          serde name: org.apache.hadoop.hive.ql.io.orc.OrcSerde
          name: tpch_flat_orc_2.l3
          isTemporary: true

  Stage: Stage-2
    Stats-Aggr Operator

@@@sample-queries-tpch/tpch_query22.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q22_customer_tmp_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q22_customer_tmp1_cached

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q22_orders_tmp_cached

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          if not exists: true
          or replace: false
          columns: c_acctbal double, c_custkey bigint, cntrycode string
          expanded text: select
	`customer`.`c_acctbal`,
	`customer`.`c_custkey`,
	substr(`customer`.`c_phone`, 1, 2) as `cntrycode`
from
	`tpch_flat_orc_2`.`customer`
where
	substr(`customer`.`c_phone`, 1, 2) = '13' or
	substr(`customer`.`c_phone`, 1, 2) = '31' or
	substr(`customer`.`c_phone`, 1, 2) = '23' or
	substr(`customer`.`c_phone`, 1, 2) = '29' or
	substr(`customer`.`c_phone`, 1, 2) = '30' or
	substr(`customer`.`c_phone`, 1, 2) = '18' or
	substr(`customer`.`c_phone`, 1, 2) = '17'
          name: tpch_flat_orc_2.q22_customer_tmp_cached
          original text: select
	c_acctbal,
	c_custkey,
	substr(c_phone, 1, 2) as cntrycode
from
	customer
where
	substr(c_phone, 1, 2) = '13' or
	substr(c_phone, 1, 2) = '31' or
	substr(c_phone, 1, 2) = '23' or
	substr(c_phone, 1, 2) = '29' or
	substr(c_phone, 1, 2) = '30' or
	substr(c_phone, 1, 2) = '18' or
	substr(c_phone, 1, 2) = '17'
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query2.sql
STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
      Drop Table Operator:
        Drop Table
          table: q2_min_ps_supplycost

STAGE DEPENDENCIES:
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-1
      Create View Operator:
        Create View
          or replace: false
          columns: min_p_partkey bigint, min_ps_supplycost double
          expanded text: select
	`part`.`p_partkey` as `min_p_partkey`,
	min(`partsupp`.`ps_supplycost`) as `min_ps_supplycost`
from
	`tpch_flat_orc_2`.`part`,
	`tpch_flat_orc_2`.`partsupp`,
	`tpch_flat_orc_2`.`supplier`,
	`tpch_flat_orc_2`.`nation`,
	`tpch_flat_orc_2`.`region`
where
	`part`.`p_partkey` = `partsupp`.`ps_partkey`
	and `supplier`.`s_suppkey` = `partsupp`.`ps_suppkey`
	and `supplier`.`s_nationkey` = `nation`.`n_nationkey`
	and `nation`.`n_regionkey` = `region`.`r_regionkey`
	and `region`.`r_name` = 'EUROPE'
group by
	`part`.`p_partkey`
          name: tpch_flat_orc_2.q2_min_ps_supplycost
          original text: select
	p_partkey as min_p_partkey,
	min(ps_supplycost) as min_ps_supplycost
from
	part,
	partsupp,
	supplier,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'EUROPE'
group by
	p_partkey
          rewrite enabled: false

@@@sample-queries-tpch/tpch_query3.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-10 depends on stages: Stage-14
  Stage-9 depends on stages: Stage-1, Stage-10 , consists of Stage-12, Stage-13, Stage-2
  Stage-12 has a backup stage: Stage-2
  Stage-7 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-13 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-13
  Stage-2
  Stage-1
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_mktsegment = 'BUILDING') and c_custkey is not null) (type: boolean)
              Statistics: Num rows: 150000 Data size: 87300000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 150000 Data size: 87300000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate < '1995-03-22') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1000000 Data size: 530000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint), o_orderdate (type: string), o_shippriority (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1000000 Data size: 530000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2, _col3
                  Statistics: Num rows: 1100000 Data size: 583000012 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate > '1995-03-22') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8
              Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: bigint), _col2 (type: string), _col3 (type: int), (_col7 * (1.0 - _col8)) (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col1 (type: string), _col0 (type: bigint), _col2 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: bigint), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: bigint), _col2 (type: int)
              Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: bigint), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 2199632 Data size: 1772903510 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col3 (type: double), _col0 (type: string), _col2 (type: int)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 2199632 Data size: 1772903510 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double), _col2 (type: string)
              sort order: -+
              Statistics: Num rows: 2199632 Data size: 1772903510 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: bigint), _col3 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: bigint), KEY.reducesinkkey0 (type: double), KEY.reducesinkkey1 (type: string), VALUE._col1 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 2199632 Data size: 1772903510 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 10
            Statistics: Num rows: 10 Data size: 8060 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 10 Data size: 8060 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate > '1995-03-22') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col3, _col6, _col7, _col8
                  Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: bigint), _col2 (type: string), _col3 (type: int), (_col7 * (1.0 - _col8)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col1 (type: string), _col0 (type: bigint), _col2 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 1100000 Data size: 583000012 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: string), _col3 (type: int)
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate > '1995-03-22') and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 3999332 Data size: 3223461592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8
          Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: bigint), _col2 (type: string), _col3 (type: int), (_col7 * (1.0 - _col8)) (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col3)
              keys: _col1 (type: string), _col0 (type: bigint), _col2 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 4399265 Data size: 3545807828 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate < '1995-03-22') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1000000 Data size: 530000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint), o_orderdate (type: string), o_shippriority (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1000000 Data size: 530000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 1000000 Data size: 530000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_mktsegment = 'BUILDING') and c_custkey is not null) (type: boolean)
              Statistics: Num rows: 150000 Data size: 87300000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 150000 Data size: 87300000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 150000 Data size: 87300000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col2, _col3
          Statistics: Num rows: 1100000 Data size: 583000012 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query4.sql
STAGE DEPENDENCIES:
  Stage-4 is a root stage
  Stage-7 depends on stages: Stage-4 , consists of Stage-8, Stage-9, Stage-1
  Stage-8 has a backup stage: Stage-1
  Stage-5 depends on stages: Stage-8
  Stage-2 depends on stages: Stage-1, Stage-5, Stage-6
  Stage-3 depends on stages: Stage-2
  Stage-9 has a backup stage: Stage-1
  Stage-6 depends on stages: Stage-9
  Stage-1
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_orderkey = l_orderkey) and (l_commitdate < l_receiptdate)) (type: boolean)
              Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint)
                outputColumnNames: l_orderkey
                Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: l_orderkey (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 1999666 Data size: 1611730796 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 999833 Data size: 805865398 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Conditional Operator

  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: o
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1996-05-01') and (o_orderdate < '1996-08-01')) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2
                  Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count()
                    keys: _col2 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 549908 Data size: 443225978 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 549908 Data size: 443225978 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 549908 Data size: 443225978 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 549908 Data size: 443225978 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:o 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:o 
          TableScan
            alias: o
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1996-05-01') and (o_orderdate < '1996-08-01')) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2
              Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count()
                keys: _col2 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: o
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1996-05-01') and (o_orderdate < '1996-08-01')) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderpriority (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 999833 Data size: 805865398 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2
          Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: count()
            keys: _col2 (type: string)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1099816 Data size: 886451957 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query5.sql
STAGE DEPENDENCIES:
  Stage-30 is a root stage
  Stage-22 depends on stages: Stage-30
  Stage-21 depends on stages: Stage-22 , consists of Stage-28, Stage-29, Stage-3
  Stage-28 has a backup stage: Stage-3
  Stage-19 depends on stages: Stage-28
  Stage-18 depends on stages: Stage-3, Stage-19, Stage-20 , consists of Stage-26, Stage-27, Stage-4
  Stage-26 has a backup stage: Stage-4
  Stage-16 depends on stages: Stage-26
  Stage-15 depends on stages: Stage-4, Stage-16, Stage-17 , consists of Stage-24, Stage-25, Stage-5
  Stage-24 has a backup stage: Stage-5
  Stage-13 depends on stages: Stage-24
  Stage-6 depends on stages: Stage-5, Stage-13, Stage-14
  Stage-7 depends on stages: Stage-6
  Stage-25 has a backup stage: Stage-5
  Stage-14 depends on stages: Stage-25
  Stage-5
  Stage-27 has a backup stage: Stage-4
  Stage-17 depends on stages: Stage-27
  Stage-4
  Stage-29 has a backup stage: Stage-3
  Stage-20 depends on stages: Stage-29
  Stage-3
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:supplier 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:region 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:supplier 
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)
        $hdt$_0:$hdt$_4:region 
          TableScan
            alias: region
            Statistics: Num rows: 5 Data size: 1240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((r_name = 'AFRICA') and r_regionkey is not null) (type: boolean)
              Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_regionkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (n_nationkey is not null and n_regionkey is not null) (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string), n_regionkey (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 27 Data size: 7287 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col1 (type: bigint)
                    outputColumnNames: _col1, _col5, _col6
                    Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:lineitem 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:lineitem 
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_orderkey is not null and l_suppkey is not null) (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: bigint)
                    1 _col1 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col1, _col6, _col7, _col9, _col10
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_5:orders 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_5:orders 
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-01-01') and (o_orderdate < '1994-01-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col6, _col9, _col10, _col12
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col12 (type: bigint), _col6 (type: bigint)
                    1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col12 (type: bigint), _col6 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)
              outputColumnNames: _col1, _col9, _col10
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: string), (_col9 * (1.0 - _col10)) (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double)
              sort order: -
              Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col12 (type: bigint), _col6 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col12 (type: bigint), _col6 (type: bigint)
                    1 _col0 (type: bigint), _col1 (type: bigint)
                  outputColumnNames: _col1, _col9, _col10
                  Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: string), (_col9 * (1.0 - _col10)) (type: double)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1)
                      keys: _col0 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col12 (type: bigint), _col6 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col12 (type: bigint), _col6 (type: bigint)
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col9 (type: double), _col10 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                  Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col12 (type: bigint), _col6 (type: bigint)
            1 _col0 (type: bigint), _col1 (type: bigint)
          outputColumnNames: _col1, _col9, _col10
          Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: string), (_col9 * (1.0 - _col10)) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col0 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-01-01') and (o_orderdate < '1994-01-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col6, _col9, _col10, _col12
                  Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col7 (type: bigint)
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col6 (type: bigint), _col9 (type: double), _col10 (type: double)
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((o_orderdate >= '1993-01-01') and (o_orderdate < '1994-01-01') and o_custkey is not null and o_orderkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col6, _col9, _col10, _col12
          Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col5 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_orderkey is not null and l_suppkey is not null) (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: bigint)
                    1 _col1 (type: bigint)
                  outputColumnNames: _col1, _col6, _col7, _col9, _col10
                  Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col5 (type: bigint)
              Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col6 (type: bigint)
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_orderkey is not null and l_suppkey is not null) (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col5 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col1, _col6, _col7, _col9, _col10
          Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query6.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((l_shipdate >= '1993-01-01') and (l_shipdate < '1994-01-01') and l_discount BETWEEN 0.05 AND 0.07 and (l_quantity < 25.0)) (type: boolean)
              Statistics: Num rows: 49374 Data size: 39795444 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: (l_extendedprice * l_discount) (type: double)
                outputColumnNames: _col0
                Statistics: Num rows: 49374 Data size: 39795444 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col0)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    sort order: 
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query7.sql
STAGE DEPENDENCIES:
  Stage-6 is a root stage
  Stage-17 depends on stages: Stage-6, Stage-18 , consists of Stage-21, Stage-22, Stage-7
  Stage-21 has a backup stage: Stage-7
  Stage-15 depends on stages: Stage-21
  Stage-13 depends on stages: Stage-7, Stage-14, Stage-15, Stage-16 , consists of Stage-19, Stage-20, Stage-2
  Stage-19 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-19
  Stage-3 depends on stages: Stage-2, Stage-11, Stage-12
  Stage-4 depends on stages: Stage-3
  Stage-20 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-20
  Stage-2
  Stage-22 has a backup stage: Stage-7
  Stage-16 depends on stages: Stage-22
  Stage-7
  Stage-23 is a root stage
  Stage-14 depends on stages: Stage-23
  Stage-24 is a root stage
  Stage-18 depends on stages: Stage-24
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (o_orderkey is not null and o_custkey is not null) (type: boolean)
              Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' and l_suppkey is not null and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double), l_shipdate (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 1333110 Data size: 1074486660 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6
          Statistics: Num rows: 3300000 Data size: 1749000037 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col4, _col5, _col6, _col10
              Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), _col10 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: string)
                outputColumnNames: _col1, _col10, _col4, _col5, _col6
                Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col3, _col8, _col9, _col10, _col14
              Statistics: Num rows: 3993000 Data size: 2116290136 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: double), _col9 (type: double), _col10 (type: string), _col14 (type: string), _col3 (type: string)
                outputColumnNames: _col4, _col5, _col6, _col12, _col14
                Statistics: Num rows: 3993000 Data size: 2116290136 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (((_col12 = 'KENYA') and (_col14 = 'PERU')) or ((_col12 = 'PERU') and (_col14 = 'KENYA'))) (type: boolean)
                  Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col12 (type: string), _col14 (type: string), year(_col6) (type: int), (_col4 * (1.0 - _col5)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 998250 Data size: 529072534 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Statistics: Num rows: 998250 Data size: 529072534 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 998250 Data size: 529072534 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 998250 Data size: 529072534 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col3, _col8, _col9, _col10, _col14
              Statistics: Num rows: 3993000 Data size: 2116290136 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: double), _col9 (type: double), _col10 (type: string), _col14 (type: string), _col3 (type: string)
                outputColumnNames: _col4, _col5, _col6, _col12, _col14
                Statistics: Num rows: 3993000 Data size: 2116290136 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (((_col12 = 'KENYA') and (_col14 = 'PERU')) or ((_col12 = 'PERU') and (_col14 = 'KENYA'))) (type: boolean)
                  Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col12 (type: string), _col14 (type: string), year(_col6) (type: int), (_col4 * (1.0 - _col5)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 330000 Data size: 192060004 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: string), _col10 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col3, _col8, _col9, _col10, _col14
          Statistics: Num rows: 3993000 Data size: 2116290136 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: double), _col9 (type: double), _col10 (type: string), _col14 (type: string), _col3 (type: string)
            outputColumnNames: _col4, _col5, _col6, _col12, _col14
            Statistics: Num rows: 3993000 Data size: 2116290136 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((_col12 = 'KENYA') and (_col14 = 'PERU')) or ((_col12 = 'PERU') and (_col14 = 'KENYA'))) (type: boolean)
              Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col12 (type: string), _col14 (type: string), year(_col6) (type: int), (_col4 * (1.0 - _col5)) (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col3)
                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1996500 Data size: 1058145068 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col4, _col5, _col6, _col10
              Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), _col10 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: string)
                outputColumnNames: _col1, _col10, _col4, _col5, _col6
                Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col3 (type: bigint)
              Statistics: Num rows: 3300000 Data size: 1749000037 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col4, _col5, _col6, _col10
          Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col10 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: string)
            outputColumnNames: _col1, _col10, _col4, _col5, _col6
            Statistics: Num rows: 3630000 Data size: 1923900082 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:n2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:n2 
          TableScan
            alias: n2
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((n_name = 'PERU') or (n_name = 'KENYA')) and n_nationkey is not null) (type: boolean)
              Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 330000 Data size: 192060004 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:$hdt$_4:$hdt$_5:n1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:$hdt$_4:$hdt$_5:n1 
          TableScan
            alias: n1
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((n_name = 'KENYA') or (n_name = 'PERU')) and n_nationkey is not null) (type: boolean)
              Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 24 Data size: 6360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query8.sql
STAGE DEPENDENCIES:
  Stage-26 is a root stage , consists of Stage-36, Stage-9
  Stage-36 has a backup stage: Stage-9
  Stage-25 depends on stages: Stage-36
  Stage-24 depends on stages: Stage-9, Stage-25, Stage-27 , consists of Stage-34, Stage-35, Stage-10
  Stage-34 has a backup stage: Stage-10
  Stage-22 depends on stages: Stage-34
  Stage-20 depends on stages: Stage-10, Stage-21, Stage-22, Stage-23 , consists of Stage-31, Stage-32, Stage-7
  Stage-31 has a backup stage: Stage-7
  Stage-18 depends on stages: Stage-31
  Stage-16 depends on stages: Stage-7, Stage-17, Stage-18, Stage-19 , consists of Stage-28, Stage-29, Stage-2
  Stage-28 has a backup stage: Stage-2
  Stage-14 depends on stages: Stage-28
  Stage-3 depends on stages: Stage-2, Stage-14, Stage-15
  Stage-4 depends on stages: Stage-3
  Stage-29 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-29
  Stage-2
  Stage-32 has a backup stage: Stage-7
  Stage-19 depends on stages: Stage-32
  Stage-7
  Stage-35 has a backup stage: Stage-10
  Stage-23 depends on stages: Stage-35
  Stage-10
  Stage-9
  Stage-30 is a root stage
  Stage-17 depends on stages: Stage-30
  Stage-33 is a root stage
  Stage-21 depends on stages: Stage-33
  Stage-37 is a root stage
  Stage-27 depends on stages: Stage-37
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-26
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$hdt$_4:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$hdt$_4:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' and o_orderkey is not null and o_custkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 403332 Data size: 213766461 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col2, _col3, _col4, _col11
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col11 (type: string), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
                outputColumnNames: _col11, _col2, _col3, _col4
                Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col3, _col7, _col8, _col15
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: year(_col15) (type: int), CASE WHEN ((_col3 = 'PERU')) THEN ((_col7 * (1.0 - _col8))) ELSE (0) END (type: double), (_col7 * (1.0 - _col8)) (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), (_col1 / _col2) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 7984665 Data size: 6435641083 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col3, _col7, _col8, _col15
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: year(_col15) (type: int), CASE WHEN ((_col3 = 'PERU')) THEN ((_col7 * (1.0 - _col8))) ELSE (0) END (type: double), (_col7 * (1.0 - _col8)) (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col2 (type: bigint)
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double), _col11 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col2 (type: bigint)
          outputColumnNames: _col3, _col7, _col8, _col15
          Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: year(_col15) (type: int), CASE WHEN ((_col3 = 'PERU')) THEN ((_col7 * (1.0 - _col8))) ELSE (0) END (type: double), (_col7 * (1.0 - _col8)) (type: double)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col2 (type: bigint)
              outputColumnNames: _col2, _col3, _col4, _col11
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col11 (type: string), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
                outputColumnNames: _col11, _col2, _col3, _col4
                Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col2 (type: bigint)
              Statistics: Num rows: 403332 Data size: 213766461 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col2 (type: bigint)
          outputColumnNames: _col2, _col3, _col4, _col11
          Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col11 (type: string), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col11, _col2, _col3, _col4
            Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col2, _col4
              Statistics: Num rows: 403332 Data size: 213766461 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col1 (type: bigint)
              Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 27 Data size: 7287 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col2, _col4
          Statistics: Num rows: 403332 Data size: 213766461 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_custkey is not null and c_nationkey is not null) (type: boolean)
              Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_custkey (type: bigint), c_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 300000 Data size: 174600000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (o_orderdate BETWEEN '1995-01-01' AND '1996-12-31' and o_orderkey is not null and o_custkey is not null) (type: boolean)
              Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_custkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 333333 Data size: 176666490 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 366666 Data size: 194333143 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:n2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:n2 
          TableScan
            alias: n2
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: n_nationkey is not null (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_3:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_3:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_type = 'ECONOMY BURNISHED NICKEL') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_partkey is not null and l_suppkey is not null and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_partkey (type: bigint), l_suppkey (type: bigint), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2, _col3, _col4
                  Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_4:$hdt$_6:$hdt$_7:region 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_4:$hdt$_6:$hdt$_7:region 
          TableScan
            alias: region
            Statistics: Num rows: 5 Data size: 1240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((r_name = 'AMERICA') and r_regionkey is not null) (type: boolean)
              Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_regionkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 2 Data size: 496 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: n1
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (n_nationkey is not null and n_regionkey is not null) (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_regionkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 27 Data size: 7287 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpch/tpch_query9.sql
STAGE DEPENDENCIES:
  Stage-27 is a root stage
  Stage-18 depends on stages: Stage-27
  Stage-17 depends on stages: Stage-8, Stage-18, Stage-19, Stage-20 , consists of Stage-25, Stage-26, Stage-2
  Stage-25 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-25
  Stage-14 depends on stages: Stage-2, Stage-15, Stage-16 , consists of Stage-23, Stage-24, Stage-3
  Stage-23 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-23
  Stage-4 depends on stages: Stage-3, Stage-12, Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-24 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-24
  Stage-3
  Stage-26 has a backup stage: Stage-2
  Stage-16 depends on stages: Stage-26
  Stage-2
  Stage-30 is a root stage
  Stage-22 depends on stages: Stage-30
  Stage-21 depends on stages: Stage-22 , consists of Stage-28, Stage-29, Stage-8
  Stage-28 has a backup stage: Stage-8
  Stage-19 depends on stages: Stage-28
  Stage-29 has a backup stage: Stage-8
  Stage-20 depends on stages: Stage-29
  Stage-8
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:nation 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:nation 
          TableScan
            alias: nation
            Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: n_nationkey is not null (type: boolean)
              Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: n_nationkey (type: bigint), n_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 25 Data size: 6625 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: supplier
            Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_suppkey is not null and s_nationkey is not null) (type: boolean)
              Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_suppkey (type: bigint), s_nationkey (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 20000 Data size: 9580000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col10, _col11, _col12
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:orders 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:orders 
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col3, _col6, _col10, _col11, _col12, _col16
              Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col3 (type: string), year(_col16) (type: int), ((_col11 * (1.0 - _col12)) - (_col6 * _col10)) (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col0 (type: string), _col1 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int)
              Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 8783132 Data size: 7079205788 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int)
              sort order: +-
              Statistics: Num rows: 8783132 Data size: 7079205788 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: int), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 8783132 Data size: 7079205788 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 8783132 Data size: 7079205788 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col3, _col6, _col10, _col11, _col12, _col16
                  Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: string), year(_col16) (type: int), ((_col11 * (1.0 - _col12)) - (_col6 * _col10)) (type: double)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col0 (type: string), _col1 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col7 (type: bigint)
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string), _col6 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double)
          TableScan
            alias: orders
            Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: o_orderkey is not null (type: boolean)
              Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: o_orderkey (type: bigint), o_orderdate (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 3000000 Data size: 1590000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col7 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col3, _col6, _col10, _col11, _col12, _col16
          Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col3 (type: string), year(_col16) (type: int), ((_col11 * (1.0 - _col12)) - (_col6 * _col10)) (type: double)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col0 (type: string), _col1 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 17566264 Data size: 14158411577 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col5 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col10, _col11, _col12
              Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 22000 Data size: 10538000 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col5 (type: bigint)
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double), _col3 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col5 (type: bigint)
          outputColumnNames: _col3, _col6, _col7, _col10, _col11, _col12
          Statistics: Num rows: 15969331 Data size: 12871282973 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_5:part 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_5:part 
          TableScan
            alias: part
            Statistics: Num rows: 400000 Data size: 247200000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_name like '%plum%') and p_partkey is not null) (type: boolean)
              Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_partkey (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 200000 Data size: 123600000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: lineitem
            Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (l_partkey is not null and l_suppkey is not null and l_orderkey is not null) (type: boolean)
              Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: l_orderkey (type: bigint), l_partkey (type: bigint), l_suppkey (type: bigint), l_quantity (type: double), l_extendedprice (type: double), l_discount (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 11997996 Data size: 9670384776 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_3:partsupp 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_3:partsupp 
          TableScan
            alias: partsupp
            Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_supplycost (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint), _col1 (type: bigint)
                    1 _col1 (type: bigint), _col0 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: bigint), _col1 (type: bigint)
                1 _col1 (type: bigint), _col0 (type: bigint)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col10
              Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: double), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
                outputColumnNames: _col2, _col3, _col5, _col6, _col7, _col8
                Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: bigint), _col1 (type: bigint)
                1 _col1 (type: bigint), _col0 (type: bigint)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: partsupp
            Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_supplycost (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint), _col1 (type: bigint)
                    1 _col1 (type: bigint), _col0 (type: bigint)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col10
                  Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: double), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
                    outputColumnNames: _col2, _col3, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col2 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 13197795 Data size: 10637423484 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            alias: partsupp
            Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ps_partkey is not null and ps_suppkey is not null) (type: boolean)
              Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ps_partkey (type: bigint), ps_suppkey (type: bigint), ps_supplycost (type: double)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint), _col0 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
                  Statistics: Num rows: 1600000 Data size: 376000000 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: bigint), _col1 (type: bigint)
            1 _col1 (type: bigint), _col0 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col10
          Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: double), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col2, _col3, _col5, _col6, _col7, _col8
            Statistics: Num rows: 14517574 Data size: 11701166086 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

