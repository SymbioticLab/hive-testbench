@@@sample-queries-tpcds/query12.sql
STAGE DEPENDENCIES:
  Stage-10 is a root stage
  Stage-3 depends on stages: Stage-10
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-10
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col1 (type: float)
                      outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col1
                      Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
                          sort order: +++++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
                          Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col3 (type: string), _col0 (type: string), _col1 (type: string), _col4 (type: float), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: string)
              sort order: +
              Map-reduce partition columns: _col3 (type: string)
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col3 (type: float), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: float, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col3 ASC NULLS FIRST
                  partition by: _col3
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col5
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col0 (type: string), _col5 (type: double), ((_col5 * 100.0) / sum_window_0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col0 (type: string), _col6 (type: double)
              sort order: +++++
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: float), KEY.reducesinkkey2 (type: string), VALUE._col1 (type: double), KEY.reducesinkkey4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query13.sql
STAGE DEPENDENCIES:
  Stage-17 is a root stage
  Stage-6 depends on stages: Stage-17
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and ((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 3) or (hd_dep_count = 1)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_dep_count (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 62500 Data size: 63429996 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 62500 Data size: 63429996 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col9 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_sales_price BETWEEN 100 AND 150 or ss_sales_price BETWEEN 50 AND 100 or ss_sales_price BETWEEN 150 AND 200) and (ss_net_profit BETWEEN 100 AND 200 or ss_net_profit BETWEEN 150 AND 300 or ss_net_profit BETWEEN 50 AND 250) and ss_store_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 3056088 Data size: 275396684 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_sales_price (type: float), ss_ext_sales_price (type: float), ss_ext_wholesale_cost (type: float), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 3056088 Data size: 275396684 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 3361696 Data size: 302936358 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col7, _col8, _col9, _col12, _col13
                    Statistics: Num rows: 3697865 Data size: 333230001 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8, _col9, _col12, _col13, _col15
                      Statistics: Num rows: 4067651 Data size: 366553009 Basic stats: COMPLETE Column stats: NONE
                      Filter Operator
                        predicate: (((_col12 = 'M') and (_col13 = '4 yr Degree') and _col5 BETWEEN 100 AND 150 and (_col15 = 3)) or ((_col12 = 'D') and (_col13 = 'Primary') and _col5 BETWEEN 50 AND 100 and (_col15 = 1)) or ((_col12 = 'U') and (_col13 = 'Advanced Degree') and _col5 BETWEEN 150 AND 200 and (_col15 = 1))) (type: boolean)
                        Statistics: Num rows: 169485 Data size: 15273000 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col2 (type: int), _col4 (type: int), _col6 (type: float), _col7 (type: float), _col8 (type: float), _col9 (type: int)
                          outputColumnNames: _col2, _col4, _col6, _col7, _col8, _col9
                          Statistics: Num rows: 169485 Data size: 15273000 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: int)
                              1 _col0 (type: int)
                            outputColumnNames: _col4, _col6, _col7, _col8, _col9, _col17
                            Statistics: Num rows: 186433 Data size: 16800300 Basic stats: COMPLETE Column stats: NONE
                            Filter Operator
                              predicate: (((_col17) IN ('KY', 'GA', 'NM') and _col8 BETWEEN 100 AND 200) or ((_col17) IN ('MT', 'OR', 'IN') and _col8 BETWEEN 150 AND 300) or ((_col17) IN ('WI', 'MO', 'WV') and _col8 BETWEEN 50 AND 250)) (type: boolean)
                              Statistics: Num rows: 31071 Data size: 2799944 Basic stats: COMPLETE Column stats: NONE
                              Select Operator
                                expressions: _col4 (type: int), _col6 (type: float), _col7 (type: float), _col9 (type: int)
                                outputColumnNames: _col4, _col6, _col7, _col9
                                Statistics: Num rows: 31071 Data size: 2799944 Basic stats: COMPLETE Column stats: NONE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col9 (type: int)
                                    1 _col0 (type: int)
                                  outputColumnNames: _col4, _col6, _col7
                                  Statistics: Num rows: 40176 Data size: 44957392 Basic stats: COMPLETE Column stats: NONE
                                  Group By Operator
                                    aggregations: avg(_col4), avg(_col6), avg(_col7), sum(_col7)
                                    mode: hash
                                    outputColumnNames: _col0, _col1, _col2, _col3
                                    Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
                                    Reduce Output Operator
                                      sort order: 
                                      Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
                                      value expressions: _col0 (type: struct<count:bigint,sum:double,input:int>), _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), sum(VALUE._col3)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 236 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query15.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage , consists of Stage-14, Stage-1
  Stage-14 has a backup stage: Stage-1
  Stage-11 depends on stages: Stage-14
  Stage-13 depends on stages: Stage-1, Stage-11
  Stage-4 depends on stages: Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-1
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_bill_customer_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col6, _col7
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((substr(_col7, 1, 5)) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') or (_col6) IN ('CA', 'WA', 'GA') or (_col1 > 500)) (type: boolean)
                Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: float), _col2 (type: int), _col7 (type: string)
                  outputColumnNames: _col1, _col2, _col7
                  Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                          TopN Hash Memory Usage: 0.1
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 9536141 Data size: 1294244684 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 9536141 Data size: 1294244684 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 9536141 Data size: 1294244684 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_bill_customer_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col4
          Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query17.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-24 depends on stages: Stage-1 , consists of Stage-26, Stage-27, Stage-2
  Stage-26 has a backup stage: Stage-2
  Stage-22 depends on stages: Stage-26
  Stage-25 depends on stages: Stage-2, Stage-22, Stage-23
  Stage-8 depends on stages: Stage-25
  Stage-9 depends on stages: Stage-8
  Stage-27 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-27
  Stage-2
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col4 (type: int), _col5 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col9, _col10
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:catalog_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:catalog_sales 
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int), _col7 (type: int)
                    1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int), _col7 (type: int)
                1 _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:d1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:d2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_5:d3 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_6:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_7:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name = '2000Q1') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col10 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_quarter_name) IN ('2000Q1', '2000Q2', '2000Q3') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_7:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col9, _col10, _col13, _col14
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col10 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col4, _col9, _col13, _col14
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col9, _col13
                  Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col4, _col9, _col13, _col22
                    Statistics: Num rows: 48726459 Data size: 4390942306 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col4, _col9, _col13, _col22, _col24, _col25
                      Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col24 (type: string), _col25 (type: string), _col22 (type: string), _col4 (type: int), _col9 (type: int), _col13 (type: int)
                        outputColumnNames: _col24, _col25, _col22, _col4, _col9, _col13
                        Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: count(_col4), avg(_col4), stddev_samp(_col4), count(_col9), avg(_col9), stddev_samp(_col9), count(_col13), avg(_col13), stddev_samp(_col13)
                          keys: _col24 (type: string), _col25 (type: string), _col22 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                          Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                            Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                            TopN Hash Memory Usage: 0.1
                            value expressions: _col3 (type: bigint), _col4 (type: struct<count:bigint,sum:double,input:int>), _col5 (type: struct<count:bigint,sum:double,variance:double>), _col6 (type: bigint), _col7 (type: struct<count:bigint,sum:double,input:int>), _col8 (type: struct<count:bigint,sum:double,variance:double>), _col9 (type: bigint), _col10 (type: struct<count:bigint,sum:double,input:int>), _col11 (type: struct<count:bigint,sum:double,variance:double>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), avg(VALUE._col1), stddev_samp(VALUE._col2), count(VALUE._col3), avg(VALUE._col4), stddev_samp(VALUE._col5), count(VALUE._col6), avg(VALUE._col7), stddev_samp(VALUE._col8)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
          Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), (_col8 / _col7) (type: double), _col9 (type: bigint), _col10 (type: double), (_col11 / _col10) (type: double), _col2 (type: string), _col3 (type: bigint), _col4 (type: double), _col5 (type: double), (_col5 / _col4) (type: double), _col6 (type: bigint), _col7 (type: double), _col8 (type: double)
            outputColumnNames: _col0, _col1, _col10, _col11, _col12, _col13, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
            Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: double), _col13 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: bigint), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col10 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
          Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int), _col7 (type: int)
                1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int), _col7 (type: int)
                    1 _col1 (type: int), _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int), _col7 (type: int)
              sort order: ++
              Map-reduce partition columns: _col6 (type: int), _col7 (type: int)
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: int), _col5 (type: int), _col9 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col0 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col0 (type: int)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int), _col7 (type: int)
            1 _col1 (type: int), _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query18.sql
STAGE DEPENDENCIES:
  Stage-26 is a root stage
  Stage-20 depends on stages: Stage-26
  Stage-19 depends on stages: Stage-20 , consists of Stage-24, Stage-25, Stage-4
  Stage-24 has a backup stage: Stage-4
  Stage-17 depends on stages: Stage-24
  Stage-23 depends on stages: Stage-4, Stage-17, Stage-18
  Stage-7 depends on stages: Stage-23
  Stage-8 depends on stages: Stage-7
  Stage-25 has a backup stage: Stage-4
  Stage-18 depends on stages: Stage-25
  Stage-4
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:cd1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'M') and (cd_education_status = 'College') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 480200 Data size: 179402720 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_dep_count (type: int)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 480200 Data size: 179402720 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_cdemo_sk is not null and cs_item_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_bill_cdemo_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_list_price (type: float), cs_sales_price (type: float), cs_coupon_amt (type: float), cs_net_profit (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col14
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7, _col14, _col16
                      Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_birth_month) IN (9, 5, 12, 4, 1, 10) and c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_addr_sk (type: int), c_birth_year (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4
                Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col14, _col16, _col18, _col19, _col21
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_6:cd2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('ND', 'WI', 'AL', 'NC', 'OK', 'MS', 'TN') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_6:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col19 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col14, _col16, _col18, _col21, _col23, _col24, _col25
              Statistics: Num rows: 23077462 Data size: 3132072436 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col18 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col14, _col16, _col21, _col23, _col24, _col25
                Statistics: Num rows: 25385208 Data size: 3445279754 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col16 (type: string), _col25 (type: string), _col24 (type: string), _col23 (type: string), CAST( _col3 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col4 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col6 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col5 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col7 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col21 AS decimal(12,2)) (type: decimal(12,2)), CAST( _col14 AS decimal(12,2)) (type: decimal(12,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                  Statistics: Num rows: 25385208 Data size: 3445279754 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: avg(_col4), avg(_col5), avg(_col6), avg(_col7), avg(_col8), avg(_col9), avg(_col10)
                    keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), 0 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                    Statistics: Num rows: 126926040 Data size: 17226398770 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
                      sort order: +++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
                      Statistics: Num rows: 126926040 Data size: 17226398770 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col5 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col6 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col7 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col8 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col9 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col10 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>), _col11 (type: struct<count:bigint,sum:decimal(22,2),input:decimal(12,2)>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3), avg(VALUE._col4), avg(VALUE._col5), avg(VALUE._col6)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7, _col8, _col9, _col10, _col11
          Statistics: Num rows: 63463020 Data size: 8613199385 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col5 (type: decimal(16,6)), _col6 (type: decimal(16,6)), _col7 (type: decimal(16,6)), _col8 (type: decimal(16,6)), _col9 (type: decimal(16,6)), _col10 (type: decimal(16,6)), _col11 (type: decimal(16,6))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
            Statistics: Num rows: 63463020 Data size: 8613199385 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col0 (type: string)
              sort order: ++++
              Statistics: Num rows: 63463020 Data size: 8613199385 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: decimal(16,6)), _col5 (type: decimal(16,6)), _col6 (type: decimal(16,6)), _col7 (type: decimal(16,6)), _col8 (type: decimal(16,6)), _col9 (type: decimal(16,6)), _col10 (type: decimal(16,6))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), VALUE._col0 (type: decimal(16,6)), VALUE._col1 (type: decimal(16,6)), VALUE._col2 (type: decimal(16,6)), VALUE._col3 (type: decimal(16,6)), VALUE._col4 (type: decimal(16,6)), VALUE._col5 (type: decimal(16,6)), VALUE._col6 (type: decimal(16,6))
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
          Statistics: Num rows: 63463020 Data size: 8613199385 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_birth_month) IN (9, 5, 12, 4, 1, 10) and c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_addr_sk (type: int), c_birth_year (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4
                Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col14, _col16, _col18, _col19, _col21
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col4 (type: float), _col5 (type: float), _col6 (type: float), _col7 (type: float), _col14 (type: int), _col16 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((c_birth_month) IN (9, 5, 12, 4, 1, 10) and c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_addr_sk (type: int), c_birth_year (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4
                Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 250000 Data size: 215004982 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col14, _col16, _col18, _col19, _col21
          Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query19.sql
STAGE DEPENDENCIES:
  Stage-23 is a root stage
  Stage-18 depends on stages: Stage-23
  Stage-17 depends on stages: Stage-18 , consists of Stage-21, Stage-22, Stage-3
  Stage-21 has a backup stage: Stage-3
  Stage-15 depends on stages: Stage-21
  Stage-20 depends on stages: Stage-3, Stage-15, Stage-16
  Stage-6 depends on stages: Stage-20
  Stage-7 depends on stages: Stage-6
  Stage-22 has a backup stage: Stage-3
  Stage-16 depends on stages: Stage-22
  Stage-3
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 11) and (d_year = 1999) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col4 (type: int)
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 7) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string), i_manufact_id (type: int), i_manufact (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col4 (type: int)
                  outputColumnNames: _col3, _col4, _col5, _col6
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col5, _col6, _col9, _col10, _col11, _col12
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col6, _col9, _col10, _col11, _col12, _col15
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_5:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_zip (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_5:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_zip (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col15 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col5, _col6, _col9, _col10, _col11, _col12, _col17
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col5 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col6, _col9, _col10, _col11, _col12, _col17, _col19
                Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (substr(_col17, 1, 5) <> substr(_col19, 1, 5)) (type: boolean)
                  Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: string), _col9 (type: int), _col11 (type: int), _col12 (type: string), _col6 (type: float)
                    outputColumnNames: _col10, _col9, _col11, _col12, _col6
                    Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col6)
                      keys: _col10 (type: string), _col9 (type: int), _col11 (type: int), _col12 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: string)
                        sort order: ++++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: string)
                        Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col0 (type: string), _col2 (type: int), _col3 (type: string), _col4 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: double), _col1 (type: string), _col0 (type: int), _col2 (type: int), _col3 (type: string)
              sort order: -++++
              Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey2 (type: int), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col5, _col6, _col9, _col10, _col11, _col12, _col15
                  Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col6 (type: float), _col9 (type: int), _col10 (type: string), _col11 (type: int), _col12 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col5, _col6, _col9, _col10, _col11, _col12, _col15
          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query20.sql
STAGE DEPENDENCIES:
  Stage-10 is a root stage
  Stage-3 depends on stages: Stage-10
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-10
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2001-01-12' AND '2001-02-11' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_item_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col1 (type: float)
                      outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col1
                      Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
                          sort order: +++++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
                          Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col3 (type: string), _col0 (type: string), _col1 (type: string), _col4 (type: float), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: string)
              sort order: +
              Map-reduce partition columns: _col3 (type: string)
              Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col3 (type: float), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: float, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col3 ASC NULLS FIRST
                  partition by: _col3
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col5
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col0 (type: string), _col5 (type: double), ((_col5 * 100.0) / sum_window_0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col0 (type: string), _col6 (type: double)
              sort order: +++++
              Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: float), KEY.reducesinkkey2 (type: string), VALUE._col1 (type: double), KEY.reducesinkkey4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query21.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage
  Stage-4 depends on stages: Stage-12
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 11333 Data size: 16239366 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11333 Data size: 16239366 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-07' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_warehouse_sk is not null and inv_item_sk is not null) (type: boolean)
              Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int), inv_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col5
                  Statistics: Num rows: 146421003 Data size: 1727775088 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2, _col3, _col5, _col7
                    Statistics: Num rows: 161063106 Data size: 1900552637 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col5, _col7, _col10
                      Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col5 (type: string), _col7 (type: string), CASE WHEN ((CAST( _col10 AS DATE) < 1998-04-08)) THEN (_col2) ELSE (0) END (type: int), CASE WHEN ((CAST( _col10 AS DATE) >= 1998-04-08)) THEN (_col2) ELSE (0) END (type: int)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col2), sum(_col3)
                          keys: _col0 (type: string), _col1 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string)
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                            Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col2 (type: bigint), _col3 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 88584710 Data size: 1045303973 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: CASE WHEN ((_col2 > 0)) THEN ((UDFToDouble(_col3) / UDFToDouble(_col2)) BETWEEN 0.6666666666666666 AND 1.5) ELSE (null) END (type: boolean)
            Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: bigint), _col3 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1100 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1100 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query22.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage
  Stage-4 depends on stages: Stage-12
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:warehouse 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null) (type: boolean)
              Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int), inv_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 146421003 Data size: 1727775088 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col2, _col7, _col8, _col9, _col10
                    Statistics: Num rows: 161063106 Data size: 1900552637 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col2 (type: int)
                        outputColumnNames: _col7, _col8, _col9, _col10, _col2
                        Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: avg(_col2)
                          keys: _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), 0 (type: int)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                          Statistics: Num rows: 885847100 Data size: 10453039730 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
                            sort order: +++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int)
                            Statistics: Num rows: 885847100 Data size: 10453039730 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col5 (type: struct<count:bigint,sum:double,input:int>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col5
          Statistics: Num rows: 442923550 Data size: 5226519865 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col3 (type: string), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 442923550 Data size: 5226519865 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: double), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: +++++
              Statistics: Num rows: 442923550 Data size: 5226519865 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 442923550 Data size: 5226519865 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1100 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1100 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query24.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-67 depends on stages: Stage-1
  Stage-47 depends on stages: Stage-67
  Stage-46 depends on stages: Stage-47 , consists of Stage-65, Stage-66, Stage-4
  Stage-65 has a backup stage: Stage-4
  Stage-44 depends on stages: Stage-65
  Stage-64 depends on stages: Stage-4, Stage-44, Stage-45
  Stage-6 depends on stages: Stage-64
  Stage-42 depends on stages: Stage-6, Stage-20 , consists of Stage-62, Stage-63, Stage-7
  Stage-62 has a backup stage: Stage-7
  Stage-40 depends on stages: Stage-62
  Stage-39 depends on stages: Stage-7, Stage-32, Stage-40, Stage-41 , consists of Stage-61, Stage-8
  Stage-61 has a backup stage: Stage-8
  Stage-38 depends on stages: Stage-61
  Stage-8
  Stage-63 has a backup stage: Stage-7
  Stage-41 depends on stages: Stage-63
  Stage-7
  Stage-66 has a backup stage: Stage-4
  Stage-45 depends on stages: Stage-66
  Stage-4
  Stage-14 is a root stage
  Stage-71 depends on stages: Stage-14
  Stage-53 depends on stages: Stage-71
  Stage-52 depends on stages: Stage-53 , consists of Stage-69, Stage-70, Stage-17
  Stage-69 has a backup stage: Stage-17
  Stage-50 depends on stages: Stage-69
  Stage-68 depends on stages: Stage-17, Stage-50, Stage-51
  Stage-19 depends on stages: Stage-68
  Stage-20 depends on stages: Stage-19
  Stage-70 has a backup stage: Stage-17
  Stage-51 depends on stages: Stage-70
  Stage-17
  Stage-26 is a root stage
  Stage-75 depends on stages: Stage-26
  Stage-59 depends on stages: Stage-75
  Stage-58 depends on stages: Stage-59 , consists of Stage-73, Stage-74, Stage-29
  Stage-73 has a backup stage: Stage-29
  Stage-56 depends on stages: Stage-73
  Stage-72 depends on stages: Stage-29, Stage-56, Stage-57
  Stage-31 depends on stages: Stage-72
  Stage-32 depends on stages: Stage-31
  Stage-74 has a backup stage: Stage-29
  Stage-57 depends on stages: Stage-74
  Stage-29
  Stage-0 depends on stages: Stage-38, Stage-8

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color = 'orchid') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col8, _col10, _col11
              Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17
                Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-46
    Conditional Operator

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_4:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_4:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string), _col4 (type: float)
                outputColumnNames: _col8, _col19, _col20, _col10, _col13, _col14, _col16, _col17, _col22, _col4
                Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col8 (type: string), _col19 (type: string), _col20 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col5 (type: string), _col6 (type: string), _col7 (type: int), _col8 (type: string)
                    sort order: +++++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                    Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col9 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: int), KEY._col8 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 23192142 Data size: 2050156720 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col9 (type: double)
            outputColumnNames: _col0, _col6, _col7, _col9
            Statistics: Num rows: 23192142 Data size: 2050156720 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col9)
              keys: _col0 (type: string), _col6 (type: string), _col7 (type: string)
              mode: complete
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 11596071 Data size: 1025078360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col2 (type: string), _col1 (type: string), _col0 (type: string), _col3 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 11596071 Data size: 1025078360 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-62
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 11596071 Data size: 1129442999 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-39
    Conditional Operator

  Stage: Stage-61
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3, _col5
              Statistics: Num rows: 11596071 Data size: 2161493318 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col3 > _col5) (type: boolean)
                Statistics: Num rows: 3865357 Data size: 720497772 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 3865357 Data size: 720497772 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 3865357 Data size: 720497772 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 11596071 Data size: 1129442999 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1, _col2, _col3, _col5
          Statistics: Num rows: 11596071 Data size: 2161493318 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col3 > _col5) (type: boolean)
            Statistics: Num rows: 3865357 Data size: 720497772 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 3865357 Data size: 720497772 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 3865357 Data size: 720497772 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 11596071 Data size: 1129442999 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 11596071 Data size: 1025078360 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: double)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 11596071 Data size: 1129442999 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:store 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-53
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col8, _col10, _col11
              Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-52
    Conditional Operator

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                  sort order: ++++++++++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                  Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 23192142 Data size: 2050156720 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            Statistics: Num rows: 23192142 Data size: 2050156720 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              mode: hash
              outputColumnNames: _col0
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (sq_count_check(_col0) <= 1) (type: boolean)
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_store_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4
          Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_4:store 
          Fetch Operator
            limit: -1
        $hdt$_2:$hdt$_2:$hdt$_5:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_market_id = 7) and s_store_sk is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col3, _col4
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:$hdt$_2:$hdt$_5:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_current_price (type: float), i_size (type: string), i_color (type: string), i_units (type: string), i_manager_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col4, _col8, _col10, _col11
              Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-58
    Conditional Operator

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_6:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_6:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
              Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_7:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_7:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_zip is not null and ca_country is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_state (type: string), ca_zip (type: string), ca_country (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: string), _col21 (type: string)
                    1 _col1 (type: string), upper(_col2) (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: string), _col21 (type: string)
                1 _col1 (type: string), upper(_col2) (type: string)
              outputColumnNames: _col4, _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22
              Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string), _col4 (type: float)
                outputColumnNames: _col8, _col10, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col22, _col4
                Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col8 (type: string), _col10 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int), _col19 (type: string), _col20 (type: string), _col22 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                  Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                    sort order: ++++++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: int), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                    Statistics: Num rows: 46384285 Data size: 4100313529 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col10 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
          Statistics: Num rows: 23192142 Data size: 2050156720 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: double)
            outputColumnNames: _col10
            Statistics: Num rows: 23192142 Data size: 2050156720 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col10)
              mode: hash
              outputColumnNames: _col0
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: struct<count:bigint,sum:double,input:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: (0.05 * _col0) (type: double)
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-57
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
                  Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col8 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: float), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_birth_country is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string), c_birth_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col4, _col8, _col10, _col11, _col13, _col14, _col15, _col16, _col17, _col19, _col20, _col21
          Statistics: Num rows: 42167531 Data size: 3727557673 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query25.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-24 depends on stages: Stage-1 , consists of Stage-26, Stage-27, Stage-2
  Stage-26 has a backup stage: Stage-2
  Stage-22 depends on stages: Stage-26
  Stage-25 depends on stages: Stage-2, Stage-22, Stage-23
  Stage-8 depends on stages: Stage-25
  Stage-9 depends on stages: Stage-8
  Stage-27 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-27
  Stage-2
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col4 (type: float), _col5 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_net_loss (type: float), sr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: float), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col9, _col10
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:catalog_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:catalog_sales 
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_net_profit (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int), _col7 (type: int)
                    1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int), _col7 (type: int)
                1 _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:d1 
          Fetch Operator
            limit: -1
        $hdt$_4:d2 
          Fetch Operator
            limit: -1
        $hdt$_5:d3 
          Fetch Operator
            limit: -1
        $hdt$_6:store 
          Fetch Operator
            limit: -1
        $hdt$_7:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 4) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col10 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 4 AND 10 and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_7:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col9, _col10, _col13, _col14
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col10 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col4, _col9, _col13, _col14
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col9, _col13
                  Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col4, _col9, _col13, _col25, _col26
                    Statistics: Num rows: 48726459 Data size: 4390942306 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col4, _col9, _col13, _col25, _col26, _col28, _col29
                      Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string), _col4 (type: float), _col9 (type: float), _col13 (type: float)
                        outputColumnNames: _col28, _col29, _col25, _col26, _col4, _col9, _col13
                        Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col4), sum(_col9), sum(_col13)
                          keys: _col28 (type: string), _col29 (type: string), _col25 (type: string), _col26 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                          Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                            sort order: ++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                            Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                            TopN Hash Memory Usage: 0.1
                            value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int), _col7 (type: int)
                1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_net_profit (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int), _col7 (type: int)
                    1 _col1 (type: int), _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int), _col7 (type: int)
              sort order: ++
              Map-reduce partition columns: _col6 (type: int), _col7 (type: int)
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: int), _col9 (type: float), _col10 (type: int)
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_net_profit (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col0 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col0 (type: int)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int), _col7 (type: int)
            1 _col1 (type: int), _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query26.sql
STAGE DEPENDENCIES:
  Stage-15 is a root stage
  Stage-5 depends on stages: Stage-15
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:item 
          Fetch Operator
            limit: -1
        $hdt$_4:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'F') and (cd_marital_status = 'W') and (cd_education_status = 'Primary') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 240100 Data size: 89701360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 240100 Data size: 89701360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((p_channel_email = 'N') or (p_channel_event = 'N')) and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_cdemo_sk is not null and cs_item_sk is not null and cs_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_cdemo_sk (type: int), cs_item_sk (type: int), cs_promo_sk (type: int), cs_quantity (type: int), cs_list_price (type: float), cs_sales_price (type: float), cs_coupon_amt (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col7 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col15
                      Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col3, _col4, _col5, _col6, _col15
                        Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col15 (type: string), _col3 (type: int), _col4 (type: float), _col6 (type: float), _col5 (type: float)
                          outputColumnNames: _col15, _col3, _col4, _col6, _col5
                          Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: avg(_col3), avg(_col4), avg(_col6), avg(_col5)
                            keys: _col15 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                              TopN Hash Memory Usage: 0.1
                              value expressions: _col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>), _col4 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query27.sql
STAGE DEPENDENCIES:
  Stage-15 is a root stage
  Stage-5 depends on stages: Stage-15
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:store 
          Fetch Operator
            limit: -1
        $hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'F') and (cd_marital_status = 'D') and (cd_education_status = 'Unknown') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 240100 Data size: 89701360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 240100 Data size: 89701360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_state) IN ('KS', 'AL', 'MN', 'SC', 'VT') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_cdemo_sk is not null and ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_cdemo_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_list_price (type: float), ss_sales_price (type: float), ss_coupon_amt (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col7 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col15
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col3, _col4, _col5, _col6, _col15, _col17
                        Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col17 (type: string), _col15 (type: string), _col3 (type: int), _col4 (type: float), _col6 (type: float), _col5 (type: float)
                          outputColumnNames: _col17, _col15, _col3, _col4, _col6, _col5
                          Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: avg(_col3), avg(_col4), avg(_col6), avg(_col5)
                            keys: _col17 (type: string), _col15 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                            Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: string)
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                              TopN Hash Memory Usage: 0.1
                              value expressions: _col2 (type: struct<count:bigint,sum:double,input:int>), _col3 (type: struct<count:bigint,sum:double,input:float>), _col4 (type: struct<count:bigint,sum:double,input:float>), _col5 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query28.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-14 depends on stages: Stage-1, Stage-3, Stage-4, Stage-5, Stage-6, Stage-7 , consists of Stage-15, Stage-16, Stage-17, Stage-18, Stage-19, Stage-20, Stage-2
  Stage-15 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-15
  Stage-16 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-16
  Stage-17 has a backup stage: Stage-2
  Stage-10 depends on stages: Stage-17
  Stage-18 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-18
  Stage-19 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-19
  Stage-20 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-20
  Stage-2
  Stage-3 is a root stage
  Stage-4 is a root stage
  Stage-5 is a root stage
  Stage-6 is a root stage
  Stage-7 is a root stage
  Stage-0 depends on stages: Stage-8, Stage-9, Stage-10, Stage-11, Stage-12, Stage-13, Stage-2

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 0 AND 5 and (ss_list_price BETWEEN 11 AND 21 or ss_coupon_amt BETWEEN 460 AND 1460 or ss_wholesale_cost BETWEEN 14 AND 34)) (type: boolean)
              Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
               Inner Join 0 to 3
               Inner Join 0 to 4
               Inner Join 0 to 5
          keys:
            0 
            1 
            2 
            3 
            4 
            5 
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: double), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
            Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
            Limit
              Number of rows: 100
              Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 601 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 26 AND 30 and (ss_list_price BETWEEN 28 AND 38 or ss_coupon_amt BETWEEN 2513 AND 3513 or ss_wholesale_cost BETWEEN 42 AND 62)) (type: boolean)
              Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 21 AND 25 and (ss_list_price BETWEEN 135 AND 145 or ss_coupon_amt BETWEEN 14180 AND 15180 or ss_wholesale_cost BETWEEN 38 AND 58)) (type: boolean)
              Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 16 AND 20 and (ss_list_price BETWEEN 142 AND 152 or ss_coupon_amt BETWEEN 3054 AND 4054 or ss_wholesale_cost BETWEEN 80 AND 100)) (type: boolean)
              Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 11 AND 15 and (ss_list_price BETWEEN 66 AND 76 or ss_coupon_amt BETWEEN 920 AND 1920 or ss_wholesale_cost BETWEEN 4 AND 24)) (type: boolean)
              Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_quantity BETWEEN 6 AND 10 and (ss_list_price BETWEEN 91 AND 101 or ss_coupon_amt BETWEEN 1430 AND 2430 or ss_wholesale_cost BETWEEN 32 AND 52)) (type: boolean)
              Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_list_price (type: float)
                outputColumnNames: ss_list_price
                Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(ss_list_price), count(ss_list_price), count(DISTINCT ss_list_price)
                  keys: ss_list_price (type: float)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: float)
                    sort order: +
                    Statistics: Num rows: 1066701 Data size: 94295043 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), count(VALUE._col1), count(DISTINCT KEY._col0:0._col0)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query29.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-24 depends on stages: Stage-1 , consists of Stage-26, Stage-27, Stage-2
  Stage-26 has a backup stage: Stage-2
  Stage-22 depends on stages: Stage-26
  Stage-25 depends on stages: Stage-2, Stage-22, Stage-23
  Stage-8 depends on stages: Stage-25
  Stage-9 depends on stages: Stage-8
  Stage-27 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-27
  Stage-2
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col4 (type: int), _col5 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: int), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col9, _col10
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:catalog_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:catalog_sales 
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int), _col7 (type: int)
                    1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int), _col7 (type: int)
                1 _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:d1 
          Fetch Operator
            limit: -1
        $hdt$_4:d2 
          Fetch Operator
            limit: -1
        $hdt$_5:d3 
          Fetch Operator
            limit: -1
        $hdt$_6:store 
          Fetch Operator
            limit: -1
        $hdt$_7:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_moy BETWEEN 2 AND 5 and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col10 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000, 2001, 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_7:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col9, _col10, _col13, _col14
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col10 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col4, _col9, _col13, _col14
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col9, _col13
                  Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col4, _col9, _col13, _col24, _col25
                    Statistics: Num rows: 48726459 Data size: 4390942306 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col4, _col9, _col13, _col24, _col25, _col27, _col28
                      Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string), _col4 (type: int), _col9 (type: int), _col13 (type: int)
                        outputColumnNames: _col27, _col28, _col24, _col25, _col4, _col9, _col13
                        Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col4), sum(_col9), sum(_col13)
                          keys: _col27 (type: string), _col28 (type: string), _col24 (type: string), _col25 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                          Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                            sort order: ++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                            Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                            TopN Hash Memory Usage: 0.1
                            value expressions: _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 26799553 Data size: 2415018320 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: int), _col7 (type: int)
                1 _col1 (type: int), _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: int), _col7 (type: int)
                    1 _col1 (type: int), _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: int), _col7 (type: int)
              sort order: ++
              Map-reduce partition columns: _col6 (type: int), _col7 (type: int)
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: int), _col5 (type: int), _col9 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_customer_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col0 (type: int)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col0 (type: int)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: int), _col7 (type: int)
            1 _col1 (type: int), _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col13, _col14
          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query31.sql
STAGE DEPENDENCIES:
  Stage-62 is a root stage
  Stage-3 depends on stages: Stage-62
  Stage-42 depends on stages: Stage-3, Stage-11, Stage-16, Stage-21, Stage-26 , consists of Stage-57, Stage-58, Stage-59, Stage-60, Stage-61, Stage-4
  Stage-57 has a backup stage: Stage-4
  Stage-37 depends on stages: Stage-57
  Stage-36 depends on stages: Stage-4, Stage-31, Stage-37, Stage-38, Stage-39, Stage-40, Stage-41 , consists of Stage-55, Stage-56, Stage-5
  Stage-55 has a backup stage: Stage-5
  Stage-34 depends on stages: Stage-55
  Stage-6 depends on stages: Stage-5, Stage-34, Stage-35
  Stage-56 has a backup stage: Stage-5
  Stage-35 depends on stages: Stage-56
  Stage-5
  Stage-58 has a backup stage: Stage-4
  Stage-38 depends on stages: Stage-58
  Stage-59 has a backup stage: Stage-4
  Stage-39 depends on stages: Stage-59
  Stage-60 has a backup stage: Stage-4
  Stage-40 depends on stages: Stage-60
  Stage-61 has a backup stage: Stage-4
  Stage-41 depends on stages: Stage-61
  Stage-4
  Stage-63 is a root stage
  Stage-11 depends on stages: Stage-63
  Stage-64 is a root stage
  Stage-16 depends on stages: Stage-64
  Stage-65 is a root stage
  Stage-21 depends on stages: Stage-65
  Stage-66 is a root stage
  Stage-26 depends on stages: Stage-66
  Stage-67 is a root stage
  Stage-31 depends on stages: Stage-67
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-62
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 1) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_addr_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_addr_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-57
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 73217818 Data size: 6597959462 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Conditional Operator

  Stage: Stage-55
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col7, _col9, _col11
              Statistics: Num rows: 40269800 Data size: 3628877782 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col3 > 0.0)) THEN (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > (_col5 / _col3))) ELSE ((null > (_col5 / _col3))) END) ELSE (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), (_col9 / _col7) (type: double), (_col3 / _col1) (type: double), (_col11 / _col9) (type: double), (_col5 / _col3) (type: double)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: double)
              sort order: +
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), 1998 (type: int), KEY.reducesinkkey0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-56
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col7, _col9, _col11
              Statistics: Num rows: 40269800 Data size: 3628877782 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col3 > 0.0)) THEN (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > (_col5 / _col3))) ELSE ((null > (_col5 / _col3))) END) ELSE (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), (_col9 / _col7) (type: double), (_col3 / _col1) (type: double), (_col11 / _col9) (type: double), (_col5 / _col3) (type: double)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: double), _col3 (type: double), _col5 (type: double), _col7 (type: double), _col9 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5, _col7, _col9, _col11
          Statistics: Num rows: 40269800 Data size: 3628877782 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: CASE WHEN ((_col3 > 0.0)) THEN (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > (_col5 / _col3))) ELSE ((null > (_col5 / _col3))) END) ELSE (CASE WHEN ((_col9 > 0.0)) THEN (((_col11 / _col9) > null)) ELSE (null) END) END (type: boolean)
            Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), (_col9 / _col7) (type: double), (_col3 / _col1) (type: double), (_col11 / _col9) (type: double), (_col5 / _col3) (type: double)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-58
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-38
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 73217818 Data size: 6597959462 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-59
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 73217818 Data size: 6597959462 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-60
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME4 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 73217818 Data size: 6597959462 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-61
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME2 
          Fetch Operator
            limit: -1
        $hdt$_0:$INTNAME3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
        $hdt$_0:$INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
                   Inner Join 0 to 3
                   Inner Join 3 to 4
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
                3 _col0 (type: string)
                4 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
              Statistics: Num rows: 73217818 Data size: 6597959462 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
                Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
               Inner Join 0 to 3
               Inner Join 3 to 4
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
            2 _col0 (type: string)
            3 _col0 (type: string)
            4 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7, _col9
          Statistics: Num rows: 73217818 Data size: 6597959462 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: CASE WHEN ((_col1 > 0.0)) THEN (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > (_col3 / _col1))) ELSE ((null > (_col3 / _col1))) END) ELSE (CASE WHEN ((_col7 > 0.0)) THEN (((_col9 / _col7) > null)) ELSE (null) END) END (type: boolean)
            Statistics: Num rows: 36608909 Data size: 3298979731 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1:$hdt$_3:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1:$hdt$_3:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_addr_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_addr_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 3) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_addr_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_addr_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:$hdt$_5:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 1) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:$hdt$_5:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_bill_addr_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_4:$hdt$_5:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:$hdt$_6:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_4:$hdt$_5:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_4:$hdt$_6:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_bill_addr_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 3) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_bill_addr_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col7
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: string), _col1 (type: float)
                      outputColumnNames: _col7, _col1
                      Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col7 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query32.sql
STAGE DEPENDENCIES:
  Stage-18 is a root stage
  Stage-13 depends on stages: Stage-18
  Stage-12 depends on stages: Stage-7, Stage-13 , consists of Stage-15, Stage-16, Stage-17, Stage-2
  Stage-15 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-15
  Stage-3 depends on stages: Stage-2, Stage-9, Stage-10, Stage-11
  Stage-16 has a backup stage: Stage-2
  Stage-10 depends on stages: Stage-16
  Stage-17 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-17
  Stage-2
  Stage-19 is a root stage
  Stage-7 depends on stages: Stage-19
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:d 
          TableScan
            alias: d
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2000-01-27' AND '2000-04-27' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_item_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_ext_discount_amt (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_1:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col1, _col5
              Statistics: Num rows: 34676878 Data size: 4706344454 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
                Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: float)
                  outputColumnNames: _col1
                  Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col1)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 1 to 2
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col1, _col5
                  Statistics: Num rows: 34676878 Data size: 4706344454 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
                    Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col1 (type: float)
                      outputColumnNames: _col1
                      Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col1, _col5
              Statistics: Num rows: 34676878 Data size: 4706344454 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
                Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: float)
                  outputColumnNames: _col1
                  Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col1)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: float)
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col1, _col5
          Statistics: Num rows: 34676878 Data size: 4706344454 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (UDFToDouble(_col1) > _col5) (type: boolean)
            Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: float)
              outputColumnNames: _col1
              Statistics: Num rows: 11558959 Data size: 1568781439 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:d 
          TableScan
            alias: d
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2000-01-27' AND '2000-04-27' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_item_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_ext_discount_amt (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: avg(_col1)
                    keys: _col0 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col1 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), (1.3 * _col1) (type: double)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query34.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage
  Stage-4 depends on stages: Stage-19
  Stage-13 depends on stages: Stage-4 , consists of Stage-17, Stage-18, Stage-5
  Stage-17 has a backup stage: Stage-5
  Stage-11 depends on stages: Stage-17
  Stage-6 depends on stages: Stage-5, Stage-11, Stage-12
  Stage-18 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-18
  Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and (d_dom BETWEEN 1 AND 3 or d_dom BETWEEN 25 AND 28) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_county) IN ('Kittitas County', 'Adams County', 'Richland County', 'Furnas County', 'Orange County', 'Appanoose County', 'Franklin Parish', 'Tehama County') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_buy_potential = '1001-5000') or (hd_buy_potential = '5001-10000')) and (hd_vehicle_count > 0) and CASE WHEN ((hd_vehicle_count > 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) > 1.2)) ELSE (null) END and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 1200 Data size: 128400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1200 Data size: 128400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col3
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        keys: _col0 (type: int), _col3 (type: bigint)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: bigint)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col0 (type: int), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: _col2 BETWEEN 15 AND 20 (type: boolean)
              Statistics: Num rows: 2033828 Data size: 183276626 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
              Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: +++-
              Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: bigint), _col5 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 2033828 Data size: 183276626 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: bigint)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
          Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query39.sql
STAGE DEPENDENCIES:
  Stage-28 is a root stage
  Stage-4 depends on stages: Stage-28
  Stage-19 depends on stages: Stage-4, Stage-13 , consists of Stage-26, Stage-27, Stage-5
  Stage-26 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-26
  Stage-6 depends on stages: Stage-5, Stage-17, Stage-18
  Stage-27 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-27
  Stage-5
  Stage-29 is a root stage
  Stage-13 depends on stages: Stage-29
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 3) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null) (type: boolean)
              Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int), inv_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4
                  Statistics: Num rows: 146421003 Data size: 1727775088 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 161063106 Data size: 1900552637 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col4, _col5, _col6
                      Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col2 (type: int)
                        outputColumnNames: _col5, _col4, _col6, _col2
                        Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: stddev_samp(_col2), avg(_col2)
                          keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
                            Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col3 (type: struct<count:bigint,sum:double,variance:double>), _col4 (type: struct<count:bigint,sum:double,input:int>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: stddev_samp(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 88584710 Data size: 1045303973 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col1, _col2, _col3, _col4
            Statistics: Num rows: 88584710 Data size: 1045303973 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: CASE WHEN ((_col4 = 0.0)) THEN (false) ELSE (((_col3 / _col4) > 1.0)) END (type: boolean)
              Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col4 (type: double), CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE ((_col3 / _col4)) END (type: double)
                outputColumnNames: _col1, _col2, _col3, _col4
                Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
              Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
                Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double), _col8 (type: double), _col9 (type: double)
              sort order: ++++++
              Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col5 (type: int), _col6 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), 3 (type: int), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), VALUE._col0 (type: int), VALUE._col1 (type: int), 4 (type: int), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int), _col2 (type: int)
                1 _col1 (type: int), _col2 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
              Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
                Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: int)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: int)
              Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int), _col2 (type: int)
              sort order: ++
              Map-reduce partition columns: _col1 (type: int), _col2 (type: int)
              Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: int)
            1 _col1 (type: int), _col2 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
          Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double), _col4 (type: double), _col6 (type: int), _col7 (type: int), _col8 (type: double), _col9 (type: double)
            outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9
            Statistics: Num rows: 48721591 Data size: 574917197 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_3:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_3:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 4) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inventory
            Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null) (type: boolean)
              Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int), inv_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4
                  Statistics: Num rows: 146421003 Data size: 1727775088 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 161063106 Data size: 1900552637 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col4, _col5, _col6
                      Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col5 (type: int), _col4 (type: int), _col6 (type: string), _col2 (type: int)
                        outputColumnNames: _col5, _col4, _col6, _col2
                        Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: stddev_samp(_col2), avg(_col2)
                          keys: _col5 (type: int), _col4 (type: int), _col6 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
                            Statistics: Num rows: 177169420 Data size: 2090607946 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col3 (type: struct<count:bigint,sum:double,variance:double>), _col4 (type: struct<count:bigint,sum:double,input:int>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: stddev_samp(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 88584710 Data size: 1045303973 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: int), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col1, _col2, _col3, _col4
            Statistics: Num rows: 88584710 Data size: 1045303973 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: CASE WHEN ((_col4 = 0.0)) THEN (false) ELSE (((_col3 / _col4) > 1.0)) END (type: boolean)
              Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: int), _col4 (type: double), CASE WHEN ((_col4 = 0.0)) THEN (null) ELSE ((_col3 / _col4)) END (type: double)
                outputColumnNames: _col1, _col2, _col3, _col4
                Statistics: Num rows: 44292355 Data size: 522651986 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

1	20600	3	260.75	1.5840562735960761	1	20600	4	286.0	1.2462505096731606
1	25432	3	253.75	1.6040082612138984	1	25432	4	241.0	1.2413645172021182
1	47810	3	296.0	1.5814491948463614	1	47810	4	289.8	1.0805550540370878
1	48886	3	308.6666666666667	1.6454258456941424	1	48886	4	236.2	1.3312998186213658
1	98060	3	334.6666666666667	1.6906577647182017	1	98060	4	312.8	1.0186587914895646
2	41996	3	290.0	1.5770651108475378	2	41996	4	373.6	1.072276288438518
2	52496	3	171.66666666666666	1.5960562670228966	2	52496	4	323.5	1.0644853243828396
2	101122	3	269.5	1.7014096372693137	2	101122	4	283.0	1.2777186785101318
3	1960	3	285.5	1.5972939105317387	3	1960	4	305.0	1.0664914081587489
3	2326	3	291.25	1.5835967730795173	3	2326	4	381.2	1.1301095182823502
3	21932	3	137.0	1.5874751754424477	3	21932	4	298.0	1.0460401335334697
3	37006	3	337.0	1.6986491310386498	3	37006	4	338.0	1.1489903133796158
3	37666	3	335.3333333333333	1.636495999939053	3	37666	4	343.0	1.02410616876775
3	48751	3	287.25	1.5797387560965914	3	48751	4	348.4	1.1849317779883404
3	70882	3	250.75	1.5229541869107532	3	70882	4	309.75	1.042526109164106
3	88552	3	201.5	1.569549032849202	3	88552	4	455.4	1.0274493121553172
3	101995	3	169.0	1.5224320444896107	3	101995	4	205.75	1.4491171795316213
4	5486	3	256.25	1.5116814233688514	4	5486	4	288.4	1.2949511810453924
4	17209	3	269.75	1.6136603092120447	4	17209	4	197.4	1.1453574706320038
4	25154	3	223.0	1.6010831728056985	4	25154	4	373.2	1.0174208512257783
4	39442	3	150.25	1.731100820204814	4	39442	4	369.4	1.0180694628294766
4	51890	3	200.66666666666666	1.5419246755104703	4	51890	4	338.8	1.01609320646557
4	75904	3	349.6666666666667	1.500065656445976	4	75904	4	332.0	1.037253072877859
4	78757	3	225.75	1.6472187310469568	4	78757	4	326.8	1.0885933337463614
4	85328	3	98.75	1.7442701153564304	4	85328	4	358.0	1.0477783577204673
4	86414	3	323.3333333333333	1.6652975919397952	4	86414	4	148.6	1.3452942804656947
5	11929	3	114.33333333333333	1.5049154897483725	5	11929	4	271.8	1.1645780162929835
5	21410	3	293.3333333333333	1.5768375251047626	5	21410	4	298.25	1.1683833959891985
5	24968	3	190.5	1.5568206309689576	5	24968	4	226.0	1.2810059298616947
5	27811	3	204.25	1.9413637140931794	5	27811	4	337.6	1.1128192218538424
5	86149	3	142.33333333333334	1.5050441981851759	5	86149	4	195.4	1.0836894680540456
6	26146	3	255.5	1.729488153219165	6	26146	4	354.8	1.0621188098691108
6	62134	3	342.0	1.6408928439305455	6	62134	4	250.25	1.1733671104097705
6	80614	3	223.75	1.6833382749113408	6	80614	4	339.6	1.0407849302528942
6	98572	3	331.0	1.674762725261051	6	98572	4	323.6	1.1177952317273743
7	6692	3	284.3333333333333	1.5464813470724532	7	6692	4	408.0	1.0722808120759106
7	12998	3	233.0	1.5061320502180133	7	12998	4	343.4	1.04516157296789
7	16447	3	291.3333333333333	1.5242799799042899	7	16447	4	342.0	1.0347469455898928
7	25442	3	294.0	1.5291325677242575	7	25442	4	345.6	1.0151954153736842
7	50185	3	243.75	1.6176501817307873	7	50185	4	300.5	1.226849664851965
7	56588	3	131.0	1.5616238584334947	7	56588	4	325.5	1.4020452101979846
7	69998	3	220.33333333333334	1.5293885223931114	7	69998	4	274.6	1.128872494097781
8	2821	3	195.25	1.5659845486312738	8	2821	4	163.4	1.0092595310315349
8	11264	3	314.3333333333333	1.5047899397862605	8	11264	4	307.5	1.2565995611535272
8	23191	3	319.6666666666667	1.514879483042462	8	23191	4	373.4	1.1247490870592323
8	29342	3	297.0	1.569280047244682	8	29342	4	274.25	1.2626913692853945
8	89431	3	28.75	1.5292155881561833	8	89431	4	375.2	1.0361899563597945
8	95642	3	242.5	1.5476485156559894	8	95642	4	486.0	1.0237626699321833
8	100351	3	288.25	1.539530759219135	8	100351	4	258.0	1.1479980685221598
9	3826	3	243.25	1.6697881505174978	9	3826	4	411.0	1.042250873644278
9	50536	3	299.75	1.550840389504294	9	50536	4	237.4	1.5958852902762533
9	54514	3	310.0	1.50037456301566	9	54514	4	237.2	1.076039447482168
9	55900	3	320.3333333333333	1.5536471612525389	9	55900	4	471.2	1.0252680454196321
9	89552	3	70.0	1.571233754157567	9	89552	4	377.8	1.0050730673678285
10	13946	3	264.0	1.6796711998963514	10	13946	4	384.8	1.019589707597953
10	23227	3	125.33333333333333	1.5354499880856354	10	23227	4	334.25	1.036603164226553
10	42896	3	187.33333333333334	1.5371657391589237	10	42896	4	270.2	1.4039930900747122
10	45944	3	231.0	1.647840677127822	10	45944	4	373.2	1.1217841738916923
10	71804	3	350.6666666666667	1.568405633889478	10	71804	4	258.6	1.1016389635548998
10	73987	3	189.5	1.6180289255984015	10	73987	4	422.4	1.030649110056865
@@@sample-queries-tpcds/query3.sql
STAGE DEPENDENCIES:
  Stage-9 is a root stage
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:dt 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:dt 
          TableScan
            alias: dt
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id = 436) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
                  outputColumnNames: _col1, _col3, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col7, _col8
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col1 (type: int), _col7 (type: int), _col8 (type: string), _col4 (type: float)
                      outputColumnNames: _col1, _col7, _col8, _col4
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col4)
                        keys: _col1 (type: int), _col7 (type: int), _col8 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: string)
                          sort order: +++
                          Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col3 (type: double), _col1 (type: int)
              sort order: +-+
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query40.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-14 depends on stages: Stage-1
  Stage-5 depends on stages: Stage-14
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_warehouse_sk (type: int), cs_item_sk (type: int), cs_order_number (type: bigint), cs_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col3 (type: float), _col4 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_refunded_cash (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col3, _col4, _col7
          Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_current_price BETWEEN 0.99 AND 1.49 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 11333 Data size: 16239366 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 11333 Data size: 16239366 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1998-03-09' AND '1998-05-08' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col7, _col9
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col3, _col4, _col7, _col9, _col11
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col7, _col9, _col11, _col14
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col9 (type: string), _col11 (type: string), CASE WHEN ((CAST( _col14 AS DATE) < 1998-04-08)) THEN ((_col3 - COALESCE(_col7,0))) ELSE (0) END (type: float), CASE WHEN ((CAST( _col14 AS DATE) >= 1998-04-08)) THEN ((_col3 - COALESCE(_col7,0))) ELSE (0) END (type: float)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3)
                      keys: _col0 (type: string), _col1 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                        Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                        TopN Hash Memory Usage: 0.1
                        value expressions: _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query42.sql
STAGE DEPENDENCIES:
  Stage-9 is a root stage
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:dt 
          Fetch Operator
            limit: -1
        $hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:dt 
          TableScan
            alias: dt
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
        $hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category_id (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
                  outputColumnNames: _col3, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col7, _col8
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: int), _col8 (type: string), _col4 (type: float)
                      outputColumnNames: _col7, _col8, _col4
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col4)
                        keys: _col7 (type: int), _col8 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: string)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: string), _col2 (type: double)
            outputColumnNames: _col1, _col2, _col3
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: double), _col1 (type: int), _col2 (type: string)
              sort order: -++
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: 1998 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query43.sql
STAGE DEPENDENCIES:
  Stage-9 is a root stage
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_day_name (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
        $hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_gmt_offset = -6) and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_store_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_store_sk (type: int), ss_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
                  outputColumnNames: _col2, _col3, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2, _col4, _col7, _col8
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col8 (type: string), _col7 (type: string), CASE WHEN ((_col2 = 'Sunday')) THEN (_col4) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Monday')) THEN (_col4) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Tuesday')) THEN (_col4) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Wednesday')) THEN (_col4) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Thursday')) THEN (_col4) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Friday')) THEN (_col4) ELSE (null) END (type: float), CASE WHEN ((_col2 = 'Saturday')) THEN (_col4) ELSE (null) END (type: float)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                        keys: _col0 (type: string), _col1 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: string)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          TopN Hash Memory Usage: 0.1
                          value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double)
              sort order: +++++++++
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double), KEY.reducesinkkey6 (type: double), KEY.reducesinkkey7 (type: double), KEY.reducesinkkey8 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query45.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage
  Stage-15 depends on stages: Stage-12, Stage-16 , consists of Stage-21, Stage-22, Stage-5
  Stage-21 has a backup stage: Stage-5
  Stage-13 depends on stages: Stage-21
  Stage-6 depends on stages: Stage-5, Stage-13, Stage-14
  Stage-7 depends on stages: Stage-6
  Stage-22 has a backup stage: Stage-5
  Stage-14 depends on stages: Stage-22
  Stage-5
  Stage-20 is a root stage , consists of Stage-25, Stage-1
  Stage-25 has a backup stage: Stage-1
  Stage-19 depends on stages: Stage-25
  Stage-24 depends on stages: Stage-1, Stage-19
  Stage-18 depends on stages: Stage-24
  Stage-23 depends on stages: Stage-18
  Stage-16 depends on stages: Stage-23
  Stage-1
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i2
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_item_sk) IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-15
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col7, _col8
              Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col8, _col7, _col2
                Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col8 (type: string), _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 5794435 Data size: 787964326 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 5794435 Data size: 787964326 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 5794435 Data size: 787964326 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col13 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col7, _col8
              Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col8 (type: string), _col7 (type: string), _col2 (type: float)
                outputColumnNames: _col8, _col7, _col2
                Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col8 (type: string), _col7 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col13 (type: string)
              sort order: +
              Map-reduce partition columns: _col13 (type: string)
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float), _col7 (type: string), _col8 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col13 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col7, _col8
          Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col8 (type: string), _col7 (type: string), _col2 (type: float)
            outputColumnNames: _col8, _col7, _col2
            Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col8 (type: string), _col7 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_bill_customer_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_bill_customer_sk (type: int), ws_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col5
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col7, _col8
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_4:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_qoy = 2) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col7, _col8
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col7, _col8, _col13
                Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_bill_customer_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_bill_customer_sk (type: int), ws_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: int)
                  Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: float), _col3 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col5
          Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query46.sql
STAGE DEPENDENCIES:
  Stage-26 is a root stage
  Stage-5 depends on stages: Stage-26
  Stage-18 depends on stages: Stage-5 , consists of Stage-24, Stage-25, Stage-6
  Stage-24 has a backup stage: Stage-6
  Stage-16 depends on stages: Stage-24
  Stage-23 depends on stages: Stage-6, Stage-16, Stage-17
  Stage-8 depends on stages: Stage-23
  Stage-25 has a backup stage: Stage-6
  Stage-17 depends on stages: Stage-25
  Stage-6
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_dow) IN (6, 0) and (d_year) IN (1998, 1999, 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18263 Data size: 20436297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18263 Data size: 20436297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_city) IN ('Rosedale', 'Bethlehem', 'Clinton', 'Clifton', 'Springfield') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 4) or (hd_vehicle_count = 2)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_coupon_amt (type: float), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col2, _col4, _col5, _col6
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col17
                        Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: int), _col2 (type: int), _col4 (type: bigint), _col17 (type: string), _col5 (type: float), _col6 (type: float)
                          outputColumnNames: _col0, _col2, _col4, _col17, _col5, _col6
                          Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: sum(_col5), sum(_col6)
                            keys: _col0 (type: int), _col2 (type: int), _col4 (type: bigint), _col17 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                            Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                              sort order: ++++
                              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                              value expressions: _col4 (type: double), _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: bigint), _col0 (type: int), _col3 (type: string), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8
              Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:current_addr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:current_addr 
          TableScan
            alias: current_addr
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col7, _col8, _col10
              Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col10 <> _col2) (type: boolean)
                Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col8 (type: string), _col7 (type: string), _col10 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: bigint)
                    sort order: +++++
                    Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col5 (type: double), _col6 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: bigint), VALUE._col0 (type: double), VALUE._col1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8
                  Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8
          Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query48.sql
STAGE DEPENDENCIES:
  Stage-14 is a root stage
  Stage-5 depends on stages: Stage-14
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and (cd_education_status = '4 yr Degree') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 480200 Data size: 179402720 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 480200 Data size: 179402720 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 62500 Data size: 63429996 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 62500 Data size: 63429996 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_sales_price BETWEEN 100 AND 150 or ss_sales_price BETWEEN 50 AND 100 or ss_sales_price BETWEEN 150 AND 200) and (ss_net_profit BETWEEN 0 AND 2000 or ss_net_profit BETWEEN 150 AND 3000 or ss_net_profit BETWEEN 50 AND 25000) and ss_store_sk is not null and ss_cdemo_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 3056088 Data size: 275396684 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_cdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6
                Statistics: Num rows: 3056088 Data size: 275396684 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col5, _col6
                  Statistics: Num rows: 3361696 Data size: 302936358 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col3, _col5, _col6
                    Statistics: Num rows: 3697865 Data size: 333230001 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col3, _col5, _col6, _col12
                      Statistics: Num rows: 4067651 Data size: 366553009 Basic stats: COMPLETE Column stats: NONE
                      Filter Operator
                        predicate: (((_col12) IN ('KY', 'GA', 'NM') and _col5 BETWEEN 0 AND 2000) or ((_col12) IN ('MT', 'OR', 'IN') and _col5 BETWEEN 150 AND 3000) or ((_col12) IN ('WI', 'MO', 'WV') and _col5 BETWEEN 50 AND 25000)) (type: boolean)
                        Statistics: Num rows: 677940 Data size: 61092002 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col3 (type: int), _col6 (type: int)
                          outputColumnNames: _col3, _col6
                          Statistics: Num rows: 677940 Data size: 61092002 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col6 (type: int)
                              1 _col0 (type: int)
                            outputColumnNames: _col3
                            Statistics: Num rows: 745734 Data size: 67201203 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col3)
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                sort order: 
                                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query49.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-26 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-26
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5, Stage-13, Stage-20
  Stage-9 is a root stage
  Stage-27 depends on stages: Stage-9
  Stage-11 depends on stages: Stage-27
  Stage-12 depends on stages: Stage-11
  Stage-13 depends on stages: Stage-12
  Stage-16 is a root stage
  Stage-28 depends on stages: Stage-16
  Stage-18 depends on stages: Stage-28
  Stage-19 depends on stages: Stage-18
  Stage-20 depends on stages: Stage-19
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ws_net_profit > 1) and (ws_net_paid > 0) and (ws_quantity > 0) and ws_order_number is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 266510 Data size: 36241722 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_net_paid (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 266510 Data size: 36241722 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 266510 Data size: 36241722 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float), _col5 (type: int)
          TableScan
            alias: wr
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((wr_return_amt > 10000) and wr_item_sk is not null and wr_order_number is not null) (type: boolean)
              Statistics: Num rows: 239739 Data size: 22104066 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 239739 Data size: 22104066 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 239739 Data size: 22104066 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col5, _col8, _col9
          Statistics: Num rows: 293161 Data size: 39865895 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col8, _col9
              Statistics: Num rows: 322477 Data size: 43852485 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col2,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col3,0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 322477 Data size: 43852485 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 322477 Data size: 43852485 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 322477 Data size: 43852485 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: bigint, _col2: bigint, _col3: double, _col4: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
              value expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: int, _col2: bigint, _col3: bigint, _col4: double, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_1
                        arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 161238 Data size: 21926174 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)
              Statistics: Num rows: 107492 Data size: 14617449 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'web' (type: string), _col1 (type: int), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 107492 Data size: 14617449 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int)
                sort order: +++
                Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
                TopN Hash Memory Usage: 0.1
                value expressions: _col1 (type: int), _col2 (type: decimal(35,20))
          TableScan
            Union
              Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int)
                sort order: +++
                Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
                TopN Hash Memory Usage: 0.1
                value expressions: _col1 (type: int), _col2 (type: decimal(35,20))
          TableScan
            Union
              Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int)
                sort order: +++
                Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
                TopN Hash Memory Usage: 0.1
                value expressions: _col1 (type: int), _col2 (type: decimal(35,20))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: int), VALUE._col1 (type: decimal(35,20)), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 732418 Data size: 80694295 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cs_net_profit > 1) and (cs_net_paid > 0) and (cs_quantity > 0) and cs_order_number is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 530714 Data size: 72028481 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_net_paid (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 530714 Data size: 72028481 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 530714 Data size: 72028481 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float), _col5 (type: int)
          TableScan
            alias: cr
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cr_return_amount > 10000) and cr_item_sk is not null and cr_order_number is not null) (type: boolean)
              Statistics: Num rows: 479916 Data size: 50951013 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 479916 Data size: 50951013 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 479916 Data size: 50951013 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col5, _col8, _col9
          Statistics: Num rows: 583785 Data size: 79231330 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col8, _col9
              Statistics: Num rows: 642163 Data size: 87154464 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col2,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col3,0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 642163 Data size: 87154464 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 642163 Data size: 87154464 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 642163 Data size: 87154464 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: bigint, _col2: bigint, _col3: double, _col4: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
              value expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: int, _col2: bigint, _col3: bigint, _col4: double, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_1
                        arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 321081 Data size: 43577164 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)
              Statistics: Num rows: 214054 Data size: 29051442 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'catalog' (type: string), _col1 (type: int), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 214054 Data size: 29051442 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: sts
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_net_profit > 1) and (ss_net_paid > 0) and (ss_quantity > 0) and ss_item_sk is not null and ss_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 1018696 Data size: 91798894 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_net_paid (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 1018696 Data size: 91798894 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1018696 Data size: 91798894 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float), _col5 (type: int)
          TableScan
            alias: sr
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((sr_return_amt > 10000) and sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 958477 Data size: 74399295 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 958477 Data size: 74399295 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 958477 Data size: 74399295 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col5, _col8, _col9
          Statistics: Num rows: 1120565 Data size: 100978785 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        null-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col5 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col8, _col9
              Statistics: Num rows: 1232621 Data size: 111076665 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: int), COALESCE(_col8,0) (type: int), COALESCE(_col2,0) (type: int), COALESCE(_col9,0) (type: float), COALESCE(_col3,0) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1232621 Data size: 111076665 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 1232621 Data size: 111076665 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 1232621 Data size: 111076665 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: bigint, _col2: bigint, _col3: double, _col4: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
              outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
              sort order: ++
              Map-reduce partition columns: 0 (type: int)
              Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
              value expressions: rank_window_0 (type: int), _col0 (type: int), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: int, _col2: bigint, _col3: bigint, _col4: double, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS FIRST
                  partition by: 0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_1
                        arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 616310 Data size: 55538287 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((_col0 <= 10) or (rank_window_1 <= 10)) (type: boolean)
              Statistics: Num rows: 410872 Data size: 37025404 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'store' (type: string), _col1 (type: int), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 410872 Data size: 37025404 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query50.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-14 depends on stages: Stage-1
  Stage-5 depends on stages: Stage-14
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col4 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_customer_sk (type: int), sr_ticket_number (type: bigint), sr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: int), _col2 (type: bigint)
          outputColumnNames: _col2, _col4, _col8
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:d1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_company_id (type: int), s_street_number (type: string), s_street_name (type: string), s_street_type (type: string), s_suite_number (type: string), s_city (type: string), s_county (type: string), s_state (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col4, _col8, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col4 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col4, _col8, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col4, _col8, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: string), _col11 (type: int), _col12 (type: string), _col13 (type: string), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col17 (type: string), _col18 (type: string), _col19 (type: string), CASE WHEN (((_col8 - _col4) <= 30)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col8 - _col4) > 30) and ((_col8 - _col4) <= 60))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col8 - _col4) > 60) and ((_col8 - _col4) <= 90))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col8 - _col4) > 90) and ((_col8 - _col4) <= 120))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col8 - _col4) > 120)) THEN (1) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                    Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14)
                      keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                      Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                        sort order: ++++++++++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
                        Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                        TopN Hash Memory Usage: 0.1
                        value expressions: _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string)
              sort order: ++++++++++
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey5 (type: string), KEY.reducesinkkey6 (type: string), KEY.reducesinkkey7 (type: string), KEY.reducesinkkey8 (type: string), KEY.reducesinkkey9 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query51.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage
  Stage-2 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-13 is a root stage
  Stage-8 depends on stages: Stage-13
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col4
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: int), _col4 (type: string), _col1 (type: float)
                    outputColumnNames: _col0, _col4, _col1
                    Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1)
                      keys: _col0 (type: int), _col4 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int), _col1 (type: string)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 3957677 Data size: 538190123 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: string, _col2: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col1 ASC NULLS FIRST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col2
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~CURRENT
            Statistics: Num rows: 3957677 Data size: 538190123 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: string), sum_window_0 (type: double)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 3957677 Data size: 538190123 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 3957677 Data size: 538190123 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
              Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: string)
            1 _col0 (type: int), _col1 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END (type: int), CASE WHEN (_col1 is not null) THEN (_col1) ELSE (_col4) END (type: string)
              sort order: ++
              Map-reduce partition columns: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END (type: int)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col1 (type: string), _col2 (type: double), _col3 (type: int), _col4 (type: string), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: int), VALUE._col1 (type: string), VALUE._col2 (type: double), VALUE._col3 (type: int), VALUE._col4 (type: string), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: string, _col2: double, _col3: int, _col4: string, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: CASE WHEN (_col1 is not null) THEN (_col1) ELSE (_col4) END ASC NULLS FIRST
                  partition by: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END
                  raw input shape:
                  window functions:
                      window function definition
                        alias: max_window_0
                        arguments: _col2
                        name: max
                        window function: GenericUDAFMaxEvaluator
                        window frame: PRECEDING(MAX)~CURRENT
                      window function definition
                        alias: max_window_1
                        arguments: _col5
                        name: max
                        window function: GenericUDAFMaxEvaluator
                        window frame: PRECEDING(MAX)~CURRENT
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (max_window_0 > max_window_1) (type: boolean)
              Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: CASE WHEN (_col0 is not null) THEN (_col0) ELSE (_col3) END (type: int), CASE WHEN (_col1 is not null) THEN (_col1) ELSE (_col4) END (type: string), _col2 (type: double), _col5 (type: double), max_window_0 (type: double), max_window_1 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_1:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: int), _col4 (type: string), _col1 (type: float)
                    outputColumnNames: _col0, _col4, _col1
                    Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1)
                      keys: _col0 (type: int), _col4 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int), _col1 (type: string)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: int, _col1: string, _col2: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col1 ASC NULLS FIRST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col2
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~CURRENT
            Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: string), sum_window_0 (type: double)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query52.sql
STAGE DEPENDENCIES:
  Stage-9 is a root stage
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:dt 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:dt 
          TableScan
            alias: dt
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
                  outputColumnNames: _col3, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col7, _col8
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: int), _col8 (type: string), _col4 (type: float)
                      outputColumnNames: _col7, _col8, _col4
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col4)
                        keys: _col7 (type: int), _col8 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: string)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: string), _col2 (type: double)
            outputColumnNames: _col1, _col2, _col3
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: double), _col1 (type: int)
              sort order: -+
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: 1998 (type: int), KEY.reducesinkkey1 (type: int), VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query54.sql
STAGE DEPENDENCIES:
  Stage-37 is a root stage
  Stage-30 depends on stages: Stage-37
  Stage-36 depends on stages: Stage-30
  Stage-29 depends on stages: Stage-36
  Stage-28 depends on stages: Stage-29 , consists of Stage-34, Stage-35, Stage-3
  Stage-34 has a backup stage: Stage-3
  Stage-26 depends on stages: Stage-34
  Stage-4 depends on stages: Stage-3, Stage-26, Stage-27
  Stage-25 depends on stages: Stage-4 , consists of Stage-32, Stage-33, Stage-5
  Stage-32 has a backup stage: Stage-5
  Stage-23 depends on stages: Stage-32
  Stage-31 depends on stages: Stage-5, Stage-23, Stage-24
  Stage-9 depends on stages: Stage-31
  Stage-10 depends on stages: Stage-9
  Stage-11 depends on stages: Stage-10
  Stage-33 has a backup stage: Stage-5
  Stage-24 depends on stages: Stage-33
  Stage-5
  Stage-35 has a backup stage: Stage-3
  Stage-27 depends on stages: Stage-35
  Stage-3
  Stage-0 depends on stages: Stage-11

STAGE PLANS:
  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Jewelry') and (i_class = 'football') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_date_sk (type: int), cs_bill_customer_sk (type: int), cs_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 21525066 Data size: 2923297952 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 23677573 Data size: 3215627816 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: int), ws_bill_customer_sk (type: int), ws_item_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 21525066 Data size: 2923297952 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 23677573 Data size: 3215627816 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 3) and (d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1
              Statistics: Num rows: 26045330 Data size: 3537190674 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-28
    Conditional Operator

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col9, _col10
              Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col9 (type: int), _col10 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 14324931 Data size: 1945454844 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Conditional Operator

  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:store_sales 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:store_sales 
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_customer_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col3, _col4
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_county is not null and ca_state is not null) (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_county (type: string), ca_state (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_county is not null and s_state is not null) (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_county (type: string), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: string), _col7 (type: string)
                    1 _col0 (type: string), _col1 (type: string)
        $hdt$_0:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1203 AND 1205 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col3, _col4, _col6, _col7
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col6 (type: string), _col7 (type: string)
                  1 _col0 (type: string), _col1 (type: string)
                outputColumnNames: _col0, _col3, _col4
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col3)
                    keys: _col0 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: UDFToInteger((_col1 / 50.0)) (type: int)
            outputColumnNames: _col0
            Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count()
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 10067450 Data size: 907219445 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: bigint), (_col0 * 50) (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 10067450 Data size: 907219445 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Statistics: Num rows: 10067450 Data size: 907219445 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: int)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 10067450 Data size: 907219445 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_customer_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 14324931 Data size: 1945454844 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int)
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_customer_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: float), _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col3, _col4
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col9, _col10
                  Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col9 (type: int), _col10 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 26045330 Data size: 3537190674 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col9, _col10
          Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col9 (type: int), _col10 (type: int)
            mode: hash
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 28649863 Data size: 3890909825 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query55.sql
STAGE DEPENDENCIES:
  Stage-9 is a root stage
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
        $hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 36) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col2 (type: int)
                  outputColumnNames: _col3, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col7, _col8
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col7 (type: int), _col8 (type: string), _col4 (type: float)
                      outputColumnNames: _col7, _col8, _col4
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col4)
                        keys: _col7 (type: int), _col8 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: string)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: int), _col1 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: double), _col0 (type: int)
              sort order: -+
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query56.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-32 depends on stages: Stage-11, Stage-33 , consists of Stage-48, Stage-49, Stage-4
  Stage-48 has a backup stage: Stage-4
  Stage-30 depends on stages: Stage-48
  Stage-5 depends on stages: Stage-4, Stage-30, Stage-31
  Stage-6 depends on stages: Stage-5, Stage-16, Stage-25
  Stage-7 depends on stages: Stage-6
  Stage-49 has a backup stage: Stage-4
  Stage-31 depends on stages: Stage-49
  Stage-4
  Stage-20 is a root stage
  Stage-38 depends on stages: Stage-20, Stage-39 , consists of Stage-50, Stage-51, Stage-15
  Stage-50 has a backup stage: Stage-15
  Stage-36 depends on stages: Stage-50
  Stage-16 depends on stages: Stage-15, Stage-36, Stage-37
  Stage-51 has a backup stage: Stage-15
  Stage-37 depends on stages: Stage-51
  Stage-15
  Stage-29 is a root stage
  Stage-44 depends on stages: Stage-29, Stage-45 , consists of Stage-52, Stage-53, Stage-24
  Stage-52 has a backup stage: Stage-24
  Stage-42 depends on stages: Stage-52
  Stage-25 depends on stages: Stage-24, Stage-42, Stage-43
  Stage-53 has a backup stage: Stage-24
  Stage-43 depends on stages: Stage-53
  Stage-24
  Stage-55 is a root stage
  Stage-35 depends on stages: Stage-55
  Stage-54 depends on stages: Stage-35
  Stage-33 depends on stages: Stage-54
  Stage-57 is a root stage
  Stage-41 depends on stages: Stage-57
  Stage-56 depends on stages: Stage-41
  Stage-39 depends on stages: Stage-56
  Stage-59 is a root stage
  Stage-47 depends on stages: Stage-59
  Stage-58 depends on stages: Stage-47
  Stage-45 depends on stages: Stage-58
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('purple', 'burlywood', 'indian') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 17946161 Data size: 1977219546 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double)
              sort order: +
              Statistics: Num rows: 17946161 Data size: 1977219546 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 17946161 Data size: 1977219546 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-49
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col10
          Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col2 (type: float)
            outputColumnNames: _col10, _col2
            Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('purple', 'burlywood', 'indian') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-38
    Conditional Operator

  Stage: Stage-50
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-51
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col10
          Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col2 (type: float)
            outputColumnNames: _col10, _col2
            Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('purple', 'burlywood', 'indian') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Conditional Operator

  Stage: Stage-52
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 5267668 Data size: 716331122 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-53
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col10
          Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col2 (type: float)
            outputColumnNames: _col10, _col2
            Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-55
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_addr_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-54
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col10
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-57
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_addr_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_addr_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-56
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col10
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-59
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_bill_addr_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-58
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col10
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query58.sql
STAGE DEPENDENCIES:
  Stage-58 is a root stage
  Stage-37 depends on stages: Stage-58
  Stage-36 depends on stages: Stage-37, Stage-39 , consists of Stage-56, Stage-57, Stage-3
  Stage-56 has a backup stage: Stage-3
  Stage-34 depends on stages: Stage-56
  Stage-4 depends on stages: Stage-3, Stage-34, Stage-35
  Stage-33 depends on stages: Stage-4, Stage-15 , consists of Stage-54, Stage-55, Stage-5
  Stage-54 has a backup stage: Stage-5
  Stage-31 depends on stages: Stage-54
  Stage-30 depends on stages: Stage-5, Stage-23, Stage-31, Stage-32 , consists of Stage-52, Stage-53, Stage-6
  Stage-52 has a backup stage: Stage-6
  Stage-28 depends on stages: Stage-52
  Stage-7 depends on stages: Stage-6, Stage-28, Stage-29
  Stage-53 has a backup stage: Stage-6
  Stage-29 depends on stages: Stage-53
  Stage-6
  Stage-55 has a backup stage: Stage-5
  Stage-32 depends on stages: Stage-55
  Stage-5
  Stage-57 has a backup stage: Stage-3
  Stage-35 depends on stages: Stage-57
  Stage-3
  Stage-59 is a root stage
  Stage-39 depends on stages: Stage-59
  Stage-62 is a root stage
  Stage-43 depends on stages: Stage-62
  Stage-42 depends on stages: Stage-43, Stage-45 , consists of Stage-60, Stage-61, Stage-14
  Stage-60 has a backup stage: Stage-14
  Stage-40 depends on stages: Stage-60
  Stage-15 depends on stages: Stage-14, Stage-40, Stage-41
  Stage-61 has a backup stage: Stage-14
  Stage-41 depends on stages: Stage-61
  Stage-14
  Stage-63 is a root stage
  Stage-45 depends on stages: Stage-63
  Stage-66 is a root stage
  Stage-49 depends on stages: Stage-66
  Stage-48 depends on stages: Stage-49, Stage-51 , consists of Stage-64, Stage-65, Stage-22
  Stage-64 has a backup stage: Stage-22
  Stage-46 depends on stages: Stage-64
  Stage-23 depends on stages: Stage-22, Stage-46, Stage-47
  Stage-65 has a backup stage: Stage-22
  Stage-47 depends on stages: Stage-65
  Stage-22
  Stage-67 is a root stage
  Stage-51 depends on stages: Stage-67
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-58
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col6
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-36
    Conditional Operator

  Stage: Stage-56
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: float)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Conditional Operator

  Stage: Stage-54
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3
              Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col3) AND (1.1 * _col3) and _col3 BETWEEN (0.9 * _col1) AND (1.1 * _col1)) (type: boolean)
                Statistics: Num rows: 248579 Data size: 22400479 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-30
    Conditional Operator

  Stage: Stage-52
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 5267668 Data size: 716331115 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col3 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col5 BETWEEN (0.9 * _col1) AND (1.1 * _col1) and _col5 BETWEEN (0.9 * _col3) AND (1.1 * _col3)) (type: boolean)
                Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: double), (((_col1 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col3 (type: double), (((_col3 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col5 (type: double), (((_col5 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), (((_col1 + _col3) + _col5) / 3.0) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double)
              sort order: ++
              Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-53
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 5267668 Data size: 716331115 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col3 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col5 BETWEEN (0.9 * _col1) AND (1.1 * _col1) and _col5 BETWEEN (0.9 * _col3) AND (1.1 * _col3)) (type: boolean)
                Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: double), (((_col1 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col3 (type: double), (((_col3 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col5 (type: double), (((_col5 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), (((_col1 + _col3) + _col5) / 3.0) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 248579 Data size: 22400479 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col3 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 4788789 Data size: 651210091 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5
          Statistics: Num rows: 5267668 Data size: 716331115 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col3 BETWEEN (0.9 * _col5) AND (1.1 * _col5) and _col5 BETWEEN (0.9 * _col1) AND (1.1 * _col1) and _col5 BETWEEN (0.9 * _col3) AND (1.1 * _col3)) (type: boolean)
            Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: double), (((_col1 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col3 (type: double), (((_col3 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), _col5 (type: double), (((_col5 / ((_col1 + _col3) + _col5)) / 3.0) * 100.0) (type: double), (((_col1 + _col3) + _col5) / 3.0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 802 Data size: 109061 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-55
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3
              Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 BETWEEN (0.9 * _col3) AND (1.1 * _col3) and _col3 BETWEEN (0.9 * _col1) AND (1.1 * _col1)) (type: boolean)
                Statistics: Num rows: 248579 Data size: 22400479 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 9536141 Data size: 1294244684 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3
          Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 BETWEEN (0.9 * _col3) AND (1.1 * _col3) and _col3 BETWEEN (0.9 * _col1) AND (1.1 * _col1)) (type: boolean)
            Statistics: Num rows: 248579 Data size: 22400479 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-57
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: float)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col4
          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col1 (type: float)
            outputColumnNames: _col4, _col1
            Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-59
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-62
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_item_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col6
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-60
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: float)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 9536141 Data size: 1294244684 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-61
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: float)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col4
          Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col1 (type: float)
            outputColumnNames: _col4, _col1
            Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_4:$hdt$_4:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_4:$hdt$_4:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col6
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-48
    Conditional Operator

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: float)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 4788789 Data size: 651210091 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: float)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: float), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col4
          Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col1 (type: float)
            outputColumnNames: _col4, _col1
            Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-67
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_4:$hdt$_4:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_4:$hdt$_4:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)

  Stage: Stage-51
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date = '1998-08-04') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: _col1
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query60.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-32 depends on stages: Stage-11, Stage-33 , consists of Stage-48, Stage-49, Stage-4
  Stage-48 has a backup stage: Stage-4
  Stage-30 depends on stages: Stage-48
  Stage-5 depends on stages: Stage-4, Stage-30, Stage-31
  Stage-6 depends on stages: Stage-5, Stage-16, Stage-25
  Stage-7 depends on stages: Stage-6
  Stage-49 has a backup stage: Stage-4
  Stage-31 depends on stages: Stage-49
  Stage-4
  Stage-20 is a root stage
  Stage-38 depends on stages: Stage-20, Stage-39 , consists of Stage-50, Stage-51, Stage-15
  Stage-50 has a backup stage: Stage-15
  Stage-36 depends on stages: Stage-50
  Stage-16 depends on stages: Stage-15, Stage-36, Stage-37
  Stage-51 has a backup stage: Stage-15
  Stage-37 depends on stages: Stage-51
  Stage-15
  Stage-29 is a root stage
  Stage-44 depends on stages: Stage-29, Stage-45 , consists of Stage-52, Stage-53, Stage-24
  Stage-52 has a backup stage: Stage-24
  Stage-42 depends on stages: Stage-52
  Stage-25 depends on stages: Stage-24, Stage-42, Stage-43
  Stage-53 has a backup stage: Stage-24
  Stage-43 depends on stages: Stage-53
  Stage-24
  Stage-55 is a root stage
  Stage-35 depends on stages: Stage-55
  Stage-54 depends on stages: Stage-35
  Stage-33 depends on stages: Stage-54
  Stage-57 is a root stage
  Stage-41 depends on stages: Stage-57
  Stage-56 depends on stages: Stage-41
  Stage-39 depends on stages: Stage-56
  Stage-59 is a root stage
  Stage-47 depends on stages: Stage-59
  Stage-58 depends on stages: Stage-47
  Stage-45 depends on stages: Stage-58
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Children') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col1 (type: double)
          TableScan
            Union
              Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col1)
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 35892323 Data size: 3954439203 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 17946161 Data size: 1977219546 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double)
              sort order: ++
              Statistics: Num rows: 17946161 Data size: 1977219546 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 17946161 Data size: 1977219546 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-49
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col10
          Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col2 (type: float)
            outputColumnNames: _col10, _col2
            Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Children') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-38
    Conditional Operator

  Stage: Stage-50
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-51
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col10
          Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col2 (type: float)
            outputColumnNames: _col10, _col2
            Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: i
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Children') and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_id (type: string)
                outputColumnNames: i_item_id
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: i_item_id (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Conditional Operator

  Stage: Stage-52
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 5267668 Data size: 716331122 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-53
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col2, _col10
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col10 (type: string), _col2 (type: float)
                outputColumnNames: _col10, _col2
                Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col10 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col10 (type: string)
              sort order: +
              Map-reduce partition columns: _col10 (type: string)
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 25500 Data size: 36539648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col10 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col2, _col10
          Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col10 (type: string), _col2 (type: float)
            outputColumnNames: _col10, _col2
            Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col10 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-55
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_addr_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_addr_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-54
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col10
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-57
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_bill_addr_sk is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_addr_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-56
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col10
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-59
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 9) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_bill_addr_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_bill_addr_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-58
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -6) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-45
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col2, _col10
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query64.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-97 depends on stages: Stage-1 , consists of Stage-124, Stage-125, Stage-2
  Stage-124 has a backup stage: Stage-2
  Stage-95 depends on stages: Stage-124
  Stage-123 depends on stages: Stage-2, Stage-95, Stage-96
  Stage-82 depends on stages: Stage-123
  Stage-81 depends on stages: Stage-37, Stage-82 , consists of Stage-120, Stage-121, Stage-122, Stage-16
  Stage-120 has a backup stage: Stage-16
  Stage-78 depends on stages: Stage-120
  Stage-17 depends on stages: Stage-16, Stage-78, Stage-79, Stage-80
  Stage-77 depends on stages: Stage-17, Stage-55 , consists of Stage-118, Stage-119, Stage-18
  Stage-118 has a backup stage: Stage-18
  Stage-75 depends on stages: Stage-118
  Stage-19 depends on stages: Stage-18, Stage-75, Stage-76
  Stage-119 has a backup stage: Stage-18
  Stage-76 depends on stages: Stage-119
  Stage-18
  Stage-121 has a backup stage: Stage-16
  Stage-79 depends on stages: Stage-121
  Stage-122 has a backup stage: Stage-16
  Stage-80 depends on stages: Stage-122
  Stage-16
  Stage-125 has a backup stage: Stage-2
  Stage-96 depends on stages: Stage-125
  Stage-2
  Stage-36 is a root stage
  Stage-37 depends on stages: Stage-36
  Stage-39 is a root stage
  Stage-117 depends on stages: Stage-39 , consists of Stage-130, Stage-131, Stage-40
  Stage-130 has a backup stage: Stage-40
  Stage-115 depends on stages: Stage-130
  Stage-129 depends on stages: Stage-40, Stage-115, Stage-116
  Stage-102 depends on stages: Stage-129
  Stage-101 depends on stages: Stage-73, Stage-102 , consists of Stage-126, Stage-127, Stage-128, Stage-54
  Stage-126 has a backup stage: Stage-54
  Stage-98 depends on stages: Stage-126
  Stage-55 depends on stages: Stage-54, Stage-98, Stage-99, Stage-100
  Stage-127 has a backup stage: Stage-54
  Stage-99 depends on stages: Stage-127
  Stage-128 has a backup stage: Stage-54
  Stage-100 depends on stages: Stage-128
  Stage-54
  Stage-131 has a backup stage: Stage-40
  Stage-116 depends on stages: Stage-131
  Stage-40
  Stage-72 is a root stage
  Stage-73 depends on stages: Stage-72
  Stage-0 depends on stages: Stage-19

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_customer_sk is not null and ss_store_sk is not null and ss_cdemo_sk is not null and ss_promo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_promo_sk (type: int), ss_ticket_number (type: bigint), ss_wholesale_cost (type: float), ss_list_price (type: float), ss_coupon_amt (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col7 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col7 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col8 (type: float), _col9 (type: float), _col10 (type: float), _col11 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col7 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-97
    Conditional Operator

  Stage: Stage-124
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-95
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-123
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:d1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_4:d2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_5:d3 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_6:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_7:cd1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_8:cd2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_1:promotion 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:hd1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:hd2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_4:ad1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_5:ad2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_6:ib1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_7:ib2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_4:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_5:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_store_name is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_7:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_8:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_1:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_promo_sk is not null (type: boolean)
              Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:hd1 
          TableScan
            alias: hd1
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:hd2 
          TableScan
            alias: hd2
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col16 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_4:ad1 
          TableScan
            alias: ad1
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_5:ad2 
          TableScan
            alias: ad2
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col17 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_6:ib1 
          TableScan
            alias: ib1
            Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col35 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_7:ib2 
          TableScan
            alias: ib2
            Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col37 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-82
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col19 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col18, _col23
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col23, _col25
                  Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col5 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col23, _col25, _col27, _col28
                    Statistics: Num rows: 48726459 Data size: 4390942306 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3, _col4, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
                      Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col15 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0, _col3, _col4, _col6, _col8, _col9, _col10, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
                        Statistics: Num rows: 58959017 Data size: 5313040420 Basic stats: COMPLETE Column stats: NONE
                        Filter Operator
                          predicate: (_col30 <> _col32) (type: boolean)
                          Statistics: Num rows: 58959017 Data size: 5313040420 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col0 (type: int), _col10 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col3 (type: int), _col4 (type: int), _col6 (type: int), _col8 (type: float), _col9 (type: float)
                            outputColumnNames: _col0, _col10, _col16, _col17, _col23, _col25, _col27, _col28, _col3, _col4, _col6, _col8, _col9
                            Statistics: Num rows: 58959017 Data size: 5313040420 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col6 (type: int)
                                1 _col0 (type: int)
                              outputColumnNames: _col0, _col3, _col4, _col8, _col9, _col10, _col16, _col17, _col23, _col25, _col27, _col28
                              Statistics: Num rows: 64854920 Data size: 5844344588 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col3 (type: int)
                                  1 _col0 (type: int)
                                outputColumnNames: _col0, _col4, _col8, _col9, _col10, _col16, _col17, _col23, _col25, _col27, _col28, _col35
                                Statistics: Num rows: 71340413 Data size: 6428779186 Basic stats: COMPLETE Column stats: NONE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col16 (type: int)
                                    1 _col0 (type: int)
                                  outputColumnNames: _col0, _col4, _col8, _col9, _col10, _col17, _col23, _col25, _col27, _col28, _col35, _col37
                                  Statistics: Num rows: 78474456 Data size: 7071657257 Basic stats: COMPLETE Column stats: NONE
                                  Map Join Operator
                                    condition map:
                                         Inner Join 0 to 1
                                    keys:
                                      0 _col4 (type: int)
                                      1 _col0 (type: int)
                                    outputColumnNames: _col0, _col8, _col9, _col10, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
                                    Statistics: Num rows: 86321903 Data size: 7778823151 Basic stats: COMPLETE Column stats: NONE
                                    Map Join Operator
                                      condition map:
                                           Inner Join 0 to 1
                                      keys:
                                        0 _col17 (type: int)
                                        1 _col0 (type: int)
                                      outputColumnNames: _col0, _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                                      Statistics: Num rows: 94954095 Data size: 8556705651 Basic stats: COMPLETE Column stats: NONE
                                      Map Join Operator
                                        condition map:
                                             Inner Join 0 to 1
                                        keys:
                                          0 _col35 (type: int)
                                          1 _col0 (type: int)
                                        outputColumnNames: _col0, _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                                        Statistics: Num rows: 104449506 Data size: 9412376420 Basic stats: COMPLETE Column stats: NONE
                                        Map Join Operator
                                          condition map:
                                               Inner Join 0 to 1
                                          keys:
                                            0 _col37 (type: int)
                                            1 _col0 (type: int)
                                          outputColumnNames: _col0, _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                                          Statistics: Num rows: 114894459 Data size: 10353614286 Basic stats: COMPLETE Column stats: NONE
                                          File Output Operator
                                            compressed: false
                                            table:
                                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-81
    Conditional Operator

  Stage: Stage-120
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-78
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
                Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              sort order: ++++++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string), KEY._col10 (type: string), KEY._col11 (type: string), KEY._col12 (type: string), KEY._col13 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 126383907 Data size: 11388975915 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col13 (type: string), _col1 (type: int), _col11 (type: string), _col12 (type: string), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col0 (type: string), _col2 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
            outputColumnNames: _col0, _col1, _col10, _col11, _col13, _col14, _col15, _col16, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
            Statistics: Num rows: 126383907 Data size: 11388975915 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Conditional Operator

  Stage: Stage-118
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)

  Stage: Stage-75
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col15, _col16, _col30, _col31, _col32, _col33
              Statistics: Num rows: 139022300 Data size: 12527873778 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col30 <= _col13) (type: boolean)
                Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col3 (type: string), _col30 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
                  outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col20 (type: bigint)
              sort order: +++
              Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col12 (type: bigint), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: string), VALUE._col5 (type: string), VALUE._col6 (type: string), VALUE._col7 (type: string), VALUE._col8 (type: string), 2000 (type: int), VALUE._col9 (type: bigint), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), 2001 (type: int), KEY.reducesinkkey2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20
          Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-119
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)

  Stage: Stage-76
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
                1 _col2 (type: string), _col1 (type: int), _col3 (type: string)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col15, _col16, _col30, _col31, _col32, _col33
              Statistics: Num rows: 139022300 Data size: 12527873778 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col30 <= _col13) (type: boolean)
                Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col3 (type: string), _col30 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
                  outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              sort order: +++
              Map-reduce partition columns: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              Statistics: Num rows: 126383907 Data size: 11388975915 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              sort order: +++
              Map-reduce partition columns: _col2 (type: string), _col1 (type: int), _col3 (type: string)
              Statistics: Num rows: 126383907 Data size: 11388975915 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col2 (type: string), _col1 (type: int), _col3 (type: string)
            1 _col2 (type: string), _col1 (type: int), _col3 (type: string)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col15, _col16, _col30, _col31, _col32, _col33
          Statistics: Num rows: 139022300 Data size: 12527873778 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col30 <= _col13) (type: boolean)
            Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col2 (type: string), _col11 (type: string), _col13 (type: bigint), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col3 (type: string), _col30 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string)
              outputColumnNames: _col0, _col1, _col10, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col2, _col20, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 46340766 Data size: 4175957865 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-121
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)

  Stage: Stage-79
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 0 to 2
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
                  Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
                    outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
                    Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
                      keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                      Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-122
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_8:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-80
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
                Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 114894459 Data size: 10353614286 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: float), _col9 (type: float), _col10 (type: float), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 2640231 Data size: 357596880 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
          Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
            outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
            Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
              keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-125
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-96
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col8 (type: float), _col9 (type: float), _col10 (type: float), _col11 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-36
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_order_number is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_ext_list_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_item_sk is not null and cr_order_number is not null) (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_refunded_cash (type: float), cr_reversed_charge (type: float), cr_store_credit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float), _col4 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col5, _col6, _col7
          Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col2 (type: float), ((_col5 + _col6) + _col7) (type: float)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7920693 Data size: 1072790641 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > (2.0 * _col2)) (type: boolean)
            Statistics: Num rows: 2640231 Data size: 357596880 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 2640231 Data size: 357596880 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-39
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null and ss_customer_sk is not null and ss_store_sk is not null and ss_cdemo_sk is not null and ss_promo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_cdemo_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_promo_sk (type: int), ss_ticket_number (type: bigint), ss_wholesale_cost (type: float), ss_list_price (type: float), ss_coupon_amt (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col7 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col7 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col8 (type: float), _col9 (type: float), _col10 (type: float), _col11 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col7 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-117
    Conditional Operator

  Stage: Stage-130
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-115
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-129
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:d1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:d2 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:d3 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_7:store 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_8:cd1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_9:cd2 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_2:promotion 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_3:hd1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_4:hd2 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_5:ad1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_6:ad2 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_7:ib1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_8:ib2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_4:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_5:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col19 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_6:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_7:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_store_name is not null and s_zip is not null) (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_zip (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_8:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_1:$hdt$_9:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_2:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_promo_sk is not null (type: boolean)
              Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_3:hd1 
          TableScan
            alias: hd1
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_4:hd2 
          TableScan
            alias: hd2
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col16 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_5:ad1 
          TableScan
            alias: ad1
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_6:ad2 
          TableScan
            alias: ad2
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_street_number (type: string), ca_street_name (type: string), ca_city (type: string), ca_zip (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col17 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_7:ib1 
          TableScan
            alias: ib1
            Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col35 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_8:ib2 
          TableScan
            alias: ib2
            Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ib_income_band_sk is not null (type: boolean)
              Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col37 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-102
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col11 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col18, _col19
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col19 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col18, _col23
                Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col18 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col23, _col25
                  Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col5 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col23, _col25, _col27, _col28
                    Statistics: Num rows: 48726459 Data size: 4390942306 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3, _col4, _col6, _col8, _col9, _col10, _col15, _col16, _col17, _col23, _col25, _col27, _col28, _col30
                      Statistics: Num rows: 53599106 Data size: 4830036641 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col15 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0, _col3, _col4, _col6, _col8, _col9, _col10, _col16, _col17, _col23, _col25, _col27, _col28, _col30, _col32
                        Statistics: Num rows: 58959017 Data size: 5313040420 Basic stats: COMPLETE Column stats: NONE
                        Filter Operator
                          predicate: (_col30 <> _col32) (type: boolean)
                          Statistics: Num rows: 58959017 Data size: 5313040420 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col0 (type: int), _col10 (type: float), _col16 (type: int), _col17 (type: int), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col3 (type: int), _col4 (type: int), _col6 (type: int), _col8 (type: float), _col9 (type: float)
                            outputColumnNames: _col0, _col10, _col16, _col17, _col23, _col25, _col27, _col28, _col3, _col4, _col6, _col8, _col9
                            Statistics: Num rows: 58959017 Data size: 5313040420 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col6 (type: int)
                                1 _col0 (type: int)
                              outputColumnNames: _col0, _col3, _col4, _col8, _col9, _col10, _col16, _col17, _col23, _col25, _col27, _col28
                              Statistics: Num rows: 64854920 Data size: 5844344588 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col3 (type: int)
                                  1 _col0 (type: int)
                                outputColumnNames: _col0, _col4, _col8, _col9, _col10, _col16, _col17, _col23, _col25, _col27, _col28, _col35
                                Statistics: Num rows: 71340413 Data size: 6428779186 Basic stats: COMPLETE Column stats: NONE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col16 (type: int)
                                    1 _col0 (type: int)
                                  outputColumnNames: _col0, _col4, _col8, _col9, _col10, _col17, _col23, _col25, _col27, _col28, _col35, _col37
                                  Statistics: Num rows: 78474456 Data size: 7071657257 Basic stats: COMPLETE Column stats: NONE
                                  Map Join Operator
                                    condition map:
                                         Inner Join 0 to 1
                                    keys:
                                      0 _col4 (type: int)
                                      1 _col0 (type: int)
                                    outputColumnNames: _col0, _col8, _col9, _col10, _col17, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42
                                    Statistics: Num rows: 86321903 Data size: 7778823151 Basic stats: COMPLETE Column stats: NONE
                                    Map Join Operator
                                      condition map:
                                           Inner Join 0 to 1
                                      keys:
                                        0 _col17 (type: int)
                                        1 _col0 (type: int)
                                      outputColumnNames: _col0, _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col35, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                                      Statistics: Num rows: 94954095 Data size: 8556705651 Basic stats: COMPLETE Column stats: NONE
                                      Map Join Operator
                                        condition map:
                                             Inner Join 0 to 1
                                        keys:
                                          0 _col35 (type: int)
                                          1 _col0 (type: int)
                                        outputColumnNames: _col0, _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col37, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                                        Statistics: Num rows: 104449506 Data size: 9412376420 Basic stats: COMPLETE Column stats: NONE
                                        Map Join Operator
                                          condition map:
                                               Inner Join 0 to 1
                                          keys:
                                            0 _col37 (type: int)
                                            1 _col0 (type: int)
                                          outputColumnNames: _col0, _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47
                                          Statistics: Num rows: 114894459 Data size: 10353614286 Basic stats: COMPLETE Column stats: NONE
                                          File Output Operator
                                            compressed: false
                                            table:
                                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-101
    Conditional Operator

  Stage: Stage-126
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-98
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
                Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-55
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              sort order: ++++++++++++++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: int), _col4 (type: int), _col5 (type: string), _col6 (type: string), _col7 (type: string), _col8 (type: string), _col9 (type: string), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string)
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: string), KEY._col6 (type: string), KEY._col7 (type: string), KEY._col8 (type: string), KEY._col9 (type: string), KEY._col10 (type: string), KEY._col11 (type: string), KEY._col12 (type: string), KEY._col13 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
          Statistics: Num rows: 126383907 Data size: 11388975915 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: int), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col0 (type: string), _col2 (type: string)
            outputColumnNames: _col1, _col13, _col14, _col15, _col16, _col2, _col3
            Statistics: Num rows: 126383907 Data size: 11388975915 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-127
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:$hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)

  Stage: Stage-99
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 0 to 2
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
                  Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
                    outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
                    Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
                      keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                      Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-128
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_1:$hdt$_1:$hdt$_9:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-100
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
                outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
                Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
                  keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 114894459 Data size: 10353614286 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col8 (type: float), _col9 (type: float), _col10 (type: float), _col23 (type: int), _col25 (type: int), _col27 (type: string), _col28 (type: string), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string)
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_color) IN ('maroon', 'burnished', 'dim', 'steel', 'navajo', 'chocolate') and i_current_price BETWEEN 35 AND 45 and i_current_price BETWEEN 36 AND 50 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_product_name (type: string)
                outputColumnNames: _col0, _col3
                Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 629 Data size: 901311 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 2640231 Data size: 357596880 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col8, _col9, _col10, _col23, _col25, _col27, _col28, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col50, _col53
          Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string), _col8 (type: float), _col9 (type: float), _col10 (type: float)
            outputColumnNames: _col27, _col50, _col28, _col23, _col25, _col39, _col40, _col41, _col42, _col44, _col45, _col46, _col47, _col53, _col8, _col9, _col10
            Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(), sum(_col8), sum(_col9), sum(_col10)
              keys: _col27 (type: string), _col50 (type: int), _col28 (type: string), _col23 (type: int), _col25 (type: int), _col39 (type: string), _col40 (type: string), _col41 (type: string), _col42 (type: string), _col44 (type: string), _col45 (type: string), _col46 (type: string), _col47 (type: string), _col53 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
              Statistics: Num rows: 252767815 Data size: 22777951922 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-131
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-116
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col8 (type: float), _col9 (type: float), _col10 (type: float), _col11 (type: int)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_first_sales_date_sk is not null and c_first_shipto_date_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_shipto_date_sk (type: int), c_first_sales_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col15, _col16, _col17, _col18, _col19
          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-72
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_order_number is not null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_ext_list_price (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 14401261 Data size: 1950528520 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_item_sk is not null and cr_order_number is not null) (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_refunded_cash (type: float), cr_reversed_charge (type: float), cr_store_credit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float), _col4 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col5, _col6, _col7
          Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col2 (type: float), ((_col5 + _col6) + _col7) (type: float)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1), sum(_col2)
              keys: _col0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-73
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 15841387 Data size: 2145581418 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7920693 Data size: 1072790641 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > (2.0 * _col2)) (type: boolean)
            Statistics: Num rows: 2640231 Data size: 357596880 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 2640231 Data size: 357596880 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query65.sql
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-6 depends on stages: Stage-20
  Stage-19 depends on stages: Stage-6
  Stage-14 depends on stages: Stage-19
  Stage-13 depends on stages: Stage-9, Stage-14 , consists of Stage-17, Stage-18, Stage-2
  Stage-17 has a backup stage: Stage-2
  Stage-11 depends on stages: Stage-17
  Stage-3 depends on stages: Stage-2, Stage-11, Stage-12
  Stage-18 has a backup stage: Stage-2
  Stage-12 depends on stages: Stage-18
  Stage-2
  Stage-21 is a root stage
  Stage-9 depends on stages: Stage-21
  Stage-0 depends on stages: Stage-3

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1212 AND 1223 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_store_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col0 (type: int), _col2 (type: float)
                    outputColumnNames: _col1, _col0, _col2
                    Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col1 (type: int), _col0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int), _col1 (type: int)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col2 (type: double)
            outputColumnNames: _col1, _col2
            Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col2)
              keys: _col1 (type: int)
              mode: complete
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 7563824 Data size: 681607353 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: int), _col1 (type: double)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7563824 Data size: 681607353 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:store 
          Fetch Operator
            limit: -1
        $hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 
                    1 
                    2 
        $hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string), i_current_price (type: float), i_wholesale_cost (type: float), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 
                    1 
                    2 

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 
                1 
                2 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
              Statistics: Num rows: 78694024896000 Data size: 270860385448108512 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col11
              Statistics: Num rows: 86563429261811 Data size: 297946430450734208 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col11 <= (0.1 * _col8)) (type: boolean)
                Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col3 (type: string), _col11 (type: double), _col4 (type: float), _col5 (type: float), _col6 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: float), _col4 (type: float), _col5 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: float), VALUE._col2 (type: float), VALUE._col3 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 344100 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 344100 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col11
              Statistics: Num rows: 86563429261811 Data size: 297946430450734208 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col11 <= (0.1 * _col8)) (type: boolean)
                Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: string), _col3 (type: string), _col11 (type: double), _col4 (type: float), _col5 (type: float), _col6 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col2 (type: int), _col7 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col2 (type: int), _col7 (type: int)
              Statistics: Num rows: 78694024896000 Data size: 270860385448108512 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col3 (type: string), _col4 (type: float), _col5 (type: float), _col6 (type: string), _col8 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col0 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col0 (type: int)
              Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col2 (type: int), _col7 (type: int)
            1 _col0 (type: int), _col1 (type: int), _col0 (type: int)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col11
          Statistics: Num rows: 86563429261811 Data size: 297946430450734208 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col11 <= (0.1 * _col8)) (type: boolean)
            Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col3 (type: string), _col11 (type: double), _col4 (type: float), _col5 (type: float), _col6 (type: string)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 28854476420603 Data size: 99315476816909120 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1212 AND 1223 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: int), _col0 (type: int), _col2 (type: float)
                    outputColumnNames: _col1, _col0, _col2
                    Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col2)
                      keys: _col1 (type: int), _col0 (type: int)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: int), _col1 (type: int)
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
                        Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col2 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query66.sql
STAGE DEPENDENCIES:
  Stage-29 is a root stage
  Stage-5 depends on stages: Stage-29
  Stage-6 depends on stages: Stage-5, Stage-16
  Stage-7 depends on stages: Stage-6
  Stage-30 is a root stage
  Stage-16 depends on stages: Stage-30
  Stage-0 depends on stages: Stage-7

STAGE PLANS:
  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:ship_mode 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string), w_warehouse_sq_ft (type: int), w_city (type: string), w_county (type: string), w_state (type: string), w_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_time BETWEEN 49530 AND 78330 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:ship_mode 
          TableScan
            alias: ship_mode
            Statistics: Num rows: 20 Data size: 9378 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((sm_carrier) IN ('DIAMOND', 'AIRBORNE') and sm_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 10 Data size: 4689 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sm_ship_mode_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 10 Data size: 4689 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_warehouse_sk is not null and ws_sold_time_sk is not null and ws_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: int), ws_ship_mode_sk (type: int), ws_warehouse_sk (type: int), ws_quantity (type: int), ws_sales_price (type: float), ws_net_paid_inc_tax (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col6 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col1, _col3, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                      Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col3, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                        Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col8 (type: string), _col9 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string), CASE WHEN ((_col16 = 1)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 1)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                          Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29)
                            keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                            Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                              sort order: ++++++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                              Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                              value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
          Statistics: Num rows: 5267668 Data size: 716331122 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), (_col6 / UDFToDouble(_col1)) (type: double), (_col7 / UDFToDouble(_col1)) (type: double), (_col8 / UDFToDouble(_col1)) (type: double), (_col9 / UDFToDouble(_col1)) (type: double), (_col10 / UDFToDouble(_col1)) (type: double), (_col11 / UDFToDouble(_col1)) (type: double), (_col12 / UDFToDouble(_col1)) (type: double), (_col13 / UDFToDouble(_col1)) (type: double), (_col14 / UDFToDouble(_col1)) (type: double), (_col15 / UDFToDouble(_col1)) (type: double), (_col16 / UDFToDouble(_col1)) (type: double), (_col17 / UDFToDouble(_col1)) (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29), sum(_col30), sum(_col31), sum(_col32), sum(_col33), sum(_col34), sum(_col35), sum(_col36), sum(_col37), sum(_col38), sum(_col39), sum(_col40), sum(_col41)
                  keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                  Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double)
          TableScan
            Union
              Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), (_col6 / UDFToDouble(_col1)) (type: double), (_col7 / UDFToDouble(_col1)) (type: double), (_col8 / UDFToDouble(_col1)) (type: double), (_col9 / UDFToDouble(_col1)) (type: double), (_col10 / UDFToDouble(_col1)) (type: double), (_col11 / UDFToDouble(_col1)) (type: double), (_col12 / UDFToDouble(_col1)) (type: double), (_col13 / UDFToDouble(_col1)) (type: double), (_col14 / UDFToDouble(_col1)) (type: double), (_col15 / UDFToDouble(_col1)) (type: double), (_col16 / UDFToDouble(_col1)) (type: double), (_col17 / UDFToDouble(_col1)) (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29), sum(_col30), sum(_col31), sum(_col32), sum(_col33), sum(_col34), sum(_col35), sum(_col36), sum(_col37), sum(_col38), sum(_col39), sum(_col40), sum(_col41)
                  keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                  Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                    Statistics: Num rows: 15757423 Data size: 2140000312 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23), sum(VALUE._col24), sum(VALUE._col25), sum(VALUE._col26), sum(VALUE._col27), sum(VALUE._col28), sum(VALUE._col29), sum(VALUE._col30), sum(VALUE._col31), sum(VALUE._col32), sum(VALUE._col33), sum(VALUE._col34), sum(VALUE._col35)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
          Statistics: Num rows: 7878711 Data size: 1070000088 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: int), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col2 (type: string), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col3 (type: string), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col4 (type: string), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double), _col5 (type: string), _col6 (type: double), _col7 (type: double)
            outputColumnNames: _col0, _col1, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col2, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col3, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col4, _col40, _col41, _col42, _col43, _col5, _col8, _col9
            Statistics: Num rows: 7878711 Data size: 1070000088 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 7878711 Data size: 1070000088 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: double), _col33 (type: double), _col34 (type: double), _col35 (type: double), _col36 (type: double), _col37 (type: double), _col38 (type: double), _col39 (type: double), _col40 (type: double), _col41 (type: double), _col42 (type: double), _col43 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: int), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: string), 'DIAMOND,AIRBORNE' (type: string), 2002 (type: int), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: double), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double), VALUE._col12 (type: double), VALUE._col13 (type: double), VALUE._col14 (type: double), VALUE._col15 (type: double), VALUE._col16 (type: double), VALUE._col17 (type: double), VALUE._col18 (type: double), VALUE._col19 (type: double), VALUE._col20 (type: double), VALUE._col21 (type: double), VALUE._col22 (type: double), VALUE._col23 (type: double), VALUE._col24 (type: double), VALUE._col25 (type: double), VALUE._col26 (type: double), VALUE._col27 (type: double), VALUE._col28 (type: double), VALUE._col29 (type: double), VALUE._col30 (type: double), VALUE._col31 (type: double), VALUE._col32 (type: double), VALUE._col33 (type: double), VALUE._col34 (type: double), VALUE._col35 (type: double), VALUE._col36 (type: double), VALUE._col37 (type: double), VALUE._col38 (type: double), VALUE._col39 (type: double), VALUE._col40 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41, _col42, _col43
          Statistics: Num rows: 7878711 Data size: 1070000088 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 13500 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:ship_mode 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string), w_warehouse_sq_ft (type: int), w_city (type: string), w_county (type: string), w_state (type: string), w_country (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_time BETWEEN 49530 AND 78330 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:ship_mode 
          TableScan
            alias: ship_mode
            Statistics: Num rows: 20 Data size: 9378 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((sm_carrier) IN ('DIAMOND', 'AIRBORNE') and sm_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 10 Data size: 4689 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sm_ship_mode_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 10 Data size: 4689 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is not null and cs_sold_time_sk is not null and cs_ship_mode_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_time_sk (type: int), cs_ship_mode_sk (type: int), cs_warehouse_sk (type: int), cs_quantity (type: int), cs_ext_sales_price (type: float), cs_net_paid_inc_ship_tax (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col12, _col13
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col6 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col1, _col3, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                      Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col3, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col16
                        Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col8 (type: string), _col9 (type: int), _col10 (type: string), _col11 (type: string), _col12 (type: string), _col13 (type: string), CASE WHEN ((_col16 = 1)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col4 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 1)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 2)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 3)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 4)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 5)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 6)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 7)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 8)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 9)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 10)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 11)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float), CASE WHEN ((_col16 = 12)) THEN ((_col5 * UDFToFloat(_col3))) ELSE (0) END (type: float)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                          Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29)
                            keys: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                            Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                              sort order: ++++++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string)
                              Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                              value expressions: _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: double), _col28 (type: double), _col29 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23)
          keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
          Statistics: Num rows: 10489755 Data size: 1423669190 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query67.sql
STAGE DEPENDENCIES:
  Stage-13 is a root stage
  Stage-4 depends on stages: Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_moy (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col2, _col3, _col4
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string), i_product_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_store_sk (type: int), ss_quantity (type: int), ss_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col2, _col3, _col7, _col8, _col9, _col11
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col11, _col13, _col14, _col15, _col16
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col15 (type: string), _col14 (type: string), _col13 (type: string), _col16 (type: string), _col7 (type: int), _col9 (type: int), _col8 (type: int), _col11 (type: string), COALESCE((_col3 * UDFToFloat(_col2)),0) (type: float)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                        Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col8)
                          keys: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), 0 (type: int)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                          Statistics: Num rows: 329480181 Data size: 29690817588 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: int)
                            sort order: +++++++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: int)
                            Statistics: Num rows: 329480181 Data size: 29690817588 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col9 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: int), KEY._col5 (type: int), KEY._col6 (type: int), KEY._col7 (type: string), KEY._col8 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9
          Statistics: Num rows: 164740090 Data size: 14845408748 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col9 (type: double), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string)
            outputColumnNames: _col0, _col1, _col16, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 164740090 Data size: 14845408748 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col16 (type: double)
              sort order: +-
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 164740090 Data size: 14845408748 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col16
          Statistics: Num rows: 164740090 Data size: 14845408748 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: int, _col5: int, _col6: int, _col7: string, _col16: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col16 DESC NULLS LAST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: _col16
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 164740090 Data size: 14845408748 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (rank_window_0 <= 100) (type: boolean)
              Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col16 (type: double), rank_window_0 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: string), _col8 (type: double), _col9 (type: int)
              sort order: ++++++++++
              Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey6 (type: int), KEY.reducesinkkey7 (type: string), KEY.reducesinkkey8 (type: double), KEY.reducesinkkey9 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query68.sql
STAGE DEPENDENCIES:
  Stage-26 is a root stage
  Stage-5 depends on stages: Stage-26
  Stage-18 depends on stages: Stage-5 , consists of Stage-24, Stage-25, Stage-6
  Stage-24 has a backup stage: Stage-6
  Stage-16 depends on stages: Stage-24
  Stage-23 depends on stages: Stage-6, Stage-16, Stage-17
  Stage-8 depends on stages: Stage-23
  Stage-25 has a backup stage: Stage-6
  Stage-17 depends on stages: Stage-25
  Stage-6
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and d_dom BETWEEN 1 AND 2 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_city) IN ('Rosedale', 'Bethlehem') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 4) or (hd_vehicle_count = 2)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_ext_sales_price (type: float), ss_ext_list_price (type: float), ss_ext_tax (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col18
                        Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col0 (type: int), _col2 (type: int), _col4 (type: bigint), _col18 (type: string), _col5 (type: float), _col6 (type: float), _col7 (type: float)
                          outputColumnNames: _col0, _col2, _col4, _col18, _col5, _col6, _col7
                          Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: sum(_col5), sum(_col6), sum(_col7)
                            keys: _col0 (type: int), _col2 (type: int), _col4 (type: bigint), _col18 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                            Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                              sort order: ++++
                              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                              value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: bigint), _col0 (type: int), _col3 (type: string), _col4 (type: double), _col5 (type: double), _col6 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col8, _col9
              Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:current_addr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:current_addr 
          TableScan
            alias: current_addr
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ca_address_sk is not null (type: boolean)
              Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_city (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col8, _col9, _col11
              Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col11 <> _col2) (type: boolean)
                Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col9 (type: string), _col8 (type: string), _col11 (type: string), _col2 (type: string), _col0 (type: bigint), _col3 (type: double), _col5 (type: double), _col4 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col4 (type: bigint)
                    sort order: ++
                    Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col5 (type: double), _col6 (type: double), _col7 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey1 (type: bigint), VALUE._col3 (type: double), VALUE._col4 (type: double), VALUE._col5 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 24363229 Data size: 2195471152 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col8, _col9
                  Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: string), _col3 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col8, _col9
          Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query70.sql
STAGE DEPENDENCIES:
  Stage-22 is a root stage
  Stage-17 depends on stages: Stage-22
  Stage-16 depends on stages: Stage-12, Stage-17 , consists of Stage-21, Stage-3
  Stage-21 has a backup stage: Stage-3
  Stage-15 depends on stages: Stage-21
  Stage-4 depends on stages: Stage-3, Stage-15
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5
  Stage-3
  Stage-23 is a root stage
  Stage-11 depends on stages: Stage-23
  Stage-12 depends on stages: Stage-11
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:s 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:s 
          TableScan
            alias: s
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_state is not null) (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_county (type: string), s_state (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_store_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_store_sk (type: int), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col6, _col7
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col7 (type: string)
                1 _col0 (type: string)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Semi Join 0 to 1
              keys:
                0 _col7 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col6, _col7
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col1 (type: float)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 109826727 Data size: 9896939196 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 109826727 Data size: 9896939196 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col3 (type: double), _col2 (type: int)
            outputColumnNames: _col0, _col1, _col4, _col5
            Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: int), CASE WHEN ((_col5 = 2)) THEN (_col0) ELSE (null) END (type: string), _col4 (type: double)
              sort order: +++
              Map-reduce partition columns: _col5 (type: int), CASE WHEN ((_col5 = 2)) THEN (_col0) ELSE (null) END (type: string)
              Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey0 (type: int)
          outputColumnNames: _col0, _col1, _col4, _col5
          Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col4: double, _col5: int
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col4 ASC NULLS FIRST
                  partition by: _col5, CASE WHEN ((_col5 = 2)) THEN (_col0) ELSE (null) END
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: _col4
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col4 (type: double), _col0 (type: string), _col1 (type: string), _col5 (type: int), rank_window_0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int), CASE WHEN ((_col3 = 0)) THEN (_col1) ELSE (null) END (type: string), _col4 (type: int)
              sort order: -++
              Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: double), _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: double), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: int), KEY.reducesinkkey2 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 54913363 Data size: 4948469552 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col7 (type: string)
              sort order: +
              Map-reduce partition columns: _col7 (type: string)
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: float), _col6 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col7 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col6, _col7
          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col1 (type: float)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col2)
              keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 109826727 Data size: 9896939196 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_4:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_5:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_store_sk is not null and s_state is not null) (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_3:$hdt$_5:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_store_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_store_sk (type: int), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col4 (type: string), _col1 (type: float)
                      outputColumnNames: _col4, _col1
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col4 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double)
              sort order: +-
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col1 DESC NULLS LAST
                  partition by: _col0
                  raw input shape:
                  window functions:
                      window function definition
                        alias: rank_window_0
                        arguments: _col1
                        name: rank
                        window function: GenericUDAFRankEvaluator
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
                        isPivotResult: true
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (rank_window_0 <= 5) (type: boolean)
              Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string)
                outputColumnNames: _col0
                Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: string)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 5546804 Data size: 499845372 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query71.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage
  Stage-14 depends on stages: Stage-19
  Stage-18 depends on stages: Stage-14
  Stage-3 depends on stages: Stage-18
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manager_id = 1) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_brand (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_moy = 12) and (d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: int), ws_item_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: float), _col1 (type: int), _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                    Union
                      Statistics: Num rows: 53932868 Data size: 5942057229 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: int)
                          1 _col1 (type: int)
                        outputColumnNames: _col1, _col2, _col4, _col6
                        Statistics: Num rows: 59326156 Data size: 6536263093 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_sold_time_sk (type: int), cs_item_sk (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: float), _col1 (type: int), _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                    Union
                      Statistics: Num rows: 53932868 Data size: 5942057229 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: int)
                          1 _col1 (type: int)
                        outputColumnNames: _col1, _col2, _col4, _col6
                        Statistics: Num rows: 59326156 Data size: 6536263093 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_sold_time_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: float), _col1 (type: int), _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                    Union
                      Statistics: Num rows: 53932868 Data size: 5942057229 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: int)
                          1 _col1 (type: int)
                        outputColumnNames: _col1, _col2, _col4, _col6
                        Statistics: Num rows: 59326156 Data size: 6536263093 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:time_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((t_meal_time = 'breakfast') or (t_meal_time = 'dinner')) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int), t_hour (type: int), t_minute (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col4, _col8, _col9
              Statistics: Num rows: 65258773 Data size: 7189889558 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), _col2 (type: string), _col8 (type: int), _col9 (type: int), _col4 (type: float)
                outputColumnNames: _col1, _col2, _col8, _col9, _col4
                Statistics: Num rows: 65258773 Data size: 7189889558 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4)
                  keys: _col1 (type: int), _col2 (type: string), _col8 (type: int), _col9 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 65258773 Data size: 7189889558 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: string), _col2 (type: int), _col3 (type: int)
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: string), _col2 (type: int), _col3 (type: int)
                    Statistics: Num rows: 65258773 Data size: 7189889558 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col4 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: string), KEY._col2 (type: int), KEY._col3 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 32629386 Data size: 3594944723 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: double), _col0 (type: int)
              sort order: -+
              Statistics: Num rows: 32629386 Data size: 3594944723 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: string), VALUE._col1 (type: int), VALUE._col2 (type: int), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 32629386 Data size: 3594944723 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 32629386 Data size: 3594944723 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query72.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-34 depends on stages: Stage-1
  Stage-25 depends on stages: Stage-34
  Stage-24 depends on stages: Stage-25 , consists of Stage-33, Stage-10
  Stage-33 has a backup stage: Stage-10
  Stage-23 depends on stages: Stage-33
  Stage-11 depends on stages: Stage-10, Stage-23
  Stage-12 depends on stages: Stage-11
  Stage-10
  Stage-0 depends on stages: Stage-12

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_item_sk is not null and cs_bill_cdemo_sk is not null and cs_bill_hdemo_sk is not null and cs_ship_date_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_ship_date_sk (type: int), cs_bill_cdemo_sk (type: int), cs_bill_hdemo_sk (type: int), cs_item_sk (type: int), cs_promo_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col3 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col3 (type: int)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col4 (type: int), _col5 (type: bigint), _col6 (type: int), _col7 (type: int)
          TableScan
            alias: inventory
            Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null) (type: boolean)
              Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_item_sk (type: int), inv_warehouse_sk (type: int), inv_quantity_on_hand (type: int), inv_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col3 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11
          Statistics: Num rows: 146421003 Data size: 1727775088 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col10 < _col6) (type: boolean)
            Statistics: Num rows: 48807001 Data size: 575925029 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: int), _col11 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: bigint), _col7 (type: int), _col9 (type: int)
              outputColumnNames: _col0, _col1, _col11, _col2, _col3, _col4, _col5, _col7, _col9
              Statistics: Num rows: 48807001 Data size: 575925029 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:warehouse 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_4:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_5:d1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_6:d2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_7:d3 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:warehouse 
          TableScan
            alias: warehouse
            Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: int), w_warehouse_name (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 10 Data size: 10282 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col9 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_desc (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 960400 Data size: 358805440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 960400 Data size: 358805440 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_4:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_buy_potential = '1001-5000') and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_5:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_6:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col22 (type: int), _col11 (type: int)
                    1 _col1 (type: int), _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_7:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: p_promo_sk (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col4 (type: int)
                  1 _col0 (type: int)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col9 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col7, _col11, _col13
              Statistics: Num rows: 53687702 Data size: 633517545 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col3 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col7, _col11, _col13, _col15
                Statistics: Num rows: 59056473 Data size: 696869314 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col7, _col11, _col13, _col15
                  Statistics: Num rows: 64962121 Data size: 766556262 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col3, _col4, _col5, _col7, _col11, _col13, _col15
                    Statistics: Num rows: 71458334 Data size: 843211906 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col7 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3, _col4, _col5, _col11, _col13, _col15, _col21, _col22
                      Statistics: Num rows: 78604169 Data size: 927533116 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col22 (type: int), _col11 (type: int)
                          1 _col1 (type: int), _col0 (type: int)
                        outputColumnNames: _col0, _col3, _col4, _col5, _col13, _col15, _col21, _col22
                        Statistics: Num rows: 86464587 Data size: 1020286449 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: int)
                            1 _col0 (type: int)
                          outputColumnNames: _col3, _col4, _col5, _col13, _col15, _col21, _col22, _col27
                          Statistics: Num rows: 95111047 Data size: 1122315118 Basic stats: COMPLETE Column stats: NONE
                          Filter Operator
                            predicate: (UDFToDouble(_col27) > (UDFToDouble(_col21) + 5.0)) (type: boolean)
                            Statistics: Num rows: 31703682 Data size: 374105035 Basic stats: COMPLETE Column stats: NONE
                            Select Operator
                              expressions: _col13 (type: string), _col15 (type: string), _col22 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: bigint)
                              outputColumnNames: _col13, _col15, _col22, _col3, _col4, _col5
                              Statistics: Num rows: 31703682 Data size: 374105035 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Left Outer Join0 to 1
                                keys:
                                  0 _col4 (type: int)
                                  1 _col0 (type: int)
                                outputColumnNames: _col3, _col5, _col13, _col15, _col22, _col28
                                Statistics: Num rows: 34874050 Data size: 411515547 Basic stats: COMPLETE Column stats: NONE
                                File Output Operator
                                  compressed: false
                                  table:
                                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Conditional Operator

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:catalog_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:catalog_returns 
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int), _col5 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col3 (type: int), _col5 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col13, _col15, _col22, _col28
              Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col15 (type: string), _col13 (type: string), _col22 (type: int), CASE WHEN (_col28 is null) THEN (1) ELSE (0) END (type: int), CASE WHEN (_col28 is not null) THEN (1) ELSE (0) END (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(_col3), count(_col4), count()
                  keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 19180727 Data size: 226333549 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint), _col0 (type: string), _col1 (type: string), _col2 (type: int)
              sort order: -+++
              Statistics: Num rows: 19180727 Data size: 226333549 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 19180727 Data size: 226333549 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 1100 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 1100 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: int), _col5 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col3 (type: int), _col5 (type: bigint)
              Statistics: Num rows: 34874050 Data size: 411515547 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col13 (type: string), _col15 (type: string), _col22 (type: int), _col28 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col3 (type: int), _col5 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col13, _col15, _col22, _col28
          Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col15 (type: string), _col13 (type: string), _col22 (type: int), CASE WHEN (_col28 is null) THEN (1) ELSE (0) END (type: int), CASE WHEN (_col28 is not null) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(_col3), count(_col4), count()
              keys: _col0 (type: string), _col1 (type: string), _col2 (type: int)
              mode: hash
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 38361455 Data size: 452667111 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query73.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage
  Stage-4 depends on stages: Stage-19
  Stage-13 depends on stages: Stage-4 , consists of Stage-17, Stage-18, Stage-5
  Stage-17 has a backup stage: Stage-5
  Stage-11 depends on stages: Stage-17
  Stage-6 depends on stages: Stage-5, Stage-11, Stage-12
  Stage-18 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-18
  Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and d_dom BETWEEN 1 AND 2 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 4058 Data size: 4540902 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_county) IN ('Kittitas County', 'Adams County', 'Richland County', 'Furnas County') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_buy_potential = '1001-5000') or (hd_buy_potential = '5001-10000')) and (hd_vehicle_count > 0) and CASE WHEN ((hd_vehicle_count > 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) > 1.0)) ELSE (null) END and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 1200 Data size: 128400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1200 Data size: 128400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col3
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col3
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        keys: _col0 (type: int), _col3 (type: bigint)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: bigint)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col1 (type: bigint), _col0 (type: int), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: _col2 BETWEEN 1 AND 5 (type: boolean)
              Statistics: Num rows: 2033828 Data size: 183276626 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
              Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col5 (type: bigint)
              sort order: -
              Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 2033828 Data size: 183276626 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: bigint)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_salutation (type: string), c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
          Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: string), _col5 (type: string), _col4 (type: string), _col7 (type: string), _col0 (type: bigint), _col2 (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 2237210 Data size: 201604292 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query75.sql
STAGE DEPENDENCIES:
  Stage-71 is a root stage
  Stage-46 depends on stages: Stage-71
  Stage-45 depends on stages: Stage-46 , consists of Stage-70, Stage-3
  Stage-70 has a backup stage: Stage-3
  Stage-44 depends on stages: Stage-70
  Stage-4 depends on stages: Stage-3, Stage-12, Stage-18, Stage-44, Stage-48, Stage-52
  Stage-43 depends on stages: Stage-4, Stage-25 , consists of Stage-68, Stage-69, Stage-5
  Stage-68 has a backup stage: Stage-5
  Stage-41 depends on stages: Stage-68
  Stage-6 depends on stages: Stage-5, Stage-41, Stage-42
  Stage-69 has a backup stage: Stage-5
  Stage-42 depends on stages: Stage-69
  Stage-5
  Stage-3
  Stage-73 is a root stage
  Stage-50 depends on stages: Stage-73
  Stage-49 depends on stages: Stage-50 , consists of Stage-72, Stage-12
  Stage-72 has a backup stage: Stage-12
  Stage-48 depends on stages: Stage-72
  Stage-12
  Stage-75 is a root stage
  Stage-54 depends on stages: Stage-75
  Stage-53 depends on stages: Stage-54 , consists of Stage-74, Stage-18
  Stage-74 has a backup stage: Stage-18
  Stage-52 depends on stages: Stage-74
  Stage-18
  Stage-77 is a root stage
  Stage-58 depends on stages: Stage-77
  Stage-57 depends on stages: Stage-58 , consists of Stage-76, Stage-24
  Stage-76 has a backup stage: Stage-24
  Stage-56 depends on stages: Stage-76
  Stage-25 depends on stages: Stage-24, Stage-31, Stage-37, Stage-56, Stage-60, Stage-64
  Stage-24
  Stage-79 is a root stage
  Stage-62 depends on stages: Stage-79
  Stage-61 depends on stages: Stage-62 , consists of Stage-78, Stage-31
  Stage-78 has a backup stage: Stage-31
  Stage-60 depends on stages: Stage-78
  Stage-31
  Stage-81 is a root stage
  Stage-66 depends on stages: Stage-81
  Stage-65 depends on stages: Stage-66 , consists of Stage-80, Stage-37
  Stage-80 has a backup stage: Stage-37
  Stage-64 depends on stages: Stage-80
  Stage-37
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-71
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_item_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col10
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-45
    Conditional Operator

  Stage: Stage-70
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:catalog_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_3:catalog_returns 
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int), _col1 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-44
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 32629385 Data size: 3594944722 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-43
    Conditional Operator

  Stage: Stage-68
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
              Statistics: Num rows: 35892324 Data size: 3954439279 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((CAST( _col4 AS decimal(17,2)) / CAST( _col10 AS decimal(17,2))) < 0.9) (type: boolean)
                Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col10 (type: bigint), _col4 (type: bigint), (_col4 - _col10) (type: bigint), (_col5 - _col11) (type: double)
                  outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col8 (type: bigint)
              sort order: +
              Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: bigint), _col7 (type: bigint), _col9 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: 2001 (type: int), 2002 (type: int), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: bigint), VALUE._col5 (type: bigint), KEY.reducesinkkey0 (type: bigint), VALUE._col6 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
          Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-69
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)

  Stage: Stage-42
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
              Statistics: Num rows: 35892324 Data size: 3954439279 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((CAST( _col4 AS decimal(17,2)) / CAST( _col10 AS decimal(17,2))) < 0.9) (type: boolean)
                Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col10 (type: bigint), _col4 (type: bigint), (_col4 - _col10) (type: bigint), (_col5 - _col11) (type: double)
                  outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                  Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              Statistics: Num rows: 32629385 Data size: 3594944722 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
              Statistics: Num rows: 32629385 Data size: 3594944722 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: bigint), _col5 (type: double)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
            1 _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
          Statistics: Num rows: 35892324 Data size: 3954439279 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((CAST( _col4 AS decimal(17,2)) / CAST( _col10 AS decimal(17,2))) < 0.9) (type: boolean)
            Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col10 (type: bigint), _col4 (type: bigint), (_col4 - _col10) (type: bigint), (_col5 - _col11) (type: double)
              outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
              Statistics: Num rows: 11964108 Data size: 1318146426 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-73
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-50
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col10
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-49
    Conditional Operator

  Stage: Stage-72
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:store_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_3:store_returns 
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int), _col1 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-48
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-75
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col10
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-53
    Conditional Operator

  Stage: Stage-74
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:web_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_3:web_returns 
          TableScan
            alias: web_returns
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int), _col1 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-52
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: web_returns
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-77
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_item_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col10
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-57
    Conditional Operator

  Stage: Stage-76
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_4:catalog_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery1:$hdt$_1-subquery1:$hdt$_4:catalog_returns 
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int), _col1 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-56
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col4), sum(_col5)
                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  Statistics: Num rows: 65258771 Data size: 7189889555 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col4 (type: bigint), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 32629385 Data size: 3594944722 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-79
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col10
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-61
    Conditional Operator

  Stage: Stage-78
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_4:store_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery1:$hdt$_1-subquery1-subquery2:$hdt$_1-subquery2:$hdt$_4:store_returns 
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int), _col1 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-81
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category = 'Sports') and i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_manufact_id is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-66
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col10
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col6, _col7, _col8, _col10
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-65
    Conditional Operator

  Stage: Stage-80
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_4:web_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_1-subquery2:$hdt$_1-subquery2:$hdt$_4:web_returns 
          TableScan
            alias: web_returns
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int), _col1 (type: bigint)
                    1 _col0 (type: int), _col1 (type: bigint)

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: int), _col1 (type: bigint)
                1 _col0 (type: int), _col1 (type: bigint)
              outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
              Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int), _col3 (type: float), _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int)
          TableScan
            alias: web_returns
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col2, _col3, _col6, _col7, _col8, _col10, _col15, _col16
          Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col6 (type: int), _col7 (type: int), _col8 (type: int), _col10 (type: int), (_col2 - COALESCE(_col15,0)) (type: int), (_col3 - COALESCE(_col16,0)) (type: float)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query76.sql
STAGE DEPENDENCIES:
  Stage-22 is a root stage
  Stage-18 depends on stages: Stage-22
  Stage-21 depends on stages: Stage-18, Stage-20
  Stage-3 depends on stages: Stage-21
  Stage-4 depends on stages: Stage-3
  Stage-23 is a root stage
  Stage-20 depends on stages: Stage-23
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_web_page_sk is null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 3597889 Data size: 489263800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_ext_sales_price (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col2, _col3
                Statistics: Num rows: 3597889 Data size: 489263800 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3, _col5
                  Statistics: Num rows: 3957677 Data size: 538190191 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: d_date_sk is not null (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_year (type: int), d_qoy (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_addr_sk is null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 13752407 Data size: 1239286070 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col2, _col3
                Statistics: Num rows: 13752407 Data size: 1239286070 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3, _col5
                  Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2, _col5, _col7, _col8
                    Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: 'store' (type: string), 'ss_addr_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col2 (type: float)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
                      Union
                        Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: count(), sum(_col5)
                          keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                          Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                            sort order: +++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                            Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                            TopN Hash Memory Usage: 0.1
                            value expressions: _col5 (type: bigint), _col6 (type: double)
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col5, _col7, _col8
              Statistics: Num rows: 4353444 Data size: 592009222 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'web' (type: string), 'ws_web_page_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col2 (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 4353444 Data size: 592009222 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(), sum(_col5)
                    keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                      sort order: +++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                      Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                      TopN Hash Memory Usage: 0.1
                      value expressions: _col5 (type: bigint), _col6 (type: double)
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col3 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col2, _col5, _col7, _col8
              Statistics: Num rows: 8669218 Data size: 1176586113 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: 'catalog' (type: string), 'cs_warehouse_sk' (type: string), _col7 (type: int), _col8 (type: int), _col5 (type: string), _col2 (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 8669218 Data size: 1176586113 Basic stats: COMPLETE Column stats: NONE
                Union
                  Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(), sum(_col5)
                    keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                      sort order: +++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
                      Statistics: Num rows: 29663075 Data size: 3268131544 Basic stats: COMPLETE Column stats: NONE
                      TopN Hash Memory Usage: 0.1
                      value expressions: _col5 (type: bigint), _col6 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 14831537 Data size: 1634065716 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: string)
              sort order: +++++
              Statistics: Num rows: 14831537 Data size: 1634065716 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col5 (type: bigint), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: int), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 14831537 Data size: 1634065716 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_warehouse_sk is null and cs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 7164644 Data size: 972385176 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_item_sk (type: int), cs_ext_sales_price (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col1, _col2, _col3
                Statistics: Num rows: 7164644 Data size: 972385176 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col3, _col5
                  Statistics: Num rows: 7881108 Data size: 1069623716 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query79.sql
STAGE DEPENDENCIES:
  Stage-19 is a root stage
  Stage-4 depends on stages: Stage-19
  Stage-13 depends on stages: Stage-4 , consists of Stage-17, Stage-18, Stage-5
  Stage-17 has a backup stage: Stage-5
  Stage-11 depends on stages: Stage-17
  Stage-6 depends on stages: Stage-5, Stage-11, Stage-12
  Stage-18 has a backup stage: Stage-5
  Stage-12 depends on stages: Stage-18
  Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (1998, 1999, 2000) and (d_dow = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (s_number_employees BETWEEN 200 AND 295 and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 11 Data size: 21096 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_city (type: string)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 11 Data size: 21096 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((hd_dep_count = 8) or (hd_vehicle_count > 0)) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 6000 Data size: 642000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 6000 Data size: 642000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_hdemo_sk (type: int), ss_addr_sk (type: int), ss_store_sk (type: int), ss_ticket_number (type: bigint), ss_coupon_amt (type: float), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col13
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col13
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col0 (type: int), _col2 (type: int), _col4 (type: bigint), _col13 (type: string), _col5 (type: float), _col6 (type: float)
                        outputColumnNames: _col0, _col2, _col4, _col13, _col5, _col6
                        Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col5), sum(_col6)
                          keys: _col0 (type: int), _col2 (type: int), _col4 (type: bigint), _col13 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                            sort order: ++++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: bigint), _col3 (type: string)
                            Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col4 (type: double), _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: bigint), _col0 (type: int), _col3 (type: string), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7
              Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), substr(_col2, 1, 30) (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col5 (type: double)
              sort order: ++++
              Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: bigint), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: double), KEY.reducesinkkey3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7
                  Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), substr(_col2, 1, 30) (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col2 (type: string), _col3 (type: double), _col4 (type: double)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7
          Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), substr(_col2, 1, 30) (type: string), _col0 (type: bigint), _col3 (type: double), _col4 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 20134899 Data size: 1814438841 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query7.sql
STAGE DEPENDENCIES:
  Stage-15 is a root stage
  Stage-5 depends on stages: Stage-15
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:item 
          Fetch Operator
            limit: -1
        $hdt$_4:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_gender = 'F') and (cd_marital_status = 'W') and (cd_education_status = 'Primary') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 240100 Data size: 89701360 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 240100 Data size: 89701360 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((p_channel_email = 'N') or (p_channel_event = 'N')) and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_cdemo_sk is not null and ss_item_sk is not null and ss_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_cdemo_sk (type: int), ss_promo_sk (type: int), ss_quantity (type: int), ss_list_price (type: float), ss_sales_price (type: float), ss_coupon_amt (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col7 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col2, _col3, _col4, _col5, _col6, _col15
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col3, _col4, _col5, _col6, _col15
                        Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col15 (type: string), _col3 (type: int), _col4 (type: float), _col6 (type: float), _col5 (type: float)
                          outputColumnNames: _col15, _col3, _col4, _col6, _col5
                          Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: avg(_col3), avg(_col4), avg(_col6), avg(_col5)
                            keys: _col15 (type: string)
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                              TopN Hash Memory Usage: 0.1
                              value expressions: _col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>), _col4 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2), avg(VALUE._col3)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 20134900 Data size: 1814438891 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query80.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-48 depends on stages: Stage-1
  Stage-6 depends on stages: Stage-48
  Stage-7 depends on stages: Stage-6, Stage-19, Stage-30
  Stage-8 depends on stages: Stage-7
  Stage-14 is a root stage
  Stage-49 depends on stages: Stage-14
  Stage-19 depends on stages: Stage-49
  Stage-25 is a root stage
  Stage-50 depends on stages: Stage-25
  Stage-30 depends on stages: Stage-50
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_store_sk is not null and ss_item_sk is not null and ss_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_store_sk (type: int), ss_promo_sk (type: int), ss_ticket_number (type: bigint), ss_ext_sales_price (type: float), ss_net_profit (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float), _col6 (type: int)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_ticket_number (type: bigint), sr_return_amt (type: float), sr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
          Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:item 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_5:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 34000 Data size: 48719531 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 34000 Data size: 48719531 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery1:$hdt$_0-subquery1:$hdt$_0:$hdt$_5:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_channel_tv = 'N') and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 250 Data size: 294918 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 250 Data size: 294918 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col9, _col10
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col14
                Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5, _col9, _col10, _col14
                  Statistics: Num rows: 40269800 Data size: 3628877783 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col5, _col9, _col10, _col14
                    Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col14 (type: string), _col4 (type: float), COALESCE(_col9,0) (type: float), (_col5 - COALESCE(_col10,0)) (type: float)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1), sum(_col2), sum(_col3)
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 44296780 Data size: 3991765647 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'store channel' (type: string), concat('store', _col0) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 22148390 Data size: 1995882823 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Union
              Statistics: Num rows: 39481556 Data size: 4349883367 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col2), sum(_col3), sum(_col4)
                keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 118444668 Data size: 13049650101 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  Statistics: Num rows: 118444668 Data size: 13049650101 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 39481556 Data size: 4349883367 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col2), sum(_col3), sum(_col4)
                keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 118444668 Data size: 13049650101 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  Statistics: Num rows: 118444668 Data size: 13049650101 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col3 (type: double), _col4 (type: double), _col5 (type: double)
          TableScan
            Union
              Statistics: Num rows: 39481556 Data size: 4349883367 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(_col2), sum(_col3), sum(_col4)
                keys: _col0 (type: string), _col1 (type: string), 0 (type: int)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 118444668 Data size: 13049650101 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int)
                  Statistics: Num rows: 118444668 Data size: 13049650101 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
                  value expressions: _col3 (type: double), _col4 (type: double), _col5 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col3, _col4, _col5
          Statistics: Num rows: 59222334 Data size: 6524825050 Basic stats: COMPLETE Column stats: NONE
          pruneGroupingSetId: true
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col3 (type: double), _col4 (type: double), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 59222334 Data size: 6524825050 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 59222334 Data size: 6524825050 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 59222334 Data size: 6524825050 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 11000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cs_catalog_page_sk is not null and cs_item_sk is not null and cs_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_catalog_page_sk (type: int), cs_item_sk (type: int), cs_promo_sk (type: int), cs_order_number (type: bigint), cs_ext_sales_price (type: float), cs_net_profit (type: float), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float), _col6 (type: int)
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_order_number (type: bigint), cr_return_amount (type: float), cr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col1 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
          Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-49
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:catalog_page 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:catalog_page 
          TableScan
            alias: catalog_page
            Statistics: Num rows: 12000 Data size: 5530160 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cp_catalog_page_sk is not null (type: boolean)
              Statistics: Num rows: 12000 Data size: 5530160 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cp_catalog_page_sk (type: int), cp_catalog_page_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12000 Data size: 5530160 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 34000 Data size: 48719531 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 34000 Data size: 48719531 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery1:$hdt$_0-subquery1-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_channel_tv = 'N') and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 250 Data size: 294918 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 250 Data size: 294918 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col9, _col10
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col0 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col2, _col4, _col5, _col9, _col10, _col14
                Statistics: Num rows: 19072283 Data size: 2588489505 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5, _col9, _col10, _col14
                  Statistics: Num rows: 20979511 Data size: 2847338517 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col5, _col9, _col10, _col14
                    Statistics: Num rows: 23077462 Data size: 3132072436 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col14 (type: string), _col4 (type: float), COALESCE(_col9,0) (type: float), (_col5 - COALESCE(_col10,0)) (type: float)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 23077462 Data size: 3132072436 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1), sum(_col2), sum(_col3)
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Statistics: Num rows: 23077462 Data size: 3132072436 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 23077462 Data size: 3132072436 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 11538731 Data size: 1566036218 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'catalog channel' (type: string), concat('catalog_page', _col0) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 11538731 Data size: 1566036218 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_web_site_sk is not null and ws_item_sk is not null and ws_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_web_site_sk (type: int), ws_promo_sk (type: int), ws_order_number (type: bigint), ws_ext_sales_price (type: float), ws_net_profit (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col3 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col3 (type: bigint)
                  Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float), _col6 (type: int)
          TableScan
            alias: web_returns
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_order_number (type: bigint), wr_return_amt (type: float), wr_net_loss (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                  Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: float), _col3 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: int), _col3 (type: bigint)
            1 _col0 (type: int), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
          Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-50
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:web_site 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          Fetch Operator
            limit: -1
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 1998-08-04 AND 1998-09-04 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_3:web_site 
          TableScan
            alias: web_site
            Statistics: Num rows: 42 Data size: 78018 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: web_site_sk is not null (type: boolean)
              Statistics: Num rows: 42 Data size: 78018 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: web_site_sk (type: int), web_site_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 42 Data size: 78018 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_4:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_current_price > 50) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 34000 Data size: 48719531 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 34000 Data size: 48719531 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0-subquery2:$hdt$_0-subquery2:$hdt$_0:$hdt$_5:promotion 
          TableScan
            alias: promotion
            Statistics: Num rows: 500 Data size: 589836 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((p_channel_tv = 'N') and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 250 Data size: 294918 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 250 Data size: 294918 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col9, _col10
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col1 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col2, _col4, _col5, _col9, _col10, _col14
                Statistics: Num rows: 9577579 Data size: 1302420318 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col2, _col4, _col5, _col9, _col10, _col14
                  Statistics: Num rows: 10535337 Data size: 1432662380 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col4, _col5, _col9, _col10, _col14
                    Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col14 (type: string), _col4 (type: float), COALESCE(_col9,0) (type: float), (_col5 - COALESCE(_col10,0)) (type: float)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1), sum(_col2), sum(_col3)
                        keys: _col0 (type: string)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3
                        Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 11588870 Data size: 1575928652 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 5794435 Data size: 787964326 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: 'web channel' (type: string), concat('web_site', _col0) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 5794435 Data size: 787964326 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query82.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-9 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_manufact_id) IN (437, 129, 727, 663) and i_current_price BETWEEN 30 AND 60 and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 5666 Data size: 8118966 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 5666 Data size: 8118966 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 5666 Data size: 8118966 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: float)
          TableScan
            alias: inventory
            Statistics: Num rows: 133110000 Data size: 1570704592 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_quantity_on_hand BETWEEN 100 AND 500 and inv_item_sk is not null) (type: boolean)
              Statistics: Num rows: 14790000 Data size: 174522732 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: inv_item_sk (type: int), inv_date_sk (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 14790000 Data size: 174522732 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 14790000 Data size: 174522732 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col2 (type: int)
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col7
          Statistics: Num rows: 63362181 Data size: 5601138143 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-30' AND '2002-07-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col7 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3
              Statistics: Num rows: 69698400 Data size: 6161252090 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col1 (type: string), _col2 (type: string), _col3 (type: float)
                mode: hash
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 69698400 Data size: 6161252090 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: float)
                  sort order: +++
                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: float)
                  Statistics: Num rows: 69698400 Data size: 6161252090 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.1
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 34849200 Data size: 3080626045 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Statistics: Num rows: 34849200 Data size: 3080626045 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col1 (type: string), _col2 (type: float)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), VALUE._col1 (type: float)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 34849200 Data size: 3080626045 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 8800 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 8800 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query83.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-57 depends on stages: Stage-11
  Stage-10 depends on stages: Stage-57
  Stage-36 depends on stages: Stage-10, Stage-37 , consists of Stage-55, Stage-56, Stage-3
  Stage-55 has a backup stage: Stage-3
  Stage-34 depends on stages: Stage-55
  Stage-4 depends on stages: Stage-3, Stage-34, Stage-35
  Stage-33 depends on stages: Stage-4, Stage-15, Stage-24 , consists of Stage-52, Stage-53, Stage-54, Stage-5
  Stage-52 has a backup stage: Stage-5
  Stage-30 depends on stages: Stage-52
  Stage-6 depends on stages: Stage-5, Stage-30, Stage-31, Stage-32
  Stage-53 has a backup stage: Stage-5
  Stage-31 depends on stages: Stage-53
  Stage-54 has a backup stage: Stage-5
  Stage-32 depends on stages: Stage-54
  Stage-5
  Stage-56 has a backup stage: Stage-3
  Stage-35 depends on stages: Stage-56
  Stage-3
  Stage-20 is a root stage
  Stage-60 depends on stages: Stage-20
  Stage-19 depends on stages: Stage-60
  Stage-42 depends on stages: Stage-19, Stage-43 , consists of Stage-58, Stage-59, Stage-14
  Stage-58 has a backup stage: Stage-14
  Stage-40 depends on stages: Stage-58
  Stage-15 depends on stages: Stage-14, Stage-40, Stage-41
  Stage-59 has a backup stage: Stage-14
  Stage-41 depends on stages: Stage-59
  Stage-14
  Stage-29 is a root stage
  Stage-63 depends on stages: Stage-29
  Stage-28 depends on stages: Stage-63
  Stage-48 depends on stages: Stage-28, Stage-49 , consists of Stage-61, Stage-62, Stage-23
  Stage-61 has a backup stage: Stage-23
  Stage-46 depends on stages: Stage-61
  Stage-24 depends on stages: Stage-23, Stage-46, Stage-47
  Stage-62 has a backup stage: Stage-23
  Stage-47 depends on stages: Stage-62
  Stage-23
  Stage-64 is a root stage
  Stage-37 depends on stages: Stage-64
  Stage-65 is a root stage
  Stage-43 depends on stages: Stage-65
  Stage-66 is a root stage
  Stage-49 depends on stages: Stage-66
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date) IN ('1998-01-02', '1998-10-15', '1998-11-10') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: d_week_seq
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: d_week_seq (type: int)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-57
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_3:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_3:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 40176 Data size: 44957448 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-36
    Conditional Operator

  Stage: Stage-55
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: int)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1846867 Data size: 145469824 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Conditional Operator

  Stage: Stage-52
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: bigint)
              sort order: ++
              Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: bigint), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: decimal(25,6))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: double), VALUE._col1 (type: bigint), VALUE._col2 (type: double), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: decimal(25,6))
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 7800 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 7800 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-53
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-54
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
              keys:
                0 _col0 (type: string)
                1 _col0 (type: string)
                2 _col0 (type: string)
              outputColumnNames: _col0, _col1, _col3, _col5
              Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1846867 Data size: 145469824 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 958152 Data size: 101723776 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 456975 Data size: 42961189 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
          keys:
            0 _col0 (type: string)
            1 _col0 (type: string)
            2 _col0 (type: string)
          outputColumnNames: _col0, _col1, _col3, _col5
          Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: bigint), (((UDFToDouble(_col1) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col3 (type: bigint), (((UDFToDouble(_col3) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), _col5 (type: bigint), (((UDFToDouble(_col5) / UDFToDouble(((_col1 + _col3) + _col5))) / 3.0) * 100.0) (type: double), (CAST( ((_col1 + _col3) + _col5) AS decimal(19,0)) / 3) (type: decimal(25,6))
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
            Statistics: Num rows: 4063107 Data size: 320033619 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-56
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-35
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: int)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 3357940 Data size: 264490585 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 40176 Data size: 44957448 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col4
          Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col1 (type: int)
            outputColumnNames: _col4, _col1
            Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 3693734 Data size: 290939649 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date) IN ('1998-01-02', '1998-10-15', '1998-11-10') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: d_week_seq
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: d_week_seq (type: int)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-60
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_4:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_4:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 40176 Data size: 44957448 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Conditional Operator

  Stage: Stage-58
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: int)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 958152 Data size: 101723776 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-59
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-41
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: int)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 1742095 Data size: 184952316 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 40176 Data size: 44957448 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col4
          Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col1 (type: int)
            outputColumnNames: _col4, _col1
            Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date) IN ('1998-01-02', '1998-10-15', '1998-11-10') and d_week_seq is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_week_seq (type: int)
                outputColumnNames: d_week_seq
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: d_week_seq (type: int)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-63
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_5:$hdt$_5:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_5:$hdt$_5:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date (type: string), d_week_seq (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0
              Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: string)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 80353 Data size: 89916016 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 40176 Data size: 44957448 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-48
    Conditional Operator

  Stage: Stage-61
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-46
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: int)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 456975 Data size: 42961189 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-62
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: string)
                1 _col0 (type: string)
              outputColumnNames: _col1, _col4
              Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col4 (type: string), _col1 (type: int)
                outputColumnNames: _col4, _col1
                Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col4 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col6 (type: string)
              sort order: +
              Map-reduce partition columns: _col6 (type: string)
              Statistics: Num rows: 830864 Data size: 78111252 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col4 (type: string)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string)
              sort order: +
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 40176 Data size: 44957448 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col6 (type: string)
            1 _col0 (type: string)
          outputColumnNames: _col1, _col4
          Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col4 (type: string), _col1 (type: int)
            outputColumnNames: _col4, _col1
            Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col1)
              keys: _col4 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 913950 Data size: 85922379 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-64
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-37
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_returns
            Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_item_sk is not null (type: boolean)
              Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_return_quantity (type: int), sr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 2775158 Data size: 218587252 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 3052673 Data size: 240445982 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col6
                    Statistics: Num rows: 3357940 Data size: 264490585 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-65
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-43
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cr_item_sk is not null (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_item_sk (type: int), cr_return_quantity (type: int), cr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 1583723 Data size: 168138466 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col6
                    Statistics: Num rows: 1742095 Data size: 184952316 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-66
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:item 
          Fetch Operator
            limit: -1
        $hdt$_2:$hdt$_4:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_item_id is not null) (type: boolean)
              Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:$hdt$_4:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-49
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_returns
            Statistics: Num rows: 686665 Data size: 64554752 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 686665 Data size: 64554752 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_return_quantity (type: int), wr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 686665 Data size: 64554752 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4
                  Statistics: Num rows: 755331 Data size: 71010228 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col6
                    Statistics: Num rows: 830864 Data size: 78111252 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query84.sql
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-16 depends on stages: Stage-20
  Stage-15 depends on stages: Stage-16 , consists of Stage-18, Stage-19, Stage-2
  Stage-18 has a backup stage: Stage-2
  Stage-13 depends on stages: Stage-18
  Stage-17 depends on stages: Stage-2, Stage-13, Stage-14
  Stage-5 depends on stages: Stage-17
  Stage-19 has a backup stage: Stage-2
  Stage-14 depends on stages: Stage-19
  Stage-2
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:customer_address 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_city = 'Hopewell') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_id (type: string), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5
                  Statistics: Num rows: 550000 Data size: 473010970 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Conditional Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_5:store_returns 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
        $hdt$_5:store_returns 
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_cdemo_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_cdemo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col4, _col5
              Statistics: Num rows: 6325950 Data size: 491035531 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_4:income_band 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int), hd_income_band_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:income_band 
          TableScan
            alias: income_band
            Statistics: Num rows: 20 Data size: 240 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ib_lower_bound >= 32287) and (ib_upper_bound <= 82287) and ib_income_band_sk is not null) (type: boolean)
              Statistics: Num rows: 2 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ib_income_band_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col2 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col4, _col5, _col11
              Statistics: Num rows: 6958545 Data size: 540139095 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col11 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col4, _col5
                Statistics: Num rows: 7654399 Data size: 594153017 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), concat(_col5, ', ', _col4) (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 7654399 Data size: 594153017 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    sort order: +
                    Statistics: Num rows: 7654399 Data size: 594153017 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.1
                    value expressions: _col1 (type: string)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7654399 Data size: 594153017 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 7700 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 7700 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
                2 _col0 (type: int)
        $hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_cdemo_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_cdemo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                       Inner Join 1 to 2
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                    2 _col0 (type: int)
                  outputColumnNames: _col0, _col2, _col4, _col5
                  Statistics: Num rows: 6325950 Data size: 491035531 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: int)
              sort order: +
              Map-reduce partition columns: _col1 (type: int)
              Statistics: Num rows: 550000 Data size: 473010970 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col2 (type: int), _col4 (type: string), _col5 (type: string)
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: sr_cdemo_sk is not null (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_cdemo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 _col1 (type: int)
            1 _col0 (type: int)
            2 _col0 (type: int)
          outputColumnNames: _col0, _col2, _col4, _col5
          Statistics: Num rows: 6325950 Data size: 491035531 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query85.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-23 depends on stages: Stage-1
  Stage-8 depends on stages: Stage-23
  Stage-9 depends on stages: Stage-8
  Stage-0 depends on stages: Stage-9

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ws_sales_price BETWEEN 100 AND 150 or ws_sales_price BETWEEN 50 AND 100 or ws_sales_price BETWEEN 150 AND 200) and (ws_net_profit BETWEEN 100 AND 200 or ws_net_profit BETWEEN 150 AND 300 or ws_net_profit BETWEEN 50 AND 250) and ws_order_number is not null and ws_item_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 799530 Data size: 108725168 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_item_sk (type: int), ws_web_page_sk (type: int), ws_order_number (type: bigint), ws_quantity (type: int), ws_sales_price (type: float), ws_net_profit (type: float), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 799530 Data size: 108725168 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 799530 Data size: 108725168 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: float), _col5 (type: float), _col6 (type: int)
          TableScan
            alias: web_returns
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wr_item_sk is not null and wr_order_number is not null and wr_refunded_cdemo_sk is not null and wr_returning_cdemo_sk is not null and wr_refunded_addr_sk is not null and wr_reason_sk is not null) (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: int), wr_refunded_cdemo_sk (type: int), wr_refunded_addr_sk (type: int), wr_returning_cdemo_sk (type: int), wr_reason_sk (type: int), wr_order_number (type: bigint), wr_fee (type: float), wr_refunded_cash (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col5 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col5 (type: bigint)
                  Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col6 (type: float), _col7 (type: float)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col5 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col13, _col14
          Statistics: Num rows: 879483 Data size: 119597687 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:web_page 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:cd1 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1:cd2 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_1:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_2:reason 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:web_page 
          TableScan
            alias: web_page
            Statistics: Num rows: 200 Data size: 117582 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wp_web_page_sk is not null (type: boolean)
              Statistics: Num rows: 200 Data size: 117582 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 200 Data size: 117582 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:cd1 
          TableScan
            alias: cd1
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col8 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_1:cd2 
          TableScan
            alias: cd2
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null) (type: boolean)
              Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
                    1 _col1 (type: string), _col2 (type: string), _col0 (type: int)
        $hdt$_0:$hdt$_2:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state) IN ('KY', 'GA', 'NM', 'MT', 'OR', 'IN', 'WI', 'MO', 'WV') and (ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 62500 Data size: 63429996 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 62500 Data size: 63429996 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col9 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1998) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 40870356 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:reason 
          TableScan
            alias: reason
            Statistics: Num rows: 45 Data size: 9112 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: r_reason_sk is not null (type: boolean)
              Statistics: Num rows: 45 Data size: 9112 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_reason_sk (type: int), r_reason_desc (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 45 Data size: 9112 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col11 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col4, _col5, _col6, _col8, _col9, _col10, _col11, _col13, _col14
              Statistics: Num rows: 967431 Data size: 131557458 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col8 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col3, _col4, _col5, _col6, _col9, _col10, _col11, _col13, _col14, _col17, _col18
                Statistics: Num rows: 2112880 Data size: 789371985 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (((_col17 = 'M') and (_col18 = '4 yr Degree') and _col4 BETWEEN 100 AND 150) or ((_col17 = 'D') and (_col18 = 'Primary') and _col4 BETWEEN 50 AND 100) or ((_col17 = 'U') and (_col18 = 'Advanced Degree') and _col4 BETWEEN 150 AND 200)) (type: boolean)
                  Statistics: Num rows: 176073 Data size: 65780874 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col10 (type: int), _col11 (type: int), _col13 (type: float), _col14 (type: float), _col17 (type: string), _col18 (type: string), _col3 (type: int), _col5 (type: float), _col6 (type: int), _col9 (type: int)
                    outputColumnNames: _col10, _col11, _col13, _col14, _col17, _col18, _col3, _col5, _col6, _col9
                    Statistics: Num rows: 176073 Data size: 65780874 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col17 (type: string), _col18 (type: string), _col10 (type: int)
                        1 _col1 (type: string), _col2 (type: string), _col0 (type: int)
                      outputColumnNames: _col3, _col5, _col6, _col9, _col11, _col13, _col14
                      Statistics: Num rows: 2112880 Data size: 789371985 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col9 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col3, _col5, _col6, _col11, _col13, _col14, _col23
                        Statistics: Num rows: 2324168 Data size: 868309202 Basic stats: COMPLETE Column stats: NONE
                        Filter Operator
                          predicate: (((_col23) IN ('KY', 'GA', 'NM') and _col5 BETWEEN 100 AND 200) or ((_col23) IN ('MT', 'OR', 'IN') and _col5 BETWEEN 150 AND 300) or ((_col23) IN ('WI', 'MO', 'WV') and _col5 BETWEEN 50 AND 250)) (type: boolean)
                          Statistics: Num rows: 387360 Data size: 144717702 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col11 (type: int), _col13 (type: float), _col14 (type: float), _col3 (type: int), _col6 (type: int)
                            outputColumnNames: _col11, _col13, _col14, _col3, _col6
                            Statistics: Num rows: 387360 Data size: 144717702 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col6 (type: int)
                                1 _col0 (type: int)
                              outputColumnNames: _col3, _col11, _col13, _col14
                              Statistics: Num rows: 426096 Data size: 159189475 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col11 (type: int)
                                  1 _col0 (type: int)
                                outputColumnNames: _col3, _col13, _col14, _col28
                                Statistics: Num rows: 468705 Data size: 175108426 Basic stats: COMPLETE Column stats: NONE
                                Select Operator
                                  expressions: _col28 (type: string), _col3 (type: int), _col14 (type: float), _col13 (type: float)
                                  outputColumnNames: _col28, _col3, _col14, _col13
                                  Statistics: Num rows: 468705 Data size: 175108426 Basic stats: COMPLETE Column stats: NONE
                                  Group By Operator
                                    aggregations: avg(_col3), avg(_col14), avg(_col13)
                                    keys: _col28 (type: string)
                                    mode: hash
                                    outputColumnNames: _col0, _col1, _col2, _col3
                                    Statistics: Num rows: 468705 Data size: 175108426 Basic stats: COMPLETE Column stats: NONE
                                    Reduce Output Operator
                                      key expressions: _col0 (type: string)
                                      sort order: +
                                      Map-reduce partition columns: _col0 (type: string)
                                      Statistics: Num rows: 468705 Data size: 175108426 Basic stats: COMPLETE Column stats: NONE
                                      value expressions: _col1 (type: struct<count:bigint,sum:double,input:int>), _col2 (type: struct<count:bigint,sum:double,input:float>), _col3 (type: struct<count:bigint,sum:double,input:float>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0), avg(VALUE._col1), avg(VALUE._col2)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 234352 Data size: 87554026 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: substr(_col0, 1, 20) (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 234352 Data size: 87554026 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: double), _col2 (type: double), _col3 (type: double)
              sort order: ++++
              Statistics: Num rows: 234352 Data size: 87554026 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 234352 Data size: 87554026 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 37300 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 37300 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query87.sql
STAGE DEPENDENCIES:
  Stage-39 is a root stage
  Stage-26 depends on stages: Stage-39
  Stage-25 depends on stages: Stage-26 , consists of Stage-37, Stage-38, Stage-2
  Stage-37 has a backup stage: Stage-2
  Stage-23 depends on stages: Stage-37
  Stage-3 depends on stages: Stage-2, Stage-23, Stage-24
  Stage-22 depends on stages: Stage-3, Stage-11 , consists of Stage-36, Stage-4
  Stage-36 has a backup stage: Stage-4
  Stage-21 depends on stages: Stage-36
  Stage-20 depends on stages: Stage-4, Stage-16, Stage-21 , consists of Stage-35, Stage-5
  Stage-35 has a backup stage: Stage-5
  Stage-19 depends on stages: Stage-35
  Stage-6 depends on stages: Stage-5, Stage-19
  Stage-5
  Stage-4
  Stage-38 has a backup stage: Stage-2
  Stage-24 depends on stages: Stage-38
  Stage-2
  Stage-42 is a root stage
  Stage-30 depends on stages: Stage-42
  Stage-29 depends on stages: Stage-30 , consists of Stage-40, Stage-41, Stage-10
  Stage-40 has a backup stage: Stage-10
  Stage-27 depends on stages: Stage-40
  Stage-11 depends on stages: Stage-10, Stage-27, Stage-28
  Stage-41 has a backup stage: Stage-10
  Stage-28 depends on stages: Stage-41
  Stage-10
  Stage-45 is a root stage
  Stage-34 depends on stages: Stage-45
  Stage-33 depends on stages: Stage-34 , consists of Stage-43, Stage-44, Stage-15
  Stage-43 has a backup stage: Stage-15
  Stage-31 depends on stages: Stage-43
  Stage-16 depends on stages: Stage-15, Stage-31, Stage-32
  Stage-44 has a backup stage: Stage-15
  Stage-32 depends on stages: Stage-44
  Stage-15
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-39
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_customer_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_customer_sk (type: int), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Conditional Operator

  Stage: Stage-37
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_2:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_2:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col6, _col7
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                outputColumnNames: _col7, _col6, _col3
                Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-22
    Conditional Operator

  Stage: Stage-36
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 18304454 Data size: 1649489865 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: _col3 is null (type: boolean)
                Statistics: Num rows: 9152227 Data size: 824744932 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 9152227 Data size: 824744932 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-35
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
                1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
              outputColumnNames: _col6
              Statistics: Num rows: 10067449 Data size: 907219444 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: _col6 is null (type: boolean)
                Statistics: Num rows: 5033724 Data size: 453609676 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  Statistics: Num rows: 5033724 Data size: 453609676 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count()
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 9152227 Data size: 824744932 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
            1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
          outputColumnNames: _col6
          Statistics: Num rows: 10067449 Data size: 907219444 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: _col6 is null (type: boolean)
            Statistics: Num rows: 5033724 Data size: 453609676 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              Statistics: Num rows: 5033724 Data size: 453609676 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count()
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: string), _col1 (type: string), _col2 (type: string)
            1 _col0 (type: string), _col1 (type: string), _col2 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 18304454 Data size: 1649489865 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: _col3 is null (type: boolean)
            Statistics: Num rows: 9152227 Data size: 824744932 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 9152227 Data size: 824744932 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-38
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col6, _col7
                  Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                    outputColumnNames: _col7, _col6, _col3
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col6, _col7
          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
            outputColumnNames: _col7, _col6, _col3
            Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-42
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cs_bill_customer_sk is not null (type: boolean)
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cs_bill_customer_sk (type: int), cs_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-29
    Conditional Operator

  Stage: Stage-40
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-27
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col6, _col7
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                outputColumnNames: _col7, _col6, _col3
                Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 8669219 Data size: 1176586045 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-41
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-28
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col6, _col7
                  Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                    outputColumnNames: _col7, _col6, _col3
                    Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col6, _col7
          Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
            outputColumnNames: _col7, _col6, _col3
            Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 17338439 Data size: 2353172227 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-45
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-34
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_bill_customer_sk is not null (type: boolean)
              Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_bill_customer_sk (type: int), ws_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7195778 Data size: 978527600 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-33
    Conditional Operator

  Stage: Stage-43
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col3, _col6, _col7
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                outputColumnNames: _col7, _col6, _col3
                Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              sort order: +++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string)
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 4353445 Data size: 592009223 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-44
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: int)
                1 _col0 (type: int)

  Stage: Stage-32
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col6, _col7
                  Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                    outputColumnNames: _col7, _col6, _col3
                    Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Map-reduce partition columns: _col0 (type: int)
              Statistics: Num rows: 7915355 Data size: 1076380383 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: string)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_first_name (type: string), c_last_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col3, _col6, _col7
          Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col7 (type: string), _col6 (type: string), _col3 (type: string)
            outputColumnNames: _col7, _col6, _col3
            Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col7 (type: string), _col6 (type: string), _col3 (type: string)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 8706890 Data size: 1184018446 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query88.sql
STAGE DEPENDENCIES:
  Stage-99 is a root stage
  Stage-4 depends on stages: Stage-99
  Stage-66 depends on stages: Stage-4, Stage-12, Stage-19, Stage-26, Stage-33, Stage-40, Stage-47, Stage-54 , consists of Stage-91, Stage-92, Stage-93, Stage-94, Stage-95, Stage-96, Stage-97, Stage-98, Stage-5
  Stage-91 has a backup stage: Stage-5
  Stage-58 depends on stages: Stage-91
  Stage-92 has a backup stage: Stage-5
  Stage-59 depends on stages: Stage-92
  Stage-93 has a backup stage: Stage-5
  Stage-60 depends on stages: Stage-93
  Stage-94 has a backup stage: Stage-5
  Stage-61 depends on stages: Stage-94
  Stage-95 has a backup stage: Stage-5
  Stage-62 depends on stages: Stage-95
  Stage-96 has a backup stage: Stage-5
  Stage-63 depends on stages: Stage-96
  Stage-97 has a backup stage: Stage-5
  Stage-64 depends on stages: Stage-97
  Stage-98 has a backup stage: Stage-5
  Stage-65 depends on stages: Stage-98
  Stage-5
  Stage-100 is a root stage
  Stage-12 depends on stages: Stage-100
  Stage-101 is a root stage
  Stage-19 depends on stages: Stage-101
  Stage-102 is a root stage
  Stage-26 depends on stages: Stage-102
  Stage-103 is a root stage
  Stage-33 depends on stages: Stage-103
  Stage-104 is a root stage
  Stage-40 depends on stages: Stage-104
  Stage-105 is a root stage
  Stage-47 depends on stages: Stage-105
  Stage-106 is a root stage
  Stage-54 depends on stages: Stage-106
  Stage-0 depends on stages: Stage-58, Stage-59, Stage-60, Stage-61, Stage-62, Stage-63, Stage-64, Stage-65, Stage-5

STAGE PLANS:
  Stage: Stage-99
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 8) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-66
    Conditional Operator

  Stage: Stage-91
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-58
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-92
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-59
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-93
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-60
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-94
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-61
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-95
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-62
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-96
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-63
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-97
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME7 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME7 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-64
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-98
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
        $INTNAME2 
          Fetch Operator
            limit: -1
        $INTNAME3 
          Fetch Operator
            limit: -1
        $INTNAME4 
          Fetch Operator
            limit: -1
        $INTNAME5 
          Fetch Operator
            limit: -1
        $INTNAME6 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME2 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME3 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME4 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME5 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
        $INTNAME6 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 

  Stage: Stage-65
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 0 to 2
                   Inner Join 0 to 3
                   Inner Join 0 to 4
                   Inner Join 0 to 5
                   Inner Join 0 to 6
                   Inner Join 0 to 7
              keys:
                0 
                1 
                2 
                3 
                4 
                5 
                6 
                7 
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 0 to 2
               Inner Join 0 to 3
               Inner Join 0 to 4
               Inner Join 0 to 5
               Inner Join 0 to 6
               Inner Join 0 to 7
          keys:
            0 
            1 
            2 
            3 
            4 
            5 
            6 
            7 
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 65 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-100
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_4:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 9) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_4:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-101
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:$hdt$_4:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_2:$hdt$_5:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:$hdt$_4:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 9) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:$hdt$_5:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-102
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:$hdt$_4:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_3:$hdt$_5:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:$hdt$_6:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:$hdt$_4:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:$hdt$_5:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 10) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:$hdt$_6:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-103
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:$hdt$_5:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_4:$hdt$_6:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_4:$hdt$_7:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:$hdt$_5:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:$hdt$_6:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 10) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:$hdt$_7:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-33
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-104
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:$hdt$_6:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_5:$hdt$_7:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_5:$hdt$_8:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:$hdt$_6:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:$hdt$_7:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 11) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:$hdt$_8:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-40
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-105
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_6:$hdt$_7:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_6:$hdt$_8:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_6:$hdt$_9:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_6:$hdt$_7:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:$hdt$_8:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 11) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:$hdt$_9:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-47
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-106
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_7:$hdt$_10:store 
          Fetch Operator
            limit: -1
        $hdt$_7:$hdt$_8:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_7:$hdt$_9:time_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_7:$hdt$_10:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_7:$hdt$_8:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((hd_dep_count = 3) and (hd_vehicle_count <= 5)) or ((hd_dep_count = 0) and (hd_vehicle_count <= 2)) or ((hd_dep_count = 1) and (hd_vehicle_count <= 3))) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_7:$hdt$_9:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 12) and (t_minute < 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-54
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query89.sql
STAGE DEPENDENCIES:
  Stage-13 is a root stage
  Stage-4 depends on stages: Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((i_class) IN ('wallpaper', 'parenting', 'musical') or (i_class) IN ('womens', 'birdal', 'pants')) and ((i_category) IN ('Home', 'Books', 'Electronics') or (i_category) IN ('Shoes', 'Jewelry', 'Men')) and (((i_category) IN ('Home', 'Books', 'Electronics') and (i_class) IN ('wallpaper', 'parenting', 'musical')) or ((i_category) IN ('Shoes', 'Jewelry', 'Men') and (i_class) IN ('womens', 'birdal', 'pants'))) and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_brand (type: string), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int), d_moy (type: int)
                outputColumnNames: _col0, _col2
                Statistics: Num rows: 36525 Data size: 40871475 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_0:$hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int), s_store_name (type: string), s_company_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col5 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_store_sk (type: int), ss_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col7 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col10
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col5 (type: int)
                        1 _col0 (type: int)
                      outputColumnNames: _col1, _col2, _col3, _col6, _col10, _col12, _col13
                      Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col10 (type: int), _col12 (type: string), _col13 (type: string), _col6 (type: float)
                        outputColumnNames: _col1, _col2, _col3, _col10, _col12, _col13, _col6
                        Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col6)
                          keys: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col10 (type: int), _col12 (type: string), _col13 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                          Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: int), _col4 (type: string), _col5 (type: string)
                            sort order: ++++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: int), _col4 (type: string), _col5 (type: string)
                            Statistics: Num rows: 36608909 Data size: 3298979732 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col6 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: int), KEY._col4 (type: string), KEY._col5 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col1 (type: string), _col0 (type: string), _col4 (type: string), _col5 (type: string), _col3 (type: int), _col6 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
            Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
              sort order: ++++
              Map-reduce partition columns: _col0 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
              Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col5 (type: int), _col6 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col1 (type: int), VALUE._col2 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: string, _col5: int, _col6: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col0 ASC NULLS FIRST, _col2 ASC NULLS FIRST, _col3 ASC NULLS FIRST, _col4 ASC NULLS FIRST
                  partition by: _col0, _col2, _col3, _col4
                  raw input shape:
                  window functions:
                      window function definition
                        alias: avg_window_0
                        arguments: _col6
                        name: avg
                        window function: GenericUDAFAverageEvaluatorDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: avg_window_0 (type: double), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: double)
              outputColumnNames: avg_window_0, _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 18304454 Data size: 1649489820 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: CASE WHEN ((avg_window_0 <> 0.0)) THEN (((abs((_col6 - avg_window_0)) / avg_window_0) > 0.1)) ELSE (null) END (type: boolean)
                Statistics: Num rows: 9152227 Data size: 824744910 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: double), avg_window_0 (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 9152227 Data size: 824744910 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: (_col6 - _col7) (type: double), _col3 (type: string)
              sort order: ++
              Statistics: Num rows: 9152227 Data size: 824744910 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: string), _col5 (type: int), _col6 (type: double), _col7 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col3 (type: string), VALUE._col4 (type: int), VALUE._col5 (type: double), VALUE._col6 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 9152227 Data size: 824744910 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 9000 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query90.sql
STAGE DEPENDENCIES:
  Stage-28 is a root stage
  Stage-4 depends on stages: Stage-28
  Stage-19 depends on stages: Stage-4, Stage-13 , consists of Stage-26, Stage-27, Stage-5
  Stage-26 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-26
  Stage-6 depends on stages: Stage-5, Stage-17, Stage-18
  Stage-27 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-27
  Stage-5
  Stage-29 is a root stage
  Stage-13 depends on stages: Stage-29
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:web_page 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 8) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_hour BETWEEN 6 AND 7 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_3:web_page 
          TableScan
            alias: web_page
            Statistics: Num rows: 200 Data size: 117582 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wp_char_count BETWEEN 5000 AND 5200 and wp_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 22 Data size: 12934 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 22 Data size: 12934 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_hdemo_sk is not null and ws_sold_time_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: int), ws_ship_hdemo_sk (type: int), ws_web_page_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 9579959 Data size: 1302609891 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: decimal(35,20))
              sort order: +
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: decimal(35,20))
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_4:web_page 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 8) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_3:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (t_hour BETWEEN 14 AND 15 and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 9600 Data size: 4531200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_1:$hdt$_4:web_page 
          TableScan
            alias: web_page
            Statistics: Num rows: 200 Data size: 117582 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wp_char_count BETWEEN 5000 AND 5200 and wp_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 22 Data size: 12934 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 22 Data size: 12934 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_hdemo_sk is not null and ws_sold_time_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: int), ws_ship_hdemo_sk (type: int), ws_web_page_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 9579959 Data size: 1302609891 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query91.sql
STAGE DEPENDENCIES:
  Stage-26 is a root stage
  Stage-21 depends on stages: Stage-26
  Stage-20 depends on stages: Stage-21 , consists of Stage-24, Stage-25, Stage-3
  Stage-24 has a backup stage: Stage-3
  Stage-18 depends on stages: Stage-24
  Stage-23 depends on stages: Stage-3, Stage-18, Stage-19
  Stage-7 depends on stages: Stage-23
  Stage-8 depends on stages: Stage-7
  Stage-25 has a backup stage: Stage-3
  Stage-19 depends on stages: Stage-25
  Stage-3
  Stage-0 depends on stages: Stage-8

STAGE PLANS:
  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:call_center 
          Fetch Operator
            limit: -1
        $hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:call_center 
          TableScan
            alias: call_center
            Statistics: Num rows: 24 Data size: 49188 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cc_call_center_sk is not null (type: boolean)
              Statistics: Num rows: 24 Data size: 49188 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cc_call_center_sk (type: int), cc_call_center_id (type: string), cc_name (type: string), cc_manager (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 24 Data size: 49188 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)
        $hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 1999) and (d_moy = 11) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 20435178 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_returns
            Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (cr_call_center_sk is not null and cr_returning_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cr_returning_customer_sk (type: int), cr_call_center_sk (type: int), cr_net_loss (type: float), cr_returned_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1439749 Data size: 152853148 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col1 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6, _col7
                  Statistics: Num rows: 1583723 Data size: 168138466 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col7 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col2, _col3, _col4, _col6
                    Statistics: Num rows: 1742095 Data size: 184952316 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:customer 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:customer 
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col6, _col12, _col13, _col14
              Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_4:customer_address 
          Fetch Operator
            limit: -1
        $hdt$_5:customer_demographics 
          Fetch Operator
            limit: -1
        $hdt$_6:household_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_4:customer_address 
          TableScan
            alias: customer_address
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -7) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col14 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 717610880 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((cd_education_status = 'Unknown') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'W')) and (((cd_marital_status = 'M') and (cd_education_status = 'Unknown')) or ((cd_marital_status = 'W') and (cd_education_status = 'Advanced Degree'))) and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 960400 Data size: 358805440 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: int), cd_marital_status (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 960400 Data size: 358805440 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col12 (type: int)
                    1 _col0 (type: int)
        $hdt$_6:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_buy_potential like '0-500%') and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col13 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col14 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col2, _col3, _col6, _col12, _col13
              Statistics: Num rows: 2107934 Data size: 223792312 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col12 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col1, _col2, _col3, _col6, _col13, _col18, _col19
                Statistics: Num rows: 2318727 Data size: 246171548 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col13 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col6, _col18, _col19
                  Statistics: Num rows: 2550599 Data size: 270788708 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col18 (type: string), _col19 (type: string), _col6 (type: float)
                    outputColumnNames: _col1, _col2, _col3, _col18, _col19, _col6
                    Statistics: Num rows: 2550599 Data size: 270788708 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col6)
                      keys: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col18 (type: string), _col19 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 2550599 Data size: 270788708 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
                        sort order: +++++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: string)
                        Statistics: Num rows: 2550599 Data size: 270788708 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 1275299 Data size: 135394300 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 1275299 Data size: 135394300 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: double)
              sort order: -
              Statistics: Num rows: 1275299 Data size: 135394300 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1275299 Data size: 135394300 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1275299 Data size: 135394300 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col4 (type: int)
                1 _col0 (type: int)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col4 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col6, _col12, _col13, _col14
                  Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: int)
              sort order: +
              Map-reduce partition columns: _col4 (type: int)
              Statistics: Num rows: 1742095 Data size: 184952316 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col6 (type: float)
          TableScan
            alias: customer
            Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: int), c_current_cdemo_sk (type: int), c_current_hdemo_sk (type: int), c_current_addr_sk (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 500000 Data size: 430009964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col4 (type: int)
            1 _col0 (type: int)
          outputColumnNames: _col1, _col2, _col3, _col6, _col12, _col13, _col14
          Statistics: Num rows: 1916304 Data size: 203447552 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query92.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-2 depends on stages: Stage-11
  Stage-3 depends on stages: Stage-2, Stage-7
  Stage-4 depends on stages: Stage-3
  Stage-12 is a root stage
  Stage-7 depends on stages: Stage-12
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_month_seq >= 1206) and (d_month_seq <= 1217) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_sold_date_sk (type: int)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: int), _col0 (type: int)
                  outputColumnNames: _col1, _col0
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col1 (type: int), _col0 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int)
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
                      Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int)
            1 _col0 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CASE WHEN ((_col0 is not null and _col2 is null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is null and _col2 is not null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is not null and _col2 is not null)) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col0), sum(_col1), sum(_col2)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:d2 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:d2 
          TableScan
            alias: d2
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_month_seq >= 1206) and (d_month_seq <= 1217) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: cs
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_sold_date_sk (type: int)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: int), _col1 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
                    Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query93.sql
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-8 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-8
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and ss_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sales_price (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col3 (type: int), _col4 (type: float)
          TableScan
            alias: store_returns
            Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_reason_sk is not null and sr_item_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_item_sk (type: int), sr_reason_sk (type: int), sr_ticket_number (type: bigint), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: int), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: int), _col2 (type: bigint)
                  Statistics: Num rows: 2875432 Data size: 223197964 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: int), _col3 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: int), _col2 (type: bigint)
            1 _col0 (type: int), _col2 (type: bigint)
          outputColumnNames: _col1, _col3, _col4, _col6, _col8
          Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_2:reason 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_2:reason 
          TableScan
            alias: reason
            Statistics: Num rows: 45 Data size: 9112 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((r_reason_desc = 'Did not like the warranty') and r_reason_sk is not null) (type: boolean)
              Statistics: Num rows: 22 Data size: 4454 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: r_reason_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 22 Data size: 4454 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col6 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col6 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col1, _col3, _col4, _col8
              Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: int), CASE WHEN (_col8 is not null) THEN ((UDFToFloat((_col3 - _col8)) * _col4)) ELSE ((UDFToFloat(_col3) * _col4)) END (type: float)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 17424599 Data size: 1540312977 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: double), _col0 (type: int)
              sort order: ++
              Statistics: Num rows: 17424599 Data size: 1540312977 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: int), KEY.reducesinkkey0 (type: double)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 17424599 Data size: 1540312977 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 8800 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 8800 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query94.sql
STAGE DEPENDENCIES:
  Stage-7 is a root stage
  Stage-19 depends on stages: Stage-7 , consists of Stage-22, Stage-1
  Stage-22 has a backup stage: Stage-1
  Stage-18 depends on stages: Stage-22
  Stage-21 depends on stages: Stage-1, Stage-18
  Stage-15 depends on stages: Stage-21
  Stage-14 depends on stages: Stage-15 , consists of Stage-20, Stage-5
  Stage-20 has a backup stage: Stage-5
  Stage-13 depends on stages: Stage-20
  Stage-6 depends on stages: Stage-5, Stage-13
  Stage-5
  Stage-1
  Stage-0 depends on stages: Stage-6

STAGE PLANS:
  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws2
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: ws3
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col0 <> _col2) (type: boolean)
            Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:ca 
          Fetch Operator
            limit: -1
        $hdt$_3:s 
          Fetch Operator
            limit: -1
        $hdt$_4:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:ca 
          TableScan
            alias: ca
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'TX') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:s 
          TableScan
            alias: s
            Statistics: Num rows: 42 Data size: 78018 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((web_company_name = 'pri') and web_site_sk is not null) (type: boolean)
              Statistics: Num rows: 21 Data size: 39009 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: web_site_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 21 Data size: 39009 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:d 
          TableScan
            alias: d
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '1999-05-01' AND '1999-07-01' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5
              Statistics: Num rows: 9579959 Data size: 1302609891 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col3, _col4, _col5
                Statistics: Num rows: 10537955 Data size: 1432870911 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5
                  Statistics: Num rows: 11591750 Data size: 1576158036 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_5:wr1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_5:wr1 
          TableScan
            alias: wr1
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col3, _col4, _col5, _col12
              Statistics: Num rows: 12750925 Data size: 1733773877 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: _col12 is null (type: boolean)
                Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
                  outputColumnNames: _col3, _col4, _col5
                  Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                    keys: _col3 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: double), _col3 (type: double)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col0:0._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col3 (type: bigint)
              Statistics: Num rows: 11591750 Data size: 1576158036 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col4 (type: float), _col5 (type: float)
          TableScan
            alias: wr1
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col3, _col4, _col5, _col12
          Statistics: Num rows: 12750925 Data size: 1733773877 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: _col12 is null (type: boolean)
            Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: float)
              outputColumnNames: _col3, _col4, _col5
              Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                keys: _col3 (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 6375462 Data size: 866886870 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col3 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col3 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query95.sql
STAGE DEPENDENCIES:
  Stage-6 is a root stage
  Stage-18 depends on stages: Stage-6, Stage-8, Stage-19, Stage-20 , consists of Stage-23, Stage-1
  Stage-23 has a backup stage: Stage-1
  Stage-17 depends on stages: Stage-23
  Stage-22 depends on stages: Stage-1, Stage-17
  Stage-5 depends on stages: Stage-22
  Stage-1
  Stage-9 is a root stage
  Stage-21 depends on stages: Stage-9 , consists of Stage-24, Stage-25, Stage-8
  Stage-24 has a backup stage: Stage-8
  Stage-19 depends on stages: Stage-24
  Stage-25 has a backup stage: Stage-8
  Stage-20 depends on stages: Stage-25
  Stage-8
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws2
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: ws3
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col0 <> _col2) (type: boolean)
            Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col3 (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                       Left Semi Join 0 to 2
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                    2 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 19159919 Data size: 2605219783 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-22
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:ca 
          Fetch Operator
            limit: -1
        $hdt$_4:s 
          Fetch Operator
            limit: -1
        $hdt$_5:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:ca 
          TableScan
            alias: ca
            Statistics: Num rows: 250000 Data size: 253719984 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_state = 'GA') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 125000 Data size: 126859992 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_4:s 
          TableScan
            alias: s
            Statistics: Num rows: 42 Data size: 78018 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((web_company_name = 'pri') and web_site_sk is not null) (type: boolean)
              Statistics: Num rows: 21 Data size: 39009 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: web_site_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 21 Data size: 39009 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)
        $hdt$_5:d 
          TableScan
            alias: d
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN '2002-05-01' AND '2002-06-30' and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col1 (type: int)
                1 _col0 (type: int)
              outputColumnNames: _col0, _col2, _col3, _col4, _col5
              Statistics: Num rows: 21075911 Data size: 2865741823 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col3, _col4, _col5
                Statistics: Num rows: 23183502 Data size: 3152316073 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col3, _col4, _col5
                  Statistics: Num rows: 25501852 Data size: 3467547755 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: count(DISTINCT _col3), sum(_col4), sum(_col5)
                    keys: _col3 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 25501852 Data size: 3467547755 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      sort order: +
                      Statistics: Num rows: 25501852 Data size: 3467547755 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col2 (type: double), _col3 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col0:0._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws1
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null and ws_order_number is not null) (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_ship_date_sk (type: int), ws_ship_addr_sk (type: int), ws_web_site_sk (type: int), ws_order_number (type: bigint), ws_ext_ship_cost (type: float), ws_net_profit (type: float)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col3 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col3 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col4 (type: float), _col5 (type: float)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Semi Join 0 to 1
               Left Semi Join 0 to 2
          keys:
            0 _col3 (type: bigint)
            1 _col0 (type: bigint)
            2 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 19159919 Data size: 2605219783 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws4
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
          TableScan
            alias: ws5
            Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_warehouse_sk (type: int), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 7197566 Data size: 978670028 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col1 (type: bigint)
            1 _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col0 <> _col2) (type: boolean)
            Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Conditional Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: wr
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_2:wr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_2:wr 
          TableScan
            alias: wr
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-20
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: wr
            Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_order_number is not null (type: boolean)
              Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_order_number (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 719217 Data size: 66312200 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 7917322 Data size: 1076537054 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0
          Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            keys: _col0 (type: bigint)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 8709054 Data size: 1184190785 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query96.sql
STAGE DEPENDENCIES:
  Stage-12 is a root stage
  Stage-4 depends on stages: Stage-12
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:household_demographics 
          Fetch Operator
            limit: -1
        $hdt$_2:time_dim 
          Fetch Operator
            limit: -1
        $hdt$_3:store 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:household_demographics 
          TableScan
            alias: household_demographics
            Statistics: Num rows: 7200 Data size: 770400 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 5) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 385200 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
        $hdt$_2:time_dim 
          TableScan
            alias: time_dim
            Statistics: Num rows: 86400 Data size: 40780800 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour = 8) and (t_minute >= 30) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 14400 Data size: 6796800 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_3:store 
          TableScan
            alias: store
            Statistics: Num rows: 102 Data size: 195626 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_store_name = 'ese') and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 51 Data size: 97813 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_hdemo_sk is not null and ss_sold_time_sk is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_time_sk (type: int), ss_hdemo_sk (type: int), ss_store_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 28800991 Data size: 2545971828 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 31681090 Data size: 2800569071 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col2
                    Statistics: Num rows: 34849199 Data size: 3080626044 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: int)
                        1 _col0 (type: int)
                      Statistics: Num rows: 38334119 Data size: 3388688721 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query97.sql
STAGE DEPENDENCIES:
  Stage-11 is a root stage
  Stage-2 depends on stages: Stage-11
  Stage-3 depends on stages: Stage-2, Stage-7
  Stage-4 depends on stages: Stage-3
  Stage-12 is a root stage
  Stage-7 depends on stages: Stage-12
  Stage-0 depends on stages: Stage-4

STAGE PLANS:
  Stage: Stage-11
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: ss_item_sk (type: int), ss_customer_sk (type: int), ss_sold_date_sk (type: int)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col1 (type: int), _col0 (type: int)
                  outputColumnNames: _col1, _col0
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col1 (type: int), _col0 (type: int)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int)
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
                      Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 15127648 Data size: 1363214706 Basic stats: COMPLETE Column stats: NONE
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int), _col1 (type: int)
              sort order: ++
              Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
              Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
          keys:
            0 _col0 (type: int), _col1 (type: int)
            1 _col0 (type: int), _col1 (type: int)
          outputColumnNames: _col0, _col2
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CASE WHEN ((_col0 is not null and _col2 is null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is null and _col2 is not null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is not null and _col2 is not null)) THEN (1) ELSE (0) END (type: int)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: sum(_col0), sum(_col1), sum(_col2)
              mode: hash
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_month_seq BETWEEN 1193 AND 1204 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: catalog_sales
            Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: cs_bill_customer_sk (type: int), cs_item_sk (type: int), cs_sold_date_sk (type: int)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 14329288 Data size: 1944770352 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col2 (type: int)
                  1 _col0 (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: int), _col1 (type: int)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int)
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
                    Statistics: Num rows: 15762217 Data size: 2139247433 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: int), KEY._col1 (type: int)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 7881108 Data size: 1069623648 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

@@@sample-queries-tpcds/query98.sql
STAGE DEPENDENCIES:
  Stage-10 is a root stage
  Stage-3 depends on stages: Stage-10
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5

STAGE PLANS:
  Stage: Stage-10
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 102000 Data size: 146158594 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Jewelry', 'Sports', 'Books') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: int), i_item_id (type: string), i_item_desc (type: string), i_current_price (type: float), i_class (type: string), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 51000 Data size: 73079297 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
        $hdt$_0:$hdt$_2:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 73049 Data size: 81741831 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date BETWEEN 2001-01-12 AND 2001-02-11 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: int)
                outputColumnNames: _col0
                Statistics: Num rows: 8116 Data size: 9081804 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: int)
                    1 _col0 (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: int), ss_ext_sales_price (type: float), ss_sold_date_sk (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 27504814 Data size: 2478572140 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 30255296 Data size: 2726429413 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float), _col1 (type: float)
                      outputColumnNames: _col8, _col7, _col4, _col5, _col6, _col1
                      Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col8 (type: string), _col7 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: float)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
                          sort order: +++++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float)
                          Statistics: Num rows: 33280826 Data size: 2999072419 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col5 (type: double)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string), KEY._col4 (type: float)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col2 (type: string), _col3 (type: string), _col0 (type: string), _col1 (type: string), _col4 (type: float), _col5 (type: double)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col3 (type: string)
              sort order: +
              Map-reduce partition columns: _col3 (type: string)
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col4 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string), VALUE._col2 (type: string), KEY.reducesinkkey0 (type: string), VALUE._col3 (type: float), VALUE._col4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          PTF Operator
            Function definitions:
                Input definition
                  input alias: ptf_0
                  output shape: _col0: string, _col1: string, _col2: string, _col3: string, _col4: float, _col5: double
                  type: WINDOWING
                Windowing table definition
                  input alias: ptf_1
                  name: windowingtablefunction
                  order by: _col3 ASC NULLS FIRST
                  partition by: _col3
                  raw input shape:
                  window functions:
                      window function definition
                        alias: sum_window_0
                        arguments: _col5
                        name: sum
                        window function: GenericUDAFSumDouble
                        window frame: PRECEDING(MAX)~FOLLOWING(MAX)
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col1 (type: string), _col2 (type: string), _col3 (type: string), _col4 (type: float), _col0 (type: string), _col5 (type: double), ((_col5 * 100.0) / sum_window_0) (type: double)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string), _col2 (type: string), _col4 (type: string), _col0 (type: string), _col6 (type: double)
              sort order: +++++
              Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: float), _col5 (type: double)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey3 (type: string), KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: float), KEY.reducesinkkey2 (type: string), VALUE._col1 (type: double), KEY.reducesinkkey4 (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 16640413 Data size: 1499536209 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

